import{getCurrentInstance as e,inject as t,ref as a,computed as n,unref as i,isRef as r,defineComponent as o,createVNode as s,Fragment as l,openBlock as d,createElementBlock as u,createElementVNode as c,reactive as h,createTextVNode as p,resolveComponent as f,Teleport as _,isVNode as m,provide as g,watch as v,markRaw as y,watchEffect as b,h as S,onUnmounted as A,onMounted as E,toRaw as w,render as T,nextTick as C}from"vue";import{localeContextKey as R,ElMessage as D,ElTooltip as x,ElScrollbar as L,ElDivider as k,ElColorPicker as B,ElSwitch as O,ElDropdown as M,ElIcon as I,ElDropdownMenu as P,ElDropdownItem as U,ElDrawer as N,ElMenuItem as V,ElSubMenu as j,ElMenu as z,ElContainer as F,ElCol as G,ElFormItem as H,ElInput as q,ElSelect as W,ElOption as K,ElDatePicker as Y,ElInputNumber as $,ElForm as X,ElRow as Z,ElButton as J,ElTable as Q,ElTableColumn as ee,ElCheckbox as te,ElMessageBox as ae,ElPagination as ne,ElDialog as ie,ElTag as re,ElRadioGroup as oe,ElRadio as se,ElUpload as le,ElImageViewer as de,ElImage as ue,ElTimeSelect as ce,ElCheckboxGroup as he,ElEmpty as pe}from"element-plus";import{useDateFormat as fe,useNow as _e,useFullscreen as me}from"@vueuse/core";import*as ge from"@tensorflow/tfjs";import ve from"video.js";import"video.js/dist/video-js.css";import ye from"video.js/dist/lang/zh-CN.json";import be from"video.js/dist/lang/en.json";import Se from"video.js/dist/lang/zh-TW.json";const Ae="next",Ee=(e,t,a,n,i)=>{let r=`${e}-${t}`;return a&&(r+=`-${a}`),n&&(r+=`__${n}`),i&&(r+=`--${i}`),r},we=Symbol("namespaceContextKey"),Te=r=>{const o=r||(e()?t(we,a(Ae)):a(Ae));return n((()=>i(o)||Ae))},Ce=(e,t)=>{const a=Te(t);return{namespace:a,b:(t="")=>Ee(a.value,e,t,"",""),e:t=>t?Ee(a.value,e,"",t,""):"",m:t=>t?Ee(a.value,e,"","",t):"",be:(t,n)=>t&&n?Ee(a.value,e,t,n,""):"",em:(t,n)=>t&&n?Ee(a.value,e,"",t,n):"",bm:(t,n)=>t&&n?Ee(a.value,e,t,"",n):"",bem:(t,n,i)=>t&&n&&i?Ee(a.value,e,t,n,i):"",bf:(...t)=>{let n=`${a.value}-${e}`;for(const e in t){const a=t[e];a&&(n+="-"+a)}return n},is:(e,...t)=>{const a=!(t.length>=1)||t[0];return e&&a?`is-${e}`:""},cssVar:e=>{const t={};for(const n in e)e[n]&&(t[`--${a.value}-${n}`]=e[n]);return t},cssVarName:e=>`--${a.value}-${e}`,cssVarBlock:t=>{const n={};for(const i in t)t[i]&&(n[`--${a.value}-${e}-${i}`]=t[i]);return n},cssVarBlockName:t=>`--${a.value}-${e}-${t}`}};var Re="object"==typeof global&&global&&global.Object===Object&&global,De="object"==typeof self&&self&&self.Object===Object&&self,xe=Re||De||Function("return this")(),Le=xe.Symbol,ke=Object.prototype,Be=ke.hasOwnProperty,Oe=ke.toString,Me=Le?Le.toStringTag:void 0;var Ie=Object.prototype.toString;var Pe="[object Null]",Ue="[object Undefined]",Ne=Le?Le.toStringTag:void 0;function Ve(e){return null==e?void 0===e?Ue:Pe:Ne&&Ne in Object(e)?function(e){var t=Be.call(e,Me),a=e[Me];try{e[Me]=void 0;var n=!0}catch(e){}var i=Oe.call(e);return n&&(t?e[Me]=a:delete e[Me]),i}(e):function(e){return Ie.call(e)}(e)}function je(e){return null!=e&&"object"==typeof e}var ze="[object Symbol]";function Fe(e){return"symbol"==typeof e||je(e)&&Ve(e)==ze}var Ge=Array.isArray,He=1/0,qe=Le?Le.prototype:void 0,We=qe?qe.toString:void 0;function Ke(e){if("string"==typeof e)return e;if(Ge(e))return function(e,t){for(var a=-1,n=null==e?0:e.length,i=Array(n);++a<n;)i[a]=t(e[a],a,e);return i}(e,Ke)+"";if(Fe(e))return We?We.call(e):"";var t=e+"";return"0"==t&&1/e==-He?"-0":t}function Ye(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function $e(e){return e}var Xe="[object AsyncFunction]",Ze="[object Function]",Je="[object GeneratorFunction]",Qe="[object Proxy]";function et(e){if(!Ye(e))return!1;var t=Ve(e);return t==Ze||t==Je||t==Xe||t==Qe}var tt,at=xe["__core-js_shared__"],nt=(tt=/[^.]+$/.exec(at&&at.keys&&at.keys.IE_PROTO||""))?"Symbol(src)_1."+tt:"";var it=Function.prototype.toString;function rt(e){if(null!=e){try{return it.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var ot=/^\[object .+?Constructor\]$/,st=Function.prototype,lt=Object.prototype,dt=st.toString,ut=lt.hasOwnProperty,ct=RegExp("^"+dt.call(ut).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ht(e){return!(!Ye(e)||(t=e,nt&&nt in t))&&(et(e)?ct:ot).test(rt(e));var t}function pt(e,t){var a=function(e,t){return null==e?void 0:e[t]}(e,t);return ht(a)?a:void 0}var ft=pt(xe,"WeakMap"),_t=Object.create,mt=function(){function e(){}return function(t){if(!Ye(t))return{};if(_t)return _t(t);e.prototype=t;var a=new e;return e.prototype=void 0,a}}(),gt=mt;var vt=Date.now;var yt,bt,St,At=function(){try{var e=pt(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),Et=At,wt=Et?function(e,t){return Et(e,"toString",{configurable:!0,enumerable:!1,value:(a=t,function(){return a}),writable:!0});var a}:$e,Tt=(yt=wt,bt=0,St=0,function(){var e=vt(),t=16-(e-St);if(St=e,t>0){if(++bt>=800)return arguments[0]}else bt=0;return yt.apply(void 0,arguments)}),Ct=9007199254740991,Rt=/^(?:0|[1-9]\d*)$/;function Dt(e,t){var a=typeof e;return!!(t=null==t?Ct:t)&&("number"==a||"symbol"!=a&&Rt.test(e))&&e>-1&&e%1==0&&e<t}function xt(e,t,a){"__proto__"==t&&Et?Et(e,t,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[t]=a}function Lt(e,t){return e===t||e!=e&&t!=t}var kt=Object.prototype.hasOwnProperty;function Bt(e,t,a){var n=e[t];kt.call(e,t)&&Lt(n,a)&&(void 0!==a||t in e)||xt(e,t,a)}var Ot=Math.max;function Mt(e,t){return Tt(function(e,t,a){return t=Ot(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,r=Ot(n.length-t,0),o=Array(r);++i<r;)o[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=a(o),function(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}(e,this,s)}}(e,t,$e),e+"")}var It=9007199254740991;function Pt(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=It}function Ut(e){return null!=e&&Pt(e.length)&&!et(e)}function Nt(e){return Mt((function(t,a){var n=-1,i=a.length,r=i>1?a[i-1]:void 0,o=i>2?a[2]:void 0;for(r=e.length>3&&"function"==typeof r?(i--,r):void 0,o&&function(e,t,a){if(!Ye(a))return!1;var n=typeof t;return!!("number"==n?Ut(a)&&Dt(t,a.length):"string"==n&&t in a)&&Lt(a[t],e)}(a[0],a[1],o)&&(r=i<3?void 0:r,i=1),t=Object(t);++n<i;){var s=a[n];s&&e(t,s,n,r)}return t}))}var Vt=Object.prototype;function jt(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Vt)}function zt(e){return je(e)&&"[object Arguments]"==Ve(e)}var Ft=Object.prototype,Gt=Ft.hasOwnProperty,Ht=Ft.propertyIsEnumerable,qt=zt(function(){return arguments}())?zt:function(e){return je(e)&&Gt.call(e,"callee")&&!Ht.call(e,"callee")};var Wt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Kt=Wt&&"object"==typeof module&&module&&!module.nodeType&&module,Yt=Kt&&Kt.exports===Wt?xe.Buffer:void 0,$t=(Yt?Yt.isBuffer:void 0)||function(){return!1},Xt={};Xt["[object Float32Array]"]=Xt["[object Float64Array]"]=Xt["[object Int8Array]"]=Xt["[object Int16Array]"]=Xt["[object Int32Array]"]=Xt["[object Uint8Array]"]=Xt["[object Uint8ClampedArray]"]=Xt["[object Uint16Array]"]=Xt["[object Uint32Array]"]=!0,Xt["[object Arguments]"]=Xt["[object Array]"]=Xt["[object ArrayBuffer]"]=Xt["[object Boolean]"]=Xt["[object DataView]"]=Xt["[object Date]"]=Xt["[object Error]"]=Xt["[object Function]"]=Xt["[object Map]"]=Xt["[object Number]"]=Xt["[object Object]"]=Xt["[object RegExp]"]=Xt["[object Set]"]=Xt["[object String]"]=Xt["[object WeakMap]"]=!1;var Zt="object"==typeof exports&&exports&&!exports.nodeType&&exports,Jt=Zt&&"object"==typeof module&&module&&!module.nodeType&&module,Qt=Jt&&Jt.exports===Zt&&Re.process,ea=function(){try{var e=Jt&&Jt.require&&Jt.require("util").types;return e||Qt&&Qt.binding&&Qt.binding("util")}catch(e){}}(),ta=ea&&ea.isTypedArray,aa=ta?function(e){return function(t){return e(t)}}(ta):function(e){return je(e)&&Pt(e.length)&&!!Xt[Ve(e)]},na=aa,ia=Object.prototype.hasOwnProperty;function ra(e,t){var a=Ge(e),n=!a&&qt(e),i=!a&&!n&&$t(e),r=!a&&!n&&!i&&na(e),o=a||n||i||r,s=o?function(e,t){for(var a=-1,n=Array(e);++a<e;)n[a]=t(a);return n}(e.length,String):[],l=s.length;for(var d in e)!t&&!ia.call(e,d)||o&&("length"==d||i&&("offset"==d||"parent"==d)||r&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||Dt(d,l))||s.push(d);return s}function oa(e,t){return function(a){return e(t(a))}}var sa=oa(Object.keys,Object),la=Object.prototype.hasOwnProperty;function da(e){return Ut(e)?ra(e):function(e){if(!jt(e))return sa(e);var t=[];for(var a in Object(e))la.call(e,a)&&"constructor"!=a&&t.push(a);return t}(e)}var ua=Object.prototype.hasOwnProperty;function ca(e){if(!Ye(e))return function(e){var t=[];if(null!=e)for(var a in Object(e))t.push(a);return t}(e);var t=jt(e),a=[];for(var n in e)("constructor"!=n||!t&&ua.call(e,n))&&a.push(n);return a}function ha(e){return Ut(e)?ra(e,!0):ca(e)}var pa=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,fa=/^\w*$/;var _a=pt(Object,"create");var ma=Object.prototype.hasOwnProperty;var ga=Object.prototype.hasOwnProperty;function va(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var n=e[t];this.set(n[0],n[1])}}function ya(e,t){for(var a=e.length;a--;)if(Lt(e[a][0],t))return a;return-1}va.prototype.clear=function(){this.__data__=_a?_a(null):{},this.size=0},va.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},va.prototype.get=function(e){var t=this.__data__;if(_a){var a=t[e];return"__lodash_hash_undefined__"===a?void 0:a}return ma.call(t,e)?t[e]:void 0},va.prototype.has=function(e){var t=this.__data__;return _a?void 0!==t[e]:ga.call(t,e)},va.prototype.set=function(e,t){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=_a&&void 0===t?"__lodash_hash_undefined__":t,this};var ba=Array.prototype.splice;function Sa(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var n=e[t];this.set(n[0],n[1])}}Sa.prototype.clear=function(){this.__data__=[],this.size=0},Sa.prototype.delete=function(e){var t=this.__data__,a=ya(t,e);return!(a<0)&&(a==t.length-1?t.pop():ba.call(t,a,1),--this.size,!0)},Sa.prototype.get=function(e){var t=this.__data__,a=ya(t,e);return a<0?void 0:t[a][1]},Sa.prototype.has=function(e){return ya(this.__data__,e)>-1},Sa.prototype.set=function(e,t){var a=this.__data__,n=ya(a,e);return n<0?(++this.size,a.push([e,t])):a[n][1]=t,this};var Aa=pt(xe,"Map");function Ea(e,t){var a,n,i=e.__data__;return("string"==(n=typeof(a=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==a:null===a)?i["string"==typeof t?"string":"hash"]:i.map}function wa(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var n=e[t];this.set(n[0],n[1])}}wa.prototype.clear=function(){this.size=0,this.__data__={hash:new va,map:new(Aa||Sa),string:new va}},wa.prototype.delete=function(e){var t=Ea(this,e).delete(e);return this.size-=t?1:0,t},wa.prototype.get=function(e){return Ea(this,e).get(e)},wa.prototype.has=function(e){return Ea(this,e).has(e)},wa.prototype.set=function(e,t){var a=Ea(this,e),n=a.size;return a.set(e,t),this.size+=a.size==n?0:1,this};var Ta="Expected a function";function Ca(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Ta);var a=function(){var n=arguments,i=t?t.apply(this,n):n[0],r=a.cache;if(r.has(i))return r.get(i);var o=e.apply(this,n);return a.cache=r.set(i,o)||r,o};return a.cache=new(Ca.Cache||wa),a}Ca.Cache=wa;var Ra=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Da=/\\(\\)?/g,xa=function(e){var t=Ca(e,(function(e){return 500===a.size&&a.clear(),e})),a=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Ra,(function(e,a,n,i){t.push(n?i.replace(Da,"$1"):a||e)})),t})),La=xa;function ka(e,t){return Ge(e)?e:function(e,t){if(Ge(e))return!1;var a=typeof e;return!("number"!=a&&"symbol"!=a&&"boolean"!=a&&null!=e&&!Fe(e))||fa.test(e)||!pa.test(e)||null!=t&&e in Object(t)}(e,t)?[e]:La(function(e){return null==e?"":Ke(e)}(e))}var Ba=1/0;function Oa(e){if("string"==typeof e||Fe(e))return e;var t=e+"";return"0"==t&&1/e==-Ba?"-0":t}function Ma(e,t,a){var n=null==e?void 0:function(e,t){for(var a=0,n=(t=ka(t,e)).length;null!=e&&a<n;)e=e[Oa(t[a++])];return a&&a==n?e:void 0}(e,t);return void 0===n?a:n}var Ia=oa(Object.getPrototypeOf,Object),Pa="[object Object]",Ua=Function.prototype,Na=Object.prototype,Va=Ua.toString,ja=Na.hasOwnProperty,za=Va.call(Object);function Fa(e){var t=this.__data__=new Sa(e);this.size=t.size}Fa.prototype.clear=function(){this.__data__=new Sa,this.size=0},Fa.prototype.delete=function(e){var t=this.__data__,a=t.delete(e);return this.size=t.size,a},Fa.prototype.get=function(e){return this.__data__.get(e)},Fa.prototype.has=function(e){return this.__data__.has(e)},Fa.prototype.set=function(e,t){var a=this.__data__;if(a instanceof Sa){var n=a.__data__;if(!Aa||n.length<199)return n.push([e,t]),this.size=++a.size,this;a=this.__data__=new wa(n)}return a.set(e,t),this.size=a.size,this};var Ga="object"==typeof exports&&exports&&!exports.nodeType&&exports,Ha=Ga&&"object"==typeof module&&module&&!module.nodeType&&module,qa=Ha&&Ha.exports===Ga?xe.Buffer:void 0,Wa=qa?qa.allocUnsafe:void 0;var Ka=Object.prototype.propertyIsEnumerable,Ya=Object.getOwnPropertySymbols,$a=Ya?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var a=-1,n=null==e?0:e.length,i=0,r=[];++a<n;){var o=e[a];t(o,a,e)&&(r[i++]=o)}return r}(Ya(e),(function(t){return Ka.call(e,t)})))}:function(){return[]},Xa=$a;function Za(e){return function(e,t,a){var n=t(e);return Ge(e)?n:function(e,t){for(var a=-1,n=t.length,i=e.length;++a<n;)e[i+a]=t[a];return e}(n,a(e))}(e,da,Xa)}var Ja=pt(xe,"DataView"),Qa=pt(xe,"Promise"),en=pt(xe,"Set"),tn="[object Map]",an="[object Promise]",nn="[object Set]",rn="[object WeakMap]",on="[object DataView]",sn=rt(Ja),ln=rt(Aa),dn=rt(Qa),un=rt(en),cn=rt(ft),hn=Ve;(Ja&&hn(new Ja(new ArrayBuffer(1)))!=on||Aa&&hn(new Aa)!=tn||Qa&&hn(Qa.resolve())!=an||en&&hn(new en)!=nn||ft&&hn(new ft)!=rn)&&(hn=function(e){var t=Ve(e),a="[object Object]"==t?e.constructor:void 0,n=a?rt(a):"";if(n)switch(n){case sn:return on;case ln:return tn;case dn:return an;case un:return nn;case cn:return rn}return t});var pn=hn,fn=xe.Uint8Array;function _n(e,t){var a,n,i=t?(a=e.buffer,n=new a.constructor(a.byteLength),new fn(n).set(new fn(a)),n):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}function mn(e){var t=-1,a=null==e?0:e.length;for(this.__data__=new wa;++t<a;)this.add(e[t])}function gn(e,t){for(var a=-1,n=null==e?0:e.length;++a<n;)if(t(e[a],a,e))return!0;return!1}mn.prototype.add=mn.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},mn.prototype.has=function(e){return this.__data__.has(e)};var vn=1,yn=2;function bn(e,t,a,n,i,r){var o=a&vn,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var d=r.get(e),u=r.get(t);if(d&&u)return d==t&&u==e;var c=-1,h=!0,p=a&yn?new mn:void 0;for(r.set(e,t),r.set(t,e);++c<s;){var f=e[c],_=t[c];if(n)var m=o?n(_,f,c,t,e,r):n(f,_,c,e,t,r);if(void 0!==m){if(m)continue;h=!1;break}if(p){if(!gn(t,(function(e,t){if(o=t,!p.has(o)&&(f===e||i(f,e,a,n,r)))return p.push(t);var o}))){h=!1;break}}else if(f!==_&&!i(f,_,a,n,r)){h=!1;break}}return r.delete(e),r.delete(t),h}function Sn(e){var t=-1,a=Array(e.size);return e.forEach((function(e,n){a[++t]=[n,e]})),a}function An(e){var t=-1,a=Array(e.size);return e.forEach((function(e){a[++t]=e})),a}var En=1,wn=2,Tn="[object Boolean]",Cn="[object Date]",Rn="[object Error]",Dn="[object Map]",xn="[object Number]",Ln="[object RegExp]",kn="[object Set]",Bn="[object String]",On="[object Symbol]",Mn="[object ArrayBuffer]",In="[object DataView]",Pn=Le?Le.prototype:void 0,Un=Pn?Pn.valueOf:void 0;var Nn=1,Vn=Object.prototype.hasOwnProperty;var jn=1,zn="[object Arguments]",Fn="[object Array]",Gn="[object Object]",Hn=Object.prototype.hasOwnProperty;function qn(e,t,a,n,i,r){var o=Ge(e),s=Ge(t),l=o?Fn:pn(e),d=s?Fn:pn(t),u=(l=l==zn?Gn:l)==Gn,c=(d=d==zn?Gn:d)==Gn,h=l==d;if(h&&$t(e)){if(!$t(t))return!1;o=!0,u=!1}if(h&&!u)return r||(r=new Fa),o||na(e)?bn(e,t,a,n,i,r):function(e,t,a,n,i,r,o){switch(a){case In:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Mn:return!(e.byteLength!=t.byteLength||!r(new fn(e),new fn(t)));case Tn:case Cn:case xn:return Lt(+e,+t);case Rn:return e.name==t.name&&e.message==t.message;case Ln:case Bn:return e==t+"";case Dn:var s=Sn;case kn:var l=n&En;if(s||(s=An),e.size!=t.size&&!l)return!1;var d=o.get(e);if(d)return d==t;n|=wn,o.set(e,t);var u=bn(s(e),s(t),n,i,r,o);return o.delete(e),u;case On:if(Un)return Un.call(e)==Un.call(t)}return!1}(e,t,l,a,n,i,r);if(!(a&jn)){var p=u&&Hn.call(e,"__wrapped__"),f=c&&Hn.call(t,"__wrapped__");if(p||f){var _=p?e.value():e,m=f?t.value():t;return r||(r=new Fa),i(_,m,a,n,r)}}return!!h&&(r||(r=new Fa),function(e,t,a,n,i,r){var o=a&Nn,s=Za(e),l=s.length;if(l!=Za(t).length&&!o)return!1;for(var d=l;d--;){var u=s[d];if(!(o?u in t:Vn.call(t,u)))return!1}var c=r.get(e),h=r.get(t);if(c&&h)return c==t&&h==e;var p=!0;r.set(e,t),r.set(t,e);for(var f=o;++d<l;){var _=e[u=s[d]],m=t[u];if(n)var g=o?n(m,_,u,t,e,r):n(_,m,u,e,t,r);if(!(void 0===g?_===m||i(_,m,a,n,r):g)){p=!1;break}f||(f="constructor"==u)}if(p&&!f){var v=e.constructor,y=t.constructor;v==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(p=!1)}return r.delete(e),r.delete(t),p}(e,t,a,n,i,r))}function Wn(e,t,a,n,i){return e===t||(null==e||null==t||!je(e)&&!je(t)?e!=e&&t!=t:qn(e,t,a,n,Wn,i))}var Kn,Yn=function(e,t,a){for(var n=-1,i=Object(e),r=a(e),o=r.length;o--;){var s=r[Kn?o:++n];if(!1===t(i[s],s,i))break}return e},$n=Yn;function Xn(e,t,a){(void 0!==a&&!Lt(e[t],a)||void 0===a&&!(t in e))&&xt(e,t,a)}function Zn(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function Jn(e){return function(e,t,a,n){var i=!a;a||(a={});for(var r=-1,o=t.length;++r<o;){var s=t[r],l=n?n(a[s],e[s],s,a,e):void 0;void 0===l&&(l=e[s]),i?xt(a,s,l):Bt(a,s,l)}return a}(e,ha(e))}function Qn(e,t,a,n,i,r,o){var s=Zn(e,a),l=Zn(t,a),d=o.get(l);if(d)Xn(e,a,d);else{var u,c=r?r(s,l,a+"",e,t,o):void 0,h=void 0===c;if(h){var p=Ge(l),f=!p&&$t(l),_=!p&&!f&&na(l);c=l,p||f||_?Ge(s)?c=s:je(u=s)&&Ut(u)?c=function(e,t){var a=-1,n=e.length;for(t||(t=Array(n));++a<n;)t[a]=e[a];return t}(s):f?(h=!1,c=function(e,t){if(t)return e.slice();var a=e.length,n=Wa?Wa(a):new e.constructor(a);return e.copy(n),n}(l,!0)):_?(h=!1,c=_n(l,!0)):c=[]:function(e){if(!je(e)||Ve(e)!=Pa)return!1;var t=Ia(e);if(null===t)return!0;var a=ja.call(t,"constructor")&&t.constructor;return"function"==typeof a&&a instanceof a&&Va.call(a)==za}(l)||qt(l)?(c=s,qt(s)?c=Jn(s):Ye(s)&&!et(s)||(c=function(e){return"function"!=typeof e.constructor||jt(e)?{}:gt(Ia(e))}(l))):h=!1}h&&(o.set(l,c),i(c,l,n,r,o),o.delete(l)),Xn(e,a,c)}}function ei(e,t,a,n,i){e!==t&&$n(t,(function(r,o){if(i||(i=new Fa),Ye(r))Qn(e,t,o,a,ei,n,i);else{var s=n?n(Zn(e,o),r,o+"",e,t,i):void 0;void 0===s&&(s=r),Xn(e,o,s)}}),ha)}var ti=Nt((function(e,t,a,n){ei(e,t,a,n)})),ai=ti;var ni=Nt((function(e,t,a){ei(e,t,a)})),ii=ni,ri={name:"zh-cn",next:{loading:"加载中...",table:{search:"查询",clear:"清空",add:"新增",delete:"删除",batchDelete:"批量删除",export:"导出",edit:"编辑",view:"查看",unfoldSearch:"展开搜索",foldSearch:"收起搜索",notData:"暂无数据",operation:"操作",selection:"选择",selectionAll:"全选",setting:{title:"设置列",label:"列名",hide:"隐藏",filter:"筛选",sort:"排序"},message:{tip:"提示",batchDeleteTip:"您确定要批量删除吗?",cancelBatchDelete:"取消批量删除操作",deleteTip:"您确定要删除该数据吗?",cancelDelete:"取消删除操作",confirmButtonText:"确 定",cancelButtonText:"取 消"}},form:{input:"请输入",select:"请选择",requiredInput:" 必填",requiredSelect:" 必选",submit:"提 交",cancel:"取 消",reset:"重 置",confirm:"确 定",tableSelect:" 选择",selectFile:"选择文件"},date:{oneWeekAge:"一周以前",oneMonthAge:"一个月以前",threeMonthsAge:"三个月以前",oneYearAge:"一年以前",threeYearsAge:"三年以前",rangeSeparator:"至",startPlaceholder:"开始时间",endPlaceholder:"结束时间"},layout:{home:"首页",personal:"个人中心",logOut:"退出登录",tabsOther:"关闭其他",tabsLeft:"关闭左侧",tabsRight:"关闭右侧",tabsAll:"关闭全部",systemSetting:"系统配置"}}},oi={name:"en",next:{loading:"loading...",table:{search:"search",clear:"clear",add:"add",delete:"del",batchDelete:"batch delete",export:"export",edit:"edit",view:"view",unfoldSearch:"unfold search",foldSearch:"fold search",notData:"not data",operation:"operations",selection:"selection",selectionAll:"select all",setting:{title:"column setting",label:"column name",hide:"hide",filter:"filter",sort:"srot"},message:{tip:"tip",batchDeleteTip:"Are you sure you want to delete them in bulk ?",cancelBatchDelete:"Cancel batch deletion",deleteTip:"Are you sure you want to delete this data ?",cancelDelete:"Cancel delete",confirmButtonText:"OK",cancelButtonText:"Cancel"}},form:{input:"please input ",select:"please select ",requiredInput:" required",requiredSelect:" required",submit:"Submit",cancel:"Cancel",reset:"reset",confirm:"confirm",tableSelect:" select",selectFile:"select file"},date:{oneWeekAge:"one week age",oneMonthAge:"one month age",threeMonthsAge:"three months age",oneYearAge:"one year age",threeYearsAge:"three years age",rangeSeparator:"to",startPlaceholder:"start time",endPlaceholder:"end time"},layout:{home:"Home",personal:"Personal",logOut:"LogOut",tabsOther:"close other",tabsLeft:"close left",tabsRight:"close right",tabsAll:"close all",systemSetting:"system setting"}}},si={name:"zh-tw",next:{loading:"加載中...",table:{search:"查詢",clear:"清空",add:"新增",delete:"刪除",batchDelete:"批量刪除",export:"導出",edit:"編輯",view:"查看",unfoldSearch:"展開搜索",foldSearch:"收起搜索",notData:"暫無數據",operation:"操作",selection:"选择",selectionAll:"全选",setting:{title:"設置列",label:"列名",hide:"隱藏",filter:"篩選",sort:"排序"},message:{tip:"提示",batchDeleteTip:"您確定要批量刪除嗎?",cancelBatchDelete:"取消批量刪除操作",deleteTip:"您确定要删除该数据吗?",cancelDelete:"取消删除操作",confirmButtonText:"確 定",cancelButtonText:"取 消"}},form:{input:"請輸入",select:"請選擇",requiredInput:" 必填",requiredSelect:" 必選",submit:"提 交",cancel:"取 消",reset:"重 置",confirm:"确 定",tableSelect:" 選擇",selectFile:"選擇文件"},date:{oneWeekAge:"一周以前",oneMonthAge:"一个月以前",threeMonthsAge:"三个月以前",oneYearAge:"一年以前",threeYearsAge:"三年以前",rangeSeparator:"至",startPlaceholder:"開始時間",endPlaceholder:"結束時間"},layout:{home:"首頁",personal:"個人中心",logOut:"退出登錄",tabsOther:"關閉其他",tabsLeft:"關閉左側",tabsRight:"關閉右側",tabsAll:"關閉全部",systemSetting:"系統配置"}}};const li={[ri.name]:{...ri},[oi.name]:{...oi},[si.name]:{...si}},di=(e,t,a)=>Ma(a,e,e).replace(/\{(\w+)\}/g,((e,a)=>`${t?.[a]??`{${a}}`}`)),ui=e=>(t,a)=>di(t,a,i(e)),ci=e=>{const t=n((()=>i(e).name)),o=r(e)?e:a(e),s=li[t.value]||li["zh-cn"];return o.value.next=s.next,{lang:t,locale:o,t:ui(e)}},hi=R,pi=e=>{const i=e||t(hi,a());return ci(n((()=>i?.value||ri)))},fi=(e,t)=>{const n=r(e)?e:a(e),i=li[t]||li["zh-cn"];n.value.name=t,n.value.next=i.next};function _i(){return{hexToRgb:e=>{let t="";if(!/^\#?[0-9A-Fa-f]{6}$/.test(e))return D.warning("输入错误的hex"),"";t=(e=e.replace("#","")).match(/../g);for(let e=0;e<3;e++)t[e]=parseInt(t[e],16);return t},rgbToHex:(e,t,a)=>{let n=/^\d{1,3}$/;if(!n.test(e)||!n.test(t)||!n.test(a))return D.warning("输入错误的rgb颜色值"),"";let i=[e.toString(16),t.toString(16),a.toString(16)];for(let e=0;e<3;e++)1==i[e].length&&(i[e]=`0${i[e]}`);return`#${i.join("")}`},getDarkColor:(e,t)=>{if(!/^\#?[0-9A-Fa-f]{6}$/.test(e))return D.warning("输入错误的hex颜色值"),"";let a=_i().hexToRgb(e);for(let e=0;e<3;e++)a[e]=Math.floor(a[e]*(1-t));return _i().rgbToHex(a[0],a[1],a[2])},getLightColor:(e,t)=>{if(!/^\#?[0-9A-Fa-f]{6}$/.test(e))return D.warning("输入错误的hex颜色值"),"";let a=_i().hexToRgb(e);for(let e=0;e<3;e++)a[e]=Math.floor((255-a[e])*t+a[e]);return _i().rgbToHex(a[0],a[1],a[2])}}}const{getLightColor:mi}=_i(),gi=(e,t)=>{document.documentElement.style.setProperty(e,t)},vi=(e,t)=>{gi(e,t);for(let a=1;a<10;a++)gi(e+"-light-"+a,mi(t,a/10));gi(`${e}-dark-2`,t)},yi=e=>{e&&vi("--el-color-primary",e)},bi={themeColor:"--el-color-primary",headerBarColor:"--next-layout-bg-color",headerBarFontColor:"--next-layout-font-color"},Si=e=>{for(const t in bi){const a=bi[t];e[t]&&vi(a,e[t])}const t=document.documentElement;e.isDark?t.setAttribute("data-theme","dark"):t.setAttribute("data-theme","")},Ai=async(e,t,a,n,i,r=[],o,s)=>{const{videoWidth:l,videoHeight:d}=e;if(!l||!d)return;let[u,c]=t.inputs[0].shape.slice(1,3),h=n.tidy((()=>n.image.resizeBilinear(n.browser.fromPixels(e),[u,c]).div(255).expandDims(0)));a.clearRect(0,0,l,d),o.clearRect(0,0,l,d),await t.executeAsync(h).then((async t=>{let[u,c,p,f]=t;for(let t=0;t<f.dataSync()[0];++t){let[n,h,f,_]=u.dataSync().slice(4*t,4*(t+1));n=n<0||n>1?parseInt(n):n,f=f<0||f>1?parseInt(f):f,h=h<0||h>1?parseInt(h):h,_=_<0||_>1?parseInt(_):_,n=Math.round(Math.abs(n)*l),f=Math.round(Math.abs(f)*l),h=Math.round(Math.abs(h)*d),_=Math.round(Math.abs(_)*d);const m=f-n,g=_-h,v=n,y=h;let b=p.dataSync()[t],S=c.dataSync()[t].toFixed(2);const A=(e,t,a)=>{const n=`#${(1<<24|Math.floor(256*Math.random())<<16|Math.floor(256*Math.random())<<8|Math.floor(256*Math.random())).toString(16).slice(1)}`;a.strokeStyle=n,a.lineWidth=2,a.beginPath(),a.rect(v,y,m,g),a.stroke(),a.font="bold 16px Arial",a.fillStyle=n,a.fillText(`${e} ${t}`,v+10,y<20?20:y-10)};if(r?.length)for(let t=0;t<r.length;t++){const n=r[t];if(n.cls==b&&Number(S)>n.score){const t=i.find((e=>e.value==b));if(t){const n=t.label;A(n,S,await Ei(e,o)),A(n,S,a),s&&s(n,S)}}}else if(S>.5){const e=i.find((e=>e.value==b));if(e){A(e.label||"",S,a)}}}h.dispose(),n.dispose(t)}))},Ei=(e,t)=>{const a=e.videoWidth,n=e.videoHeight,i=a/n,r=a/n,o=a,s=n;let l,d,u,c;return i>r?(u=a,c=a/i,l=0,d=Math.round((n-c)/2)):i===r?(u=a,c=n,l=0,d=0):i<r&&(u=n*i,c=n,l=Math.round((a-u)/2),d=0),t.drawImage(e,0,0,o,s,l,d,u,c),t},wi=()=>({detectVideoFrameImage:({container:e,video:t,modelUrl:a,classNames:n,classInput:i=[]},r,o)=>a?n?void ge.loadGraphModel(a).then((a=>{const o=document.createElement("canvas"),s=o.getContext("2d");o.style.position="absolute",o.style.zIndex="99",o.style.pointerEvents="none",e&&e.appendChild(o);const l=document.createElement("canvas"),d=l.getContext("2d");t.ontimeupdate=e=>{const{clientWidth:u,clientHeight:c}=e.target,{videoWidth:h,videoHeight:p,offsetTop:f,offsetLeft:_}=t;o.width=h,o.height=p,o.style.top=f+"px",o.style.left=_+"px",o.style.width=u+"px",o.style.height=c+"px",l.width=h,l.height=p,l.style.width=u+"px",l.style.height=c+"px",Ai(t,a,s,ge,n,i,d,((e,t)=>{const a="image/png";let n=o.toDataURL(a,.92).replace(a,"image/octet-stream");n=n.replace(/^data:image\/[^;]+/,"data:application/octet-stream");const i=l.toDataURL(a,.92);r&&r({name:e,score:t,detectImage:i,detectCanvas:l},{canvas:o,imageDataURL:n})}))}})):(o&&o("模型类别不能未空"),!1):(o&&o("模型文件地址不能为空"),!1)}),Ti=(e,t)=>{if(e.install=a=>{for(const n of[e,...Object.values(t??{})])a.component(n.name,n)},t)for(const[a,n]of Object.entries(t))e[a]=n;return e},Ci="header-menu",Ri="header-tools-prefix",Di="header-tools-suffix";var xi={logo:"",title:"Next Element Vue",userName:"Admin",language:"zh-cn",languageDropdown:[{value:"zh-cn",label:"简体中文"},{value:"en",label:"English"},{value:"zh-tw",label:"繁體中文"}],userDropdown:[{value:"/",label:"next.layout.home"},{value:"/personal",label:"next.layout.personal"},{value:"logOut",label:"next.layout.logOut",divided:!0}],showTabs:!0,activeTab:"/",tabs:[],menuTree:[],menuRouter:!0,menuMode:"horizontal",setting:{layout:"transverse",themeColor:"#c71585",headerBarColor:"#282c34",headerBarFontColor:"#FFFFFF",isHeaderBarColorGradual:!1,asidebarColor:"#282c34",asidebarFontColor:"#ffffff",isAsidebarColorGradual:!1,isDark:!1}};const Li=Ce("text-ellipsis");const ki=Ti(o({name:"NextTextEllipsis",props:{content:{type:String,default:""},disabled:{type:Boolean,default:!1},width:{type:[String,Number],default:""},placement:{type:String,default:"top"},textAlign:{type:String,default:"left"},class:{type:String,default:""}},setup(e,{slots:t}){const i=a(!1),r=n((()=>{const t=e.width;let a={textAlign:e.textAlign};return t&&("string"==typeof t?a.width=t:"number"==typeof t&&(a.width=t+"px")),a})),o=a(),d=()=>{try{const e=o.value;e&&e.scrollWidth&&e.scrollWidth>e.offsetWidth?i.value=!0:i.value=!1}catch(e){i.value=!1}};return()=>s(l,null,[s("div",{class:[Li.b(),e.class],style:r.value,onMouseenter:d},[i.value?s(x,{effect:"dark",content:e.content,placement:e.placement,disabled:e.disabled},{default:()=>[s("span",{class:Li.e("text"),ref:o},[t.default?t.default():e.content])]}):s("span",{class:Li.e("text"),ref:o},[t.default?t.default():e.content])])])}}));var Bi=o({setup(){const e=t("__ns__",{}),a=t("options",{}),{t:n}=pi();return()=>s(l,null,[s("div",{class:e.bf("header","logo")},[a.logo&&s("img",{class:e.be("header-logo","img"),src:a.logo,alt:"logo"},null),a.title&&s("p",{class:e.be("header-logo","title")},[s(ki,{content:n(a.title)},null)])])])}}),Oi=(e,t)=>{let a=e.__vccOpts||e;for(let[e,n]of t)a[e]=n;return a},Mi={name:"ArrowDown"},Ii={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Pi=[c("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"},null,-1)];var Ui=Oi(Mi,[["render",function(e,t,a,n,i,r){return d(),u("svg",Ii,Pi)}],["__file","arrow-down.vue"]]),Ni={name:"ArrowUp"},Vi={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},ji=[c("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0z"},null,-1)];var zi=Oi(Ni,[["render",function(e,t,a,n,i,r){return d(),u("svg",Vi,ji)}],["__file","arrow-up.vue"]]),Fi={name:"Back"},Gi={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Hi=[c("path",{fill:"currentColor",d:"M224 480h640a32 32 0 1 1 0 64H224a32 32 0 0 1 0-64z"},null,-1),c("path",{fill:"currentColor",d:"m237.248 512 265.408 265.344a32 32 0 0 1-45.312 45.312l-288-288a32 32 0 0 1 0-45.312l288-288a32 32 0 1 1 45.312 45.312L237.248 512z"},null,-1)];var qi=Oi(Fi,[["render",function(e,t,a,n,i,r){return d(),u("svg",Gi,Hi)}],["__file","back.vue"]]),Wi={name:"Camera"},Ki={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Yi=[c("path",{fill:"currentColor",d:"M896 256H128v576h768V256zm-199.424-64-32.064-64h-304.96l-32 64h369.024zM96 192h160l46.336-92.608A64 64 0 0 1 359.552 64h304.96a64 64 0 0 1 57.216 35.328L768.192 192H928a32 32 0 0 1 32 32v640a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V224a32 32 0 0 1 32-32zm416 512a160 160 0 1 0 0-320 160 160 0 0 0 0 320zm0 64a224 224 0 1 1 0-448 224 224 0 0 1 0 448z"},null,-1)];var $i=Oi(Wi,[["render",function(e,t,a,n,i,r){return d(),u("svg",Ki,Yi)}],["__file","camera.vue"]]),Xi={name:"Close"},Zi={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Ji=[c("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"},null,-1)];var Qi=Oi(Xi,[["render",function(e,t,a,n,i,r){return d(),u("svg",Zi,Ji)}],["__file","close.vue"]]),er={name:"DArrowLeft"},tr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},ar=[c("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"},null,-1)];var nr=Oi(er,[["render",function(e,t,a,n,i,r){return d(),u("svg",tr,ar)}],["__file","d-arrow-left.vue"]]),ir={name:"DArrowRight"},rr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},or=[c("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688zm-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"},null,-1)];var sr=Oi(ir,[["render",function(e,t,a,n,i,r){return d(),u("svg",rr,or)}],["__file","d-arrow-right.vue"]]),lr={name:"Delete"},dr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},ur=[c("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32V256zm448-64v-64H416v64h192zM224 896h576V256H224v640zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32zm192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32z"},null,-1)];var cr=Oi(lr,[["render",function(e,t,a,n,i,r){return d(),u("svg",dr,ur)}],["__file","delete.vue"]]),hr={name:"EditPen"},pr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},fr=[c("path",{fill:"currentColor",d:"m199.04 672.64 193.984 112 224-387.968-193.92-112-224 388.032zm-23.872 60.16 32.896 148.288 144.896-45.696L175.168 732.8zM455.04 229.248l193.92 112 56.704-98.112-193.984-112-56.64 98.112zM104.32 708.8l384-665.024 304.768 175.936L409.152 884.8h.064l-248.448 78.336L104.32 708.8zm384 254.272v-64h448v64h-448z"},null,-1)];var _r=Oi(hr,[["render",function(e,t,a,n,i,r){return d(),u("svg",pr,fr)}],["__file","edit-pen.vue"]]),mr={name:"FullScreen"},gr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},vr=[c("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64v.064zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64l-192 .192zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64v-.064z"},null,-1)];var yr=Oi(mr,[["render",function(e,t,a,n,i,r){return d(),u("svg",gr,vr)}],["__file","full-screen.vue"]]),br={name:"InfoFilled"},Sr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Ar=[c("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64zm67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344zM590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"},null,-1)];var Er=Oi(br,[["render",function(e,t,a,n,i,r){return d(),u("svg",Sr,Ar)}],["__file","info-filled.vue"]]),wr={name:"MoonNight"},Tr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Cr=[c("path",{fill:"currentColor",d:"M384 512a448 448 0 0 1 215.872-383.296A384 384 0 0 0 213.76 640h188.8A448.256 448.256 0 0 1 384 512zM171.136 704a448 448 0 0 1 636.992-575.296A384 384 0 0 0 499.328 704h-328.32z"},null,-1),c("path",{fill:"currentColor",d:"M32 640h960q32 0 32 32t-32 32H32q-32 0-32-32t32-32zm128 128h384a32 32 0 1 1 0 64H160a32 32 0 1 1 0-64zm160 127.68 224 .256a32 32 0 0 1 32 32V928a32 32 0 0 1-32 32l-224-.384a32 32 0 0 1-32-32v-.064a32 32 0 0 1 32-32z"},null,-1)];var Rr=Oi(wr,[["render",function(e,t,a,n,i,r){return d(),u("svg",Tr,Cr)}],["__file","moon-night.vue"]]),Dr={name:"Picture"},xr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Lr=[c("path",{fill:"currentColor",d:"M160 160v704h704V160H160zm-32-64h768a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H128a32 32 0 0 1-32-32V128a32 32 0 0 1 32-32z"},null,-1),c("path",{fill:"currentColor",d:"M384 288q64 0 64 64t-64 64q-64 0-64-64t64-64zM185.408 876.992l-50.816-38.912L350.72 556.032a96 96 0 0 1 134.592-17.856l1.856 1.472 122.88 99.136a32 32 0 0 0 44.992-4.864l216-269.888 49.92 39.936-215.808 269.824-.256.32a96 96 0 0 1-135.04 14.464l-122.88-99.072-.64-.512a32 32 0 0 0-44.8 5.952L185.408 876.992z"},null,-1)];var kr=Oi(Dr,[["render",function(e,t,a,n,i,r){return d(),u("svg",xr,Lr)}],["__file","picture.vue"]]),Br={name:"Plus"},Or={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Mr=[c("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64h352z"},null,-1)];var Ir=Oi(Br,[["render",function(e,t,a,n,i,r){return d(),u("svg",Or,Mr)}],["__file","plus.vue"]]),Pr={name:"Refresh"},Ur={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Nr=[c("path",{fill:"currentColor",d:"M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"},null,-1)];var Vr=Oi(Pr,[["render",function(e,t,a,n,i,r){return d(),u("svg",Ur,Nr)}],["__file","refresh.vue"]]),jr={name:"Right"},zr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Fr=[c("path",{fill:"currentColor",d:"M754.752 480H160a32 32 0 1 0 0 64h594.752L521.344 777.344a32 32 0 0 0 45.312 45.312l288-288a32 32 0 0 0 0-45.312l-288-288a32 32 0 1 0-45.312 45.312L754.752 480z"},null,-1)];var Gr=Oi(jr,[["render",function(e,t,a,n,i,r){return d(),u("svg",zr,Fr)}],["__file","right.vue"]]),Hr={name:"Search"},qr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Wr=[c("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704z"},null,-1)];var Kr=Oi(Hr,[["render",function(e,t,a,n,i,r){return d(),u("svg",qr,Wr)}],["__file","search.vue"]]),Yr={name:"Setting"},$r={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Xr=[c("path",{fill:"currentColor",d:"M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36-116.224-25.088-65.28 113.152 79.68 88.192-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136-79.808 88.192 65.344 113.152 116.224-25.024 22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152 24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296 116.288 25.024 65.28-113.152-79.744-88.192 1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136 79.808-88.128-65.344-113.152-116.288 24.96-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384 192 192 0 0 1 0-384zm0 64a128 128 0 1 0 0 256 128 128 0 0 0 0-256z"},null,-1)];var Zr=Oi(Yr,[["render",function(e,t,a,n,i,r){return d(),u("svg",$r,Xr)}],["__file","setting.vue"]]),Jr={name:"Sunny"},Qr={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},eo=[c("path",{fill:"currentColor",d:"M512 704a192 192 0 1 0 0-384 192 192 0 0 0 0 384zm0 64a256 256 0 1 1 0-512 256 256 0 0 1 0 512zm0-704a32 32 0 0 1 32 32v64a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 768a32 32 0 0 1 32 32v64a32 32 0 1 1-64 0v-64a32 32 0 0 1 32-32zM195.2 195.2a32 32 0 0 1 45.248 0l45.248 45.248a32 32 0 1 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm543.104 543.104a32 32 0 0 1 45.248 0l45.248 45.248a32 32 0 0 1-45.248 45.248l-45.248-45.248a32 32 0 0 1 0-45.248zM64 512a32 32 0 0 1 32-32h64a32 32 0 0 1 0 64H96a32 32 0 0 1-32-32zm768 0a32 32 0 0 1 32-32h64a32 32 0 1 1 0 64h-64a32 32 0 0 1-32-32zM195.2 828.8a32 32 0 0 1 0-45.248l45.248-45.248a32 32 0 0 1 45.248 45.248L240.448 828.8a32 32 0 0 1-45.248 0zm543.104-543.104a32 32 0 0 1 0-45.248l45.248-45.248a32 32 0 0 1 45.248 45.248l-45.248 45.248a32 32 0 0 1-45.248 0z"},null,-1)];var to=Oi(Jr,[["render",function(e,t,a,n,i,r){return d(),u("svg",Qr,eo)}],["__file","sunny.vue"]]),ao={name:"Tools"},no={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},io=[c("path",{fill:"currentColor",d:"M764.416 254.72a351.68 351.68 0 0 1 86.336 149.184H960v192.064H850.752a351.68 351.68 0 0 1-86.336 149.312l54.72 94.72-166.272 96-54.592-94.72a352.64 352.64 0 0 1-172.48 0L371.136 936l-166.272-96 54.72-94.72a351.68 351.68 0 0 1-86.336-149.312H64v-192h109.248a351.68 351.68 0 0 1 86.336-149.312L204.8 160l166.208-96h.192l54.656 94.592a352.64 352.64 0 0 1 172.48 0L652.8 64h.128L819.2 160l-54.72 94.72zM704 499.968a192 192 0 1 0-384 0 192 192 0 0 0 384 0z"},null,-1)];var ro=Oi(ao,[["render",function(e,t,a,n,i,r){return d(),u("svg",no,io)}],["__file","tools.vue"]]),oo={name:"View"},so={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},lo=[c("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352zm0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448zm0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160z"},null,-1)];var uo=Oi(oo,[["render",function(e,t,a,n,i,r){return d(),u("svg",so,lo)}],["__file","view.vue"]]),co=o({setup(){},render(){const e=t("__slots__",{}),a=t("__ns__",{}),n=t("options",{}),i=t("updateOptions",null),r=h({...n.setting}),o=()=>{const e={...n,setting:{...r}};i(e)},l=e=>{if(!e)return D({type:"warning",message:"主题颜色不能为空"}),!1;r.themeColor=e,vi("--el-color-primary",e),o()},d=()=>{const e=document.documentElement;r.isDark?e.setAttribute("data-theme","dark"):e.setAttribute("data-theme",""),o()},u=(e,t,a)=>{r[t]=e,gi(a,e),o()},c=[{type:"defaults",text:"默认"},{type:"classic",text:"经典"},{type:"transverse",text:"横向"},{type:"columns",text:"分栏"}];return s(L,null,{default:()=>[s(k,{"border-style":"dashed"},{default:()=>[p("全局主题")]}),s("div",{class:a.b("config-bar-item")},[s("span",{class:a.be("config-bar-item","label")},[p("主题颜色")]),s("div",{class:a.be("config-bar-item","value")},[s(B,{modelValue:r.themeColor,"onUpdate:modelValue":e=>r.themeColor=e,predefine:["#409eff","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","#FB07A0"],onChange:l},null)])]),s("div",{class:a.b("config-bar-item")},[s("span",{class:a.be("config-bar-item","label")},[p("暗黑模式")]),s("div",{class:a.be("config-bar-item","value")},[s(O,{modelValue:r.isDark,"onUpdate:modelValue":e=>r.isDark=e,"inline-prompt":!0,size:"large","active-icon":Rr,"inactive-icon":to,"active-color":"#1f1f1f","inactive-color":"#dcdfe6",onChange:d},null)])]),s("div",{class:a.b("config-bar-item")},[s("span",{class:a.be("config-bar-item","label")},[p("顶栏背景颜色")]),s("div",{class:a.be("config-bar-item","value")},[s(B,{modelValue:r.headerBarColor,"onUpdate:modelValue":e=>r.headerBarColor=e,predefine:["#282c34","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","#FB07A0"],onChange:e=>u(e,"headerBarColor","--next-layout-bg-color")},null)])]),s("div",{class:a.b("config-bar-item")},[s("span",{class:a.be("config-bar-item","label")},[p("顶栏字体颜色")]),s("div",{class:a.be("config-bar-item","value")},[s(B,{modelValue:r.headerBarFontColor,"onUpdate:modelValue":e=>r.headerBarFontColor=e,predefine:["#282c34","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","#FB07A0"],onChange:e=>u(e,"headerBarFontColor","--next-layout-font-color")},null)])]),s("div",{class:a.b("config-bar-item")},[s("span",{class:a.be("config-bar-item","label")},[p("顶栏背景渐变")]),s("div",{class:a.be("config-bar-item","value")},[s(f("el-switch"),{modelValue:r.isHeaderBarColorGradual,"onUpdate:modelValue":e=>r.isHeaderBarColorGradual=e,onChange:o},null)])]),s(k,{"border-style":"dashed"},{default:()=>[p("布局方式")]}),s("ul",{class:a.b("config-bar-layout")},[c.map((e=>s("li",{class:[a.be("config-bar-layout",e.type),a.is("active",r.layout===e.type)],onClick:t=>((e,t)=>{e.stopPropagation(),r.layout=t.type,o()})(t,e)},[s("div",{class:"layout-wrap"},[s("div",{class:"layout-box"},[s("p",{class:"layout-text"},[e.text])])]),s("aside",null,null)])))]),s("div",{class:a.b("config-bar-item"),style:{"margin-top":"20px"}},[s("span",{class:a.be("config-bar-item","label")},[p("是否显示标签栏")]),s("div",{class:a.be("config-bar-item","value")},[s(f("el-switch"),{modelValue:n.showTabs,"onUpdate:modelValue":e=>n.showTabs=e},null)])]),e.setting?.()]})}});function ho(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!m(e)}var po=o({setup(){const e=t(hi,a()),i=t("options",{}),{t:r}=pi(),{toggle:o,isFullscreen:s}=me(),l=a(n((()=>i.language)).value),d=a(!1);return{locale:e,config:i,t:r,toggle:o,isFullscreen:s,language:l,settingDrawer:d}},render(){const e=t("__ns__",{}),a=this.config,n=t("__emit__",{}),i=this.$slots,r=this.t,o=this.isFullscreen,d=a.profile,u=a.userDropdown,c=a.languageDropdown,h=()=>{this.settingDrawer=!1};return s(l,null,[s("ul",{class:e.b("header-tools")},[i[Ri]?.(),s("li",null,[s(M,{"show-timeout":70,"hide-timeout":50,trigger:"click",onCommand:e=>{this.language=e,n("changeLanguage",e),a.onChangeLanguage&&a.onChangeLanguage(e)}},{default:()=>s("div",null,[s(I,{size:16},{default:()=>[s("svg",{class:"icon",viewBox:"0 0 1070 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1855",width:"128",height:"128"},[s("path",{d:"M232.58156522 358.13286957C244.86956522 394.4626087 265.17147826 425.984 293.48730435 453.76556522c24.04173913-26.17878261 42.2066087-58.23443478 53.96034782-95.63269565H232.58156522z","p-id":"1856"},null),s("path",{d:"M981.61530435 143.36h-448.77913044L507.19165217 6.05495652h-416.72347826c-45.94643478 0-83.34469565 37.39826087-83.34469565 83.34469565v708.42991305c0 45.94643478 37.39826087 83.34469565 83.34469565 83.34469565h379.85947826l-30.45286956 137.30504348h541.74052174c45.94643478 0 83.34469565-37.39826087 83.34469565-83.34469565V226.70469565c0-45.94643478-37.39826087-83.34469565-83.34469565-83.34469565zM415.83304348 564.35756522c-49.152-18.16486957-89.75582609-41.13808696-122.34573913-67.85113044-34.19269565 30.45286957-76.93356522 52.89182609-126.61982609 66.7826087l-17.09634783-28.31582609c48.61773913-12.82226087 89.22156522-32.05565217 121.2772174-59.30295652-33.12417391-33.65843478-56.0973913-72.65947826-68.91965218-117.00313044h-46.48069565v-32.05565217H276.92521739c-7.47965217-13.89078261-17.09634783-27.24730435-28.31582609-40.06956522l32.05565218-11.75373913c11.21947826 14.42504348 21.37043478 31.5213913 30.45286956 51.28904348h115.9346087v32.05565218h-46.48069565c-14.95930435 45.94643478-36.32973913 84.41321739-64.64556522 115.40034782 31.5213913 25.11026087 71.05669565 45.94643478 117.5373913 63.04278261l-17.63060869 27.78156522z m607.45460869 370.24278261c0 22.97321739-18.69913043 41.67234783-41.67234782 41.67234782H492.23234783l20.83617391-95.63269565h156.53843478l-89.22156522-497.39686957-0.53426087 2.67130435-3.73982608-19.76765217 1.06852174 0.53426087-32.58991305-181.64869565H982.14956522c22.97321739 0 41.67234783 18.69913043 41.67234782 41.67234782v707.89565218z","p-id":"1857"},null),s("path",{d:"M684.56626087 541.38434783h114.86608696v-30.45286957h-114.86608696V450.02573913h122.34573913v-30.45286956h-158.14121739v219.04695652h162.94956522V608.16695652h-127.15408696v-66.78260869z m239.88313043-65.71408696c-9.61669565 0-18.16486957 1.60278261-26.1787826 5.87686956-7.47965217 3.73982609-14.95930435 9.61669565-20.83617392 17.09634783V479.94434783h-34.72695652v158.67547826h34.72695652v-95.63269566c1.06852174-12.82226087 5.3426087-22.43895652 12.82226087-29.38434782 6.41113043-5.87686957 13.89078261-9.08243478 22.43895652-9.08243478 24.04173913 0 35.79547826 12.82226087 35.79547826 39.00104347v94.56417392h34.72695653v-97.76973913c1.06852174-43.27513043-19.2333913-64.64556522-58.76869566-64.64556522z","p-id":"1858"},null)])]})]),dropdown:()=>{let e;return s(P,null,ho(e=c.map((e=>s(U,{command:e.value,disabled:this.language===e.value},{default:()=>[e.label]}))))?e:{default:()=>[e]})}})]),s("li",null,[s("span",{style:{display:"inline-block",lineHeight:1},onClick:this.toggle},[s(I,{size:16},{default:()=>[o?s("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2676",width:"128",height:"128"},[s("path",{d:"M749.248 704H864a32 32 0 1 0 0-64H672a32 32 0 0 0-32 32v192a32 32 0 1 0 64 0v-114.752l137.36 137.36a32 32 0 1 0 45.232-45.264L749.248 704zM320 749.248V864a32 32 0 1 0 64 0V672a32 32 0 0 0-32-32H160a32 32 0 1 0 0 64h114.752l-137.36 137.36a32 32 0 1 0 45.264 45.232L320 749.248zM749.248 320H864a32 32 0 1 1 0 64H672a32 32 0 0 1-32-32V160a32 32 0 1 1 64 0v114.752l137.36-137.36a32 32 0 1 1 45.232 45.264L749.248 320zM320 274.752V160a32 32 0 1 1 64 0v192a32 32 0 0 1-32 32H160a32 32 0 1 1 0-64h114.752l-137.36-137.36a32 32 0 1 1 45.264-45.232L320 274.752z","p-id":"2677"},null)]):s("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2522",width:"128",height:"128"},[s("path",{d:"M237.248 192H352a32 32 0 1 0 0-64H160a32 32 0 0 0-32 32v192a32 32 0 1 0 64 0v-114.752l137.36 137.36a32 32 0 1 0 45.232-45.264L237.248 192zM832 237.248V352a32 32 0 1 0 64 0V160a32 32 0 0 0-32-32H672a32 32 0 1 0 0 64h114.752l-137.36 137.36a32 32 0 1 0 45.264 45.232L832 237.248zM237.248 832H352a32 32 0 1 1 0 64H160a32 32 0 0 1-32-32V672a32 32 0 1 1 64 0v114.752l137.36-137.36a32 32 0 1 1 45.232 45.264L237.248 832zM832 786.752V672a32 32 0 1 1 64 0v192a32 32 0 0 1-32 32H672a32 32 0 1 1 0-64h114.752l-137.36-137.36a32 32 0 1 1 45.264-45.232L832 786.752z","p-id":"2523"},null)])]})])]),i[Di]?.(),s("li",null,[s(M,{"show-timeout":70,"hide-timeout":80,onCommand:e=>{n("changeUserDropdown",e),a.onChangeUserDropdown&&a.onChangeUserDropdown(e)}},{default:()=>s("span",{class:e.be("header-tools","user")},[d?s("img",{class:"user-photo",src:d},null):null,s("span",null,[a.userName]),s(I,{class:"el-icon--right"},{default:()=>[s(Ui,null,null)]})]),dropdown:()=>s(P,null,{default:()=>[u?.map((e=>{let t;return s(U,{command:e.value,divided:!!e.divided},ho(t=r(e.label))?t:{default:()=>[t]})}))]})})]),s("li",null,[s("span",{style:{display:"inline-block",lineHeight:1},onClick:()=>{this.settingDrawer=!0}},[s(I,{size:16},{default:()=>[s(Zr,null,null)]})])])]),s(_,{to:"body"},{default:()=>[s(N,{modelValue:this.settingDrawer,"onUpdate:modelValue":e=>this.settingDrawer=e,title:this.t("next.layout.systemSetting"),direction:"rtl",size:"380px",class:e.be("drawer","setting"),"destroy-on-close":!0,beforeClose:h},{default:()=>[s(co,null,null)]})]})])}});const{getLightColor:fo}=_i();var _o=o({setup:()=>({ns:t("ns",{})}),render(){const e=this.$slots,a=this.ns,i=t("options",{}),r=n((()=>{const{isHeaderBarColorGradual:e,headerBarColor:t}=i.setting;return e?{background:`linear-gradient(to bottom , ${t}, ${fo(t,.5)})`}:""}));return s("header",{class:a.b("header"),style:r.value},[s(Bi,null,null),s("div",{class:a.bf("header","right")},[s(po,null,{default:()=>[e[Ri]?.(),e[Di]?.()]})])])}}),mo=o({props:{meta:{type:Object,default:()=>({})}},setup(e){const a=t("ns",{}),{t:n}=pi(),i=e.meta;return()=>s(l,null,[s("span",{class:a.be("item","icon")},[i.icon?s("i",{class:i.icon},null):s("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"19771",width:"32",height:"32"},[s("path",{d:"M512 958.8C265.6 958.8 65.2 758.4 65.2 512S265.6 65.2 512 65.2 958.8 265.6 958.8 512 758.4 958.8 512 958.8z m0-832c-212.4 0-385.2 172.8-385.2 385.2S299.6 897.2 512 897.2 897.2 724.4 897.2 512 724.4 126.8 512 126.8z","p-id":"19772"},null),s("path",{d:"M512 512m-169.5 0a169.5 169.5 0 1 0 339 0 169.5 169.5 0 1 0-339 0Z","p-id":"19773"},null)])]),s("span",{class:a.be("item","title")},[n(i.title)])])}});const go=o({name:"NextMenuItem",props:{menuData:{type:Array,required:!0}},setup(e){const a=t("ns",{}),i=n((()=>e.menuData)).value;return()=>s(l,null,[s(l,null,[i.map((e=>e.children?.length?s(j,{"popper-class":a.b("popper"),index:e.path||e.id,teleported:!0},{title:()=>s(mo,{meta:e.meta},null),default:()=>s(go,{menuData:e.children},null)}):s(V,{index:e.path},{default:()=>[s(mo,{meta:e.meta},null)]})))])])}}),vo=Ce("menu");const yo=Ti(o({name:"NextMenu",props:{className:{type:String,default:""},style:{type:Object,default:()=>({})},router:{type:Boolean,default:!0},mode:{type:String,values:["horizontal","vertical"],default:"horizontal"},menuTree:{type:Array,default:()=>[]}},setup(t){g("ns",vo);const n=e().appContext.config.globalProperties.$router,i=n.currentRoute?.value.fullPath,r=a(i);v((()=>n.currentRoute?.value),(e=>{r.value=e.fullPath}));return()=>s(l,null,[s(z,{class:[vo.b(),t.className],style:t.style,defaultActive:r.value,router:t.router,mode:t.mode,ellipsis:!0},{default:()=>[s(l,null,[t.menuTree.map((e=>e.children?.length?s(j,{"popper-class":vo.b("popper"),index:e.path||e.id,teleported:!0},{title:()=>s(mo,{meta:e.meta},null),default:()=>s(go,{menuData:e.children},null)}):s(V,{"popper-class":vo.b("popper"),index:e.path},{default:()=>[s(mo,{meta:e.meta},null)]})))])]})])}}));var bo=o({setup:()=>({ns:t("ns",{})}),render(){const e=this.$slots,a=this.ns,n=t("options",{});return s("aside",{class:a.b("sidebar")},[s(L,null,{default:()=>[e[Ci]?e[Ci]():s(yo,{mode:"vertical",menuTree:n.menuTree},null)]})])}});const So=Ce("layout-defaults");var Ao=o({props:{},setup:()=>(g("ns",So),{}),render(){const e=this.$slots,n=t("options",{}),i=t("__emit__",{});e.menu;const r=a(!!e.tabs);return void 0===e.tabs&&n.showTabs&&(r.value=!0),s(F,{class:So.b()},{default:()=>[s(bo,null,null),s("div",{class:[So.b("content")]},[s(_o,null,null),n.showTabs?e.tabs?e.tabs?.():s(Go,{tabs:n.tabs,activeTab:n.activeTab,onChange:(...e)=>i("tabsChange",...e),onSelect:(...e)=>i("tabsSelect",...e),onClose:(...e)=>i("tabsClose",...e)},null):null,s("main",{class:[So.bf("main"),So.is("layout-tabs",r.value)]},[e.default?.()])])]})}});const{getLightColor:Eo}=_i();var wo=o({setup(e,{slots:a}){const i=t("ns",{}),r=t("options",{}),o=n((()=>{const{isHeaderBarColorGradual:e,headerBarColor:t}=r.setting;return e?{background:`linear-gradient(to bottom , ${t}, ${Eo(t,.5)})`}:""}));return()=>s(l,null,[s("header",{class:i.b("header"),style:o.value},[s(Bi,null,null),s("div",{class:i.bf("header","menu")},[a[Ci]?a[Ci]():s(yo,{menuTree:r.menuTree,router:r.menuRouter,mode:r.menuMode},null)]),s("div",{class:i.bf("header","right")},[s(po,null,{default:()=>[a[Ri]?.(),a[Di]?.()]})])])])}});const To=Ce("layout-transverse");var Co=o({props:{},setup:()=>(g("ns",To),{}),render(){const e=this.$slots,n=t("options",{}),i=t("__emit__",{}),r={};e[Ci]&&(r[Ci]=()=>e[Ci]()),e[Ri]&&(r[Ri]=()=>e[Ri]()),e[Di]&&(r[Di]=()=>e[Di]());const o=a(!!e.tabs);return void 0===e.tabs&&n.showTabs&&(o.value=!0),s(l,null,[s(wo,null,(d=r,"function"==typeof d||"[object Object]"===Object.prototype.toString.call(d)&&!m(d)?r:{default:()=>[r]})),n.showTabs?e.tabs?e.tabs?.():s(Go,{tabs:n.tabs,activeTab:n.activeTab,onChange:(...e)=>i("tabsChange",...e),onSelect:(...e)=>i("tabsSelect",...e),onClose:(...e)=>i("tabsClose",...e)},null):null,s("main",{class:[To.b("main"),To.is("layout-tabs",o.value)]},[e.default?.()])]);var d}});const{getLightColor:Ro}=_i();var Do=o({setup(e,{slots:a}){const i=t("ns",{}),r=t("options",{}),o=n((()=>{const{isHeaderBarColorGradual:e,headerBarColor:t}=r.setting;return e?{background:`linear-gradient(to bottom , ${t}, ${Ro(t,.5)})`}:""}));return()=>s(l,null,[s("header",{class:i.b("header"),style:o.value},[s(Bi,null,null),s("div",{class:i.bf("header","menu")},null),s("div",{class:i.bf("header","right")},[s(po,null,{default:()=>[a[Ri]?.(),a[Di]?.()]})])])])}}),xo=o({setup:()=>({ns:t("ns",{})}),render(){const e=this.$slots,a=this.ns,n=t("options",{});return s("aside",{class:a.b("sidebar")},[e[Ci]?e[Ci]():s(yo,{mode:"vertical",menuTree:n.menuTree},null)])}});const Lo=Ce("layout-columns");var ko=o({props:{},setup:()=>(g("ns",Lo),{}),render(){const e=this.$slots,n=t("options",{}),i=t("__emit__",{}),r={};e[Ci]&&(r[Ci]=()=>e[Ci]()),e[Ri]&&(r[Ri]=()=>e[Ri]()),e[Di]&&(r[Di]=()=>e[Di]());const o=a(!!e.tabs);return void 0===e.tabs&&n.showTabs&&(o.value=!0),s(F,{class:Lo.b()},{default:()=>{return[s(xo,null,null),s("div",{class:[Lo.b("content")]},[s(Do,null,(t=r,"function"==typeof t||"[object Object]"===Object.prototype.toString.call(t)&&!m(t)?r:{default:()=>[r]})),n.showTabs?e.tabs?e.tabs?.():s(Go,{tabs:n.tabs,activeTab:n.activeTab,onChange:(...e)=>i("tabsChange",...e),onSelect:(...e)=>i("tabsSelect",...e),onClose:(...e)=>i("tabsClose",...e)},null):null,s("main",{class:[Lo.bf("main"),Lo.is("layout-tabs",o.value)]},[e.default?.()])])];var t}})}});const{getLightColor:Bo}=_i();var Oo=o({setup(e,{slots:a}){const i=t("ns",{}),r=t("options",{}),o=n((()=>{const{isHeaderBarColorGradual:e,headerBarColor:t}=r.setting;return e?{background:`linear-gradient(to bottom , ${t}, ${Bo(t,.5)})`}:""}));return()=>s(l,null,[s("header",{class:i.b("header"),style:o.value},[s(Bi,null,null),s("div",{class:i.bf("header","menu")},[a[Ci]?.()]),s("div",{class:i.bf("header","right")},[s(po,null,{default:()=>[a[Ri]?.(),a[Di]?.()]})])])])}}),Mo=o({setup:()=>({ns:t("ns",{})}),render(){const e=this.$slots,a=this.ns,n=t("options",{});return s("aside",{class:a.b("sidebar")},[s(L,null,{default:()=>[e[Ci]?e[Ci]():s(yo,{mode:"vertical",menuTree:n.menuTree},null)]})])}});const Io=Ce("layout-classic");var Po=o({props:{},setup:()=>(g("ns",Io),{ns:Io}),render(){const e=this.$slots,n=t("options",{}),i=t("__emit__",{});e.menu;const r=a(!!e.tabs);return void 0===e.tabs&&n.showTabs&&(r.value=!0),s(l,null,[s(Oo,null,null),s("div",{class:[Io.b("content"),Io.is("layout-tabs",r.value)]},[s(Mo,null,null),s("div",{class:Io.b("container")},[n.showTabs?e.tabs?e.tabs?.():s(Go,{tabs:n.tabs,activeTab:n.activeTab,onChange:(...e)=>i("tabsChange",...e),onSelect:(...e)=>i("tabsSelect",...e),onClose:(...e)=>i("tabsClose",...e)},null):null,s("main",{class:[Io.b("main")]},[e.default?.()])])])])}});const Uo=Ce("layout"),No={defaults:y(Ao),transverse:y(Co),columns:y(ko),classic:y(Po)},Vo=(e,t)=>{if(Array.isArray(e))return t};const jo=Ti(o({name:"NextLayout",props:{className:{type:String,default:""},style:{type:Object,default:()=>({})},options:{type:Object,default:()=>({})}},emits:["changeLanguage","changeUserDropdown","changeOptions","tabsChange","tabsSelect","tabsClose"],setup(e,{slots:t,emit:n}){const i=a(ai(xi,e.options,Vo));g("options",i.value),g("__ns__",Uo),g("__emit__",n),g("__slots__",t);const r=e=>{i.value=ai(i.value,e,Vo),Si(i.value?.setting),n("changeOptions",i.value)};return g("updateOptions",r),v((()=>e.options),(e=>{r(e)}),{deep:!0,immediate:!0}),{options:i.value,updateOptions:r}},render(){const e=this.$props,t=this.$slots,n=this.options.setting?.layout||"transverse",i=a(No[n]);b((()=>{i.value=No[n],i.value||(i.value=No.transverse)}));const r={};for(const e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=()=>t[e]?.());return s("div",{class:[Uo.b(),e.className],style:e.style},[S(i.value,{},{...r})])}})),zo=Ce("tabs");var Fo=o({name:"NextTabs",props:{activeTab:{type:[String,Number],default:"/"},tabs:{type:Array,default:()=>[]}},emits:["change","select","close"],setup(t,{emit:i}){const{t:r}=pi(),o=e().appContext.config.globalProperties.$router,d=n((()=>o.currentRoute.value.fullPath)),u=n((()=>t.tabs)),c=u.value?.findIndex((e=>e.path===d.value));if(c<0){const e=u.value[0];e&&e.path&&o.replace({path:e.path})}const h=a(c),p=a(u.value),f=e=>{const t=d.value,a=p.value.length,n=p.value.findIndex((e=>e.path===t));switch(e){case"other":n>-1&&(h.value=1,p.value=[p.value[0],p.value[n]]);break;case"left":if(n>-1){const e=p.value.slice(n);e.unshift(p.value[0]),p.value=e,h.value=1}break;case"right":if(n>-1&&n<a-1){const e=p.value.slice(0,n+1);p.value=e}break;case"all":const e=p.value[0];h.value=0,p.value=[e],_(null,e,h.value)}i("change",h.value,p.value,e)},_=(e,t,a)=>{e?.stopPropagation(),h.value=a;let n={path:t.path,query:t.query,params:t.params};o.push(n),i("select",t,a)};v((()=>o.currentRoute?.value),(e=>{const{tagTitle:t}=e.query,a={name:e.name,title:t||e.meta?.title,path:e.path,meta:e.meta,params:e.params,query:e.query},n=p.value.findIndex((t=>t.path===e.path));n>-1?(h.value=n,p.value[n]=a):(h.value=p.value.length,p.value.push(a)),i("change",h.value,p.value,"add")}));const m=()=>s("nav",{class:zo.b()},[s(L,null,{default:()=>[s("ul",{class:zo.b("list")},[p.value.map(((e,t)=>e?s("li",{class:["tab-item",zo.is("active",h.value===t)],onClick:a=>_(a,e,t)},[s("i",{class:["tab-icon",e.meta?.icon]},null),s("span",null,[r(e.title)]),e.meta?.isAffix||"/"===e.path?null:s("span",{onClick:a=>((e,t,a)=>{e.stopPropagation();const n=d.value;if(n===t.path){const e=p.value[a-1];o.push({path:e.path,query:e.query||{},params:e.params||{}}),i("close",e,p.value)}p.value.splice(a,1);const r=p.value.findIndex((e=>e.path===n))||0;h.value=r>-1?r:0,i("change",h.value,p.value,"close")})(a,e,t)},[s(I,{class:"tab-close"},{default:()=>[s(Qi,null,null)]})])]):null))])]}),s(M,{"show-timeout":80,"hide-timeout":80,onCommand:f},{default:()=>s("span",{class:zo.b("tab-more")},[s("i",{class:[zo.be("tab-more","box"),zo.be("tab-more","top")]},null),s("i",{class:[zo.be("tab-more","box"),zo.be("tab-more","bottom")]},null)]),dropdown:()=>s(P,null,{default:()=>[s(U,{command:"other"},{default:()=>[s(I,null,{default:()=>[s(Qi,null,null)]}),s("span",null,[r("next.layout.tabsOther")])]}),s(U,{command:"left"},{default:()=>[s(I,null,{default:()=>[s(qi,null,null)]}),s("span",null,[r("next.layout.tabsLeft")])]}),s(U,{command:"right"},{default:()=>[s(I,null,{default:()=>[s(Gr,null,null)]}),s("span",null,[r("next.layout.tabsRight")])]}),s(U,{command:"all"},{default:()=>[s(I,null,{default:()=>[s(Qi,null,null)]}),s("span",null,[r("next.layout.tabsAll")])]})]})})]);return()=>s(l,null,[m()])}});const Go=Ti(Fo),Ho=Ce("container");const qo=Ti(o({name:"NextContainer",props:{className:{type:String,default:""},style:{type:Object,default:()=>({})},scrollbar:{type:Boolean,default:!1},padding:{type:[Boolean,String,Number],default:!0},card:{type:Boolean,default:!1}},setup(e,{slots:t}){const a=n((()=>{let t={};const a=e.padding;return"boolean"==typeof a?t=a?{padding:"15px"}:{}:"string"==typeof a?t={padding:a}:"number"==typeof a&&(t={padding:a+"px"}),t}));return()=>e.scrollbar?s(L,{class:[Ho.b(),e.className],style:e.style},{default:()=>[t.default?.()]}):s("div",{class:[Ho.b(),e.className],style:{...a.value,...e.style}},[e.card?s("div",{class:Ho.b("card")},[t.default?.()]):t.default?.()])}}));function Wo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ko={exports:{}};(Ko.exports={}).forEach=function(e,t){for(var a=0;a<e.length;a++){var n=t(e[a]);if(n)return n}};var Yo=Ko.exports,$o={exports:{}},Xo=$o.exports={};Xo.isIE=function(e){return(-1!==(t=navigator.userAgent.toLowerCase()).indexOf("msie")||-1!==t.indexOf("trident")||-1!==t.indexOf(" edge/"))&&(!e||e===function(){var e=3,t=document.createElement("div"),a=t.getElementsByTagName("i");do{t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e"}while(a[0]);return e>4?e:undefined}());var t},Xo.isLegacyOpera=function(){return!!window.opera};var Zo=$o.exports,Jo={exports:{}};(Jo.exports={}).getOption=function(e,t,a){var n=e[t];if(null==n&&void 0!==a)return a;return n};var Qo=Jo.exports;function es(){var e={},t=0,a=0,n=0;return{add:function(i,r){r||(r=i,i=0),i>a?a=i:i<n&&(n=i),e[i]||(e[i]=[]),e[i].push(r),t++},process:function(){for(var t=n;t<=a;t++)for(var i=e[t],r=0;r<i.length;r++){(0,i[r])()}},size:function(){return t}}}var ts="_erd";function as(e){return e[ts]}var ns={initState:function(e){return e[ts]={},as(e)},getState:as,cleanState:function(e){delete e[ts]}},is=Zo,rs=Yo.forEach,os=Yo.forEach,ss=function(e){var t=e.stateHandler.getState;return{isDetectable:function(e){var a=t(e);return a&&!!a.isDetectable},markAsDetectable:function(e){t(e).isDetectable=!0},isBusy:function(e){return!!t(e).busy},markBusy:function(e,a){t(e).busy=!!a}}},ls=function(e){var t={};function a(a){var n=e.get(a);return void 0===n?[]:t[n]||[]}return{get:a,add:function(a,n){var i=e.get(a);t[i]||(t[i]=[]),t[i].push(n)},removeListener:function(e,t){for(var n=a(e),i=0,r=n.length;i<r;++i)if(n[i]===t){n.splice(i,1);break}},removeAllListeners:function(e){var t=a(e);t&&(t.length=0)}}},ds=function(){var e=1;return{generate:function(){return e++}}},us=function(e){var t=e.idGenerator,a=e.stateHandler.getState;return{get:function(e){var t=a(e);return t&&void 0!==t.id?t.id:null},set:function(e){var n=a(e);if(!n)throw new Error("setId required the element to have a resize detection state.");var i=t.generate();return n.id=i,i}}},cs=function(e){function t(){}var a={log:t,warn:t,error:t};if(!e&&window.console){var n=function(e,t){e[t]=function(){var e=console[t];if(e.apply)e.apply(console,arguments);else for(var a=0;a<arguments.length;a++)e(arguments[a])}};n(a,"log"),n(a,"warn"),n(a,"error")}return a},hs=Zo,ps=function(e){var t=(e=e||{}).reporter,a=Qo.getOption(e,"async",!0),n=Qo.getOption(e,"auto",!0);n&&!a&&(t&&t.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),a=!0);var i,r=es(),o=!1;function s(){for(o=!0;r.size();){var e=r;r=es(),e.process()}o=!1}function l(){var e;e=s,i=setTimeout(e,0)}return{add:function(e,t){!o&&n&&a&&0===r.size()&&l(),r.add(e,t)},force:function(e){o||(void 0===e&&(e=a),i&&(clearTimeout(i),i=null),e?l():s())}}},fs=ns,_s=function(e){var t=(e=e||{}).reporter,a=e.batchProcessor,n=e.stateHandler.getState;if(!t)throw new Error("Missing required dependency: reporter.");function i(t){var a=e.important?" !important; ":"; ";return(t.join(a)+a).trim()}function r(e){return n(e).object}return{makeDetectable:function(e,r,o){o||(o=r,r=e,e=null),(e=e||{}).debug,is.isIE(8)?o(r):function(r,o){var s=i(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),l=!1,d=window.getComputedStyle(r),u=r.offsetWidth,c=r.offsetHeight;function h(){function a(){if("static"===d.position){r.style.setProperty("position","relative",e.important?"important":"");var a=function(t,a,n,i){var r=n[i];"auto"!==r&&"0"!==function(e){return e.replace(/[^-\d\.]/g,"")}(r)&&(t.warn("An element that is positioned static has style."+i+"="+r+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+i+" will be set to 0. Element: ",a),a.style.setProperty(i,"0",e.important?"important":""))};a(t,r,d,"top"),a(t,r,d,"right"),a(t,r,d,"bottom"),a(t,r,d,"left")}}""!==d.position&&(a(),l=!0);var i=document.createElement("object");i.style.cssText=s,i.tabIndex=-1,i.type="text/html",i.setAttribute("aria-hidden","true"),i.onload=function(){l||a(),function e(t,a){if(!t.contentDocument){var i=n(t);return i.checkForObjectDocumentTimeoutId&&window.clearTimeout(i.checkForObjectDocumentTimeoutId),void(i.checkForObjectDocumentTimeoutId=setTimeout((function(){i.checkForObjectDocumentTimeoutId=0,e(t,a)}),100))}a(t.contentDocument)}(this,(function(e){o(r)}))},is.isIE()||(i.data="about:blank"),n(r)&&(r.appendChild(i),n(r).object=i,is.isIE()&&(i.data="about:blank"))}n(r).startSize={width:u,height:c},a?a.add(h):h()}(r,o)},addListener:function(e,t){function a(){t(e)}if(is.isIE(8))n(e).object={proxy:a},e.attachEvent("onresize",a);else{var i=r(e);if(!i)throw new Error("Element is not detectable by this strategy.");i.contentDocument.defaultView.addEventListener("resize",a)}},uninstall:function(e){if(n(e)){var t=r(e);t&&(is.isIE(8)?e.detachEvent("onresize",t.proxy):e.removeChild(t),n(e).checkForObjectDocumentTimeoutId&&window.clearTimeout(n(e).checkForObjectDocumentTimeoutId),delete n(e).object)}}}},ms=function(e){var t=(e=e||{}).reporter,a=e.batchProcessor,n=e.stateHandler.getState;e.stateHandler.hasState;var i=e.idHandler;if(!a)throw new Error("Missing required dependency: batchProcessor");if(!t)throw new Error("Missing required dependency: reporter.");var r=function(){var e=500,t=500,a=document.createElement("div");a.style.cssText=l(["position: absolute","width: 1000px","height: 1000px","visibility: hidden","margin: 0","padding: 0"]);var n=document.createElement("div");n.style.cssText=l(["position: absolute","width: 500px","height: 500px","overflow: scroll","visibility: none","top: -1500px","left: -1500px","visibility: hidden","margin: 0","padding: 0"]),n.appendChild(a),document.body.insertBefore(n,document.body.firstChild);var i=e-n.clientWidth,r=t-n.clientHeight;return document.body.removeChild(n),{width:i,height:r}}(),o="erd_scroll_detection_container";function s(e){!function(e,t,a){function n(a,n){n=n||function(t){e.head.appendChild(t)};var i=e.createElement("style");return i.innerHTML=a,i.id=t,n(i),i}if(!e.getElementById(t)){var i=a+"_animation",r=a+"_animation_active",o="/* Created by the element-resize-detector library. */\n";o+="."+a+" > div::-webkit-scrollbar { "+l(["display: none"])+" }\n\n",o+="."+r+" { "+l(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+i,"animation-name: "+i])+" }\n",o+="@-webkit-keyframes "+i+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }\n",n(o+="@keyframes "+i+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }")}}(e,"erd_scroll_detection_scrollbar_style",o)}function l(t){var a=e.important?" !important; ":"; ";return(t.join(a)+a).trim()}function d(e,a,n){if(e.addEventListener)e.addEventListener(a,n);else{if(!e.attachEvent)return t.error("[scroll] Don't know how to add event listeners.");e.attachEvent("on"+a,n)}}function u(e,a,n){if(e.removeEventListener)e.removeEventListener(a,n);else{if(!e.detachEvent)return t.error("[scroll] Don't know how to remove event listeners.");e.detachEvent("on"+a,n)}}function c(e){return n(e).container.childNodes[0].childNodes[0].childNodes[0]}function h(e){return n(e).container.childNodes[0].childNodes[0].childNodes[1]}return s(window.document),{makeDetectable:function(e,s,u){function p(){if(e.debug){var a=Array.prototype.slice.call(arguments);if(a.unshift(i.get(s),"Scroll: "),t.log.apply)t.log.apply(null,a);else for(var n=0;n<a.length;n++)t.log(a[n])}}function f(e){var t=n(e).container.childNodes[0],a=window.getComputedStyle(t);return!a.width||-1===a.width.indexOf("px")}function _(){var e=window.getComputedStyle(s),t={};return t.position=e.position,t.width=s.offsetWidth,t.height=s.offsetHeight,t.top=e.top,t.right=e.right,t.bottom=e.bottom,t.left=e.left,t.widthCSS=e.width,t.heightCSS=e.height,t}function m(){if(p("storeStyle invoked."),n(s)){var e=_();n(s).style=e}else p("Aborting because element has been uninstalled")}function g(e,t,a){n(e).lastWidth=t,n(e).lastHeight=a}function v(){return 2*r.width+1}function y(){return 2*r.height+1}function b(e){return e+10+v()}function S(e){return e+10+y()}function A(e,t,a){var n=c(e),i=h(e),r=b(t),o=S(a),s=function(e){return 2*e+v()}(t),l=function(e){return 2*e+y()}(a);n.scrollLeft=r,n.scrollTop=o,i.scrollLeft=s,i.scrollTop=l}function E(){var e=n(s).container;if(!e){(e=document.createElement("div")).className=o,e.style.cssText=l(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),n(s).container=e,function(e){e.className+=" "+o+"_animation_active"}(e),s.appendChild(e);var t=function(){n(s).onRendered&&n(s).onRendered()};d(e,"animationstart",t),n(s).onAnimationStart=t}return e}function w(){if(p("Injecting elements"),n(s)){!function(){var a=n(s).style;if("static"===a.position){s.style.setProperty("position","relative",e.important?"important":"");var i=function(e,t,a,n){var i=a[n];"auto"!==i&&"0"!==function(e){return e.replace(/[^-\d\.]/g,"")}(i)&&(e.warn("An element that is positioned static has style."+n+"="+i+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+n+" will be set to 0. Element: ",t),t.style[n]=0)};i(t,s,a,"top"),i(t,s,a,"right"),i(t,s,a,"bottom"),i(t,s,a,"left")}}();var a=n(s).container;a||(a=E());var i,u,c,h,f=r.width,_=r.height,m=l(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),g=l(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(["left: "+(i=(i=-(1+f))?i+"px":"0"),"top: "+(u=(u=-(1+_))?u+"px":"0"),"right: "+(h=(h=-f)?h+"px":"0"),"bottom: "+(c=(c=-_)?c+"px":"0")])),v=l(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),y=l(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),b=l(["position: absolute","left: 0","top: 0"]),S=l(["position: absolute","width: 200%","height: 200%"]),A=document.createElement("div"),w=document.createElement("div"),T=document.createElement("div"),C=document.createElement("div"),R=document.createElement("div"),D=document.createElement("div");A.dir="ltr",A.style.cssText=m,A.className=o,w.className=o,w.style.cssText=g,T.style.cssText=v,C.style.cssText=b,R.style.cssText=y,D.style.cssText=S,T.appendChild(C),R.appendChild(D),w.appendChild(T),w.appendChild(R),A.appendChild(w),a.appendChild(A),d(T,"scroll",x),d(R,"scroll",L),n(s).onExpandScroll=x,n(s).onShrinkScroll=L}else p("Aborting because element has been uninstalled");function x(){var e=n(s);e&&e.onExpand?e.onExpand():p("Aborting expand scroll handler: element has been uninstalled")}function L(){var e=n(s);e&&e.onShrink?e.onShrink():p("Aborting shrink scroll handler: element has been uninstalled")}}function T(){function r(t,a,n){var i=function(e){return c(e).childNodes[0]}(t),r=b(a),o=S(n);i.style.setProperty("width",r+"px",e.important?"important":""),i.style.setProperty("height",o+"px",e.important?"important":"")}function o(o){var d=s.offsetWidth,u=s.offsetHeight,c=d!==n(s).lastWidth||u!==n(s).lastHeight;p("Storing current size",d,u),g(s,d,u),a.add(0,(function(){if(c)if(n(s))if(l()){if(e.debug){var a=s.offsetWidth,o=s.offsetHeight;a===d&&o===u||t.warn(i.get(s),"Scroll: Size changed before updating detector elements.")}r(s,d,u)}else p("Aborting because element container has not been initialized");else p("Aborting because element has been uninstalled")})),a.add(1,(function(){n(s)?l()?A(s,d,u):p("Aborting because element container has not been initialized"):p("Aborting because element has been uninstalled")})),c&&o&&a.add(2,(function(){n(s)?l()?o():p("Aborting because element container has not been initialized"):p("Aborting because element has been uninstalled")}))}function l(){return!!n(s).container}function d(){p("notifyListenersIfNeeded invoked");var e=n(s);return void 0===n(s).lastNotifiedWidth&&e.lastWidth===e.startSize.width&&e.lastHeight===e.startSize.height?p("Not notifying: Size is the same as the start size, and there has been no notification yet."):e.lastWidth===e.lastNotifiedWidth&&e.lastHeight===e.lastNotifiedHeight?p("Not notifying: Size already notified"):(p("Current size not notified, notifying..."),e.lastNotifiedWidth=e.lastWidth,e.lastNotifiedHeight=e.lastHeight,void rs(n(s).listeners,(function(e){e(s)})))}function u(){p("Scroll detected."),f(s)?p("Scroll event fired while unrendered. Ignoring..."):o(d)}if(p("registerListenersAndPositionElements invoked."),n(s)){n(s).onRendered=function(){if(p("startanimation triggered."),f(s))p("Ignoring since element is still unrendered...");else{p("Element rendered.");var e=c(s),t=h(s);0!==e.scrollLeft&&0!==e.scrollTop&&0!==t.scrollLeft&&0!==t.scrollTop||(p("Scrollbars out of sync. Updating detector elements..."),o(d))}},n(s).onExpand=u,n(s).onShrink=u;var _=n(s).style;r(s,_.width,_.height)}else p("Aborting because element has been uninstalled")}function C(){if(p("finalizeDomMutation invoked."),n(s)){var e=n(s).style;g(s,e.width,e.height),A(s,e.width,e.height)}else p("Aborting because element has been uninstalled")}function R(){u(s)}function D(){var e;p("Installing..."),n(s).listeners=[],e=_(),n(s).startSize={width:e.width,height:e.height},p("Element start size",n(s).startSize),a.add(0,m),a.add(1,w),a.add(2,T),a.add(3,C),a.add(4,R)}u||(u=s,s=e,e=null),e=e||{},p("Making detectable..."),!function(e){return!function(e){var t=e.getRootNode&&e.getRootNode().contains(e);return e===e.ownerDocument.body||e.ownerDocument.body.contains(e)||t}(e)||null===window.getComputedStyle(e)}(s)?D():(p("Element is detached"),E(),p("Waiting until element is attached..."),n(s).onRendered=function(){p("Element is now attached"),D()})},addListener:function(e,t){if(!n(e).listeners.push)throw new Error("Cannot add listener to an element that is not detectable.");n(e).listeners.push(t)},uninstall:function(e){var t=n(e);t&&(t.onExpandScroll&&u(c(e),"scroll",t.onExpandScroll),t.onShrinkScroll&&u(h(e),"scroll",t.onShrinkScroll),t.onAnimationStart&&u(t.container,"animationstart",t.onAnimationStart),t.container&&e.removeChild(t.container))},initDocument:s}};function gs(e){return Array.isArray(e)||void 0!==e.length}function vs(e){if(Array.isArray(e))return e;var t=[];return os(e,(function(e){t.push(e)})),t}function ys(e){return e&&1===e.nodeType}var bs=function(e){var t;if((e=e||{}).idHandler)t={get:function(t){return e.idHandler.get(t,!0)},set:e.idHandler.set};else{var a=ds(),n=us({idGenerator:a,stateHandler:fs});t=n}var i=e.reporter;i||(i=cs(!1===i));var r=Ss(e,"batchProcessor",ps({reporter:i})),o={};o.callOnAdd=!!Ss(e,"callOnAdd",!0),o.debug=!!Ss(e,"debug",!1);var s,l=ls(t),d=ss({stateHandler:fs}),u=Ss(e,"strategy","object"),c=Ss(e,"important",!1),h={reporter:i,batchProcessor:r,stateHandler:fs,idHandler:t,important:c};if("scroll"===u&&(hs.isLegacyOpera()?(i.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),u="object"):hs.isIE(9)&&(i.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),u="object")),"scroll"===u)s=ms(h);else{if("object"!==u)throw new Error("Invalid strategy name: "+u);s=_s(h)}var p={};return{listenTo:function(e,a,n){function r(e){var t=l.get(e);os(t,(function(t){t(e)}))}function u(e,t,a){l.add(t,a),e&&a(t)}if(n||(n=a,a=e,e={}),!a)throw new Error("At least one element required.");if(!n)throw new Error("Listener required.");if(ys(a))a=[a];else{if(!gs(a))return i.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");a=vs(a)}var h=0,f=Ss(e,"callOnAdd",o.callOnAdd),_=Ss(e,"onReady",(function(){})),m=Ss(e,"debug",o.debug);os(a,(function(e){fs.getState(e)||(fs.initState(e),t.set(e));var o=t.get(e);if(m&&i.log("Attaching listener to element",o,e),!d.isDetectable(e))return m&&i.log(o,"Not detectable."),d.isBusy(e)?(m&&i.log(o,"System busy making it detectable"),u(f,e,n),p[o]=p[o]||[],void p[o].push((function(){++h===a.length&&_()}))):(m&&i.log(o,"Making detectable..."),d.markBusy(e,!0),s.makeDetectable({debug:m,important:c},e,(function(e){if(m&&i.log(o,"onElementDetectable"),fs.getState(e)){d.markAsDetectable(e),d.markBusy(e,!1),s.addListener(e,r),u(f,e,n);var t=fs.getState(e);if(t&&t.startSize){var l=e.offsetWidth,c=e.offsetHeight;t.startSize.width===l&&t.startSize.height===c||r(e)}p[o]&&os(p[o],(function(e){e()}))}else m&&i.log(o,"Element uninstalled before being detectable.");delete p[o],++h===a.length&&_()})));m&&i.log(o,"Already detecable, adding listener."),u(f,e,n),h++})),h===a.length&&_()},removeListener:l.removeListener,removeAllListeners:l.removeAllListeners,uninstall:function(e){if(!e)return i.error("At least one element is required.");if(ys(e))e=[e];else{if(!gs(e))return i.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");e=vs(e)}os(e,(function(e){l.removeAllListeners(e),s.uninstall(e),fs.cleanState(e)}))},initDocument:function(e){s.initDocument&&s.initDocument(e)}}};function Ss(e,t,a){var n=e[t];return null==n&&void 0!==a?a:n}var As=Wo(bs);const Es=(e,t)=>{const a=As();let n=null;a.listenTo(e,(()=>{null!==n&&clearTimeout(n),n=setTimeout((()=>{t&&t(e),clearTimeout(n)}),200)})),A((()=>{a.removeListener(e,(()=>{}))}))},ws=e=>{if(null==e)return e;let t;if("object"==typeof e){t=Array.isArray(e)?[]:{};for(let a in e)"object"==typeof e[a]?t[a]=ws(e[a]):t[a]=e[a]}else t=e;return t},Ts=(e,t)=>{const a=[],n=new Map;for(const i of e){const e=i[t];n.has(e)||(n.set(e,!0),a.push(i))}return a},Cs=e=>null!=e&&("string"==typeof e?""!==e.trim():!1!==e),Rs=(...e)=>{let t=null;for(let a=0;a<e.length;a++){const n=e[a];if(null!=n){t=n;break}}return t},Ds=(e,t,a)=>(Object.defineProperty(e,a,{get:()=>t[a]}),{target:e,source:t});var xs={className:{type:String,default:""},style:{type:Object,default:()=>({})},options:{type:Object,default:()=>({})},loading:{type:Boolean,default:!1},data:{type:Array,default:()=>[]},page:{type:Object,default:()=>({pageIndex:1,pageSize:10,total:0})},rowStyle:{type:Function,default:void 0},rowClassName:{type:Function,default:void 0},cellStyle:{type:Function,default:void 0},cellClassName:{type:Function,default:void 0},headerRowStyle:{type:Function,default:void 0},headerRowClassName:{type:Function,default:void 0},headerCellStyle:{type:Function,default:void 0},headerCellClassName:{type:Function,default:void 0},spanMethod:{type:Function,default:void 0}};const Ls=["menu-left-prefix","menu-left-suffix","menu-right-prefix","menu-right-suffix"],ks=["operation-column-prefix","operation-column-suffix"];var Bs={initLoadData:!0,defaultContentHeight:300,fullscreenchangeContentHeight:!1,rowKey:"id",size:"default",fit:!0,stripe:!0,border:!0,index:!0,selection:!0,headerAlign:"center",cellAlign:"center",columnMinWidth:"100px",columns:[],showSearchForm:!0,showHeaderMenu:!0,showSearchLabel:!0,searchSpan:4,searchGutter:20,searchLabelWidth:"5em",searchColumnMinWidth:300,searchColumns:[],addBtn:!0,viewBtn:!0,delBtn:!0,editBtn:!0,batchDelBtn:!1,refreshBtn:!0,settingBtn:!0,operations:!0,operationsWidth:260,operationsBtnPlain:!1,operationsBtnText:!0,operationsBtnSize:"small",addBtnText:"",isPagination:!0,dialogTitle:"",dialogWidth:"60%",dialogFullscreen:!1,closeOnClickModal:!1,formColumns:[],formLabelWidth:"5em",formSpan:12,formColumnMinWidth:350};const Os="column-",Ms=e=>Os+e,Is="search-",Ps=e=>Is+e,Us="form-",Ns=e=>Us+e,Vs=Ce("spin-loading");var js=o({name:"NextSpinLoading",props:{loading:{type:Boolean,default:!1},tip:{type:String,default:""}},setup(){const{t:e}=pi();return{t:e}},render(){const e=this.t,t=this.$slots,a=this.$props,n=a.tip||e("next.loading");return s("div",{class:Vs.b()},[a.loading?s("div",{class:Vs.b("mask")},[s("span",{class:Vs.b("mask-dot")},[s("i",{class:Vs.be("mask","dot-item")},null),s("i",{class:Vs.be("mask","dot-item")},null),s("i",{class:Vs.be("mask","dot-item")},null),s("i",{class:Vs.be("mask","dot-item")},null)]),s("span",{class:Vs.be("mask","text")},[n])]):null,t.default?.()])}}),zs=o({name:"SearchColumn",props:{searchSpan:{type:Number,default:4},columns:{type:Array,default:()=>[]},formParams:{type:Object,default:()=>{}}},setup(e,{slots:n}){const o=t("options",{}),d=r(o)?i(o):o,{t:u}=pi(),c=t("ns",{}),p=a(e.columns);v((()=>e.columns),(()=>{p.value=e.columns}),{deep:!0});const f=h(e.formParams),_=e=>e.getTime()>Date.now(),m=[{text:u("next.date.oneWeekAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-6048e5),[t,e]}},{text:u("next.date.oneMonthAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-2592e6),[t,e]}},{text:u("next.date.threeMonthsAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-7776e6),[t,e]}},{text:u("next.date.oneYearAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-31536e6),[t,e]}},{text:u("next.date.threeYearsAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-94608e6),[t,e]}}],g=(e,t)=>{f.value[t]=e},y=e=>{const t=Rs(e.searchDisabled,e.disabled,!1);if(n[Ps(e.prop)])return n[Ps(e.prop)]({column:e});if("input"===e.type||!e.type){const a=u("next.form.input")+(e.searchPlaceholder||e.searchLabel||e.label);return s(q,{modelValue:f[e.prop],"onUpdate:modelValue":t=>f[e.prop]=t,clearable:!0,disabled:t,placeholder:a},{prefix:e.prefix?()=>e.prefix(f,e):null,suffix:e.suffix?()=>e.suffix(f,e):null,prepend:e.prepend?()=>e.prepend(f,e):null,append:e.append?()=>e.append(f,e):null})}if("inputInteger"===e.type){const a=u("next.form.input")+(e.searchPlaceholder||e.searchLabel||e.label);return s(q,{modelValue:f[e.prop],"onUpdate:modelValue":t=>f[e.prop]=t,clearable:!0,disabled:t,placeholder:a,onInput:t=>((e,t)=>{const a=e.replace(/\D/g,"");f.value[t]=a})(t,e.prop)},{prefix:e.prefix?()=>e.prefix(f,e):null,suffix:e.suffix?()=>e.suffix(f,e):null,prepend:e.prepend?()=>e.prepend(f,e):null,append:e.append?()=>e.append(f,e):null})}if("inputNumber"===e.type){const a=u("next.form.input")+(e.searchPlaceholder||e.searchLabel||e.label);return s(q,{modelValue:f[e.prop],"onUpdate:modelValue":t=>f[e.prop]=t,clearable:!0,disabled:t,placeholder:a,onInput:t=>((e,t)=>{let a=e;a=a.replace(/[^0-9\.]/g,""),a=a.replace(/^\./,"0."),a=a.replace(/\.{2,}/g,"."),a=a.replace(".","DUMMY"),a=a.replace(/\./g,""),a=a.replace("DUMMY","."),f.value[t]=a})(t,e.prop)},{prefix:e.prefix?()=>e.prefix(f,e):null,suffix:e.suffix?()=>e.suffix(f,e):null,prepend:e.prepend?()=>e.prepend(f,e):null,append:e.append?()=>e.append(f,e):null})}if("select"===e.type){const a=u("next.form.select")+(e.searchPlaceholder||e.searchLabel||e.label);return s(W,{modelValue:f[e.prop],"onUpdate:modelValue":t=>f[e.prop]=t,clearable:!0,disabled:t,placeholder:a,multiple:e.searchMultiple||!1,"collapse-tags":!0,"collapse-tags-tooltip":!0},{default:()=>[e.dicData&&e.dicData.map((e=>s(K,{value:e.value,label:e.label},null)))]})}if("date"===e.type){const a=u("next.form.select")+(e.searchPlaceholder||e.searchLabel||e.label);return s(Y,{modelValue:f[e.prop],"onUpdate:modelValue":t=>f[e.prop]=t,type:"date","value-format":e.searchFormat||"YYYY-MM-DD",format:e.searchFormat||"YYYY-MM-DD",clearable:!0,"disabled-date":e.searchDisabledDate||_,disabled:t,placeholder:a,editable:e.searchEditable||!1},null)}if("datetimerange"===e.type)return s(Y,{modelValue:f[e.prop],"onUpdate:modelValue":t=>f[e.prop]=t,type:"datetimerange","value-format":e.searchFormat||"YYYY-MM-DD HH:mm:ss",format:e.searchFormat||"YYYY-MM-DD HH:mm:ss",clearable:!0,"range-separator":u("next.date.rangeSeparator"),"start-placeholder":u("next.date.startPlaceholder"),"end-placeholder":u("next.date.endPlaceholder"),"disabled-date":e.searchDisabledDate||_,disabled:t,editable:e.searchEditable||!1,shortcuts:e.searchShortcuts||m},null);if("numberRange"===e.type){const t=f[e.prop],n=a(t[0]),i=a(t[1]),r=a(e.searchMin),o=a(e.searchMax),l=a(!0),d=t=>{n.value=t,g([n.value,i.value],e.prop)},h=t=>{i.value=t,g([n.value,i.value],e.prop)};return s("div",{class:c.b("header-search-item-number-range")},[s($,{modelValue:n.value,"onUpdate:modelValue":e=>n.value=e,min:r.value,max:o.value,controls:l.value,onChange:d},null),s("span",{class:"number-range-division"},[u("next.date.rangeSeparator")]),s($,{modelValue:i.value,"onUpdate:modelValue":e=>i.value=e,min:r.value,max:o.value,controls:l.value,onChange:h},null)])}};return()=>s(l,null,[s(l,null,[p.value.map((t=>!t.hide&&s(G,{span:e.searchSpan,class:c.b("header-search-item")},{default:()=>[s(H,null,{label:()=>t.label&&Rs(d.showSearchLabel,!0)?s(ki,{width:d.searchLabelWidth,content:t.label,textAlign:"right"},null):null,default:()=>y(t)})]})))])])}});function Fs(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!m(e)}var Gs=o({name:"HeaderSearch",props:{columns:{type:Array,default:()=>[]}},emits:["confirmSearch","clearSearch","zoomResize"],setup(n,{emit:o,slots:d}){const u=t("options",{}),c=r(u)?i(u):u,p=t("ns",{}),{t:f}=pi(),_=t("searchFormSlots"),m={};_.value.forEach((e=>{m[e]=(...t)=>d[e]&&d[e](...t)}));const g=h({}),v=a(n.columns),y=()=>{v.value.forEach((e=>{g[e.prop]="",Cs(e.defaultValue)&&(g[e.prop]=e.defaultValue)}))};y();const b=()=>{o("confirmSearch",g)},S=()=>{y(),b(),o("clearSearch")},A=a(c.searchSpan),w=v.value.length,T=a(w),C=a(v.value),R=a([]),D=a(!1),{proxy:x}=e();E((()=>{const e=x.$refs.tableSearchForm?.$el;e&&Es(e,(e=>{(e=>{const t=e.clientWidth,a=c.searchColumnMinWidth;let n=Math.floor(t/a);A.value=Math.ceil(24/n);const i=24%A.value;if(i&&(A.value=i,n=24/A.value),T.value=n,w>=T.value){const e=T.value-1;C.value=v.value.slice(0,e),R.value=v.value.slice(e)}else C.value=v.value,R.value=[];const r=Math.floor(t/n);D.value=r<a})(e),o("zoomResize")}))}));const L=a(!1),k=()=>{L.value=!L.value};return()=>s(l,null,[v.value.length?s(X,{ref:"tableSearchForm",inline:!0,size:c.size,model:g,class:p.b("header")},{default:()=>[s(Z,{gutter:c.searchGutter,class:p.b("header-search")},{default:()=>[s(zs,{searchSpan:A.value,columns:C.value,formParams:g},Fs(m)?m:{default:()=>[m]}),L.value?s(zs,{searchSpan:A.value,columns:R.value,formParams:g},Fs(m)?m:{default:()=>[m]}):null,s(G,{span:A.value,class:p.b("header-search-btns")},{default:()=>[s(H,null,{default:()=>[s(J,{type:"primary",onClick:b},{icon:()=>s(I,null,{default:()=>[s(Kr,null,null)]}),default:()=>f("next.table.search")}),s(J,{onClick:S},{icon:()=>s(I,null,{default:()=>[s(cr,null,null)]}),default:()=>f("next.table.clear")}),R.value.length?D.value?s(J,{type:"primary",text:!0,bg:!0,circle:!0,class:p.b("header-search-expandBtn"),onClick:k},{icon:()=>L.value?s(nr,null,null):s(sr,null,null)}):s(J,{type:"primary",text:!0,bg:!0,class:p.b("header-search-expandBtn"),onClick:k},{icon:()=>L.value?s(I,null,{default:()=>[s(zi,null,null)]}):s(I,null,{default:()=>[s(Ui,null,null)]}),default:()=>L.value?f("next.table.foldSearch"):f("next.table.unfoldSearch")}):null]})]})]})]}):null])}}),Hs=o({name:"DrawerSetting",setup:()=>({visible:a(!1)}),render(){const e=t("options",{}),n=r(e)?i(e):e,o=a(n.columns),{t:l}=pi(),d=t("ns",{});return s(N,{modelValue:this.visible,"onUpdate:modelValue":e=>this.visible=e,title:l("next.table.setting.title"),"append-to-body":!0,size:"450px",class:d.b("setting-drawer")},{default:()=>[s(L,{class:d.be("setting-drawer","container")},{default:()=>[s(Q,{data:o.value,border:!0,style:{width:"100%"}},{default:()=>[s(ee,{prop:"label",label:l("next.table.setting.label"),align:"center"},{default:({row:e})=>s(ki,{content:l(e.label)},null)}),s(ee,{prop:"hide",label:l("next.table.setting.hide"),align:"center",width:"70px"},{default:({row:e})=>s(te,{modelValue:e.hide,"onUpdate:modelValue":t=>e.hide=t},null)}),s(ee,{prop:"filter",label:l("next.table.setting.filter"),align:"center",width:"70px"},{default:({row:e})=>s(te,{modelValue:e.filter,"onUpdate:modelValue":t=>e.filter=t},null)}),s(ee,{prop:"sort",label:l("next.table.setting.sort"),align:"center",width:"70px"},{default:({row:e})=>s(te,{modelValue:e.sortable,"onUpdate:modelValue":t=>e.sortable=t},null)})]})]})]})}}),qs=o({name:"HeaderMenu",setup:()=>({}),emits:["clickAdd","clickRefresh","deleteRows"],render(){const e=t("options",{}),o=r(e)?i(e):e,{t:l}=pi(),d=t("ns",{}),u=t("multipleSelection"),c=n((()=>u.value.length)),h=a();return s("div",{class:d.b("header-menu")},[s("div",{class:d.b("header-menu-left")},[this.$slots["menu-left-prefix"]?.(),o.addBtn&&s(J,{type:"primary",onClick:()=>{this.$emit("clickAdd")}},{icon:()=>s(I,null,{default:()=>[s(Ir,null,null)]}),default:()=>l("next.table.add")}),o.batchDelBtn&&s(J,{type:"danger",disabled:!c.value,onClick:()=>{const e=i(w(u.value.map((e=>w(e)))));ae.confirm(l("next.table.message.batchDeleteTip"),l("next.table.message.tip"),{type:"warning",showClose:!1,center:!1,confirmButtonText:l("next.table.message.confirmButtonText"),cancelButtonText:l("next.table.message.cancelButtonText")}).then((()=>{this.$emit("deleteRows",e)})).catch((()=>{D({type:"info",message:l("next.table.message.cancelBatchDelete")})}))}},{icon:()=>s(I,null,{default:()=>[s(cr,null,null)]}),default:()=>l("next.table.batchDelete")}),this.$slots["menu-left-suffix"]?.()]),s("div",{class:d.b("header-menu-right")},[this.$slots["menu-right-prefix"]?.(),o.refreshBtn&&s(J,{circle:!0,onClick:()=>{this.$emit("clickRefresh")}},{icon:()=>s(I,null,{default:()=>[s(Vr,null,null)]})}),o.settingBtn&&s(J,{circle:!0,onClick:()=>{h.value.visible=!0}},{icon:()=>s(I,null,{default:()=>[s(ro,null,null)]})}),this.$slots["menu-right-suffix"]?.()]),s(Hs,{ref:h},null)])}});const Ws=o({name:"TableColumnDynamic",props:{columnOption:{type:Object,default:()=>({})}},setup(e,{slots:a}){const n=t("columnSlots"),o={};n.value.forEach((e=>{o[e]=(...t)=>a[e]&&a[e](...t)}));const d=t("options",{}),u=r(d)?i(d):d,c=e.columnOption,h=(e,t)=>{const a=t.find((t=>t.value==e));return a?a.label:e},p=(e,t)=>c.children?.length>0?s(l,null,[c.children.map((e=>{return s(Ws,{columnOption:e},"function"==typeof(t=o)||"[object Object]"===Object.prototype.toString.call(t)&&!m(t)?o:{default:()=>[o]});var t}))]):a[Ms(c.prop)]?a[Ms(c.prop)]({row:e,index:t}):c.dicData?.length>0?s("span",null,[h(e[c.prop],c.dicData)]):null;return()=>s(l,null,[!c.hide&&s(ee,{prop:c.prop,label:c.label,headerAlign:c.headerAlign||u.headerAlign,align:c.align||u.cellAlign,minWidth:c.minWidth||u.columnMinWidth||"auto",width:c.width||"auto",fixed:c.fixed,sortable:c.sortable||!1,formatter:c.formatter||null,showOverflowTooltip:Rs(c.showOverflowTooltip,!0)},{default:({row:e,$index:t})=>p(e,t)})])}});var Ks=o({name:"TableColumnOperations",emits:["editRow","viewRow","deleteRow"],setup(e,{emit:a,slots:o}){const d=t("options"),u=r(d)?i(d):d,{t:c}=pi(),h=n((()=>{const{operationsBtnPlain:e,operationsBtnText:t}=u;return t||e})),p=()=>{const e=u.operationsBtnText,t=u.operationsBtnPlain,n=u.operationsBtnSize;return s(ee,{fixed:"right",label:c("next.table.operation"),width:u.operationsWidth,headerAlign:u.headerAlign,align:u.cellAlign},{default:i=>s(l,null,[o["operation-column-prefix"]?.(i,{text:e,plain:t,size:n}),u.editBtn?s(x,{enterable:!1,effect:"dark",content:c("next.table.edit"),placement:"top",disabled:h.value},{default:()=>[s(J,{text:e,plain:t,class:h.value?"":"operations-btn",size:n,type:"primary",onClick:()=>(e=>{a("editRow",e)})(i)},{icon:()=>s(I,null,{default:()=>[s(_r,null,null)]}),default:()=>c("next.table.edit")})]}):null,u.viewBtn?s(x,{enterable:!1,effect:"dark",content:c("next.table.view"),placement:"top",disabled:h.value},{default:()=>[s(J,{text:e,plain:t,class:h.value?"":"operations-btn",size:n,type:"primary",onClick:()=>(e=>{a("viewRow",e)})(i)},{icon:()=>s(I,null,{default:()=>[s(uo,null,null)]}),default:()=>c("next.table.view")})]}):null,u.delBtn?s(x,{enterable:!1,effect:"dark",content:c("next.table.delete"),placement:"top",disabled:h.value},{default:()=>[s(J,{text:e,plain:t,class:h.value?"":"operations-btn",size:n,type:"danger",onClick:()=>(e=>{ae.confirm(c("next.table.message.deleteTip"),c("next.table.message.tip"),{type:"warning",showClose:!1,center:!1,confirmButtonText:c("next.table.message.confirmButtonText"),cancelButtonText:c("next.table.message.cancelButtonText")}).then((()=>{a("deleteRow",e)})).catch((()=>{D({type:"info",message:c("next.table.message.cancelDelete")})}))})(i)},{icon:()=>s(I,null,{default:()=>[s(cr,null,null)]}),default:()=>c("next.table.delete")})]}):null,o["operation-column-suffix"]?.(i,{text:e,plain:t,size:n})])})};return()=>s(l,null,[p()])}}),Ys=o({name:"FooterPagination",props:{page:{type:Object,default:()=>{}}},emits:["change"],setup(e,{emit:a}){const n=t("options",{}),o=r(n)?i(n):n,d=e.page,u=e=>{d.pageIndex=e,a("change",d)},c=e=>{d.pageSize=e,a("change",d)};return()=>s(l,null,[s(ne,{currentPage:d.pageIndex,"onUpdate:currentPage":e=>d.pageIndex=e,pageSize:d.pageSize,"onUpdate:pageSize":e=>d.pageSize=e,total:d.total,small:"small"===o.size,layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,30,40,50,100],"onCurrent-change":u,"onSize-change":c},null)])}});const $s=Ce("dialog");var Xs=o({name:"NextDialog",props:{modelValue:{type:Boolean,default:!1},title:{type:String,default:""},fullscreen:{type:Boolean,default:!1},fullscreenBtn:{type:Boolean,default:!0},width:{type:[String,Number],default:"50%"},closeOnClickModal:{type:Boolean,default:!0},appendToBody:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},zoomSize:{type:Boolean,default:!0},destroyOnClose:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},top:{type:String,default:"15vh"}},emits:["close"],setup(e,{emit:t,slots:n}){const i=a(e.modelValue);v((()=>e.modelValue),(e=>{i.value=e}));const r=()=>{i.value=!1,t("close")},o=a(e.fullscreen);return()=>s(l,null,[s(ie,{modelValue:i.value,"onUpdate:modelValue":e=>i.value=e,class:$s.b(),title:e.title,appendToBody:e.appendToBody,"destroy-on-close":!0,fullscreen:o.value,"lock-scroll":!0,modal:e.modal,"show-close":!1,closeOnClickModal:e.closeOnClickModal,width:e.width,top:e.top,draggable:e.draggable,destroyOnClose:e.destroyOnClose,onClose:r},{default:()=>[n.default?.()],header:({close:t,titleId:a,titleClass:n})=>s("div",{class:$s.b("header")},[s("h4",{id:a,class:n},[e.title]),s("div",{class:$s.e("header-right")},[e.fullscreenBtn&&s("span",{class:"icon-fullscreen",onClick:()=>o.value=!o.value},[s(I,null,{default:()=>[s(yr,null,null)]})]),s("span",{class:"icon-close",onClick:t},[s(I,{size:"18"},{default:()=>[s(Qi,null,null)]})])])])})])}});const Zs={selection:!1,selectType:"radio",addBtn:!1,viewBtn:!1,delBtn:!1,editBtn:!1,batchDelBtn:!1,dialogWidth:"60%",dialogFullscreen:!1,closeOnClickModal:!1,refreshBtn:!0,settingBtn:!0,operations:!1};var Js={size:"default",colSpan:8,labelWidth:"6em",columnMinWidth:350,columns:[],formDatum:{},tableSelectConfig:Zs,isEditing:!0,showResetBtn:!0};const Qs=Ce("form");var el=o({name:"NumberRangePicker",props:{modelValue:{type:[Array,String,Number,Boolean,Object],default:function(){return[null,null]}},min:{type:Number,default:0},max:{type:Number,default:100},disabled:{type:Boolean,default:!1}},emits:["change"],setup(e,{emit:t}){const n=e.disabled,{t:i}=pi(),r=a(Array.isArray(e.modelValue)&&e.modelValue[0]||0),o=a(Array.isArray(e.modelValue)&&e.modelValue[1]||0),d=a(e.min),u=a(e.max),c=e=>{r.value=e,t("change",[r.value,o.value])},h=e=>{o.value=e,t("change",[r.value,o.value])},p=a(!0),f=a();E((()=>{const e=f.value;Es(e,(e=>{const t=e.clientWidth;p.value=t>200}))}));return()=>s(l,null,[s("div",{ref:f,class:Qs.e("number-range")},[s($,{modelValue:r.value,"onUpdate:modelValue":e=>r.value=e,min:d.value,max:u.value,controls:p.value,disabled:n,onChange:c},null),s("span",{class:Qs.em("number-range","division")},[i("next.date.rangeSeparator")]),s($,{modelValue:o.value,"onUpdate:modelValue":e=>o.value=e,min:d.value,max:u.value,controls:p.value,disabled:n,onChange:h},null)])])}});const tl=Ti(Xs);function al(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!m(e)}const nl=Ce("form"),il=o({name:"InputTableSelect",props:{modelValue:{type:[Array,String,Number,Boolean,Object],default:function(){return[]}},column:{type:Object,default:()=>({})},disabled:{type:Boolean,default:!1},formParams:{type:Object,default:()=>({})}},emits:["select"],setup(e,{emit:t}){const{t:i}=pi(),r=e.disabled,o=e.column,d=o.placeholder||i("next.form.select")+o.label,u=ws(Bs),c=ws(Zs),f=ii(u,c,o.tableSelect),_=h({visible:!1,title:o.label+i("next.form.tableSelect"),dialogWidth:f.dialogWidth}),m=()=>{_.visible=!0},g=()=>{_.visible=!1},y=h({loading:!1,page:{pageIndex:1,pageSize:20,total:0},data:[]}),b=e=>{y.loading=!0,f.loadData?.(e,(e=>{y.data=e.data||[],y.page.total=e.total||0,y.loading=!1}))},S=a([]);o.tableSelectDefaultValue?.(e.formParams,o,(e=>{e?.length&&(o.tableSelectRows=e,S.value=e)}));const A=a(""),E=n((()=>"radio"===f.selectType?!A.value:0===S.value.length)),T=e=>S.value.includes(e),C=()=>{S.value=[],A.value=""},R=()=>{const e=w(S.value);g(),t("select",e)},D=(e,t)=>{o.addEditData?.(e,t)},L=(e,t)=>{const a=f.rowKey,n=Rs(e[a],t);return"checkbox"===f.selectType?s(te,{modelValue:T(w(e)),onChange:t=>((e,t)=>{if(e)S.value.push(t);else{const e=S.value.indexOf(t);-1!==e&&S.value.splice(e,1)}})(t,w(e))},null):s(se,{label:n,onChange:()=>{A.value=n,S.value=[e]}},null)},{value:k,label:B}=o.tableSelectProps||{},O=a([]),M=a([]),I=()=>{const e=Ts(S.value,k).map((e=>({value:e[k||"value"],label:e[B||"label"]})));e.length>1?(O.value=e.splice(0,1),M.value=e):(O.value=e,M.value=[])};v((()=>o.tableSelectRows),(()=>{I()}),{deep:!0,immediate:!0});const P=(e,a)=>{const n=w(S.value);n.splice(a,1),S.value=n,I(),t("select",n)},U=()=>{let e,t;return s(l,null,[s("div",{class:["el-input",nl.e("input-table"),nl.is("disabled",r)]},[s("div",{class:"el-input__wrapper"},[O?.value.length?s("span",{class:nl.em("input-table","value")},[O.value.map(((e,t)=>s(re,{closable:!r,onClose:()=>P(0,t)},{default:()=>[e.label]}))),M?.value?.length?s(x,{"popper-class":nl.e("tooltip-tags"),placement:"bottom",effect:"light"},{default:()=>s(re,null,{default:()=>[p("+ "),M.value.length]}),content:()=>M.value.map(((e,t)=>s(re,{closable:!r,onClose:()=>P(0,t+1)},{default:()=>[e.label]})))}):null]):s("span",{class:nl.em("input-table","placeholder")},[d])]),s(J,{type:"primary",class:nl.em("input-table","append"),disabled:r,icon:Kr,onClick:m},null)]),s(tl,{modelValue:_.visible,"onUpdate:modelValue":e=>_.visible=e,title:_.title,closeOnClickModal:f.closeOnClickModal,width:f.dialogWidth,modal:!1,onClose:g},{default:()=>[s("div",{class:nl.em("input-table","content")},[s(oe,{modelValue:A.value},{default:()=>[s(_l,{options:f,loading:y.loading,data:y.data,page:y.page,"onConfirm-search":b,"onClick-add-edit":D},{default:()=>[s(ee,{fixed:"left",label:i("next.table.selection"),width:55,headerAlign:f.headerAlign,align:f.cellAlign},{default:({row:e,$index:t})=>L(e,t)})]})]})]),s("div",{class:nl.em("input-table","footer")},[s(J,{onClick:C},al(e=i("next.form.reset"))?e:{default:()=>[e]}),s(J,{type:"primary",disabled:E.value,onClick:R},al(t=i("next.form.confirm"))?t:{default:()=>[t]})])]})])};return()=>s(l,null,[U()])}}),rl=Ce("form");var ol=o({name:"UploadImage",props:{className:{type:String,default:""},style:{type:Object,default:()=>({})},modelValue:{type:String,default:""},disabled:{type:Boolean,default:!1},listType:{type:String,values:["text","picture","picture-card"],default:"picture-card"},accept:{type:String,default:"image/*"}},emits:["change"],setup(t){const{appContext:n}=e(),{t:i}=pi();return{t:i,appContext:n,defaultPreviewSrcList:ws(t.modelValue),uploadfilesPreview:a([])}},render(){const e=this.$slots,t=this.$props,a=this.$emit,n=this.t,i=t.disabled,r=this.uploadfilesPreview;let o=null;return s(l,null,[(()=>{const e=this.defaultPreviewSrcList;let t=[];return"string"==typeof e?t=[e]:"[object Array]"===Object.prototype.toString.call(e)&&(t=e),t=t.filter((e=>!!e)),t.length?s(ue,{class:rl.e("preview-image"),src:t[0],previewSrcList:t,"preview-teleported":!0,fit:"cover",style:{width:"146px",height:"146px"}},{default:()=>s(I,null,{default:()=>[s(kr,null,null)]})}):null})(),i?null:s(le,{class:[rl.b("upload-image"),t.className],style:t.style,"list-type":t.listType,"auto-upload":!1,"on-preview":e=>{const t=document.getElementsByTagName("body")[0],a=r.value.findIndex((t=>t.url===e.url))||0;o&&(T(null,o),t.removeChild(o)),o=document.createElement("div"),t.appendChild(o);const n=s({render:()=>S(_,{to:"body"},[S(de,{initialIndex:a,"url-list":r.value.map((e=>e.url)),onClose:()=>{T(null,o)}})])});o.appContext=this.appContext,T(n,o)},onChange:(e,t)=>{r.value=t,a("change",e,t)}},{trigger:()=>e.default?e.default():"picture-card"===t.listType?s(I,null,{default:()=>[s(Ir,null,null)]}):s(J,{link:!0,text:!0,type:"primary"},{default:()=>[s(I,null,{default:()=>[s(Ir,null,null)]}),s("em",null,[n("next.form.selectFile")])]})})])}});function sl(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!m(e)}const ll=Ce("form");var dl=o({name:"NextForm",props:{options:{type:Object,default:()=>({})},columns:{type:Array,default:()=>[]},formDatum:{type:Object,default:()=>({})}},emits:["submit","close"],setup(e,{slots:t,emit:i,expose:r}){const o=ws(Js),d=h(ii(o,e.options)),u=n((()=>"boolean"!=typeof d.isEditing||d.isEditing)),{t:c}=pi(),p=a(d.colSpan),f=h(e.formDatum)||{},_=h(ii({},f)),m=a([]),g=h({});v((()=>[e.columns,e.formDatum]),(()=>{(()=>{const t=e.columns;m.value=t;for(let e=0;e<t.length;e++){const a=t[e],n=f[a.prop];Cs(n)?_[a.prop]=n:_[a.prop]=Cs(a.defaultValue)?a.defaultValue:"";const{label:i}=a;if(a.rules)g[a.prop]=a.rules;else if(a.required){const e=[];e.push({required:!0,message:i+c("next.form.requiredInput"),trigger:["blur","change"]}),g[a.prop]=e}!a.dicData?.length&&a.loadDicData&&a.loadDicData(a,(e=>{e?.length&&(a.dicData=e)})),"boolean"==typeof a.disabled&&a.disabled||(a.disabled=!u.value)}})()}),{deep:!0,immediate:!0});const y=Ts(m.value,"prop");E((()=>{const e=b.value?.$el;let t=null;Es(e,(e=>{null!==t&&clearTimeout(t),t=setTimeout((()=>{p.value=((e,t=350)=>{const a=e.clientWidth;let n=Math.floor(a/t);return n>4&&(n=4),Math.ceil(24/n)})(e,d.columnMinWidth),clearTimeout(t)}),200)}))}));const b=a(),S=a(!1),A=async()=>{const e=b.value;e&&await e.validate(((e,t)=>{if(e){const e=w(_);S.value=!0,i("submit",e,(()=>{S.value=!1,i("close")}),(()=>{S.value=!1}))}}))},T=()=>{const e=b.value;e&&e.resetFields()},C=e=>e.getTime()>Date.now(),R=[{text:c("next.date.oneWeekAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-6048e5),[t,e]}},{text:c("next.date.oneMonthAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-2592e6),[t,e]}},{text:c("next.date.threeMonthsAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-7776e6),[t,e]}},{text:c("next.date.oneYearAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-31536e6),[t,e]}},{text:c("next.date.threeYearsAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-94608e6),[t,e]}}],D=e=>{if(t[Ns(e.prop)])return t[Ns(e.prop)]({column:e,formParams:_});if("input"===e.type||!e.type){const t=e.placeholder||c("next.form.input")+e.label;return s(q,{modelValue:_[e.prop],"onUpdate:modelValue":t=>_[e.prop]=t,clearable:!0,readonly:Rs(e.readonly,!1),disabled:e.disabled,placeholder:t,onChange:t=>e.onChange?.(t,e,_,y)},{prefix:e.prefix?()=>e.prefix(_,e):null,suffix:e.suffix?()=>e.suffix(_,e):null,prepend:e.prepend?()=>e.prepend(_,e):null,append:e.append?()=>e.append(_,e):null})}if("inputInteger"===e.type){const t=e.placeholder||c("next.form.input")+e.label;return s(q,{modelValue:_[e.prop],"onUpdate:modelValue":t=>_[e.prop]=t,clearable:!0,readonly:Rs(e.readonly,!1),disabled:e.disabled,placeholder:t,onInput:t=>((e,t)=>{const a=e.replace(/\D/g,"");_[t]=Number(a)})(t,e.prop),onChange:t=>e.onChange?.(t,e,_,y)},{prefix:e.prefix?()=>e.prefix(_,e):null,suffix:e.suffix?()=>e.suffix(_,e):null,prepend:e.prepend?()=>e.prepend(_,e):null,append:e.append?()=>e.append(_,e):null})}if("inputNumber"===e.type){const t=e.placeholder||c("next.form.input")+e.label;return s(q,{modelValue:_[e.prop],"onUpdate:modelValue":t=>_[e.prop]=t,clearable:!0,readonly:Rs(e.readonly,!1),disabled:e.disabled,placeholder:t,onInput:t=>((e,t)=>{let a=e;a=a.replace(/[^0-9\.]/g,""),a=a.replace(/^\./,"0."),a=a.replace(/\.{2,}/g,"."),a=a.replace(".","DUMMY"),a=a.replace(/\./g,""),a=a.replace("DUMMY","."),_[t]=Number(a)})(t,e.prop),onChange:t=>e.onChange?.(t,e,_,y)},{prefix:e.prefix?()=>e.prefix(_,e):null,suffix:e.suffix?()=>e.suffix(_,e):null,prepend:e.prepend?()=>e.prepend(_,e):null,append:e.append?()=>e.append(_,e):null})}if("textarea"===e.type){const t=e.placeholder||c("next.form.input")+e.label;return s(q,{modelValue:_[e.prop],"onUpdate:modelValue":t=>_[e.prop]=t,type:"textarea",clearable:!0,readonly:Rs(e.readonly,!1),disabled:e.disabled,placeholder:t,onChange:t=>e.onChange?.(t,e,_,y)},{prefix:e.prefix?()=>e.prefix(_,e):null,suffix:e.suffix?()=>e.suffix(_,e):null,prepend:e.prepend?()=>e.prepend(_,e):null,append:e.append?()=>e.append(_,e):null})}if("select"===e.type){const t=e.placeholder||c("next.form.select")+e.label;return s(W,{modelValue:_[e.prop],"onUpdate:modelValue":t=>_[e.prop]=t,placeholder:t,clearable:!0,disabled:e.disabled,multiple:Rs(e.multiple,!1),"collapse-tags-tooltip":!0,onChange:t=>e.onChange?.(t,e,_,y)},{default:()=>[e.dicData&&e.dicData.map((e=>s(K,{key:e.value,value:e.value,label:e.label,disabled:Rs(e.disabled,!1)},null)))]})}if("time"===e.type){const t=e.placeholder||c("next.form.select")+e.label;return s(ce,{modelValue:_[e.prop],"onUpdate:modelValue":t=>_[e.prop]=t,start:"00:00",step:"00:30",end:"23:59",editable:!1,disabled:e.disabled,placeholder:t,onChange:t=>e.onChange?.(t,e,_,y)},{prefix:()=>e.prefix?e.prefix(_,e):null,suffix:()=>e.suffix?e.suffix(_,e):null})}if("radio"===e.type)return s(oe,{modelValue:_[e.prop],"onUpdate:modelValue":t=>_[e.prop]=t,disabled:e.disabled,onChange:t=>e.onChange?.(t,e,_,y)},{default:()=>[e.dicData&&e.dicData.map((e=>s(se,{key:e.value,label:e.value,disabled:Rs(e.disabled,!1)},{default:()=>[e.label]})))]});if("checkbox"===e.type)return Cs(_[e.prop])||(_[e.prop]=[]),s(he,{modelValue:_[e.prop],"onUpdate:modelValue":t=>_[e.prop]=t,disabled:e.disabled,onChange:t=>e.onChange?.(t,e,_,y)},{default:()=>[e.dicData&&e.dicData.map((e=>s(te,{key:e.value,label:e.value,disabled:Rs(e.disabled,!1)},{default:()=>[e.label]})))]});if("date"===e.type){const t=e.placeholder||c("next.form.select")+e.label;return s(Y,{modelValue:_[e.prop],"onUpdate:modelValue":[t=>_[e.prop]=t,t=>e.onChange?.(t,e,_,y)],placeholder:t,type:"date",valueFormat:e.format||"YYYY-MM-DD",format:e.format||"YYYY-MM-DD",clearable:!0,disabledDate:e.disabledDate||C,disabled:e.disabled,editable:e.editable},null)}if("datetime"===e.type){const t=e.placeholder||c("next.form.select")+e.label;return s(Y,{modelValue:_[e.prop],"onUpdate:modelValue":[t=>_[e.prop]=t,t=>e.onChange?.(t,e,_,y)],placeholder:t,type:"datetime",valueFormat:e.format||"YYYY-MM-DD HH:mm:ss",format:e.format||"YYYY-MM-DD HH:mm:ss",clearable:!0,disabledDate:e.disabledDate||C,disabled:e.disabled,editable:e.editable},null)}if("datetimerange"===e.type){const t=e.placeholder||c("next.form.select")+e.label;return s(Y,{modelValue:_[e.prop],"onUpdate:modelValue":[t=>_[e.prop]=t,t=>e.onChange?.(t,e,_,y)],placeholder:t,type:"datetimerange",valueFormat:e.format||"YYYY-MM-DD HH:mm:ss",format:e.format||"YYYY-MM-DD HH:mm:ss",clearable:!0,"range-separator":c("next.date.rangeSeparator"),"start-placeholder":c("next.date.startPlaceholder"),"end-placeholder":c("next.date.endPlaceholder"),disabledDate:e.disabledDate||C,disabled:e.disabled,editable:e.editable,shortcuts:e.shortcuts||R},null)}return"numberRange"===e.type?s(el,{modelValue:_[e.prop],"onUpdate:modelValue":t=>_[e.prop]=t,disabled:e.disabled,onChange:t=>{return a=t,n=e.prop,Array.isArray(_[n])||(_[n]=[]),void(_[n]=Number(a));var a,n}},null):"inputTableSelect"===e.type?s(il,{modelValue:_[e.prop],"onUpdate:modelValue":t=>_[e.prop]=t,formParams:_,column:e,disabled:e.disabled,onSelect:t=>((e,t)=>{e&&(t.tableSelectRows=e);const{value:a}=t.tableSelectProps||{};_[t.prop]=e.map((e=>e[a||"value"])),t.onTableSelect?.(_,e,t)})(t,e)},null):"uploadImage"===e.type?s(ol,{modelValue:_[e.prop],"onUpdate:modelValue":t=>_[e.prop]=t,disabled:e.disabled,onChange:(...t)=>e.onChange?.(...t,e,_,y)},null):void 0};r({formParams:w(_),ruleFormRef:b,formColumns:y});const L=()=>{let e,t,a;return s(X,{ref:b,class:ll.b(),inline:!1,model:_,size:d.size},{default:()=>[s(Z,{gutter:20},sl(e=y.map((e=>!e.hide&&s(G,{span:Rs(e.span,p.value)},{default:()=>[s(H,{prop:e.prop,required:e.required,rules:g[e.prop],style:{"--form-label-width":Rs(d.formLabelWidth,d.labelWidth)}},{label:()=>e.label?s(l,null,[s(ki,{content:c(e.label),class:ll.e("item-label")},null),e.tip?s(x,{effect:"dark",content:e.tip,placement:"top"},{default:()=>[s(I,{style:{"margin-left":"5px"},color:"#f3d19e"},{default:()=>[s(Er,null,null)]})]}):null]):null,default:()=>D(e)})]}))))?e:{default:()=>[e]}),u.value&&s("div",{class:ll.e("footer")},[s(J,{type:"primary",loading:S.value,onClick:A},sl(t=c("next.form.submit"))?t:{default:()=>[t]}),d.showResetBtn?s(J,{onClick:T},sl(a=c("next.form.reset"))?a:{default:()=>[a]}):null])]})};return()=>s(l,null,[L()])}});const ul=Ti(dl);var cl=o({name:"AddEditForm",props:{formDatum:{type:Object,default:()=>({})},isEditing:{type:Boolean,default:!0},columns:{type:Array,default:()=>[]}},emits:["close","submit"],setup(e,{slots:n,emit:o,expose:d}){const u=t("addEditFormSlots"),c={};u.value.forEach((e=>{c[e]=(...t)=>n[e]&&n[e](...t)}));const h=t("options",{}),p=ws(r(h)?i(h):h);p.columnMinWidth=p.formColumnMinWidth,p.isEditing=e.isEditing;const f=a(),_=ws(r(e.formDatum)?i(e.formDatum):e.formDatum),g=ws(e.columns).map((e=>(e.hide=Rs(e.formHide,e.hide,!1),e))),v=(...e)=>{o("submit",...e)};d({getFormExpose:()=>({formParams:f.value?.formParams,formColumns:f.value?.formColumns})});const y=()=>{return s(ul,{ref:f,options:p,columns:g,formDatum:_,onClose:()=>o("close"),onSubmit:v},"function"==typeof(e=c)||"[object Object]"===Object.prototype.toString.call(e)&&!m(e)?c:{default:()=>[c]});var e};return()=>s(l,null,[y()])}});function hl(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!m(e)}const pl=Ce("crud-table");var fl=o({name:"NextCrudTable",props:xs,emits:["confirm-search","clear-search","change-pagination","selection-change","row-click","row-contextmenu","row-dblclick","cell-click","cell-dblclick","cell-contextmenu","cell-mouse-enter","cell-mouse-leave","expand-change","click-add-edit","close-add-edit","view-add-edit","delete-rows","delete-row","submit-form"],setup(e,{emit:t,slots:r,expose:o}){const d=ws(Bs),u=n((()=>{const t=i(e.options);return ii(d,t)})),c=i(u);g("options",n((()=>u.value))),g("ns",pl);const{t:p}=pi(),f=a(c.columns),_=a([]),m=a([]),y=e=>{((e,t)=>{const a=h(e.columns),n=e=>{!e.dicData?.length&&e.loadDicData&&e.loadDicData(e,(t=>{t?.length&&(e.dicData=t)}))},i=e=>{let t=[];return e.forEach((e=>{n(e),t.push(e),e.children?.length&&(t.push(...i(e.children)),e.children&&delete e.children)})),t},r=i(a),o=e.formColumns.map((e=>(n(e),e))),s=r.concat(o).map((e=>{const t={prop:e.prop,label:Rs(e.formLabel,e.label,""),type:Rs(e.formType,e.type,""),defaultValue:Rs(e.formDefaultValue,e.defaultValue,""),placeholder:Rs(e.formPlaceholder,""),required:Rs(e.formRequired,e.required,!1),sort:Rs(e.formSort,e.sort,null),prefix:Rs(e.formPrefix,e.prefix,null),suffix:Rs(e.formSuffix,e.suffix,null),prepend:Rs(e.formPrepend,e.prepend,null),append:Rs(e.formAppend,e.append,null),hide:Rs(e.formHide,e.hide,!1),disabled:Rs(e.formDisabled,e.disabled,!1),readonly:Rs(e.formReadonly,e.readonly,!1),span:Rs(e.formSpan,e.span,null),dicData:Rs(e.formDicData,e.dicData,[]),loadDicData:Rs(e.formLoadDicData,e.loadDicData,null),onChange:Rs(e.onChangeForm,e.onChange,null),tableSelect:Rs(e.tableSelect,{}),tableSelectRows:Rs(e.tableSelectRows,[]),tableSelectProps:Rs(e.tableSelectProps,null),tableSelectDefaultValue:Rs(e.tableSelectDefaultValue,null),onTableSelect:Rs(e.onTableSelect,null)};return!e.dicData?.length&&e.loadDicData&&Ds(t,e,"dicData"),t})).filter((e=>e.sort&&e.prop)).sort(((e,t)=>e.sort-t.sort)),l=(e,t)=>{const a={prop:e.prop,type:Rs(e.searchType,e.type),label:Rs(e.searchLabel,e.label),defaultValue:Rs(e.searchDefaultValue,e.defaultValue,null),placeholder:Rs(e.searchPlaceholder,e.placeholder,null),dicData:Rs(e.searchDicData,e.dicData,[]),loadDicData:Rs(e.searchLoadDicData,e.loadDicData,null),disabled:Rs(e.searchDisabled,e.disabled,!1),readonly:Rs(e.searchReadonly,e.readonly,!1),prefix:Rs(e.searchPrefix,e.prefix,null),suffix:Rs(e.searchSuffix,e.suffix,null),prepend:Rs(e.searchPrepend,e.prepend,null),append:Rs(e.searchAppend,e.append,null),hide:Rs(e.searchHide,!1),sort:Rs(e.searchSort,e.sort,t)};return!e.dicData?.length&&e.loadDicData&&Ds(a,e,"dicData"),a},d=e.searchColumns.map(((e,t)=>(n(e),l(e,t)))),u=d.length,c=d.concat((e=>{let t=[];return e.forEach(((e,a)=>{e.searchType&&t.push(l(e,a+u))})),t})(r)),p=Ts(c.sort(((e,t)=>e.sort-t.sort)),"prop");t&&t({formColumns:s,searchColumns:p,columns:a})})(e,(({formColumns:e,searchColumns:t,columns:a})=>{_.value=t,m.value=e,f.value=a}))},b=a(e.data),S=a((()=>{const e=_.value;let t={};for(let a=0;a<e.length;a++){const n=e[a];Cs(n.defaultValue)&&(t[n.prop]=n.defaultValue)}return t})()),T=a=>{const n=ws(w(a));Wn(S.value,n)||(e.page.pageIndex=1,S.value=n),t("confirm-search",n)},R=()=>{t("clear-search")},D=()=>{T(S.value)};v((()=>e.data),(e=>{b.value=e}),{immediate:!0}),v((()=>u),(e=>{y(e.value)}),{deep:!0,immediate:!0});const x=a(c.defaultContentHeight),L=a(),k=a(),B=a(),O=a(),M=a(null),I=()=>{C((()=>{const e=(L.value?.clientHeight||0)-((k.value?.clientHeight||0)+(O.value?.clientHeight||0));x.value=e}))},P=e=>{"F11"!==e.key&&"fullscreenchange"!==e.type||I()};E((()=>{Es(L.value,(()=>{I()})),c.initLoadData&&T(S.value),c.fullscreenchangeContentHeight&&(document.addEventListener("fullscreenchange",P),document.addEventListener("keydown",P))})),A((()=>{c.fullscreenchangeContentHeight&&(document.removeEventListener("fullscreenchange",P),document.removeEventListener("keydown",P))}));const U=a=>{e.page.pageIndex=a.pageIndex,e.page.pageSize=a.pageSize,t("change-pagination",a),T(S.value)},N=a([]),V=e=>{N.value=e,t("selection-change",N.value)};g("multipleSelection",N);const j=h({visible:!1,title:p("next.table.add"),rowInfo:{},isEditing:!0}),z=(e={})=>{const{dialogTitle:a}=c;j.isEditing=!0,j.title=a+" "+p("next.table.add"),j.rowInfo=e,t("click-add-edit",e),C((()=>{j.visible=!0}))},F=e=>{t("delete-rows",e,(()=>{D()}))},G=e=>{t("delete-row",e,(()=>{D()}))},H=e=>{const{dialogTitle:a}=c;j.isEditing=!0,j.title=a+" "+p("next.table.edit"),j.rowInfo=e.row,t("click-add-edit",e.row),C((()=>{j.visible=!0}))},q=e=>{const{dialogTitle:a}=c;j.isEditing=!1,j.title=a+" "+p("next.table.view"),j.rowInfo=e.row,t("view-add-edit",e.row),C((()=>{j.visible=!0}))},W=()=>{j.visible=!1,j.title="",j.rowInfo={},t("close-add-edit")},K=(...e)=>{t("submit-form",...e)},Y=a([]),$=a([]),X=a([]);for(const e in r)e.includes(Os)?Y.value.push(e):e.includes(Is)?$.value.push(e):e.includes(Us)&&X.value.push(e);g("columnSlots",Y),g("searchFormSlots",$),g("addEditFormSlots",X);const Z=t=>{const{pageIndex:a,pageSize:n}=e.page;return(a-1)*n+(t+1)},J=n((()=>{const{total:t}=e.page,a=document.createElement("span");a.innerText=t,a.style.visibility="hidden",document.body.appendChild(a);const n=a.getBoundingClientRect().width,i=Math.ceil(n)+25;return document.body.removeChild(a),i>50?i:50})),te={};$.value.forEach((e=>{te[e]=(...t)=>r[e]&&r[e](...t)}));const ae={};Y.value.forEach((e=>{ae[e]=(...t)=>r[e]&&r[e](...t)}));const ne={};X.value.forEach((e=>{ne[e]=(...t)=>r[e]&&r[e](...t)}));const ie={};Ls.forEach((e=>{ie[e]=(...t)=>r[e]&&r[e](...t)}));const re={};ks.forEach((e=>{re[e]=(...t)=>r[e]&&r[e](...t)}));o({onClickRowAdd:z,columns:f.value,getFormExpose:()=>M.value?.getFormExpose(),updateColumns:e=>{y(e)}});return()=>s(l,null,[s(l,null,[s("div",{ref:L,class:[pl.b(),e.className],style:e.style},[c.showSearchForm||c.showHeaderMenu?s("header",{ref:k,class:pl.b("header")},[c.showSearchForm&&s(Gs,{columns:_.value,onZoomResize:I,onConfirmSearch:T,onClearSearch:R},hl(te)?te:{default:()=>[te]}),c.showHeaderMenu&&s(qs,{onClickAdd:z,onDeleteRows:F,onClickRefresh:D},hl(ie)?ie:{default:()=>[ie]}),r["table-head-tip"]?.()]):null,s(js,{loading:e.loading},{default:()=>[s("div",{ref:B,class:pl.b("content")},[s(Q,{data:b.value,height:x.value,rowKey:c.rowKey,border:c.border,stripe:c.stripe,fit:c.fit,size:c.size,"row-style":c.rowStyle,"row-class-name":c.rowClassName,"cell-style":c.cellStyle,"cell-class-name":c.cellClassName,"header-row-style":c.headerRowStyle,"header-row-class-name":c.headerRowClassName,"header-cell-style":c.headerCellStyle,"header-cell-class-name":c.headerCellClassName,"span-method":e.spanMethod,"onSelection-change":V,"onRow-click":(...e)=>t("row-click",...e),"onRow-contextmenu":(...e)=>t("row-contextmenu",...e),"onRow-dblclick":(...e)=>t("row-dblclick",...e),"onCell-click":(...e)=>t("cell-click",...e),"onCell-dblclick":(...e)=>t("cell-dblclick",...e),"onCell-contextmenu":(...e)=>t("cell-contextmenu",...e),"onCell-mouse-enter":(...e)=>t("cell-mouse-enter",...e),"onCell-mouse-leave":(...e)=>t("cell-mouse-leave",...e),"onExpand-change":(...e)=>t("expand-change",...e)},{default:()=>[c.index?s(ee,{type:"index",label:"#",width:J.value,index:Z,fixed:"left",headerAlign:c.headerAlign,align:c.cellAlign},null):null,c.selection?s(ee,{type:"selection",fixed:"left",label:p("next.table.selectionAll"),width:55,headerAlign:c.headerAlign,align:c.cellAlign},null):null,r.default?.(),f.value.map((e=>s(Ws,{columnOption:e,key:e.prop},hl(ae)?ae:{default:()=>[ae]}))),c.operations?s(Ks,{onEditRow:H,onViewRow:q,onDeleteRow:G},hl(re)?re:{default:()=>[re]}):null],empty:()=>s(pe,{imageSize:x.value>220?100:50,description:p("next.table.notData")},null)})])]}),c.isPagination?s("div",{ref:O,class:pl.b("footer")},[s(Ys,{page:e.page,onChange:U},null),r["table-footer-tip"]?.()]):null,s(Xs,{modelValue:j.visible,"onUpdate:modelValue":e=>j.visible=e,title:j.title,width:c.dialogWidth,fullscreen:c.dialogFullscreen,closeOnClickModal:c.closeOnClickModal,onClose:W},{default:()=>s(cl,{ref:M,formDatum:j.rowInfo,columns:m.value,isEditing:j.isEditing,onClose:W,onSubmit:K},hl(ne)?ne:{default:()=>[ne]})})])])])}});const _l=Ti(fl),ml=Ti(js),gl=Ce("upload");const vl=Ti(o({name:"NextUpload",props:{className:{type:String,default:""},style:{type:Object,default:()=>({})},listType:{type:String,values:["text","picture","picture-card"],default:"picture-card"},accept:{type:String,default:"image/*"}},emits:["change"],setup(){const{appContext:t}=e(),{t:a}=pi();return{t:a,appContext:t}},render(){const e=this.$slots,t=this.$props,n=this.$emit,i=this.t,r=a([]),o=document.getElementsByTagName("body")[0];let l=null;return s(le,{class:[gl.b(),t.className],style:t.style,"list-type":t.listType,"auto-upload":!1,"on-preview":e=>{const t=r.value.findIndex((t=>t.url===e.url))||0;l&&(T(null,l),o.removeChild(l)),l=document.createElement("div"),o.appendChild(l);const a=s({render:()=>S(_,{to:"body"},[S(de,{initialIndex:t,"url-list":r.value.map((e=>e.url)),onClose:()=>{T(null,l)}})])});l.appContext=this.appContext,T(a,l)},onChange:(e,t)=>{r.value=t,n("change",e,t)}},{trigger:()=>e.default?e.default():"picture-card"===t.listType?s(I,null,{default:()=>[s(Ir,null,null)]}):s(J,{link:!0,text:!0,type:"primary"},{default:()=>[s(I,null,{default:()=>[s(Ir,null,null)]}),s("em",null,[i("next.form.selectFile")])]})})}}));var yl={exports:{}};window,yl.exports=function(e){var t={};function a(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,a),i.l=!0,i.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=14)}([function(e,t,a){var n=a(6),i=a.n(n),r=function(){function e(){}return e.e=function(t,a){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var n="["+t+"] > "+a;e.ENABLE_CALLBACK&&e.emitter.emit("log","error",n),e.ENABLE_ERROR&&(console.error||console.warn)},e.i=function(t,a){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var n="["+t+"] > "+a;e.ENABLE_CALLBACK&&e.emitter.emit("log","info",n),e.ENABLE_INFO&&console.info},e.w=function(t,a){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var n="["+t+"] > "+a;e.ENABLE_CALLBACK&&e.emitter.emit("log","warn",n),e.ENABLE_WARN&&console.warn},e.d=function(t,a){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var n="["+t+"] > "+a;e.ENABLE_CALLBACK&&e.emitter.emit("log","debug",n),e.ENABLE_DEBUG&&console.debug},e.v=function(t,a){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var n="["+t+"] > "+a;e.ENABLE_CALLBACK&&e.emitter.emit("log","verbose",n),e.ENABLE_VERBOSE},e}();r.GLOBAL_TAG="mpegts.js",r.FORCE_GLOBAL_TAG=!1,r.ENABLE_ERROR=!0,r.ENABLE_INFO=!0,r.ENABLE_WARN=!0,r.ENABLE_DEBUG=!0,r.ENABLE_VERBOSE=!0,r.ENABLE_CALLBACK=!1,r.emitter=new i.a,t.a=r},function(e,t,a){t.a={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",TIMED_ID3_METADATA_ARRIVED:"timed_id3_metadata_arrived",SYNCHRONOUS_KLV_METADATA_ARRIVED:"synchronous_klv_metadata_arrived",ASYNCHRONOUS_KLV_METADATA_ARRIVED:"asynchronous_klv_metadata_arrived",SMPTE2038_METADATA_ARRIVED:"smpte2038_metadata_arrived",SCTE35_METADATA_ARRIVED:"scte35_metadata_arrived",PES_PRIVATE_DATA_DESCRIPTOR:"pes_private_data_descriptor",PES_PRIVATE_DATA_ARRIVED:"pes_private_data_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"}},function(e,t,a){a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return o}));var n=a(3),i={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},r={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},o=function(){function e(e){this._type=e||"undefined",this._status=i.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return e.prototype.destroy=function(){this._status=i.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},e.prototype.isWorking=function(){return this._status===i.kConnecting||this._status===i.kBuffering},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(e){this._onContentLengthKnown=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(e){this._onURLRedirect=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onComplete",{get:function(){return this._onComplete},set:function(e){this._onComplete=e},enumerable:!1,configurable:!0}),e.prototype.open=function(e,t){throw new n.c("Unimplemented abstract function!")},e.prototype.abort=function(){throw new n.c("Unimplemented abstract function!")},e}()},function(e,t,a){a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return l}));var n,i=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),r=function(){function e(e){this._message=e}return Object.defineProperty(e.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this.name+": "+this.message},e}(),o=function(e){function t(t){return e.call(this,t)||this}return i(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),t}(r),s=function(e){function t(t){return e.call(this,t)||this}return i(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),t}(r),l=function(e){function t(t){return e.call(this,t)||this}return i(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),t}(r)},function(e,t,a){var n={};!function(){var e=self.navigator.userAgent.toLowerCase(),t=/(edge)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(iemobile)[\/]([\w.]+)/.exec(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(e)||[],a=/(ipad)/.exec(e)||/(ipod)/.exec(e)||/(windows phone)/.exec(e)||/(iphone)/.exec(e)||/(kindle)/.exec(e)||/(android)/.exec(e)||/(windows)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/.exec(e)||[],i={browser:t[5]||t[3]||t[1]||"",version:t[2]||t[4]||"0",majorVersion:t[4]||t[2]||"0",platform:a[0]||""},r={};if(i.browser){r[i.browser]=!0;var o=i.majorVersion.split(".");r.version={major:parseInt(i.majorVersion,10),string:i.version},o.length>1&&(r.version.minor=parseInt(o[1],10)),o.length>2&&(r.version.build=parseInt(o[2],10))}for(var s in i.platform&&(r[i.platform]=!0),(r.chrome||r.opr||r.safari)&&(r.webkit=!0),(r.rv||r.iemobile)&&(r.rv&&delete r.rv,i.browser="msie",r.msie=!0),r.edge&&(delete r.edge,i.browser="msedge",r.msedge=!0),r.opr&&(i.browser="opera",r.opera=!0),r.safari&&r.android&&(i.browser="android",r.android=!0),r.name=i.browser,r.platform=i.platform,n)n.hasOwnProperty(s)&&delete n[s];Object.assign(n,r)}(),t.a=n},function(e,t,a){t.a={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"}},function(e,t,a){var n,i="object"==typeof Reflect?Reflect:null,r=i&&"function"==typeof i.apply?i.apply:function(e,t,a){return Function.prototype.apply.call(e,t,a)};n=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(a,n){function i(a){e.removeListener(t,r),n(a)}function r(){"function"==typeof e.removeListener&&e.removeListener("error",i),a([].slice.call(arguments))}g(e,t,r,{once:!0}),"error"!==t&&function(e,t,a){"function"==typeof e.on&&g(e,"error",t,a)}(e,i,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function d(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function c(e,t,a,n){var i,r,o;if(d(a),void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,a.listener?a.listener:a),r=e._events),o=r[t]),void 0===o)o=r[t]=a,++e._eventsCount;else if("function"==typeof o?o=r[t]=n?[a,o]:[o,a]:n?o.unshift(a):o.push(a),(i=u(e))>0&&o.length>i&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=o.length,console&&console.warn}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,a){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:a},i=h.bind(n);return i.listener=a,n.wrapFn=i,i}function f(e,t,a){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?a?[i.listener||i]:[i]:a?function(e){for(var t=new Array(e.length),a=0;a<t.length;++a)t[a]=e[a].listener||e[a];return t}(i):m(i,i.length)}function _(e){var t=this._events;if(void 0!==t){var a=t[e];if("function"==typeof a)return 1;if(void 0!==a)return a.length}return 0}function m(e,t){for(var a=new Array(t),n=0;n<t;++n)a[n]=e[n];return a}function g(e,t,a,n){if("function"==typeof e.on)n.once?e.once(t,a):e.on(t,a);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(r){n.once&&e.removeEventListener(t,i),a(r)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(e){for(var t=[],a=1;a<arguments.length;a++)t.push(arguments[a]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=i[e];if(void 0===l)return!1;if("function"==typeof l)r(l,this,t);else{var d=l.length,u=m(l,d);for(a=0;a<d;++a)r(u[a],this,t)}return!0},s.prototype.addListener=function(e,t){return c(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return c(this,e,t,!0)},s.prototype.once=function(e,t){return d(t),this.on(e,p(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return d(t),this.prependListener(e,p(this,e,t)),this},s.prototype.removeListener=function(e,t){var a,n,i,r,o;if(d(t),void 0===(n=this._events))return this;if(void 0===(a=n[e]))return this;if(a===t||a.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,a.listener||t));else if("function"!=typeof a){for(i=-1,r=a.length-1;r>=0;r--)if(a[r]===t||a[r].listener===t){o=a[r].listener,i=r;break}if(i<0)return this;0===i?a.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(a,i),1===a.length&&(n[e]=a[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,a,n;if(void 0===(a=this._events))return this;if(void 0===a.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==a[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete a[e]),this;if(0===arguments.length){var i,r=Object.keys(a);for(n=0;n<r.length;++n)"removeListener"!==(i=r[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=a[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return f(this,e,!0)},s.prototype.rawListeners=function(e){return f(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):_.call(e,t)},s.prototype.listenerCount=_,s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(e,t,a){a.d(t,"d",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return o}));var n=function(e,t,a,n,i){this.dts=e,this.pts=t,this.duration=a,this.originalDts=n,this.isSyncPoint=i,this.fileposition=null},i=function(){function e(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return e.prototype.appendSyncPoint=function(e){e.isSyncPoint=!0,this.syncPoints.push(e)},e}(),r=function(){function e(){this._list=[]}return e.prototype.clear=function(){this._list=[]},e.prototype.appendArray=function(e){var t=this._list;0!==e.length&&(t.length>0&&e[0].originalDts<t[t.length-1].originalDts&&this.clear(),Array.prototype.push.apply(t,e))},e.prototype.getLastSyncPointBeforeDts=function(e){if(0==this._list.length)return null;var t=this._list,a=0,n=t.length-1,i=0,r=0,o=n;for(e<t[0].dts&&(a=0,r=o+1);r<=o;){if((i=r+Math.floor((o-r)/2))===n||e>=t[i].dts&&e<t[i+1].dts){a=i;break}t[i].dts<e?r=i+1:o=i-1}return this._list[a]},e}(),o=function(){function e(e){this._type=e,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return 0===this._list.length},e.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},e.prototype._searchNearestSegmentBefore=function(e){var t=this._list;if(0===t.length)return-2;var a=t.length-1,n=0,i=0,r=a,o=0;if(e<t[0].originalBeginDts)return-1;for(;i<=r;){if((n=i+Math.floor((r-i)/2))===a||e>t[n].lastSample.originalDts&&e<t[n+1].originalBeginDts){o=n;break}t[n].originalBeginDts<e?i=n+1:r=n-1}return o},e.prototype._searchNearestSegmentAfter=function(e){return this._searchNearestSegmentBefore(e)+1},e.prototype.append=function(e){var t=this._list,a=e,n=this._lastAppendLocation,i=0;-1!==n&&n<t.length&&a.originalBeginDts>=t[n].lastSample.originalDts&&(n===t.length-1||n<t.length-1&&a.originalBeginDts<t[n+1].originalBeginDts)?i=n+1:t.length>0&&(i=this._searchNearestSegmentBefore(a.originalBeginDts)+1),this._lastAppendLocation=i,this._list.splice(i,0,a)},e.prototype.getLastSegmentBefore=function(e){var t=this._searchNearestSegmentBefore(e);return t>=0?this._list[t]:null},e.prototype.getLastSampleBefore=function(e){var t=this.getLastSegmentBefore(e);return null!=t?t.lastSample:null},e.prototype.getLastSyncPointBefore=function(e){for(var t=this._searchNearestSegmentBefore(e),a=this._list[t].syncPoints;0===a.length&&t>0;)t--,a=this._list[t].syncPoints;return a.length>0?a[a.length-1]:null},e}()},function(e,t,a){var n=function(){function e(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return e.prototype.isComplete=function(){var e=!1===this.hasAudio||!0===this.hasAudio&&null!=this.audioCodec&&null!=this.audioSampleRate&&null!=this.audioChannelCount,t=!1===this.hasVideo||!0===this.hasVideo&&null!=this.videoCodec&&null!=this.width&&null!=this.height&&null!=this.fps&&null!=this.profile&&null!=this.level&&null!=this.refFrames&&null!=this.chromaFormat&&null!=this.sarNum&&null!=this.sarDen;return null!=this.mimeType&&e&&t},e.prototype.isSeekable=function(){return!0===this.hasKeyframesIndex},e.prototype.getNearestKeyframe=function(e){if(null==this.keyframesIndex)return null;var t=this.keyframesIndex,a=this._search(t.times,e);return{index:a,milliseconds:t.times[a],fileposition:t.filepositions[a]}},e.prototype._search=function(e,t){var a=0,n=e.length-1,i=0,r=0,o=n;for(t<e[0]&&(a=0,r=o+1);r<=o;){if((i=r+Math.floor((o-r)/2))===n||t>=e[i]&&t<e[i+1]){a=i;break}e[i]<t?r=i+1:o=i-1}return a},e}();t.a=n},function(e,t,a){var n=a(6),i=a.n(n),r=a(0),o=function(){function e(){}return Object.defineProperty(e,"forceGlobalTag",{get:function(){return r.a.FORCE_GLOBAL_TAG},set:function(t){r.a.FORCE_GLOBAL_TAG=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"globalTag",{get:function(){return r.a.GLOBAL_TAG},set:function(t){r.a.GLOBAL_TAG=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableAll",{get:function(){return r.a.ENABLE_VERBOSE&&r.a.ENABLE_DEBUG&&r.a.ENABLE_INFO&&r.a.ENABLE_WARN&&r.a.ENABLE_ERROR},set:function(t){r.a.ENABLE_VERBOSE=t,r.a.ENABLE_DEBUG=t,r.a.ENABLE_INFO=t,r.a.ENABLE_WARN=t,r.a.ENABLE_ERROR=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableDebug",{get:function(){return r.a.ENABLE_DEBUG},set:function(t){r.a.ENABLE_DEBUG=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableVerbose",{get:function(){return r.a.ENABLE_VERBOSE},set:function(t){r.a.ENABLE_VERBOSE=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableInfo",{get:function(){return r.a.ENABLE_INFO},set:function(t){r.a.ENABLE_INFO=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableWarn",{get:function(){return r.a.ENABLE_WARN},set:function(t){r.a.ENABLE_WARN=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableError",{get:function(){return r.a.ENABLE_ERROR},set:function(t){r.a.ENABLE_ERROR=t,e._notifyChange()},enumerable:!1,configurable:!0}),e.getConfig=function(){return{globalTag:r.a.GLOBAL_TAG,forceGlobalTag:r.a.FORCE_GLOBAL_TAG,enableVerbose:r.a.ENABLE_VERBOSE,enableDebug:r.a.ENABLE_DEBUG,enableInfo:r.a.ENABLE_INFO,enableWarn:r.a.ENABLE_WARN,enableError:r.a.ENABLE_ERROR,enableCallback:r.a.ENABLE_CALLBACK}},e.applyConfig=function(e){r.a.GLOBAL_TAG=e.globalTag,r.a.FORCE_GLOBAL_TAG=e.forceGlobalTag,r.a.ENABLE_VERBOSE=e.enableVerbose,r.a.ENABLE_DEBUG=e.enableDebug,r.a.ENABLE_INFO=e.enableInfo,r.a.ENABLE_WARN=e.enableWarn,r.a.ENABLE_ERROR=e.enableError,r.a.ENABLE_CALLBACK=e.enableCallback},e._notifyChange=function(){var t=e.emitter;if(t.listenerCount("change")>0){var a=e.getConfig();t.emit("change",a)}},e.registerListener=function(t){e.emitter.addListener("change",t)},e.removeListener=function(t){e.emitter.removeListener("change",t)},e.addLogListener=function(t){r.a.emitter.addListener("log",t),r.a.emitter.listenerCount("log")>0&&(r.a.ENABLE_CALLBACK=!0,e._notifyChange())},e.removeLogListener=function(t){r.a.emitter.removeListener("log",t),0===r.a.emitter.listenerCount("log")&&(r.a.ENABLE_CALLBACK=!1,e._notifyChange())},e}();o.emitter=new i.a,t.a=o},function(e,t,a){var n=a(6),i=a.n(n),r=a(0),o=a(4),s=a(8);function l(e,t,a){var n=e;if(t+a<n.length){for(;a--;)if(128!=(192&n[++t]))return!1;return!0}return!1}var d,u=function(e){for(var t=[],a=e,n=0,i=e.length;n<i;)if(a[n]<128)t.push(String.fromCharCode(a[n])),++n;else{if(a[n]<192);else if(a[n]<224){if(l(a,n,1)&&(r=(31&a[n])<<6|63&a[n+1])>=128){t.push(String.fromCharCode(65535&r)),n+=2;continue}}else if(a[n]<240){if(l(a,n,2)&&(r=(15&a[n])<<12|(63&a[n+1])<<6|63&a[n+2])>=2048&&55296!=(63488&r)){t.push(String.fromCharCode(65535&r)),n+=3;continue}}else if(a[n]<248){var r;if(l(a,n,3)&&(r=(7&a[n])<<18|(63&a[n+1])<<12|(63&a[n+2])<<6|63&a[n+3])>65536&&r<1114112){r-=65536,t.push(String.fromCharCode(r>>>10|55296)),t.push(String.fromCharCode(1023&r|56320)),n+=4;continue}}t.push(String.fromCharCode(65533)),++n}return t.join("")},c=a(3),h=(d=new ArrayBuffer(2),new DataView(d).setInt16(0,256,!0),256===new Int16Array(d)[0]),p=function(){function e(){}return e.parseScriptData=function(t,a,n){var i={};try{var o=e.parseValue(t,a,n),s=e.parseValue(t,a+o.size,n-o.size);i[o.data]=s.data}catch(e){r.a.e("AMF",e.toString())}return i},e.parseObject=function(t,a,n){if(n<3)throw new c.a("Data not enough when parse ScriptDataObject");var i=e.parseString(t,a,n),r=e.parseValue(t,a+i.size,n-i.size),o=r.objectEnd;return{data:{name:i.data,value:r.data},size:i.size+r.size,objectEnd:o}},e.parseVariable=function(t,a,n){return e.parseObject(t,a,n)},e.parseString=function(e,t,a){if(a<2)throw new c.a("Data not enough when parse String");var n=new DataView(e,t,a).getUint16(0,!h);return{data:n>0?u(new Uint8Array(e,t+2,n)):"",size:2+n}},e.parseLongString=function(e,t,a){if(a<4)throw new c.a("Data not enough when parse LongString");var n=new DataView(e,t,a).getUint32(0,!h);return{data:n>0?u(new Uint8Array(e,t+4,n)):"",size:4+n}},e.parseDate=function(e,t,a){if(a<10)throw new c.a("Data size invalid when parse Date");var n=new DataView(e,t,a),i=n.getFloat64(0,!h),r=n.getInt16(8,!h);return{data:new Date(i+=60*r*1e3),size:10}},e.parseValue=function(t,a,n){if(n<1)throw new c.a("Data not enough when parse Value");var i,o=new DataView(t,a,n),s=1,l=o.getUint8(0),d=!1;try{switch(l){case 0:i=o.getFloat64(1,!h),s+=8;break;case 1:i=!!o.getUint8(1),s+=1;break;case 2:var u=e.parseString(t,a+1,n-1);i=u.data,s+=u.size;break;case 3:i={};var p=0;for(9==(16777215&o.getUint32(n-4,!h))&&(p=3);s<n-4;){var f=e.parseObject(t,a+s,n-s-p);if(f.objectEnd)break;i[f.data.name]=f.data.value,s+=f.size}s<=n-3&&9==(16777215&o.getUint32(s-1,!h))&&(s+=3);break;case 8:for(i={},s+=4,p=0,9==(16777215&o.getUint32(n-4,!h))&&(p=3);s<n-8;){var _=e.parseVariable(t,a+s,n-s-p);if(_.objectEnd)break;i[_.data.name]=_.data.value,s+=_.size}s<=n-3&&9==(16777215&o.getUint32(s-1,!h))&&(s+=3);break;case 9:i=void 0,s=1,d=!0;break;case 10:i=[];var m=o.getUint32(1,!h);s+=4;for(var g=0;g<m;g++){var v=e.parseValue(t,a+s,n-s);i.push(v.data),s+=v.size}break;case 11:var y=e.parseDate(t,a+1,n-1);i=y.data,s+=y.size;break;case 12:var b=e.parseString(t,a+1,n-1);i=b.data,s+=b.size;break;default:s=n,r.a.w("AMF","Unsupported AMF value type "+l)}}catch(e){r.a.e("AMF",e.toString())}return{data:i,size:s,objectEnd:d}},e}(),f=function(){function e(e){this.TAG="ExpGolomb",this._buffer=e,this._buffer_index=0,this._total_bytes=e.byteLength,this._total_bits=8*e.byteLength,this._current_word=0,this._current_word_bits_left=0}return e.prototype.destroy=function(){this._buffer=null},e.prototype._fillCurrentWord=function(){var e=this._total_bytes-this._buffer_index;if(e<=0)throw new c.a("ExpGolomb: _fillCurrentWord() but no bytes available");var t=Math.min(4,e),a=new Uint8Array(4);a.set(this._buffer.subarray(this._buffer_index,this._buffer_index+t)),this._current_word=new DataView(a.buffer).getUint32(0,!1),this._buffer_index+=t,this._current_word_bits_left=8*t},e.prototype.readBits=function(e){if(e>32)throw new c.b("ExpGolomb: readBits() bits exceeded max 32bits!");if(e<=this._current_word_bits_left){var t=this._current_word>>>32-e;return this._current_word<<=e,this._current_word_bits_left-=e,t}var a=this._current_word_bits_left?this._current_word:0;a>>>=32-this._current_word_bits_left;var n=e-this._current_word_bits_left;this._fillCurrentWord();var i=Math.min(n,this._current_word_bits_left),r=this._current_word>>>32-i;return this._current_word<<=i,this._current_word_bits_left-=i,a<<i|r},e.prototype.readBool=function(){return 1===this.readBits(1)},e.prototype.readByte=function(){return this.readBits(8)},e.prototype._skipLeadingZero=function(){var e;for(e=0;e<this._current_word_bits_left;e++)if(0!=(this._current_word&2147483648>>>e))return this._current_word<<=e,this._current_word_bits_left-=e,e;return this._fillCurrentWord(),e+this._skipLeadingZero()},e.prototype.readUEG=function(){var e=this._skipLeadingZero();return this.readBits(e+1)-1},e.prototype.readSEG=function(){var e=this.readUEG();return 1&e?e+1>>>1:-1*(e>>>1)},e}(),_=function(){function e(){}return e._ebsp2rbsp=function(e){for(var t=e,a=t.byteLength,n=new Uint8Array(a),i=0,r=0;r<a;r++)r>=2&&3===t[r]&&0===t[r-1]&&0===t[r-2]||(n[i]=t[r],i++);return new Uint8Array(n.buffer,0,i)},e.parseSPS=function(t){for(var a=t.subarray(1,4),n="avc1.",i=0;i<3;i++){var r=a[i].toString(16);r.length<2&&(r="0"+r),n+=r}var o=e._ebsp2rbsp(t),s=new f(o);s.readByte();var l=s.readByte();s.readByte();var d=s.readByte();s.readUEG();var u=e.getProfileString(l),c=e.getLevelString(d),h=1,p=420,_=8,m=8;if((100===l||110===l||122===l||244===l||44===l||83===l||86===l||118===l||128===l||138===l||144===l)&&(3===(h=s.readUEG())&&s.readBits(1),h<=3&&(p=[0,420,422,444][h]),_=s.readUEG()+8,m=s.readUEG()+8,s.readBits(1),s.readBool()))for(var g=3!==h?8:12,v=0;v<g;v++)s.readBool()&&(v<6?e._skipScalingList(s,16):e._skipScalingList(s,64));s.readUEG();var y=s.readUEG();if(0===y)s.readUEG();else if(1===y){s.readBits(1),s.readSEG(),s.readSEG();var b=s.readUEG();for(v=0;v<b;v++)s.readSEG()}var S=s.readUEG();s.readBits(1);var A=s.readUEG(),E=s.readUEG(),w=s.readBits(1);0===w&&s.readBits(1),s.readBits(1);var T=0,C=0,R=0,D=0;s.readBool()&&(T=s.readUEG(),C=s.readUEG(),R=s.readUEG(),D=s.readUEG());var x=1,L=1,k=0,B=!0,O=0,M=0;if(s.readBool()){if(s.readBool()){var I=s.readByte();I>0&&I<16?(x=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][I-1],L=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][I-1]):255===I&&(x=s.readByte()<<8|s.readByte(),L=s.readByte()<<8|s.readByte())}if(s.readBool()&&s.readBool(),s.readBool()&&(s.readBits(4),s.readBool()&&s.readBits(24)),s.readBool()&&(s.readUEG(),s.readUEG()),s.readBool()){var P=s.readBits(32),U=s.readBits(32);B=s.readBool(),k=(O=U)/(M=2*P)}}var N=1;1===x&&1===L||(N=x/L);var V=0,j=0;0===h?(V=1,j=2-w):(V=3===h?1:2,j=(1===h?2:1)*(2-w));var z=16*(A+1),F=16*(E+1)*(2-w);z-=(T+C)*V,F-=(R+D)*j;var G=Math.ceil(z*N);return s.destroy(),s=null,{codec_mimetype:n,profile_idc:l,level_idc:d,profile_string:u,level_string:c,chroma_format_idc:h,bit_depth:_,bit_depth_luma:_,bit_depth_chroma:m,ref_frames:S,chroma_format:p,chroma_format_string:e.getChromaFormatString(p),frame_rate:{fixed:B,fps:k,fps_den:M,fps_num:O},sar_ratio:{width:x,height:L},codec_size:{width:z,height:F},present_size:{width:G,height:F}}},e._skipScalingList=function(e,t){for(var a=8,n=8,i=0;i<t;i++)0!==n&&(n=(a+e.readSEG()+256)%256),a=0===n?a:n},e.getProfileString=function(e){switch(e){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},e.getLevelString=function(e){return(e/10).toFixed(1)},e.getChromaFormatString=function(e){switch(e){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},e}(),m=a(5),g=function(){function e(){}return e._ebsp2rbsp=function(e){for(var t=e,a=t.byteLength,n=new Uint8Array(a),i=0,r=0;r<a;r++)r>=2&&3===t[r]&&0===t[r-1]&&0===t[r-2]||(n[i]=t[r],i++);return new Uint8Array(n.buffer,0,i)},e.parseVPS=function(t){var a=e._ebsp2rbsp(t),n=new f(a);return n.readByte(),n.readByte(),n.readBits(4),n.readBits(2),n.readBits(6),{num_temporal_layers:n.readBits(3)+1,temporal_id_nested:n.readBool()}},e.parseSPS=function(t){var a=e._ebsp2rbsp(t),n=new f(a);n.readByte(),n.readByte();for(var i=0,r=0,o=0,s=0,l=(n.readBits(4),n.readBits(3)),d=(n.readBool(),n.readBits(2)),u=n.readBool(),c=n.readBits(5),h=n.readByte(),p=n.readByte(),_=n.readByte(),m=n.readByte(),g=n.readByte(),v=n.readByte(),y=n.readByte(),b=n.readByte(),S=n.readByte(),A=n.readByte(),E=n.readByte(),w=[],T=[],C=0;C<l;C++)w.push(n.readBool()),T.push(n.readBool());if(l>0)for(C=l;C<8;C++)n.readBits(2);for(C=0;C<l;C++)w[C]&&(n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte()),T[C]&&n.readByte();n.readUEG();var R=n.readUEG();3==R&&n.readBits(1);var D=n.readUEG(),x=n.readUEG();n.readBool()&&(i+=n.readUEG(),r+=n.readUEG(),o+=n.readUEG(),s+=n.readUEG());var L=n.readUEG(),k=n.readUEG(),B=n.readUEG();for(C=n.readBool()?0:l;C<=l;C++)n.readUEG(),n.readUEG(),n.readUEG();if(n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG(),n.readBool()&&n.readBool())for(var O=0;O<4;O++)for(var M=0;M<(3===O?2:6);M++)if(n.readBool()){var I=Math.min(64,1<<4+(O<<1));for(O>1&&n.readSEG(),C=0;C<I;C++)n.readSEG()}else n.readUEG();n.readBool(),n.readBool(),n.readBool()&&(n.readByte(),n.readUEG(),n.readUEG(),n.readBool());var P=n.readUEG(),U=0;for(C=0;C<P;C++){var N=!1;if(0!==C&&(N=n.readBool()),N){C===P&&n.readUEG(),n.readBool(),n.readUEG();for(var V=0,j=0;j<=U;j++){var z=n.readBool(),F=!1;z||(F=n.readBool()),(z||F)&&V++}U=V}else{var G=n.readUEG(),H=n.readUEG();for(U=G+H,j=0;j<G;j++)n.readUEG(),n.readBool();for(j=0;j<H;j++)n.readUEG(),n.readBool()}}if(n.readBool()){var q=n.readUEG();for(C=0;C<q;C++){for(j=0;j<B+4;j++)n.readBits(1);n.readBits(1)}}var W=0,K=1,Y=1,$=!1,X=1,Z=1;if(n.readBool(),n.readBool(),n.readBool()){if(n.readBool()){var J=n.readByte();J>0&&J<=16?(K=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][J-1],Y=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][J-1]):255===J&&(K=n.readBits(16),Y=n.readBits(16))}if(n.readBool()&&n.readBool(),n.readBool()&&(n.readBits(3),n.readBool(),n.readBool()&&(n.readByte(),n.readByte(),n.readByte())),n.readBool()&&(n.readUEG(),n.readUEG()),n.readBool(),n.readBool(),n.readBool(),n.readBool()&&(n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG()),n.readBool()&&(X=n.readBits(32),Z=n.readBits(32),n.readBool()&&n.readUEG(),n.readBool())){var Q=!1,ee=!1,te=!1;for(Q=n.readBool(),ee=n.readBool(),(Q||ee)&&((te=n.readBool())&&(n.readByte(),n.readBits(5),n.readBool(),n.readBits(5)),n.readBits(4),n.readBits(4),te&&n.readBits(4),n.readBits(5),n.readBits(5),n.readBits(5)),C=0;C<=l;C++){var ae=n.readBool();$=ae;var ne=!0,ie=1;ae||(ne=n.readBool());var re=!1;if(ne?n.readUEG():re=n.readBool(),re||(ie=n.readUEG()+1),Q){for(j=0;j<ie;j++)n.readUEG(),n.readUEG(),te&&(n.readUEG(),n.readUEG());n.readBool()}if(ee){for(j=0;j<ie;j++)n.readUEG(),n.readUEG(),te&&(n.readUEG(),n.readUEG());n.readBool()}}}n.readBool()&&(n.readBool(),n.readBool(),n.readBool(),W=n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG())}n.readBool();var oe="hvc1."+c+".1.L"+E+".B0",se=D-(i+r)*(1===R||2===R?2:1),le=x-(o+s)*(1===R?2:1),de=1;return 1!==K&&1!==Y&&(de=K/Y),n.destroy(),n=null,{codec_mimetype:oe,level_string:e.getLevelString(E),profile_idc:c,bit_depth:L+8,ref_frames:1,chroma_format:R,chroma_format_string:e.getChromaFormatString(R),general_level_idc:E,general_profile_space:d,general_tier_flag:u,general_profile_idc:c,general_profile_compatibility_flags_1:h,general_profile_compatibility_flags_2:p,general_profile_compatibility_flags_3:_,general_profile_compatibility_flags_4:m,general_constraint_indicator_flags_1:g,general_constraint_indicator_flags_2:v,general_constraint_indicator_flags_3:y,general_constraint_indicator_flags_4:b,general_constraint_indicator_flags_5:S,general_constraint_indicator_flags_6:A,min_spatial_segmentation_idc:W,constant_frame_rate:0,chroma_format_idc:R,bit_depth_luma_minus8:L,bit_depth_chroma_minus8:k,frame_rate:{fixed:$,fps:Z/X,fps_den:X,fps_num:Z},sar_ratio:{width:K,height:Y},codec_size:{width:se,height:le},present_size:{width:se*de,height:le}}},e.parsePPS=function(t){var a=e._ebsp2rbsp(t),n=new f(a);n.readByte(),n.readByte(),n.readUEG(),n.readUEG(),n.readBool(),n.readBool(),n.readBits(3),n.readBool(),n.readBool(),n.readUEG(),n.readUEG(),n.readSEG(),n.readBool(),n.readBool(),n.readBool()&&n.readUEG(),n.readSEG(),n.readSEG(),n.readBool(),n.readBool(),n.readBool(),n.readBool();var i=n.readBool(),r=n.readBool(),o=1;return r&&i?o=0:r?o=3:i&&(o=2),{parallelismType:o}},e.getChromaFormatString=function(e){switch(e){case 0:return"4:0:0";case 1:return"4:2:0";case 2:return"4:2:2";case 3:return"4:4:4";default:return"Unknown"}},e.getProfileString=function(e){switch(e){case 1:return"Main";case 2:return"Main10";case 3:return"MainSP";case 4:return"Rext";case 9:return"SCC";default:return"Unknown"}},e.getLevelString=function(e){return(e/30).toFixed(1)},e}();function v(e){return e.byteOffset%2==0&&e.byteLength%2==0}function y(e){return e.byteOffset%4==0&&e.byteLength%4==0}function b(e,t){for(var a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}var S,A=function(e,t){return e.byteLength===t.byteLength&&(y(e)&&y(t)?function(e,t){return b(new Uint32Array(e.buffer,e.byteOffset,e.byteLength/4),new Uint32Array(t.buffer,t.byteOffset,t.byteLength/4))}(e,t):v(e)&&v(t)?function(e,t){return b(new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2))}(e,t):function(e,t){return b(e,t)}(e,t))},E=function(){function e(){}return e.parseOBUs=function(t){for(var a=null,n=0;n<t.byteLength;){t[n];var i=(120&t[n])>>3,r=0!=(4&t[n]),o=0!=(2&t[n]);t[n],n+=1,r&&(n+=1);var s=Number.POSITIVE_INFINITY;if(o){s=0;for(var l=0;s|=(127&t[n])<<7*l,0!=(128&t[n+=1]);l++);}1===i&&(a=e.parseSeuqneceHeader(t.subarray(n,n+s))),n+=s}return a},e.parseSeuqneceHeader=function(t){var a=new f(t),n=a.readBits(3),i=(a.readBool(),a.readBool()),r=!0,o=0,s=0,l=[];if(i)l.push({operating_point_idc:0,level:a.readBits(5),tier:0});else{if(a.readBool()){var d=a.readBits(32),u=a.readBits(32),c=a.readBool();if(c){for(var h=0;0===a.readBits(1);)h+=1;h>=32||a.readBits(h)}o=u,s=d,r=c,a.readBool()&&(a.readBits(5),a.readBits(32),a.readBits(5),a.readBits(5))}for(var p=a.readBool(),_=a.readBits(5),m=0;m<=_;m++){var g=a.readBits(12),v=a.readBits(5),y=v>7?a.readBits(1):0;l.push({operating_point_idc:g,level:v,tier:y}),p&&a.readBool()&&a.readBits(4)}}var b=l[0],S=b.level,A=b.tier,E=a.readBits(4),w=a.readBits(4),T=a.readBits(E+1)+1,C=a.readBits(w+1)+1,R=!1;i||(R=a.readBool()),R&&(a.readBits(4),a.readBits(4)),a.readBool(),a.readBool(),a.readBool();var D=!1;i||(a.readBool(),a.readBool(),a.readBool(),a.readBool(),(D=a.readBool())&&(a.readBool(),a.readBool()),(a.readBool()||a.readBits(1))&&(a.readBool()||a.readBits(1)),D&&a.readBits(3)),a.readBool(),a.readBool(),a.readBool();var x=a.readBool(),L=8;L=2===n&&x?a.readBool()?12:10:x?10:8;var k=!1;1!==n&&(k=a.readBool()),a.readBool()&&(a.readBits(8),a.readBits(8),a.readBits(8));var B=1,O=1;return k?(a.readBits(1),B=1,O=1):(a.readBits(1),0==n?(B=1,O=1):1==n?(B=0,O=0):12==L?a.readBits(1)&&a.readBits(1):(B=1,O=0),B&&O&&a.readBits(2),a.readBits(1)),a.readBool(),a.destroy(),a=null,{codec_mimetype:"av01."+n+"."+e.getLevelString(S,A)+"."+L.toString(10).padStart(2,"0"),level:S,tier:A,level_string:e.getLevelString(S,A),profile_idc:n,profile_string:""+n,bit_depth:L,ref_frames:1,chroma_format:e.getChromaFormat(k,B,O),chroma_format_string:e.getChromaFormatString(k,B,O),frame_rate:{fixed:r,fps:o/s,fps_den:s,fps_num:o},sar_ratio:{width:1,height:1},codec_size:{width:T,height:C},present_size:{width:1*T,height:C}}},e.getLevelString=function(e,t){return e.toString(10).padStart(2,"0")+(0===t?"M":"H")},e.getChromaFormat=function(e,t,a){return e?0:0===t&&0===a?3:1===t&&0===a?2:1===t&&1===a?1:Number.NaN},e.getChromaFormatString=function(e,t,a){return e?"4:0:0":0===t&&0===a?"4:4:4":1===t&&0===a?"4:2:2":1===t&&1===a?"4:2:0":"Unknown"},e}(),w=function(){function e(e,t){this.TAG="FLVDemuxer",this._config=t,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=e.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=e.hasAudioTrack,this._hasVideo=e.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new s.a,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}()}return e.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},e.probe=function(e){var t=new Uint8Array(e);if(t.byteLength<9)return{needMoreData:!0};var a={match:!1};if(70!==t[0]||76!==t[1]||86!==t[2]||1!==t[3])return a;var n,i,r=(4&t[4])>>>2!=0,o=0!=(1&t[4]),s=(n=t)[i=5]<<24|n[i+1]<<16|n[i+2]<<8|n[i+3];return s<9?a:{match:!0,consumed:s,dataOffset:s,hasAudioTrack:r,hasVideoTrack:o}},e.prototype.bindDataSource=function(e){return e.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(e.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(e){this._onTrackMetadata=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(e){this._onMediaInfo=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(e){this._onMetaDataArrived=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(e){this._onScriptDataArrived=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(e){this._onDataAvailable=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(e){this._timestampBase=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedDuration",{get:function(){return this._duration},set:function(e){this._durationOverrided=!0,this._duration=e,this._mediaInfo.duration=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedHasAudio",{set:function(e){this._hasAudioFlagOverrided=!0,this._hasAudio=e,this._mediaInfo.hasAudio=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedHasVideo",{set:function(e){this._hasVideoFlagOverrided=!0,this._hasVideo=e,this._mediaInfo.hasVideo=e},enumerable:!1,configurable:!0}),e.prototype.resetMediaInfo=function(){this._mediaInfo=new s.a},e.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched},e.prototype.parseChunks=function(t,a){if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new c.a("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var n=0,i=this._littleEndian;if(0===a){if(!(t.byteLength>13))return 0;n=e.probe(t).dataOffset}for(this._firstParse&&(this._firstParse=!1,a+n!==this._dataOffset&&r.a.w(this.TAG,"First time parsing but chunk byteStart invalid!"),0!==(o=new DataView(t,n)).getUint32(0,!i)&&r.a.w(this.TAG,"PrevTagSize0 !== 0 !!!"),n+=4);n<t.byteLength;){this._dispatch=!0;var o=new DataView(t,n);if(n+11+4>t.byteLength)break;var s=o.getUint8(0),l=16777215&o.getUint32(0,!i);if(n+11+l+4>t.byteLength)break;if(8===s||9===s||18===s){var d=o.getUint8(4),u=o.getUint8(5),h=o.getUint8(6)|u<<8|d<<16|o.getUint8(7)<<24;0!=(16777215&o.getUint32(7,!i))&&r.a.w(this.TAG,"Meet tag which has StreamID != 0!");var p=n+11;switch(s){case 8:this._parseAudioData(t,p,l,h);break;case 9:this._parseVideoData(t,p,l,h,a+n);break;case 18:this._parseScriptData(t,p,l)}var f=o.getUint32(11+l,!i);f!==11+l&&r.a.w(this.TAG,"Invalid PrevTagSize "+f),n+=11+l+4}else r.a.w(this.TAG,"Unsupported tag type "+s+", skipped"),n+=11+l+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),n},e.prototype._parseScriptData=function(e,t,a){var n=p.parseScriptData(e,t,a);if(n.hasOwnProperty("onMetaData")){if(null==n.onMetaData||"object"!=typeof n.onMetaData)return void r.a.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&r.a.w(this.TAG,"Found another onMetaData tag!"),this._metadata=n;var i=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},i)),"boolean"==typeof i.hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=i.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),"boolean"==typeof i.hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=i.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),"number"==typeof i.audiodatarate&&(this._mediaInfo.audioDataRate=i.audiodatarate),"number"==typeof i.videodatarate&&(this._mediaInfo.videoDataRate=i.videodatarate),"number"==typeof i.width&&(this._mediaInfo.width=i.width),"number"==typeof i.height&&(this._mediaInfo.height=i.height),"number"==typeof i.duration){if(!this._durationOverrided){var o=Math.floor(i.duration*this._timescale);this._duration=o,this._mediaInfo.duration=o}}else this._mediaInfo.duration=0;if("number"==typeof i.framerate){var s=Math.floor(1e3*i.framerate);if(s>0){var l=s/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=l,this._referenceFrameRate.fps_num=s,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=l}}if("object"==typeof i.keyframes){this._mediaInfo.hasKeyframesIndex=!0;var d=i.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(d),i.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=i,r.a.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(n).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},n))},e.prototype._parseKeyframesIndex=function(e){for(var t=[],a=[],n=1;n<e.times.length;n++){var i=this._timestampBase+Math.floor(1e3*e.times[n]);t.push(i),a.push(e.filepositions[n])}return{times:t,filepositions:a}},e.prototype._parseAudioData=function(e,t,a,n){if(a<=1)r.a.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");else if(!0!==this._hasAudioFlagOverrided||!1!==this._hasAudio){this._littleEndian;var i=new DataView(e,t,a).getUint8(0),o=i>>>4;if(2===o||10===o){var s=0,l=(12&i)>>>2;if(l>=0&&l<=4){s=this._flvSoundRateTable[l];var d=1&i,u=this._audioMetadata,c=this._audioTrack;if(u||(!1===this._hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(u=this._audioMetadata={}).type="audio",u.id=c.id,u.timescale=this._timescale,u.duration=this._duration,u.audioSampleRate=s,u.channelCount=0===d?1:2),10===o){var h=this._parseAACAudioData(e,t+1,a-1);if(null==h)return;if(0===h.packetType){if(u.config){if(A(h.data.config,u.config))return;r.a.w(this.TAG,"AudioSpecificConfig has been changed, re-generate initialization segment")}var p=h.data;u.audioSampleRate=p.samplingRate,u.channelCount=p.channelCount,u.codec=p.codec,u.originalCodec=p.originalCodec,u.config=p.config,u.refSampleDuration=1024/u.audioSampleRate*u.timescale,r.a.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",u),(g=this._mediaInfo).audioCodec=u.originalCodec,g.audioSampleRate=u.audioSampleRate,g.audioChannelCount=u.channelCount,g.hasVideo?null!=g.videoCodec&&(g.mimeType='video/x-flv; codecs="'+g.videoCodec+","+g.audioCodec+'"'):g.mimeType='video/x-flv; codecs="'+g.audioCodec+'"',g.isComplete()&&this._onMediaInfo(g)}else if(1===h.packetType){var f=this._timestampBase+n,_={unit:h.data,length:h.data.byteLength,dts:f,pts:f};c.samples.push(_),c.length+=h.data.length}else r.a.e(this.TAG,"Flv: Unsupported AAC data type "+h.packetType)}else if(2===o){if(!u.codec){var g;if(null==(p=this._parseMP3AudioData(e,t+1,a-1,!0)))return;u.audioSampleRate=p.samplingRate,u.channelCount=p.channelCount,u.codec=p.codec,u.originalCodec=p.originalCodec,u.refSampleDuration=1152/u.audioSampleRate*u.timescale,r.a.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",u),(g=this._mediaInfo).audioCodec=u.codec,g.audioSampleRate=u.audioSampleRate,g.audioChannelCount=u.channelCount,g.audioDataRate=p.bitRate,g.hasVideo?null!=g.videoCodec&&(g.mimeType='video/x-flv; codecs="'+g.videoCodec+","+g.audioCodec+'"'):g.mimeType='video/x-flv; codecs="'+g.audioCodec+'"',g.isComplete()&&this._onMediaInfo(g)}var v=this._parseMP3AudioData(e,t+1,a-1,!1);if(null==v)return;f=this._timestampBase+n;var y={unit:v,length:v.byteLength,dts:f,pts:f};c.samples.push(y),c.length+=v.length}}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+l)}else this._onError(m.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+o)}},e.prototype._parseAACAudioData=function(e,t,a){if(!(a<=1)){var n={},i=new Uint8Array(e,t,a);return n.packetType=i[0],0===i[0]?n.data=this._parseAACAudioSpecificConfig(e,t+1,a-1):n.data=i.subarray(1),n}r.a.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!")},e.prototype._parseAACAudioSpecificConfig=function(e,t,a){var n,i,r=new Uint8Array(e,t,a),o=null,s=0,l=null;if(s=n=r[0]>>>3,(i=(7&r[0])<<1|r[1]>>>7)<0||i>=this._mpegSamplingRates.length)this._onError(m.a.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");else{var d=this._mpegSamplingRates[i],u=(120&r[1])>>>3;if(!(u<0||u>=8)){5===s&&(l=(7&r[1])<<1|r[2]>>>7,r[2]);var c=self.navigator.userAgent.toLowerCase();return-1!==c.indexOf("firefox")?i>=6?(s=5,o=new Array(4),l=i-3):(s=2,o=new Array(2),l=i):-1!==c.indexOf("android")?(s=2,o=new Array(2),l=i):(s=5,l=i,o=new Array(4),i>=6?l=i-3:1===u&&(s=2,o=new Array(2),l=i)),o[0]=s<<3,o[0]|=(15&i)>>>1,o[1]=(15&i)<<7,o[1]|=(15&u)<<3,5===s&&(o[1]|=(15&l)>>>1,o[2]=(1&l)<<7,o[2]|=8,o[3]=0),{config:o,samplingRate:d,channelCount:u,codec:"mp4a.40."+s,originalCodec:"mp4a.40."+n}}this._onError(m.a.FORMAT_ERROR,"Flv: AAC invalid channel configuration")}},e.prototype._parseMP3AudioData=function(e,t,a,n){if(!(a<4)){this._littleEndian;var i=new Uint8Array(e,t,a),o=null;if(n){if(255!==i[0])return;var s=i[1]>>>3&3,l=(6&i[1])>>1,d=(240&i[2])>>>4,u=(12&i[2])>>>2,c=3!=(i[3]>>>6&3)?2:1,h=0,p=0;switch(s){case 0:h=this._mpegAudioV25SampleRateTable[u];break;case 2:h=this._mpegAudioV20SampleRateTable[u];break;case 3:h=this._mpegAudioV10SampleRateTable[u]}switch(l){case 1:d<this._mpegAudioL3BitRateTable.length&&(p=this._mpegAudioL3BitRateTable[d]);break;case 2:d<this._mpegAudioL2BitRateTable.length&&(p=this._mpegAudioL2BitRateTable[d]);break;case 3:d<this._mpegAudioL1BitRateTable.length&&(p=this._mpegAudioL1BitRateTable[d])}o={bitRate:p,samplingRate:h,channelCount:c,codec:"mp3",originalCodec:"mp3"}}else o=i;return o}r.a.w(this.TAG,"Flv: Invalid MP3 packet, header missing!")},e.prototype._parseVideoData=function(e,t,a,n,i){if(a<=1)r.a.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");else if(!0!==this._hasVideoFlagOverrided||!1!==this._hasVideo){var o=new Uint8Array(e,t,a)[0],s=(112&o)>>>4;if(0!=(128&o)){var l=15&o,d=String.fromCharCode.apply(String,new Uint8Array(e,t,a).slice(1,5));if("hvc1"===d)this._parseEnhancedHEVCVideoPacket(e,t+5,a-5,n,i,s,l);else{if("av01"!==d)return void this._onError(m.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+d);this._parseEnhancedAV1VideoPacket(e,t+5,a-5,n,i,s,l)}}else{var u=15&o;if(7===u)this._parseAVCVideoPacket(e,t+1,a-1,n,i,s);else{if(12!==u)return void this._onError(m.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+u);this._parseHEVCVideoPacket(e,t+1,a-1,n,i,s)}}}},e.prototype._parseAVCVideoPacket=function(e,t,a,n,i,o){if(a<4)r.a.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");else{var s=this._littleEndian,l=new DataView(e,t,a),d=l.getUint8(0),u=(16777215&l.getUint32(0,!s))<<8>>8;if(0===d)this._parseAVCDecoderConfigurationRecord(e,t+4,a-4);else if(1===d)this._parseAVCVideoData(e,t+4,a-4,n,i,o,u);else if(2!==d)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid video packet type "+d)}},e.prototype._parseHEVCVideoPacket=function(e,t,a,n,i,o){if(a<4)r.a.w(this.TAG,"Flv: Invalid HEVC packet, missing HEVCPacketType or/and CompositionTime");else{var s=this._littleEndian,l=new DataView(e,t,a),d=l.getUint8(0),u=(16777215&l.getUint32(0,!s))<<8>>8;if(0===d)this._parseHEVCDecoderConfigurationRecord(e,t+4,a-4);else if(1===d)this._parseHEVCVideoData(e,t+4,a-4,n,i,o,u);else if(2!==d)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid video packet type "+d)}},e.prototype._parseEnhancedHEVCVideoPacket=function(e,t,a,n,i,r,o){var s=this._littleEndian,l=new DataView(e,t,a);if(0===o)this._parseHEVCDecoderConfigurationRecord(e,t,a);else if(1===o){var d=(4294967040&l.getUint32(0,!s))>>8;this._parseHEVCVideoData(e,t+3,a-3,n,i,r,d)}else if(3===o)this._parseHEVCVideoData(e,t,a,n,i,r,0);else if(2!==o)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid video packet type "+o)},e.prototype._parseEnhancedAV1VideoPacket=function(e,t,a,n,i,r,o){if(this._littleEndian,0===o)this._parseAV1CodecConfigurationRecord(e,t,a);else if(1===o)this._parseAV1VideoData(e,t,a,n,i,r,0);else{if(5===o)return void this._onError(m.a.FORMAT_ERROR,"Flv: Not Supported MP2T AV1 video packet type "+o);if(2!==o)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid video packet type "+o)}},e.prototype._parseAVCDecoderConfigurationRecord=function(e,t,a){if(a<7)r.a.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");else{var n=this._videoMetadata,i=this._videoTrack,o=this._littleEndian,s=new DataView(e,t,a);if(n){if(void 0!==n.avcc){var l=new Uint8Array(e,t,a);if(A(l,n.avcc))return;r.a.w(this.TAG,"AVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(n=this._videoMetadata={}).type="video",n.id=i.id,n.timescale=this._timescale,n.duration=this._duration;var d=s.getUint8(0),u=s.getUint8(1);if(s.getUint8(2),s.getUint8(3),1===d&&0!==u)if(this._naluLengthSize=1+(3&s.getUint8(4)),3===this._naluLengthSize||4===this._naluLengthSize){var c=31&s.getUint8(5);if(0!==c){c>1&&r.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+c);for(var h=6,p=0;p<c;p++){var f=s.getUint16(h,!o);if(h+=2,0!==f){var g=new Uint8Array(e,t+h,f);h+=f;var v=_.parseSPS(g);if(0===p){n.codecWidth=v.codec_size.width,n.codecHeight=v.codec_size.height,n.presentWidth=v.present_size.width,n.presentHeight=v.present_size.height,n.profile=v.profile_string,n.level=v.level_string,n.bitDepth=v.bit_depth,n.chromaFormat=v.chroma_format,n.sarRatio=v.sar_ratio,n.frameRate=v.frame_rate,!1!==v.frame_rate.fixed&&0!==v.frame_rate.fps_num&&0!==v.frame_rate.fps_den||(n.frameRate=this._referenceFrameRate);var y=n.frameRate.fps_den,b=n.frameRate.fps_num;n.refSampleDuration=n.timescale*(y/b);for(var S=g.subarray(1,4),E="avc1.",w=0;w<3;w++){var T=S[w].toString(16);T.length<2&&(T="0"+T),E+=T}n.codec=E;var C=this._mediaInfo;C.width=n.codecWidth,C.height=n.codecHeight,C.fps=n.frameRate.fps,C.profile=n.profile,C.level=n.level,C.refFrames=v.ref_frames,C.chromaFormat=v.chroma_format_string,C.sarNum=n.sarRatio.width,C.sarDen=n.sarRatio.height,C.videoCodec=E,C.hasAudio?null!=C.audioCodec&&(C.mimeType='video/x-flv; codecs="'+C.videoCodec+","+C.audioCodec+'"'):C.mimeType='video/x-flv; codecs="'+C.videoCodec+'"',C.isComplete()&&this._onMediaInfo(C)}}}var R=s.getUint8(h);if(0!==R){for(R>1&&r.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+R),h++,p=0;p<R;p++)f=s.getUint16(h,!o),h+=2,0!==f&&(h+=f);n.avcc=new Uint8Array(a),n.avcc.set(new Uint8Array(e,t,a),0),r.a.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",n)}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS")}else this._onError(m.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord")}},e.prototype._parseHEVCDecoderConfigurationRecord=function(e,t,a){if(a<22)r.a.w(this.TAG,"Flv: Invalid HEVCDecoderConfigurationRecord, lack of data!");else{var n=this._videoMetadata,i=this._videoTrack,o=this._littleEndian,s=new DataView(e,t,a);if(n){if(void 0!==n.hvcc){var l=new Uint8Array(e,t,a);if(A(l,n.hvcc))return;r.a.w(this.TAG,"HEVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(n=this._videoMetadata={}).type="video",n.id=i.id,n.timescale=this._timescale,n.duration=this._duration;var d=s.getUint8(0),u=31&s.getUint8(1);if(1===d&&0!==u)if(this._naluLengthSize=1+(3&s.getUint8(21)),3===this._naluLengthSize||4===this._naluLengthSize){for(var c=s.getUint8(22),h=0,p=23;h<c;h++){var f=63&s.getUint8(p+0),_=s.getUint16(p+1,!o);p+=3;for(var v=0;v<_;v++){var y=s.getUint16(p+0,!o);if(0===v)if(33===f){p+=2;var b=new Uint8Array(e,t+p,y),S=g.parseSPS(b);n.codecWidth=S.codec_size.width,n.codecHeight=S.codec_size.height,n.presentWidth=S.present_size.width,n.presentHeight=S.present_size.height,n.profile=S.profile_string,n.level=S.level_string,n.bitDepth=S.bit_depth,n.chromaFormat=S.chroma_format,n.sarRatio=S.sar_ratio,n.frameRate=S.frame_rate,!1!==S.frame_rate.fixed&&0!==S.frame_rate.fps_num&&0!==S.frame_rate.fps_den||(n.frameRate=this._referenceFrameRate);var E=n.frameRate.fps_den,w=n.frameRate.fps_num;n.refSampleDuration=n.timescale*(E/w),n.codec=S.codec_mimetype;var T=this._mediaInfo;T.width=n.codecWidth,T.height=n.codecHeight,T.fps=n.frameRate.fps,T.profile=n.profile,T.level=n.level,T.refFrames=S.ref_frames,T.chromaFormat=S.chroma_format_string,T.sarNum=n.sarRatio.width,T.sarDen=n.sarRatio.height,T.videoCodec=S.codec_mimetype,T.hasAudio?null!=T.audioCodec&&(T.mimeType='video/x-flv; codecs="'+T.videoCodec+","+T.audioCodec+'"'):T.mimeType='video/x-flv; codecs="'+T.videoCodec+'"',T.isComplete()&&this._onMediaInfo(T),p+=y}else p+=2+y;else p+=2+y}}n.hvcc=new Uint8Array(a),n.hvcc.set(new Uint8Array(e,t,a),0),r.a.v(this.TAG,"Parsed HEVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",n)}else this._onError(m.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid HEVCDecoderConfigurationRecord")}},e.prototype._parseAV1CodecConfigurationRecord=function(e,t,a){if(a<4)r.a.w(this.TAG,"Flv: Invalid AV1CodecConfigurationRecord, lack of data!");else{var n=this._videoMetadata,i=this._videoTrack,o=(this._littleEndian,new DataView(e,t,a));n?void 0!==n.av1c&&r.a.w(this.TAG,"Found another AV1CodecConfigurationRecord!"):(!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(n=this._videoMetadata={}).type="video",n.id=i.id,n.timescale=this._timescale,n.duration=this._duration);var s=127&o.getUint8(0);if(o.getUint8(1),o.getUint8(1),o.getUint8(2),1===s){var l=E.parseOBUs(new Uint8Array(e,t+4,a-4));if(null!=l){n.codecWidth=l.codec_size.width,n.codecHeight=l.codec_size.height,n.presentWidth=l.present_size.width,n.presentHeight=l.present_size.height,n.profile=l.profile_string,n.level=l.level_string,n.bitDepth=l.bit_depth,n.chromaFormat=l.chroma_format,n.sarRatio=l.sar_ratio,n.frameRate=l.frame_rate,!1!==l.frame_rate.fixed&&0!==l.frame_rate.fps_num&&0!==l.frame_rate.fps_den||(n.frameRate=this._referenceFrameRate);var d=n.frameRate.fps_den,u=n.frameRate.fps_num;n.refSampleDuration=n.timescale*(d/u),n.codec=l.codec_mimetype;var c=this._mediaInfo;c.width=n.codecWidth,c.height=n.codecHeight,c.fps=n.frameRate.fps,c.profile=n.profile,c.level=n.level,c.refFrames=l.ref_frames,c.chromaFormat=l.chroma_format_string,c.sarNum=n.sarRatio.width,c.sarDen=n.sarRatio.height,c.videoCodec=l.codec_mimetype,c.hasAudio?null!=c.audioCodec&&(c.mimeType='video/x-flv; codecs="'+c.videoCodec+","+c.audioCodec+'"'):c.mimeType='video/x-flv; codecs="'+c.videoCodec+'"',c.isComplete()&&this._onMediaInfo(c),n.av1c=new Uint8Array(a),n.av1c.set(new Uint8Array(e,t,a),0),r.a.v(this.TAG,"Parsed AV1CodecConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",n)}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}},e.prototype._parseAVCVideoData=function(e,t,a,n,i,o,s){for(var l=this._littleEndian,d=new DataView(e,t,a),u=[],c=0,h=0,p=this._naluLengthSize,f=this._timestampBase+n,_=1===o;h<a;){if(h+4>=a){r.a.w(this.TAG,"Malformed Nalu near timestamp "+f+", offset = "+h+", dataSize = "+a);break}var m=d.getUint32(h,!l);if(3===p&&(m>>>=8),m>a-p)return void r.a.w(this.TAG,"Malformed Nalus near timestamp "+f+", NaluSize > DataSize!");var g=31&d.getUint8(h+p);5===g&&(_=!0);var v=new Uint8Array(e,t+h,p+m),y={type:g,data:v};u.push(y),c+=v.byteLength,h+=p+m}if(u.length){var b=this._videoTrack,S={units:u,length:c,isKeyframe:_,dts:f,cts:s,pts:f+s};_&&(S.fileposition=i),b.samples.push(S),b.length+=c}},e.prototype._parseHEVCVideoData=function(e,t,a,n,i,o,s){for(var l=this._littleEndian,d=new DataView(e,t,a),u=[],c=0,h=0,p=this._naluLengthSize,f=this._timestampBase+n,_=1===o;h<a;){if(h+4>=a){r.a.w(this.TAG,"Malformed Nalu near timestamp "+f+", offset = "+h+", dataSize = "+a);break}var m=d.getUint32(h,!l);if(3===p&&(m>>>=8),m>a-p)return void r.a.w(this.TAG,"Malformed Nalus near timestamp "+f+", NaluSize > DataSize!");var g=31&d.getUint8(h+p);19!==g&&20!==g||(_=!0);var v=new Uint8Array(e,t+h,p+m),y={type:g,data:v};u.push(y),c+=v.byteLength,h+=p+m}if(u.length){var b=this._videoTrack,S={units:u,length:c,isKeyframe:_,dts:f,cts:s,pts:f+s};_&&(S.fileposition=i),b.samples.push(S),b.length+=c}},e.prototype._parseAV1VideoData=function(e,t,a,n,i,r,o){this._littleEndian;var s,l=[],d=this._timestampBase+n,u=1===r;if(s=a,l.push({unitType:0,data:new Uint8Array(e,t+0,a)}),l.length){var c=this._videoTrack,h={units:l,length:s,isKeyframe:u,dts:d,cts:o,pts:d+o};u&&(h.fileposition=i),c.samples.push(h),c.length+=s}},e}(),T=function(){function e(){}return e.prototype.destroy=function(){this.onError=null,this.onMediaInfo=null,this.onMetaDataArrived=null,this.onTrackMetadata=null,this.onDataAvailable=null,this.onTimedID3Metadata=null,this.onSynchronousKLVMetadata=null,this.onAsynchronousKLVMetadata=null,this.onSMPTE2038Metadata=null,this.onSCTE35Metadata=null,this.onPESPrivateData=null,this.onPESPrivateDataDescriptor=null},e}(),C=function(){this.program_pmt_pid={}};!function(e){e[e.kMPEG1Audio=3]="kMPEG1Audio",e[e.kMPEG2Audio=4]="kMPEG2Audio",e[e.kPESPrivateData=6]="kPESPrivateData",e[e.kADTSAAC=15]="kADTSAAC",e[e.kLOASAAC=17]="kLOASAAC",e[e.kAC3=129]="kAC3",e[e.kEAC3=135]="kEAC3",e[e.kMetadata=21]="kMetadata",e[e.kSCTE35=134]="kSCTE35",e[e.kH264=27]="kH264",e[e.kH265=36]="kH265"}(S||(S={}));var R,D=function(){this.pid_stream_type={},this.common_pids={h264:void 0,h265:void 0,adts_aac:void 0,loas_aac:void 0,opus:void 0,ac3:void 0,eac3:void 0,mp3:void 0},this.pes_private_data_pids={},this.timed_id3_pids={},this.synchronous_klv_pids={},this.asynchronous_klv_pids={},this.scte_35_pids={},this.smpte2038_pids={}},x=function(){},L=function(){},k=function(){this.slices=[],this.total_length=0,this.expected_length=0,this.file_position=0};!function(e){e[e.kUnspecified=0]="kUnspecified",e[e.kSliceNonIDR=1]="kSliceNonIDR",e[e.kSliceDPA=2]="kSliceDPA",e[e.kSliceDPB=3]="kSliceDPB",e[e.kSliceDPC=4]="kSliceDPC",e[e.kSliceIDR=5]="kSliceIDR",e[e.kSliceSEI=6]="kSliceSEI",e[e.kSliceSPS=7]="kSliceSPS",e[e.kSlicePPS=8]="kSlicePPS",e[e.kSliceAUD=9]="kSliceAUD",e[e.kEndOfSequence=10]="kEndOfSequence",e[e.kEndOfStream=11]="kEndOfStream",e[e.kFiller=12]="kFiller",e[e.kSPSExt=13]="kSPSExt",e[e.kReserved0=14]="kReserved0"}(R||(R={}));var B,O,M=function(){},I=function(e){var t=e.data.byteLength;this.type=e.type,this.data=new Uint8Array(4+t),new DataView(this.data.buffer).setUint32(0,t),this.data.set(e.data,4)},P=function(){function e(e){this.TAG="H264AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=e,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not find H264 startcode until payload end!")}return e.prototype.findNextStartCodeOffset=function(e){for(var t=e,a=this.data_;;){if(t+3>=a.byteLength)return this.eof_flag_=!0,a.byteLength;var n=a[t+0]<<24|a[t+1]<<16|a[t+2]<<8|a[t+3],i=a[t+0]<<16|a[t+1]<<8|a[t+2];if(1===n||1===i)return t;t++}},e.prototype.readNextNaluPayload=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var a=this.current_startcode_offset_,n=31&e[a+=1==(e[a]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3])?4:3],i=(128&e[a])>>>7,r=this.findNextStartCodeOffset(a);if(this.current_startcode_offset_=r,!(n>=R.kReserved0)&&0===i){var o=e.subarray(a,r);(t=new M).type=n,t.data=o}}return t},e}(),U=function(){function e(e,t,a){var n=8+e.byteLength+1+2+t.byteLength,i=!1;66!==e[3]&&77!==e[3]&&88!==e[3]&&(i=!0,n+=4);var r=this.data=new Uint8Array(n);r[0]=1,r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=255,r[5]=225;var o=e.byteLength;r[6]=o>>>8,r[7]=255&o;var s=8;r.set(e,8),r[s+=o]=1;var l=t.byteLength;r[s+1]=l>>>8,r[s+2]=255&l,r.set(t,s+3),s+=3+l,i&&(r[s]=252|a.chroma_format_idc,r[s+1]=248|a.bit_depth_luma-8,r[s+2]=248|a.bit_depth_chroma-8,r[s+3]=0,s+=4)}return e.prototype.getData=function(){return this.data},e}();!function(e){e[e.kNull=0]="kNull",e[e.kAACMain=1]="kAACMain",e[e.kAAC_LC=2]="kAAC_LC",e[e.kAAC_SSR=3]="kAAC_SSR",e[e.kAAC_LTP=4]="kAAC_LTP",e[e.kAAC_SBR=5]="kAAC_SBR",e[e.kAAC_Scalable=6]="kAAC_Scalable",e[e.kLayer1=32]="kLayer1",e[e.kLayer2=33]="kLayer2",e[e.kLayer3=34]="kLayer3"}(B||(B={})),function(e){e[e.k96000Hz=0]="k96000Hz",e[e.k88200Hz=1]="k88200Hz",e[e.k64000Hz=2]="k64000Hz",e[e.k48000Hz=3]="k48000Hz",e[e.k44100Hz=4]="k44100Hz",e[e.k32000Hz=5]="k32000Hz",e[e.k24000Hz=6]="k24000Hz",e[e.k22050Hz=7]="k22050Hz",e[e.k16000Hz=8]="k16000Hz",e[e.k12000Hz=9]="k12000Hz",e[e.k11025Hz=10]="k11025Hz",e[e.k8000Hz=11]="k8000Hz",e[e.k7350Hz=12]="k7350Hz"}(O||(O={}));var N,V,j=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],z=(N=function(e,t){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}N(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),F=function(){},G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return z(t,e),t}(F),H=function(){function e(e){this.TAG="AACADTSParser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not found ADTS syncword until payload end")}return e.prototype.findNextSyncwordOffset=function(e){for(var t=e,a=this.data_;;){if(t+7>=a.byteLength)return this.eof_flag_=!0,a.byteLength;if(4095==(a[t+0]<<8|a[t+1])>>>4)return t;t++}},e.prototype.readNextAACFrame=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var a=this.current_syncword_offset_,n=(8&e[a+1])>>>3,i=(6&e[a+1])>>>1,r=1&e[a+1],o=(192&e[a+2])>>>6,s=(60&e[a+2])>>>2,l=(1&e[a+2])<<2|(192&e[a+3])>>>6,d=(3&e[a+3])<<11|e[a+4]<<3|(224&e[a+5])>>>5;if(e[a+6],a+d>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var u=1===r?7:9,c=d-u;a+=u;var h=this.findNextSyncwordOffset(a+c);if(this.current_syncword_offset_=h,(0===n||1===n)&&0===i){var p=e.subarray(a,a+c);(t=new F).audio_object_type=o+1,t.sampling_freq_index=s,t.sampling_frequency=j[s],t.channel_config=l,t.data=p}}return t},e.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},e.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},e}(),q=function(){function e(e){this.TAG="AACLOASParser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not found LOAS syncword until payload end")}return e.prototype.findNextSyncwordOffset=function(e){for(var t=e,a=this.data_;;){if(t+1>=a.byteLength)return this.eof_flag_=!0,a.byteLength;if(695==(a[t+0]<<3|a[t+1]>>>5))return t;t++}},e.prototype.getLATMValue=function(e){for(var t=e.readBits(2),a=0,n=0;n<=t;n++)a<<=8,a|=e.readByte();return a},e.prototype.readNextAACFrame=function(e){for(var t=this.data_,a=null;null==a&&!this.eof_flag_;){var n=this.current_syncword_offset_,i=(31&t[n+1])<<8|t[n+2];if(n+3+i>=this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var o=new f(t.subarray(n+3,n+3+i)),s=null;if(o.readBool()){if(null==e){r.a.w(this.TAG,"StreamMuxConfig Missing"),this.current_syncword_offset_=this.findNextSyncwordOffset(n+3+i),o.destroy();continue}s=e}else{var l=o.readBool();if(l&&o.readBool()){r.a.e(this.TAG,"audioMuxVersionA is Not Supported"),o.destroy();break}if(l&&this.getLATMValue(o),!o.readBool()){r.a.e(this.TAG,"allStreamsSameTimeFraming zero is Not Supported"),o.destroy();break}if(0!==o.readBits(6)){r.a.e(this.TAG,"more than 2 numSubFrames Not Supported"),o.destroy();break}if(0!==o.readBits(4)){r.a.e(this.TAG,"more than 2 numProgram Not Supported"),o.destroy();break}if(0!==o.readBits(3)){r.a.e(this.TAG,"more than 2 numLayer Not Supported"),o.destroy();break}var d=l?this.getLATMValue(o):0,u=o.readBits(5);d-=5;var c=o.readBits(4);d-=4;var h=o.readBits(4);d-=4,o.readBits(3),(d-=3)>0&&o.readBits(d);var p=o.readBits(3);if(0!==p){r.a.e(this.TAG,"frameLengthType = "+p+". Only frameLengthType = 0 Supported"),o.destroy();break}o.readByte();var _=o.readBool();if(_)if(l)this.getLATMValue(o);else for(;;){var m=o.readBool();if(o.readByte(),!m)break}o.readBool()&&o.readByte(),(s=new G).audio_object_type=u,s.sampling_freq_index=c,s.sampling_frequency=j[s.sampling_freq_index],s.channel_config=h,s.other_data_present=_}for(var g=0;;){var v=o.readByte();if(g+=v,255!==v)break}for(var y=new Uint8Array(g),b=0;b<g;b++)y[b]=o.readByte();(a=new G).audio_object_type=s.audio_object_type,a.sampling_freq_index=s.sampling_freq_index,a.sampling_frequency=j[s.sampling_freq_index],a.channel_config=s.channel_config,a.other_data_present=s.other_data_present,a.data=y,this.current_syncword_offset_=this.findNextSyncwordOffset(n+3+i)}return a},e.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},e.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},e}(),W=function(e){var t=null,a=e.audio_object_type,n=e.audio_object_type,i=e.sampling_freq_index,r=e.channel_config,o=0,s=navigator.userAgent.toLowerCase();-1!==s.indexOf("firefox")?i>=6?(n=5,t=new Array(4),o=i-3):(n=2,t=new Array(2),o=i):-1!==s.indexOf("android")?(n=2,t=new Array(2),o=i):(n=5,o=i,t=new Array(4),i>=6?o=i-3:1===r&&(n=2,t=new Array(2),o=i)),t[0]=n<<3,t[0]|=(15&i)>>>1,t[1]=(15&i)<<7,t[1]|=(15&r)<<3,5===n&&(t[1]|=(15&o)>>>1,t[2]=(1&o)<<7,t[2]|=8,t[3]=0),this.config=t,this.sampling_rate=j[i],this.channel_count=r,this.codec_mimetype="mp4a.40."+n,this.original_codec_mimetype="mp4a.40."+a},K=function(){},Y=function(){};!function(e){e[e.kSpliceNull=0]="kSpliceNull",e[e.kSpliceSchedule=4]="kSpliceSchedule",e[e.kSpliceInsert=5]="kSpliceInsert",e[e.kTimeSignal=6]="kTimeSignal",e[e.kBandwidthReservation=7]="kBandwidthReservation",e[e.kPrivateCommand=255]="kPrivateCommand"}(V||(V={}));var $,X=function(e){var t=e.readBool();return t?(e.readBits(6),{time_specified_flag:t,pts_time:4*e.readBits(31)+e.readBits(2)}):(e.readBits(7),{time_specified_flag:t})},Z=function(e){var t=e.readBool();return e.readBits(6),{auto_return:t,duration:4*e.readBits(31)+e.readBits(2)}},J=function(e,t){var a=t.readBits(8);return e?{component_tag:a}:{component_tag:a,splice_time:X(t)}},Q=function(e){return{component_tag:e.readBits(8),utc_splice_time:e.readBits(32)}},ee=function(e){var t=e.readBits(32),a=e.readBool();e.readBits(7);var n={splice_event_id:t,splice_event_cancel_indicator:a};if(a)return n;if(n.out_of_network_indicator=e.readBool(),n.program_splice_flag=e.readBool(),n.duration_flag=e.readBool(),e.readBits(5),n.program_splice_flag)n.utc_splice_time=e.readBits(32);else{n.component_count=e.readBits(8),n.components=[];for(var i=0;i<n.component_count;i++)n.components.push(Q(e))}return n.duration_flag&&(n.break_duration=Z(e)),n.unique_program_id=e.readBits(16),n.avail_num=e.readBits(8),n.avails_expected=e.readBits(8),n},te=function(e,t,a,n){return{descriptor_tag:e,descriptor_length:t,identifier:a,provider_avail_id:n.readBits(32)}},ae=function(e,t,a,n){var i=n.readBits(8),r=n.readBits(3);n.readBits(5);for(var o="",s=0;s<r;s++)o+=String.fromCharCode(n.readBits(8));return{descriptor_tag:e,descriptor_length:t,identifier:a,preroll:i,dtmf_count:r,DTMF_char:o}},ne=function(e){var t=e.readBits(8);return e.readBits(7),{component_tag:t,pts_offset:4*e.readBits(31)+e.readBits(2)}},ie=function(e,t,a,n){var i=n.readBits(32),r=n.readBool();n.readBits(7);var o={descriptor_tag:e,descriptor_length:t,identifier:a,segmentation_event_id:i,segmentation_event_cancel_indicator:r};if(r)return o;if(o.program_segmentation_flag=n.readBool(),o.segmentation_duration_flag=n.readBool(),o.delivery_not_restricted_flag=n.readBool(),o.delivery_not_restricted_flag?n.readBits(5):(o.web_delivery_allowed_flag=n.readBool(),o.no_regional_blackout_flag=n.readBool(),o.archive_allowed_flag=n.readBool(),o.device_restrictions=n.readBits(2)),!o.program_segmentation_flag){o.component_count=n.readBits(8),o.components=[];for(var s=0;s<o.component_count;s++)o.components.push(ne(n))}o.segmentation_duration_flag&&(o.segmentation_duration=n.readBits(40)),o.segmentation_upid_type=n.readBits(8),o.segmentation_upid_length=n.readBits(8);var l=new Uint8Array(o.segmentation_upid_length);for(s=0;s<o.segmentation_upid_length;s++)l[s]=n.readBits(8);return o.segmentation_upid=l.buffer,o.segmentation_type_id=n.readBits(8),o.segment_num=n.readBits(8),o.segments_expected=n.readBits(8),52!==o.segmentation_type_id&&54!==o.segmentation_type_id&&56!==o.segmentation_type_id&&58!==o.segmentation_type_id||(o.sub_segment_num=n.readBits(8),o.sub_segments_expected=n.readBits(8)),o},re=function(e,t,a,n){return{descriptor_tag:e,descriptor_length:t,identifier:a,TAI_seconds:n.readBits(48),TAI_ns:n.readBits(32),UTC_offset:n.readBits(16)}},oe=function(e){return{component_tag:e.readBits(8),ISO_code:String.fromCharCode(e.readBits(8),e.readBits(8),e.readBits(8)),Bit_Stream_Mode:e.readBits(3),Num_Channels:e.readBits(4),Full_Srvc_Audio:e.readBool()}},se=function(e,t,a,n){for(var i=n.readBits(4),r=[],o=0;o<i;o++)r.push(oe(n));return{descriptor_tag:e,descriptor_length:t,identifier:a,audio_count:i,components:r}},le=function(e){var t=new f(e),a=t.readBits(8),n=t.readBool(),i=t.readBool();t.readBits(2);var r=t.readBits(12),o=t.readBits(8),s=t.readBool(),l=t.readBits(6),d=4*t.readBits(31)+t.readBits(2),u=t.readBits(8),c=t.readBits(12),h=t.readBits(12),p=t.readBits(8),_=null;p===V.kSpliceNull?_={}:p===V.kSpliceSchedule?_=function(e){for(var t=e.readBits(8),a=[],n=0;n<t;n++)a.push(ee(e));return{splice_count:t,events:a}}(t):p===V.kSpliceInsert?_=function(e){var t=e.readBits(32),a=e.readBool();e.readBits(7);var n={splice_event_id:t,splice_event_cancel_indicator:a};if(a)return n;if(n.out_of_network_indicator=e.readBool(),n.program_splice_flag=e.readBool(),n.duration_flag=e.readBool(),n.splice_immediate_flag=e.readBool(),e.readBits(4),n.program_splice_flag&&!n.splice_immediate_flag&&(n.splice_time=X(e)),!n.program_splice_flag){n.component_count=e.readBits(8),n.components=[];for(var i=0;i<n.component_count;i++)n.components.push(J(n.splice_immediate_flag,e))}return n.duration_flag&&(n.break_duration=Z(e)),n.unique_program_id=e.readBits(16),n.avail_num=e.readBits(8),n.avails_expected=e.readBits(8),n}(t):p===V.kTimeSignal?_=function(e){return{splice_time:X(e)}}(t):p===V.kBandwidthReservation?_={}:p===V.kPrivateCommand?_=function(e,t){for(var a=String.fromCharCode(t.readBits(8),t.readBits(8),t.readBits(8),t.readBits(8)),n=new Uint8Array(e-4),i=0;i<e-4;i++)n[i]=t.readBits(8);return{identifier:a,private_data:n.buffer}}(h,t):t.readBits(8*h);for(var m=[],g=t.readBits(16),v=0;v<g;){var y=t.readBits(8),b=t.readBits(8),S=String.fromCharCode(t.readBits(8),t.readBits(8),t.readBits(8),t.readBits(8));0===y?m.push(te(y,b,S,t)):1===y?m.push(ae(y,b,S,t)):2===y?m.push(ie(y,b,S,t)):3===y?m.push(re(y,b,S,t)):4===y?m.push(se(y,b,S,t)):t.readBits(8*(b-4)),v+=2+b}var A={table_id:a,section_syntax_indicator:n,private_indicator:i,section_length:r,protocol_version:o,encrypted_packet:s,encryption_algorithm:l,pts_adjustment:d,cw_index:u,tier:c,splice_command_length:h,splice_command_type:p,splice_command:_,descriptor_loop_length:g,splice_descriptors:m,E_CRC32:s?t.readBits(32):void 0,CRC32:t.readBits(32)};if(p===V.kSpliceInsert){var E=_;if(E.splice_event_cancel_indicator)return{splice_command_type:p,detail:A,data:e};if(E.program_splice_flag&&!E.splice_immediate_flag){var w=E.duration_flag?E.break_duration.auto_return:void 0,T=E.duration_flag?E.break_duration.duration/90:void 0;return E.splice_time.time_specified_flag?{splice_command_type:p,pts:(d+E.splice_time.pts_time)%Math.pow(2,33),auto_return:w,duraiton:T,detail:A,data:e}:{splice_command_type:p,auto_return:w,duraiton:T,detail:A,data:e}}return{splice_command_type:p,auto_return:w=E.duration_flag?E.break_duration.auto_return:void 0,duraiton:T=E.duration_flag?E.break_duration.duration/90:void 0,detail:A,data:e}}if(p===V.kTimeSignal){var C=_;return C.splice_time.time_specified_flag?{splice_command_type:p,pts:(d+C.splice_time.pts_time)%Math.pow(2,33),detail:A,data:e}:{splice_command_type:p,detail:A,data:e}}return{splice_command_type:p,detail:A,data:e}};!function(e){e[e.kSliceIDR_W_RADL=19]="kSliceIDR_W_RADL",e[e.kSliceIDR_N_LP=20]="kSliceIDR_N_LP",e[e.kSliceCRA_NUT=21]="kSliceCRA_NUT",e[e.kSliceVPS=32]="kSliceVPS",e[e.kSliceSPS=33]="kSliceSPS",e[e.kSlicePPS=34]="kSlicePPS",e[e.kSliceAUD=35]="kSliceAUD"}($||($={}));var de=function(){},ue=function(e){var t=e.data.byteLength;this.type=e.type,this.data=new Uint8Array(4+t),new DataView(this.data.buffer).setUint32(0,t),this.data.set(e.data,4)},ce=function(){function e(e){this.TAG="H265AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=e,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not find H265 startcode until payload end!")}return e.prototype.findNextStartCodeOffset=function(e){for(var t=e,a=this.data_;;){if(t+3>=a.byteLength)return this.eof_flag_=!0,a.byteLength;var n=a[t+0]<<24|a[t+1]<<16|a[t+2]<<8|a[t+3],i=a[t+0]<<16|a[t+1]<<8|a[t+2];if(1===n||1===i)return t;t++}},e.prototype.readNextNaluPayload=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var a=this.current_startcode_offset_,n=e[a+=1==(e[a]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3])?4:3]>>1&63,i=(128&e[a])>>>7,r=this.findNextStartCodeOffset(a);if(this.current_startcode_offset_=r,0===i){var o=e.subarray(a,r);(t=new de).type=n,t.data=o}}return t},e}(),he=function(){function e(e,t,a,n){var i=23+(5+e.byteLength)+(5+t.byteLength)+(5+a.byteLength),r=this.data=new Uint8Array(i);r[0]=1,r[1]=(3&n.general_profile_space)<<6|(n.general_tier_flag?1:0)<<5|31&n.general_profile_idc,r[2]=n.general_profile_compatibility_flags_1,r[3]=n.general_profile_compatibility_flags_2,r[4]=n.general_profile_compatibility_flags_3,r[5]=n.general_profile_compatibility_flags_4,r[6]=n.general_constraint_indicator_flags_1,r[7]=n.general_constraint_indicator_flags_2,r[8]=n.general_constraint_indicator_flags_3,r[9]=n.general_constraint_indicator_flags_4,r[10]=n.general_constraint_indicator_flags_5,r[11]=n.general_constraint_indicator_flags_6,r[12]=n.general_level_idc,r[13]=240|(3840&n.min_spatial_segmentation_idc)>>8,r[14]=255&n.min_spatial_segmentation_idc,r[15]=252|3&n.parallelismType,r[16]=252|3&n.chroma_format_idc,r[17]=248|7&n.bit_depth_luma_minus8,r[18]=248|7&n.bit_depth_chroma_minus8,r[19]=0,r[20]=0,r[21]=(3&n.constant_frame_rate)<<6|(7&n.num_temporal_layers)<<3|(n.temporal_id_nested?1:0)<<2|3,r[22]=3,r[23]=128|$.kSliceVPS,r[24]=0,r[25]=1,r[26]=(65280&e.byteLength)>>8,r[27]=(255&e.byteLength)>>0,r.set(e,28),r[23+(5+e.byteLength)+0]=128|$.kSliceSPS,r[23+(5+e.byteLength)+1]=0,r[23+(5+e.byteLength)+2]=1,r[23+(5+e.byteLength)+3]=(65280&t.byteLength)>>8,r[23+(5+e.byteLength)+4]=(255&t.byteLength)>>0,r.set(t,23+(5+e.byteLength)+5),r[23+(5+e.byteLength+5+t.byteLength)+0]=128|$.kSlicePPS,r[23+(5+e.byteLength+5+t.byteLength)+1]=0,r[23+(5+e.byteLength+5+t.byteLength)+2]=1,r[23+(5+e.byteLength+5+t.byteLength)+3]=(65280&a.byteLength)>>8,r[23+(5+e.byteLength+5+t.byteLength)+4]=(255&a.byteLength)>>0,r.set(a,23+(5+e.byteLength+5+t.byteLength)+5)}return e.prototype.getData=function(){return this.data},e}(),pe=function(){},fe=function(){},_e=function(){},me=[[64,64,80,80,96,96,112,112,128,128,160,160,192,192,224,224,256,256,320,320,384,384,448,448,512,512,640,640,768,768,896,896,1024,1024,1152,1152,1280,1280],[69,70,87,88,104,105,121,122,139,140,174,175,208,209,243,244,278,279,348,349,417,418,487,488,557,558,696,697,835,836,975,976,1114,1115,1253,1254,1393,1394],[96,96,120,120,144,144,168,168,192,192,240,240,288,288,336,336,384,384,480,480,576,576,672,672,768,768,960,960,1152,1152,1344,1344,1536,1536,1728,1728,1920,1920]],ge=function(){function e(e){this.TAG="AC3Parser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return e.prototype.findNextSyncwordOffset=function(e){for(var t=e,a=this.data_;;){if(t+7>=a.byteLength)return this.eof_flag_=!0,a.byteLength;if(2935==(a[t+0]<<8|a[t+1]<<0))return t;t++}},e.prototype.readNextAC3Frame=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var a=this.current_syncword_offset_,n=e[a+4]>>6,i=[48e3,44200,33e3][n],r=63&e[a+4],o=2*me[n][r];if(a+o>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var s=this.findNextSyncwordOffset(a+o);this.current_syncword_offset_=s;var l=e[a+5]>>3,d=7&e[a+5],u=e[a+6]>>5,c=0;0!=(1&u)&&1!==u&&(c+=2),0!=(4&u)&&(c+=2),2===u&&(c+=2);var h=(e[a+6]<<8|e[a+7]<<0)>>12-c&1,p=[2,1,2,3,3,4,4,5][u]+h;(t=new _e).sampling_frequency=i,t.channel_count=p,t.channel_mode=u,t.bit_stream_identification=l,t.low_frequency_effects_channel_on=h,t.bit_stream_mode=d,t.frame_size_code=r,t.data=e.subarray(a,a+o)}return t},e.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},e.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},e}(),ve=function(e){var t;t=[e.sampling_rate_code<<6|e.bit_stream_identification<<1|e.bit_stream_mode>>2,(3&e.bit_stream_mode)<<6|e.channel_mode<<3|e.low_frequency_effects_channel_on<<2|e.frame_size_code>>4,e.frame_size_code<<4&224],this.config=t,this.sampling_rate=e.sampling_frequency,this.bit_stream_identification=e.bit_stream_identification,this.bit_stream_mode=e.bit_stream_mode,this.low_frequency_effects_channel_on=e.low_frequency_effects_channel_on,this.channel_count=e.channel_count,this.channel_mode=e.channel_mode,this.codec_mimetype="ac-3",this.original_codec_mimetype="ac-3"},ye=function(){},be=function(){function e(e){this.TAG="EAC3Parser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return e.prototype.findNextSyncwordOffset=function(e){for(var t=e,a=this.data_;;){if(t+7>=a.byteLength)return this.eof_flag_=!0,a.byteLength;if(2935==(a[t+0]<<8|a[t+1]<<0))return t;t++}},e.prototype.readNextEAC3Frame=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var a=this.current_syncword_offset_,n=new f(e.subarray(a+2)),i=(n.readBits(2),n.readBits(3),n.readBits(11)+1<<1),r=n.readBits(2),o=null,s=null;3===r?(o=[24e3,22060,16e3][r=n.readBits(2)],s=3):(o=[48e3,44100,32e3][r],s=n.readBits(2));var l=n.readBits(3),d=n.readBits(1),u=n.readBits(5);if(a+i>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var c=this.findNextSyncwordOffset(a+i);this.current_syncword_offset_=c;var h=[2,1,2,3,3,4,4,5][l]+d;n.destroy(),(t=new ye).sampling_frequency=o,t.channel_count=h,t.channel_mode=l,t.bit_stream_identification=u,t.low_frequency_effects_channel_on=d,t.frame_size=i,t.num_blks=[1,2,3,6][s],t.data=e.subarray(a,a+i)}return t},e.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},e.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},e}(),Se=function(e){var t,a=Math.floor(e.frame_size*e.sampling_frequency/(16*e.num_blks));t=[255&a,248&a,e.sampling_rate_code<<6|e.bit_stream_identification<<1|0,0|e.channel_mode<<1|e.low_frequency_effects_channel_on<<0,0],this.config=t,this.sampling_rate=e.sampling_frequency,this.bit_stream_identification=e.bit_stream_identification,this.num_blks=e.num_blks,this.low_frequency_effects_channel_on=e.low_frequency_effects_channel_on,this.channel_count=e.channel_count,this.channel_mode=e.channel_mode,this.codec_mimetype="ec-3",this.original_codec_mimetype="ec-3"},Ae=function(){},Ee=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),we=function(){return(we=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Te=function(e){function t(t,a){var n=e.call(this)||this;return n.TAG="TSDemuxer",n.first_parse_=!0,n.media_info_=new s.a,n.timescale_=90,n.duration_=0,n.current_pmt_pid_=-1,n.program_pmt_map_={},n.pes_slice_queues_={},n.section_slice_queues_={},n.video_metadata_={vps:void 0,sps:void 0,pps:void 0,details:void 0},n.audio_metadata_={codec:void 0,audio_object_type:void 0,sampling_freq_index:void 0,sampling_frequency:void 0,channel_config:void 0},n.aac_last_sample_pts_=void 0,n.aac_last_incomplete_data_=null,n.has_video_=!1,n.has_audio_=!1,n.video_init_segment_dispatched_=!1,n.audio_init_segment_dispatched_=!1,n.video_metadata_changed_=!1,n.audio_metadata_changed_=!1,n.loas_previous_frame=null,n.video_track_={type:"video",id:1,sequenceNumber:0,samples:[],length:0},n.audio_track_={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},n.ts_packet_size_=t.ts_packet_size,n.sync_offset_=t.sync_offset,n.config_=a,n}return Ee(t,e),t.prototype.destroy=function(){this.media_info_=null,this.pes_slice_queues_=null,this.section_slice_queues_=null,this.video_metadata_=null,this.audio_metadata_=null,this.aac_last_incomplete_data_=null,this.video_track_=null,this.audio_track_=null,e.prototype.destroy.call(this)},t.probe=function(e){var t=new Uint8Array(e),a=-1,n=188;if(t.byteLength<=3*n)return{needMoreData:!0};for(;-1===a;){for(var i=Math.min(1e3,t.byteLength-3*n),o=0;o<i;){if(71===t[o]&&71===t[o+n]&&71===t[o+2*n]){a=o;break}o++}if(-1===a)if(188===n)n=192;else{if(192!==n)break;n=204}}return-1===a?{match:!1}:(192===n&&a>=4?(r.a.v("TSDemuxer","ts_packet_size = 192, m2ts mode"),a-=4):204===n&&r.a.v("TSDemuxer","ts_packet_size = 204, RS encoded MPEG2-TS stream"),{match:!0,consumed:0,ts_packet_size:n,sync_offset:a})},t.prototype.bindDataSource=function(e){return e.onDataArrival=this.parseChunks.bind(this),this},t.prototype.resetMediaInfo=function(){this.media_info_=new s.a},t.prototype.parseChunks=function(e,t){if(!(this.onError&&this.onMediaInfo&&this.onTrackMetadata&&this.onDataAvailable))throw new c.a("onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var a=0;for(this.first_parse_&&(this.first_parse_=!1,a=this.sync_offset_);a+this.ts_packet_size_<=e.byteLength;){var n=t+a;192===this.ts_packet_size_&&(a+=4);var i=new Uint8Array(e,a,188),o=i[0];if(71!==o){r.a.e(this.TAG,"sync_byte = "+o+", not 0x47");break}var s=(64&i[1])>>>6,l=(i[1],(31&i[1])<<8|i[2]),d=(48&i[3])>>>4,u=15&i[3],h={},p=4;if(2==d||3==d){var f=i[4];if(5+f===188){a+=188,204===this.ts_packet_size_&&(a+=16);continue}f>0&&(h=this.parseAdaptationField(e,a+4,1+f)),p=5+f}if(1==d||3==d)if(0===l||l===this.current_pmt_pid_||null!=this.pmt_&&this.pmt_.pid_stream_type[l]===S.kSCTE35){var _=188-p;this.handleSectionSlice(e,a+p,_,{pid:l,file_position:n,payload_unit_start_indicator:s,continuity_conunter:u,random_access_indicator:h.random_access_indicator})}else if(null!=this.pmt_&&null!=this.pmt_.pid_stream_type[l]){_=188-p;var m=this.pmt_.pid_stream_type[l];l!==this.pmt_.common_pids.h264&&l!==this.pmt_.common_pids.h265&&l!==this.pmt_.common_pids.adts_aac&&l!==this.pmt_.common_pids.loas_aac&&l!==this.pmt_.common_pids.ac3&&l!==this.pmt_.common_pids.eac3&&l!==this.pmt_.common_pids.opus&&l!==this.pmt_.common_pids.mp3&&!0!==this.pmt_.pes_private_data_pids[l]&&!0!==this.pmt_.timed_id3_pids[l]&&!0!==this.pmt_.synchronous_klv_pids[l]&&!0!==this.pmt_.asynchronous_klv_pids[l]||this.handlePESSlice(e,a+p,_,{pid:l,stream_type:m,file_position:n,payload_unit_start_indicator:s,continuity_conunter:u,random_access_indicator:h.random_access_indicator})}a+=188,204===this.ts_packet_size_&&(a+=16)}return this.dispatchAudioVideoMediaSegment(),a},t.prototype.parseAdaptationField=function(e,t,a){var n=new Uint8Array(e,t,a),i=n[0];return i>0?i>183?(r.a.w(this.TAG,"Illegal adaptation_field_length: "+i),{}):{discontinuity_indicator:(128&n[1])>>>7,random_access_indicator:(64&n[1])>>>6,elementary_stream_priority_indicator:(32&n[1])>>>5}:{}},t.prototype.handleSectionSlice=function(e,t,a,n){var i=new Uint8Array(e,t,a),r=this.section_slice_queues_[n.pid];if(n.payload_unit_start_indicator){var o=i[0];if(null!=r&&0!==r.total_length){var s=new Uint8Array(e,t+1,Math.min(a,o));r.slices.push(s),r.total_length+=s.byteLength,r.total_length===r.expected_length?this.emitSectionSlices(r,n):this.clearSlices(r,n)}for(var l=1+o;l<i.byteLength&&255!==i[l+0];){var d=(15&i[l+1])<<8|i[l+2];this.section_slice_queues_[n.pid]=new k,(r=this.section_slice_queues_[n.pid]).expected_length=d+3,r.file_position=n.file_position,r.random_access_indicator=n.random_access_indicator,s=new Uint8Array(e,t+l,Math.min(a-l,r.expected_length-r.total_length)),r.slices.push(s),r.total_length+=s.byteLength,r.total_length===r.expected_length?this.emitSectionSlices(r,n):r.total_length>=r.expected_length&&this.clearSlices(r,n),l+=s.byteLength}}else null!=r&&0!==r.total_length&&(s=new Uint8Array(e,t,Math.min(a,r.expected_length-r.total_length)),r.slices.push(s),r.total_length+=s.byteLength,r.total_length===r.expected_length?this.emitSectionSlices(r,n):r.total_length>=r.expected_length&&this.clearSlices(r,n))},t.prototype.handlePESSlice=function(e,t,a,n){var i=new Uint8Array(e,t,a),o=i[0]<<16|i[1]<<8|i[2],s=(i[3],i[4]<<8|i[5]);if(n.payload_unit_start_indicator){if(1!==o)return void r.a.e(this.TAG,"handlePESSlice: packet_start_code_prefix should be 1 but with value "+o);var l=this.pes_slice_queues_[n.pid];l&&(0===l.expected_length||l.expected_length===l.total_length?this.emitPESSlices(l,n):this.clearSlices(l,n)),this.pes_slice_queues_[n.pid]=new k,this.pes_slice_queues_[n.pid].file_position=n.file_position,this.pes_slice_queues_[n.pid].random_access_indicator=n.random_access_indicator}if(null!=this.pes_slice_queues_[n.pid]){var d=this.pes_slice_queues_[n.pid];d.slices.push(i),n.payload_unit_start_indicator&&(d.expected_length=0===s?0:s+6),d.total_length+=i.byteLength,d.expected_length>0&&d.expected_length===d.total_length?this.emitPESSlices(d,n):d.expected_length>0&&d.expected_length<d.total_length&&this.clearSlices(d,n)}},t.prototype.emitSectionSlices=function(e,t){for(var a=new Uint8Array(e.total_length),n=0,i=0;n<e.slices.length;n++){var r=e.slices[n];a.set(r,i),i+=r.byteLength}e.slices=[],e.expected_length=-1,e.total_length=0;var o=new L;o.pid=t.pid,o.data=a,o.file_position=e.file_position,o.random_access_indicator=e.random_access_indicator,this.parseSection(o)},t.prototype.emitPESSlices=function(e,t){for(var a=new Uint8Array(e.total_length),n=0,i=0;n<e.slices.length;n++){var r=e.slices[n];a.set(r,i),i+=r.byteLength}e.slices=[],e.expected_length=-1,e.total_length=0;var o=new x;o.pid=t.pid,o.data=a,o.stream_type=t.stream_type,o.file_position=e.file_position,o.random_access_indicator=e.random_access_indicator,this.parsePES(o)},t.prototype.clearSlices=function(e,t){e.slices=[],e.expected_length=-1,e.total_length=0},t.prototype.parseSection=function(e){var t=e.data,a=e.pid;0===a?this.parsePAT(t):a===this.current_pmt_pid_?this.parsePMT(t):null!=this.pmt_&&this.pmt_.scte_35_pids[a]&&this.parseSCTE35(t)},t.prototype.parsePES=function(e){var t=e.data,a=t[0]<<16|t[1]<<8|t[2],n=t[3],i=t[4]<<8|t[5];if(1===a)if(188!==n&&190!==n&&191!==n&&240!==n&&241!==n&&255!==n&&242!==n&&248!==n){t[6];var o=(192&t[7])>>>6,s=t[8],l=void 0,d=void 0;2!==o&&3!==o||(l=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,d=3===o?536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2:l);var u=9+s,c=void 0;if(0!==i){if(i<3+s)return void r.a.v(this.TAG,"Malformed PES: PES_packet_length < 3 + PES_header_data_length");c=i-3-s}else c=t.byteLength-u;var h=t.subarray(u,u+c);switch(e.stream_type){case S.kMPEG1Audio:case S.kMPEG2Audio:this.parseMP3Payload(h,l);break;case S.kPESPrivateData:this.pmt_.common_pids.opus===e.pid?this.parseOpusPayload(h,l):this.pmt_.common_pids.ac3===e.pid?this.parseAC3Payload(h,l):this.pmt_.common_pids.eac3===e.pid?this.parseEAC3Payload(h,l):this.pmt_.asynchronous_klv_pids[e.pid]?this.parseAsynchronousKLVMetadataPayload(h,e.pid,n):this.pmt_.smpte2038_pids[e.pid]?this.parseSMPTE2038MetadataPayload(h,l,d,e.pid,n):this.parsePESPrivateDataPayload(h,l,d,e.pid,n);break;case S.kADTSAAC:this.parseADTSAACPayload(h,l);break;case S.kLOASAAC:this.parseLOASAACPayload(h,l);break;case S.kAC3:this.parseAC3Payload(h,l);break;case S.kEAC3:this.parseEAC3Payload(h,l);break;case S.kMetadata:this.pmt_.timed_id3_pids[e.pid]?this.parseTimedID3MetadataPayload(h,l,d,e.pid,n):this.pmt_.synchronous_klv_pids[e.pid]&&this.parseSynchronousKLVMetadataPayload(h,l,d,e.pid,n);break;case S.kH264:this.parseH264Payload(h,l,d,e.file_position,e.random_access_indicator);break;case S.kH265:this.parseH265Payload(h,l,d,e.file_position,e.random_access_indicator)}}else 188!==n&&191!==n&&240!==n&&241!==n&&255!==n&&242!==n&&248!==n||e.stream_type!==S.kPESPrivateData||(u=6,c=void 0,c=0!==i?i:t.byteLength-u,h=t.subarray(u,u+c),this.parsePESPrivateDataPayload(h,void 0,void 0,e.pid,n));else r.a.e(this.TAG,"parsePES: packet_start_code_prefix should be 1 but with value "+a)},t.prototype.parsePAT=function(e){var t=e[0];if(0===t){var a=(15&e[1])<<8|e[2],n=(e[3],e[4],(62&e[5])>>>1),i=1&e[5],o=e[6],s=(e[7],null);if(1===i&&0===o)(s=new C).version_number=n;else if(null==(s=this.pat_))return;for(var l=a-5-4,d=-1,u=-1,c=8;c<8+l;c+=4){var h=e[c]<<8|e[c+1],p=(31&e[c+2])<<8|e[c+3];0===h?s.network_pid=p:(s.program_pmt_pid[h]=p,-1===d&&(d=h),-1===u&&(u=p))}1===i&&0===o&&(null==this.pat_&&r.a.v(this.TAG,"Parsed first PAT: "+JSON.stringify(s)),this.pat_=s,this.current_program_=d,this.current_pmt_pid_=u)}else r.a.e(this.TAG,"parsePAT: table_id "+t+" is not corresponded to PAT!")},t.prototype.parsePMT=function(e){var t=e[0];if(2===t){var a=(15&e[1])<<8|e[2],n=e[3]<<8|e[4],i=(62&e[5])>>>1,o=1&e[5],s=e[6],l=(e[7],null);if(1===o&&0===s)(l=new D).program_number=n,l.version_number=i,this.program_pmt_map_[n]=l;else if(null==(l=this.program_pmt_map_[n]))return;e[8],e[9];for(var d=(15&e[10])<<8|e[11],u=12+d,c=a-9-d-4,h=u;h<u+c;){var p=e[h],f=(31&e[h+1])<<8|e[h+2],_=(15&e[h+3])<<8|e[h+4];l.pid_stream_type[f]=p;var m=l.common_pids.h264||l.common_pids.h265,g=l.common_pids.adts_aac||l.common_pids.loas_aac||l.common_pids.ac3||l.common_pids.eac3||l.common_pids.opus||l.common_pids.mp3;if(p!==S.kH264||m)if(p!==S.kH265||m)if(p!==S.kADTSAAC||g)if(p!==S.kLOASAAC||g)if(p!==S.kAC3||g)if(p!==S.kEAC3||g)if(p!==S.kMPEG1Audio&&p!==S.kMPEG2Audio||g)if(p===S.kPESPrivateData){if(l.pes_private_data_pids[f]=!0,_>0){for(var v=h+5;v<h+5+_;){var y=e[v+0],b=e[v+1];if(5===y){var A=String.fromCharCode.apply(String,Array.from(e.subarray(v+2,v+2+b)));"VANC"===A?l.smpte2038_pids[f]=!0:"Opus"===A?l.common_pids.opus=f:"KLVA"===A&&(l.asynchronous_klv_pids[f]=!0)}else if(127===y&&f===l.common_pids.opus){var E=null;if(128===e[v+2]&&(E=e[v+3]),null==E){r.a.e(this.TAG,"Not Supported Opus channel count.");continue}var w={codec:"opus",channel_count:0==(15&E)?2:15&E,channel_config_code:E,sample_rate:48e3},T={codec:"opus",meta:w};0==this.audio_init_segment_dispatched_?(this.audio_metadata_=w,this.dispatchAudioInitSegment(T)):this.detectAudioMetadataChange(T)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(T))}v+=2+b}var C=e.subarray(h+5,h+5+_);this.dispatchPESPrivateDataDescriptor(f,p,C)}}else if(p===S.kMetadata){if(_>0)for(v=h+5;v<h+5+_;){y=e[v+0];var R=e[v+1];if(38===y){var x=e[v+2]<<8|e[v+3]<<0,L=null;65535===x&&(L=String.fromCharCode.apply(String,Array.from(e.subarray(v+4,v+4+4))));var k=null;if(255===e[v+4+(65535===x?4:0)]){var B=4+(65535===x?4:0)+1;k=String.fromCharCode.apply(String,Array.from(e.subarray(v+B,v+B+4)))}"ID3 "===L&&"ID3 "===k?l.timed_id3_pids[f]=!0:"KLVA"===k&&(l.synchronous_klv_pids[f]=!0)}v+=2+R}}else p===S.kSCTE35&&(l.scte_35_pids[f]=!0);else l.common_pids.mp3=f;else l.common_pids.eac3=f;else l.common_pids.ac3=f;else l.common_pids.loas_aac=f;else l.common_pids.adts_aac=f;else l.common_pids.h265=f;else l.common_pids.h264=f;h+=5+_}n===this.current_program_&&(null==this.pmt_&&r.a.v(this.TAG,"Parsed first PMT: "+JSON.stringify(l)),this.pmt_=l,(l.common_pids.h264||l.common_pids.h265)&&(this.has_video_=!0),(l.common_pids.adts_aac||l.common_pids.loas_aac||l.common_pids.ac3||l.common_pids.opus||l.common_pids.mp3)&&(this.has_audio_=!0))}else r.a.e(this.TAG,"parsePMT: table_id "+t+" is not corresponded to PMT!")},t.prototype.parseSCTE35=function(e){var t=le(e);if(null!=t.pts){var a=Math.floor(t.pts/this.timescale_);t.pts=a}else t.nearest_pts=this.aac_last_sample_pts_;this.onSCTE35Metadata&&this.onSCTE35Metadata(t)},t.prototype.parseH264Payload=function(e,t,a,n,i){for(var o=new P(e),s=null,l=[],d=0,u=!1;null!=(s=o.readNextNaluPayload());){var c=new I(s);if(c.type===R.kSliceSPS){var h=_.parseSPS(s.data);this.video_init_segment_dispatched_?!0===this.detectVideoMetadataChange(c,h)&&(r.a.v(this.TAG,"H264: Critical h264 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:c,pps:void 0,details:h}):(this.video_metadata_.sps=c,this.video_metadata_.details=h)}else c.type===R.kSlicePPS?this.video_init_segment_dispatched_&&!this.video_metadata_changed_||(this.video_metadata_.pps=c,this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):(c.type===R.kSliceIDR||c.type===R.kSliceNonIDR&&1===i)&&(u=!0);this.video_init_segment_dispatched_&&(l.push(c),d+=c.data.byteLength)}var p=Math.floor(t/this.timescale_),f=Math.floor(a/this.timescale_);if(l.length){var m=this.video_track_,g={units:l,length:d,isKeyframe:u,dts:f,pts:p,cts:p-f,file_position:n};m.samples.push(g),m.length+=d}},t.prototype.parseH265Payload=function(e,t,a,n,i){for(var o=new ce(e),s=null,l=[],d=0,u=!1;null!=(s=o.readNextNaluPayload());){var c=new ue(s);if(c.type===$.kSliceVPS){if(!this.video_init_segment_dispatched_){var h=g.parseVPS(s.data);this.video_metadata_.vps=c,this.video_metadata_.details=we(we({},this.video_metadata_.details),h)}}else c.type===$.kSliceSPS?(h=g.parseSPS(s.data),this.video_init_segment_dispatched_?!0===this.detectVideoMetadataChange(c,h)&&(r.a.v(this.TAG,"H265: Critical h265 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:c,pps:void 0,details:h}):(this.video_metadata_.sps=c,this.video_metadata_.details=we(we({},this.video_metadata_.details),h))):c.type===$.kSlicePPS?this.video_init_segment_dispatched_&&!this.video_metadata_changed_||(h=g.parsePPS(s.data),this.video_metadata_.pps=c,this.video_metadata_.details=we(we({},this.video_metadata_.details),h),this.video_metadata_.vps&&this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):c.type!==$.kSliceIDR_W_RADL&&c.type!==$.kSliceIDR_N_LP&&c.type!==$.kSliceCRA_NUT||(u=!0);this.video_init_segment_dispatched_&&(l.push(c),d+=c.data.byteLength)}var p=Math.floor(t/this.timescale_),f=Math.floor(a/this.timescale_);if(l.length){var _=this.video_track_,m={units:l,length:d,isKeyframe:u,dts:f,pts:p,cts:p-f,file_position:n};_.samples.push(m),_.length+=d}},t.prototype.detectVideoMetadataChange=function(e,t){if(t.codec_mimetype!==this.video_metadata_.details.codec_mimetype)return r.a.v(this.TAG,"Video: Codec mimeType changed from "+this.video_metadata_.details.codec_mimetype+" to "+t.codec_mimetype),!0;if(t.codec_size.width!==this.video_metadata_.details.codec_size.width||t.codec_size.height!==this.video_metadata_.details.codec_size.height){var a=this.video_metadata_.details.codec_size,n=t.codec_size;return r.a.v(this.TAG,"Video: Coded Resolution changed from "+a.width+"x"+a.height+" to "+n.width+"x"+n.height),!0}return t.present_size.width!==this.video_metadata_.details.present_size.width&&(r.a.v(this.TAG,"Video: Present resolution width changed from "+this.video_metadata_.details.present_size.width+" to "+t.present_size.width),!0)},t.prototype.isInitSegmentDispatched=function(){return this.has_video_&&this.has_audio_?this.video_init_segment_dispatched_&&this.audio_init_segment_dispatched_:this.has_video_&&!this.has_audio_?this.video_init_segment_dispatched_:!(this.has_video_||!this.has_audio_)&&this.audio_init_segment_dispatched_},t.prototype.dispatchVideoInitSegment=function(){var e=this.video_metadata_.details,t={type:"video"};t.id=this.video_track_.id,t.timescale=1e3,t.duration=this.duration_,t.codecWidth=e.codec_size.width,t.codecHeight=e.codec_size.height,t.presentWidth=e.present_size.width,t.presentHeight=e.present_size.height,t.profile=e.profile_string,t.level=e.level_string,t.bitDepth=e.bit_depth,t.chromaFormat=e.chroma_format,t.sarRatio=e.sar_ratio,t.frameRate=e.frame_rate;var a=t.frameRate.fps_den,n=t.frameRate.fps_num;if(t.refSampleDuration=a/n*1e3,t.codec=e.codec_mimetype,this.video_metadata_.vps){var i=this.video_metadata_.vps.data.subarray(4),o=this.video_metadata_.sps.data.subarray(4),s=this.video_metadata_.pps.data.subarray(4),l=new he(i,o,s,e);t.hvcc=l.getData(),0==this.video_init_segment_dispatched_&&r.a.v(this.TAG,"Generated first HEVCDecoderConfigurationRecord for mimeType: "+t.codec)}else{o=this.video_metadata_.sps.data.subarray(4),s=this.video_metadata_.pps.data.subarray(4);var d=new U(o,s,e);t.avcc=d.getData(),0==this.video_init_segment_dispatched_&&r.a.v(this.TAG,"Generated first AVCDecoderConfigurationRecord for mimeType: "+t.codec)}this.onTrackMetadata("video",t),this.video_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var u=this.media_info_;u.hasVideo=!0,u.width=t.codecWidth,u.height=t.codecHeight,u.fps=t.frameRate.fps,u.profile=t.profile,u.level=t.level,u.refFrames=e.ref_frames,u.chromaFormat=e.chroma_format_string,u.sarNum=t.sarRatio.width,u.sarDen=t.sarRatio.height,u.videoCodec=t.codec,u.hasAudio&&u.audioCodec?u.mimeType='video/mp2t; codecs="'+u.videoCodec+","+u.audioCodec+'"':u.mimeType='video/mp2t; codecs="'+u.videoCodec+'"',u.isComplete()&&this.onMediaInfo(u)},t.prototype.dispatchVideoMediaSegment=function(){this.isInitSegmentDispatched()&&this.video_track_.length&&this.onDataAvailable(null,this.video_track_)},t.prototype.dispatchAudioMediaSegment=function(){this.isInitSegmentDispatched()&&this.audio_track_.length&&this.onDataAvailable(this.audio_track_,null)},t.prototype.dispatchAudioVideoMediaSegment=function(){this.isInitSegmentDispatched()&&(this.audio_track_.length||this.video_track_.length)&&this.onDataAvailable(this.audio_track_,this.video_track_)},t.prototype.parseADTSAACPayload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var a=new Uint8Array(e.byteLength+this.aac_last_incomplete_data_.byteLength);a.set(this.aac_last_incomplete_data_,0),a.set(e,this.aac_last_incomplete_data_.byteLength),e=a}var n,i;if(null!=t&&(i=t/this.timescale_),"aac"===this.audio_metadata_.codec){if(null==t&&null!=this.aac_last_sample_pts_)n=1024/this.audio_metadata_.sampling_frequency*1e3,i=this.aac_last_sample_pts_+n;else if(null==t)return void r.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.aac_last_sample_pts_){n=1024/this.audio_metadata_.sampling_frequency*1e3;var o=this.aac_last_sample_pts_+n;Math.abs(o-i)>1&&(r.a.w(this.TAG,"AAC: Detected pts overlapped, expected: "+o+"ms, PES pts: "+i+"ms"),i=o)}}for(var s,l=new H(e),d=null,u=i;null!=(d=l.readNextAACFrame());){n=1024/d.sampling_frequency*1e3;var c={codec:"aac",data:d};0==this.audio_init_segment_dispatched_?(this.audio_metadata_={codec:"aac",audio_object_type:d.audio_object_type,sampling_freq_index:d.sampling_freq_index,sampling_frequency:d.sampling_frequency,channel_config:d.channel_config},this.dispatchAudioInitSegment(c)):this.detectAudioMetadataChange(c)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(c)),s=u;var h=Math.floor(u),p={unit:d.data,length:d.data.byteLength,pts:h,dts:h};this.audio_track_.samples.push(p),this.audio_track_.length+=d.data.byteLength,u+=n}l.hasIncompleteData()&&(this.aac_last_incomplete_data_=l.getIncompleteData()),s&&(this.aac_last_sample_pts_=s)}},t.prototype.parseLOASAACPayload=function(e,t){var a;if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var n=new Uint8Array(e.byteLength+this.aac_last_incomplete_data_.byteLength);n.set(this.aac_last_incomplete_data_,0),n.set(e,this.aac_last_incomplete_data_.byteLength),e=n}var i,o;if(null!=t&&(o=t/this.timescale_),"aac"===this.audio_metadata_.codec){if(null==t&&null!=this.aac_last_sample_pts_)i=1024/this.audio_metadata_.sampling_frequency*1e3,o=this.aac_last_sample_pts_+i;else if(null==t)return void r.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.aac_last_sample_pts_){i=1024/this.audio_metadata_.sampling_frequency*1e3;var s=this.aac_last_sample_pts_+i;Math.abs(s-o)>1&&(r.a.w(this.TAG,"AAC: Detected pts overlapped, expected: "+s+"ms, PES pts: "+o+"ms"),o=s)}}for(var l,d=new q(e),u=null,c=o;null!=(u=d.readNextAACFrame(null!==(a=this.loas_previous_frame)&&void 0!==a?a:void 0));){this.loas_previous_frame=u,i=1024/u.sampling_frequency*1e3;var h={codec:"aac",data:u};0==this.audio_init_segment_dispatched_?(this.audio_metadata_={codec:"aac",audio_object_type:u.audio_object_type,sampling_freq_index:u.sampling_freq_index,sampling_frequency:u.sampling_frequency,channel_config:u.channel_config},this.dispatchAudioInitSegment(h)):this.detectAudioMetadataChange(h)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(h)),l=c;var p=Math.floor(c),f={unit:u.data,length:u.data.byteLength,pts:p,dts:p};this.audio_track_.samples.push(f),this.audio_track_.length+=u.data.byteLength,c+=i}d.hasIncompleteData()&&(this.aac_last_incomplete_data_=d.getIncompleteData()),l&&(this.aac_last_sample_pts_=l)}},t.prototype.parseAC3Payload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){var a,n;if(null!=t&&(n=t/this.timescale_),"ac-3"===this.audio_metadata_.codec)if(null==t&&null!=this.aac_last_sample_pts_)a=1536/this.audio_metadata_.sampling_frequency*1e3,n=this.aac_last_sample_pts_+a;else if(null==t)return void r.a.w(this.TAG,"AC3: Unknown pts");for(var i,o=new ge(e),s=null,l=n;null!=(s=o.readNextAC3Frame());){a=1536/s.sampling_frequency*1e3;var d={codec:"ac-3",data:s};0==this.audio_init_segment_dispatched_?(this.audio_metadata_={codec:"ac-3",sampling_frequency:s.sampling_frequency,bit_stream_identification:s.bit_stream_identification,bit_stream_mode:s.bit_stream_mode,low_frequency_effects_channel_on:s.low_frequency_effects_channel_on,channel_mode:s.channel_mode},this.dispatchAudioInitSegment(d)):this.detectAudioMetadataChange(d)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(d)),i=l;var u=Math.floor(l),c={unit:s.data,length:s.data.byteLength,pts:u,dts:u};this.audio_track_.samples.push(c),this.audio_track_.length+=s.data.byteLength,l+=a}i&&(this.aac_last_sample_pts_=i)}},t.prototype.parseEAC3Payload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){var a,n;if(null!=t&&(n=t/this.timescale_),"ec-3"===this.audio_metadata_.codec)if(null==t&&null!=this.aac_last_sample_pts_)a=256*this.audio_metadata_.num_blks/this.audio_metadata_.sampling_frequency*1e3,n=this.aac_last_sample_pts_+a;else if(null==t)return void r.a.w(this.TAG,"EAC3: Unknown pts");for(var i,o=new be(e),s=null,l=n;null!=(s=o.readNextEAC3Frame());){a=1536/s.sampling_frequency*1e3;var d={codec:"ec-3",data:s};0==this.audio_init_segment_dispatched_?(this.audio_metadata_={codec:"ec-3",sampling_frequency:s.sampling_frequency,bit_stream_identification:s.bit_stream_identification,low_frequency_effects_channel_on:s.low_frequency_effects_channel_on,num_blks:s.num_blks,channel_mode:s.channel_mode},this.dispatchAudioInitSegment(d)):this.detectAudioMetadataChange(d)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(d)),i=l;var u=Math.floor(l),c={unit:s.data,length:s.data.byteLength,pts:u,dts:u};this.audio_track_.samples.push(c),this.audio_track_.length+=s.data.byteLength,l+=a}i&&(this.aac_last_sample_pts_=i)}},t.prototype.parseOpusPayload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){var a,n;if(null!=t&&(n=t/this.timescale_),"opus"===this.audio_metadata_.codec)if(null==t&&null!=this.aac_last_sample_pts_)a=20,n=this.aac_last_sample_pts_+a;else if(null==t)return void r.a.w(this.TAG,"Opus: Unknown pts");for(var i,o=n,s=0;s<e.length;){a=20;for(var l=0!=(16&e[s+1]),d=0!=(8&e[s+1]),u=s+2,c=0;255===e[u];)c+=255,u+=1;c+=e[u],u+=1,u+=l?2:0,u+=d?2:0,i=o;var h=Math.floor(o),p=e.slice(u,u+c),f={unit:p,length:p.byteLength,pts:h,dts:h};this.audio_track_.samples.push(f),this.audio_track_.length+=p.byteLength,o+=a,s=u+c}i&&(this.aac_last_sample_pts_=i)}},t.prototype.parseMP3Payload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){var a=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],n=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],i=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],r=e[1]>>>3&3,o=(6&e[1])>>1,s=(240&e[2])>>>4,l=(12&e[2])>>>2,d=3!=(e[3]>>>6&3)?2:1,u=0,c=34;switch(r){case 0:u=[11025,12e3,8e3,0][l];break;case 2:u=[22050,24e3,16e3,0][l];break;case 3:u=[44100,48e3,32e3,0][l]}switch(o){case 1:c=34,s<i.length&&i[s];break;case 2:c=33,s<n.length&&n[s];break;case 3:c=32,s<a.length&&a[s]}var h=new fe;h.object_type=c,h.sample_rate=u,h.channel_count=d,h.data=e;var p={codec:"mp3",data:h};0==this.audio_init_segment_dispatched_?(this.audio_metadata_={codec:"mp3",object_type:c,sample_rate:u,channel_count:d},this.dispatchAudioInitSegment(p)):this.detectAudioMetadataChange(p)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(p));var f={unit:e,length:e.byteLength,pts:t/this.timescale_,dts:t/this.timescale_};this.audio_track_.samples.push(f),this.audio_track_.length+=e.byteLength}},t.prototype.detectAudioMetadataChange=function(e){if(e.codec!==this.audio_metadata_.codec)return r.a.v(this.TAG,"Audio: Audio Codecs changed from "+this.audio_metadata_.codec+" to "+e.codec),!0;if("aac"===e.codec&&"aac"===this.audio_metadata_.codec){if((t=e.data).audio_object_type!==this.audio_metadata_.audio_object_type)return r.a.v(this.TAG,"AAC: AudioObjectType changed from "+this.audio_metadata_.audio_object_type+" to "+t.audio_object_type),!0;if(t.sampling_freq_index!==this.audio_metadata_.sampling_freq_index)return r.a.v(this.TAG,"AAC: SamplingFrequencyIndex changed from "+this.audio_metadata_.sampling_freq_index+" to "+t.sampling_freq_index),!0;if(t.channel_config!==this.audio_metadata_.channel_config)return r.a.v(this.TAG,"AAC: Channel configuration changed from "+this.audio_metadata_.channel_config+" to "+t.channel_config),!0}else if("ac-3"===e.codec&&"ac-3"===this.audio_metadata_.codec){var t;if((t=e.data).sampling_frequency!==this.audio_metadata_.sampling_frequency)return r.a.v(this.TAG,"AC3: Sampling Frequency changed from "+this.audio_metadata_.sampling_frequency+" to "+t.sampling_frequency),!0;if(t.bit_stream_identification!==this.audio_metadata_.bit_stream_identification)return r.a.v(this.TAG,"AC3: Bit Stream Identification changed from "+this.audio_metadata_.bit_stream_identification+" to "+t.bit_stream_identification),!0;if(t.bit_stream_mode!==this.audio_metadata_.bit_stream_mode)return r.a.v(this.TAG,"AC3: BitStream Mode changed from "+this.audio_metadata_.bit_stream_mode+" to "+t.bit_stream_mode),!0;if(t.channel_mode!==this.audio_metadata_.channel_mode)return r.a.v(this.TAG,"AC3: Channel Mode changed from "+this.audio_metadata_.channel_mode+" to "+t.channel_mode),!0;if(t.low_frequency_effects_channel_on!==this.audio_metadata_.low_frequency_effects_channel_on)return r.a.v(this.TAG,"AC3: Low Frequency Effects Channel On changed from "+this.audio_metadata_.low_frequency_effects_channel_on+" to "+t.low_frequency_effects_channel_on),!0}else if("opus"===e.codec&&"opus"===this.audio_metadata_.codec){if((a=e.meta).sample_rate!==this.audio_metadata_.sample_rate)return r.a.v(this.TAG,"Opus: SamplingFrequencyIndex changed from "+this.audio_metadata_.sample_rate+" to "+a.sample_rate),!0;if(a.channel_count!==this.audio_metadata_.channel_count)return r.a.v(this.TAG,"Opus: Channel count changed from "+this.audio_metadata_.channel_count+" to "+a.channel_count),!0}else if("mp3"===e.codec&&"mp3"===this.audio_metadata_.codec){var a;if((a=e.data).object_type!==this.audio_metadata_.object_type)return r.a.v(this.TAG,"MP3: AudioObjectType changed from "+this.audio_metadata_.object_type+" to "+a.object_type),!0;if(a.sample_rate!==this.audio_metadata_.sample_rate)return r.a.v(this.TAG,"MP3: SamplingFrequencyIndex changed from "+this.audio_metadata_.sample_rate+" to "+a.sample_rate),!0;if(a.channel_count!==this.audio_metadata_.channel_count)return r.a.v(this.TAG,"MP3: Channel count changed from "+this.audio_metadata_.channel_count+" to "+a.channel_count),!0}return!1},t.prototype.dispatchAudioInitSegment=function(e){var t={type:"audio"};if(t.id=this.audio_track_.id,t.timescale=1e3,t.duration=this.duration_,"aac"===this.audio_metadata_.codec){var a="aac"===e.codec?e.data:null,n=new W(a);t.audioSampleRate=n.sampling_rate,t.channelCount=n.channel_count,t.codec=n.codec_mimetype,t.originalCodec=n.original_codec_mimetype,t.config=n.config,t.refSampleDuration=1024/t.audioSampleRate*t.timescale}else if("ac-3"===this.audio_metadata_.codec){var i="ac-3"===e.codec?e.data:null,o=new ve(i);t.audioSampleRate=o.sampling_rate,t.channelCount=o.channel_count,t.codec=o.codec_mimetype,t.originalCodec=o.original_codec_mimetype,t.config=o.config,t.refSampleDuration=1536/t.audioSampleRate*t.timescale}else if("ec-3"===this.audio_metadata_.codec){var s="ec-3"===e.codec?e.data:null,l=new Se(s);t.audioSampleRate=l.sampling_rate,t.channelCount=l.channel_count,t.codec=l.codec_mimetype,t.originalCodec=l.original_codec_mimetype,t.config=l.config,t.refSampleDuration=256*l.num_blks/t.audioSampleRate*t.timescale}else"opus"===this.audio_metadata_.codec?(t.audioSampleRate=this.audio_metadata_.sample_rate,t.channelCount=this.audio_metadata_.channel_count,t.channelConfigCode=this.audio_metadata_.channel_config_code,t.codec="opus",t.originalCodec="opus",t.config=void 0,t.refSampleDuration=20):"mp3"===this.audio_metadata_.codec&&(t.audioSampleRate=this.audio_metadata_.sample_rate,t.channelCount=this.audio_metadata_.channel_count,t.codec="mp3",t.originalCodec="mp3",t.config=void 0);0==this.audio_init_segment_dispatched_&&r.a.v(this.TAG,"Generated first AudioSpecificConfig for mimeType: "+t.codec),this.onTrackMetadata("audio",t),this.audio_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var d=this.media_info_;d.hasAudio=!0,d.audioCodec=t.originalCodec,d.audioSampleRate=t.audioSampleRate,d.audioChannelCount=t.channelCount,d.hasVideo&&d.videoCodec?d.mimeType='video/mp2t; codecs="'+d.videoCodec+","+d.audioCodec+'"':d.mimeType='video/mp2t; codecs="'+d.audioCodec+'"',d.isComplete()&&this.onMediaInfo(d)},t.prototype.dispatchPESPrivateDataDescriptor=function(e,t,a){var n=new Y;n.pid=e,n.stream_type=t,n.descriptor=a,this.onPESPrivateDataDescriptor&&this.onPESPrivateDataDescriptor(n)},t.prototype.parsePESPrivateDataPayload=function(e,t,a,n,i){var r=new K;if(r.pid=n,r.stream_id=i,r.len=e.byteLength,r.data=e,null!=t){var o=Math.floor(t/this.timescale_);r.pts=o}else r.nearest_pts=this.aac_last_sample_pts_;if(null!=a){var s=Math.floor(a/this.timescale_);r.dts=s}this.onPESPrivateData&&this.onPESPrivateData(r)},t.prototype.parseTimedID3MetadataPayload=function(e,t,a,n,i){var r=new K;if(r.pid=n,r.stream_id=i,r.len=e.byteLength,r.data=e,null!=t){var o=Math.floor(t/this.timescale_);r.pts=o}if(null!=a){var s=Math.floor(a/this.timescale_);r.dts=s}this.onTimedID3Metadata&&this.onTimedID3Metadata(r)},t.prototype.parseSynchronousKLVMetadataPayload=function(e,t,a,n,i){var r=new Ae;if(r.pid=n,r.stream_id=i,r.len=e.byteLength,r.data=e,null!=t){var o=Math.floor(t/this.timescale_);r.pts=o}if(null!=a){var s=Math.floor(a/this.timescale_);r.dts=s}r.access_units=function(e){for(var t=[],a=0;a+5<e.byteLength;){var n=e[a+0],i=e[a+1],r=e[a+2],o=e[a+3]<<8|e[a+4]<<0,s=e.slice(a+5,a+5+o);t.push({service_id:n,sequence_number:i,flags:r,data:s}),a+=5+o}return t}(e),this.onSynchronousKLVMetadata&&this.onSynchronousKLVMetadata(r)},t.prototype.parseAsynchronousKLVMetadataPayload=function(e,t,a){var n=new K;n.pid=t,n.stream_id=a,n.len=e.byteLength,n.data=e,this.onAsynchronousKLVMetadata&&this.onAsynchronousKLVMetadata(n)},t.prototype.parseSMPTE2038MetadataPayload=function(e,t,a,n,i){var r=new pe;if(r.pid=n,r.stream_id=i,r.len=e.byteLength,r.data=e,null!=t){var o=Math.floor(t/this.timescale_);r.pts=o}if(r.nearest_pts=this.aac_last_sample_pts_,null!=a){var s=Math.floor(a/this.timescale_);r.dts=s}r.ancillaries=function(e){for(var t=new f(e),a=0,n=[];a+=6,0===t.readBits(6);){var i=t.readBool();a+=1;var r=t.readBits(11);a+=11;var o=t.readBits(12);a+=12;var s=255&t.readBits(10);a+=10;var l=255&t.readBits(10);a+=10;var d=255&t.readBits(10);a+=10;for(var u=new Uint8Array(d),c=0;c<d;c++){var h=255&t.readBits(10);a+=10,u[c]=h}t.readBits(10),a+=10;var p="User Defined";65===s?7===l&&(p="SCTE-104"):95===s?220===l?p="ARIB STD-B37 (1SEG)":221===l?p="ARIB STD-B37 (ANALOG)":222===l?p="ARIB STD-B37 (SD)":223===l&&(p="ARIB STD-B37 (HD)"):97===s&&(1===l?p="EIA-708":2===l&&(p="EIA-608")),n.push({yc_indicator:i,line_number:r,horizontal_offset:o,did:s,sdid:l,user_data:u,description:p,information:{}}),t.readBits(8-(a-Math.floor(a/8))%8),a+=(8-(a-Math.floor(a/8)))%8}return t.destroy(),t=null,n}(e),this.onSMPTE2038Metadata&&this.onSMPTE2038Metadata(r)},t}(T),Ce=function(){for(var e=0,t=0,a=arguments.length;t<a;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<a;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)n[i]=r[o];return n},Re=function(){function e(){}return e.init=function(){for(var t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],hvc1:[],hvcC:[],av01:[],av1C:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[],Opus:[],dOps:[],"ac-3":[],dac3:[],"ec-3":[],dec3:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var a=e.constants={};a.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),a.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),a.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),a.STSC=a.STCO=a.STTS,a.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),a.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),a.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),a.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),a.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},e.box=function(e){for(var t=8,a=null,n=Array.prototype.slice.call(arguments,1),i=n.length,r=0;r<i;r++)t+=n[r].byteLength;(a=new Uint8Array(t))[0]=t>>>24&255,a[1]=t>>>16&255,a[2]=t>>>8&255,a[3]=255&t,a.set(e,4);var o=8;for(r=0;r<i;r++)a.set(n[r],o),o+=n[r].byteLength;return a},e.generateInitSegment=function(t){var a=e.box(e.types.ftyp,e.constants.FTYP),n=e.moov(t),i=new Uint8Array(a.byteLength+n.byteLength);return i.set(a,0),i.set(n,a.byteLength),i},e.moov=function(t){var a=e.mvhd(t.timescale,t.duration),n=e.trak(t),i=e.mvex(t);return e.box(e.types.moov,a,n,i)},e.mvhd=function(t,a){return e.box(e.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,a>>>24&255,a>>>16&255,a>>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},e.trak=function(t){return e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.tkhd=function(t){var a=t.id,n=t.duration,i=t.presentWidth,r=t.presentHeight;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>>8&255,255&i,0,0,r>>>8&255,255&r,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t),e.hdlr(t),e.minf(t))},e.mdhd=function(t){var a=t.timescale,n=t.duration;return e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,n>>>24&255,n>>>16&255,n>>>8&255,255&n,85,196,0,0]))},e.hdlr=function(t){var a=null;return a="audio"===t.type?e.constants.HDLR_AUDIO:e.constants.HDLR_VIDEO,e.box(e.types.hdlr,a)},e.minf=function(t){var a=null;return a="audio"===t.type?e.box(e.types.smhd,e.constants.SMHD):e.box(e.types.vmhd,e.constants.VMHD),e.box(e.types.minf,a,e.dinf(),e.stbl(t))},e.dinf=function(){return e.box(e.types.dinf,e.box(e.types.dref,e.constants.DREF))},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.constants.STTS),e.box(e.types.stsc,e.constants.STSC),e.box(e.types.stsz,e.constants.STSZ),e.box(e.types.stco,e.constants.STCO))},e.stsd=function(t){return"audio"===t.type?"mp3"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp3(t)):"ac-3"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.ac3(t)):"ec-3"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.ec3(t)):"opus"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.Opus(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp4a(t)):"video"===t.type&&t.codec.startsWith("hvc1")?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.hvc1(t)):"video"===t.type&&t.codec.startsWith("av01")?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.av01(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.avc1(t))},e.mp3=function(t){var a=t.channelCount,n=t.audioSampleRate,i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,16,0,0,0,0,n>>>8&255,255&n,0,0]);return e.box(e.types[".mp3"],i)},e.mp4a=function(t){var a=t.channelCount,n=t.audioSampleRate,i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,16,0,0,0,0,n>>>8&255,255&n,0,0]);return e.box(e.types.mp4a,i,e.esds(t))},e.ac3=function(t){var a=t.channelCount,n=t.audioSampleRate,i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,16,0,0,0,0,n>>>8&255,255&n,0,0]);return e.box(e.types["ac-3"],i,e.box(e.types.dac3,new Uint8Array(t.config)))},e.ec3=function(t){var a=t.channelCount,n=t.audioSampleRate,i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,16,0,0,0,0,n>>>8&255,255&n,0,0]);return e.box(e.types["ec-3"],i,e.box(e.types.dec3,new Uint8Array(t.config)))},e.esds=function(t){var a=t.config||[],n=a.length,i=new Uint8Array([0,0,0,0,3,23+n,0,1,0,4,15+n,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([n]).concat(a).concat([6,1,2]));return e.box(e.types.esds,i)},e.Opus=function(t){var a=t.channelCount,n=t.audioSampleRate,i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,16,0,0,0,0,n>>>8&255,255&n,0,0]);return e.box(e.types.Opus,i,e.dOps(t))},e.dOps=function(t){var a=t.channelCount,n=t.channelConfigCode,i=t.audioSampleRate;if(t.config)return e.box(e.types.dOps,o);var r=[];switch(n){case 1:case 2:r=[0];break;case 0:r=[255,1,1,0,1];break;case 128:r=[255,2,0,0,1];break;case 3:r=[1,2,1,0,2,1];break;case 4:r=[1,2,2,0,1,2,3];break;case 5:r=[1,3,2,0,4,1,2,3];break;case 6:r=[1,4,2,0,4,1,2,3,5];break;case 7:r=[1,4,2,0,4,1,2,3,5,6];break;case 8:r=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:r=[1,1,2,0,1];break;case 131:r=[1,1,3,0,1,2];break;case 132:r=[1,1,4,0,1,2,3];break;case 133:r=[1,1,5,0,1,2,3,4];break;case 134:r=[1,1,6,0,1,2,3,4,5];break;case 135:r=[1,1,7,0,1,2,3,4,5,6];break;case 136:r=[1,1,8,0,1,2,3,4,5,6,7]}var o=new Uint8Array(Ce([0,a,0,0,i>>>24&255,i>>>17&255,i>>>8&255,i>>>0&255,0,0],r));return e.box(e.types.dOps,o)},e.avc1=function(t){var a=t.avcc,n=t.codecWidth,i=t.codecHeight,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,n>>>8&255,255&n,i>>>8&255,255&i,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.avc1,r,e.box(e.types.avcC,a))},e.hvc1=function(t){var a=t.hvcc,n=t.codecWidth,i=t.codecHeight,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,n>>>8&255,255&n,i>>>8&255,255&i,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.hvc1,r,e.box(e.types.hvcC,a))},e.av01=function(t){var a=t.av1c,n=t.codecWidth||192,i=t.codecHeight||108,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,n>>>8&255,255&n,i>>>8&255,255&i,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.av01,r,e.box(e.types.av1C,a))},e.mvex=function(t){return e.box(e.types.mvex,e.trex(t))},e.trex=function(t){var a=t.id,n=new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return e.box(e.types.trex,n)},e.moof=function(t,a){return e.box(e.types.moof,e.mfhd(t.sequenceNumber),e.traf(t,a))},e.mfhd=function(t){var a=new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t]);return e.box(e.types.mfhd,a)},e.traf=function(t,a){var n=t.id,i=e.box(e.types.tfhd,new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n])),r=e.box(e.types.tfdt,new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a])),o=e.sdtp(t),s=e.trun(t,o.byteLength+16+16+8+16+8+8);return e.box(e.types.traf,i,r,s,o)},e.sdtp=function(t){for(var a=t.samples||[],n=a.length,i=new Uint8Array(4+n),r=0;r<n;r++){var o=a[r].flags;i[r+4]=o.isLeading<<6|o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy}return e.box(e.types.sdtp,i)},e.trun=function(t,a){var n=t.samples||[],i=n.length,r=12+16*i,o=new Uint8Array(r);a+=8+r,o.set([0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,255&i,a>>>24&255,a>>>16&255,a>>>8&255,255&a],0);for(var s=0;s<i;s++){var l=n[s].duration,d=n[s].size,u=n[s].flags,c=n[s].cts;o.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,d>>>24&255,d>>>16&255,d>>>8&255,255&d,u.isLeading<<2|u.dependsOn,u.isDependedOn<<6|u.hasRedundancy<<4|u.isNonSync,0,0,c>>>24&255,c>>>16&255,c>>>8&255,255&c],12+16*s)}return e.box(e.types.trun,o)},e.mdat=function(t){return e.box(e.types.mdat,t)},e}();Re.init();var De=Re,xe=function(){function e(){}return e.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),Le=a(7),ke=function(){function e(e){this.TAG="MP4Remuxer",this._config=e,this._isLive=!0===e.isLive,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new Le.c("audio"),this._videoSegmentInfoList=new Le.c("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!o.a.chrome||!(o.a.version.major<50||50===o.a.version.major&&o.a.version.build<2661)),this._fillSilentAfterSeek=o.a.msedge||o.a.msie,this._mp3UseMpegAudio=!o.a.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return e.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},e.prototype.bindDataSource=function(e){return e.onDataAvailable=this.remux.bind(this),e.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(e.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(e){this._onInitSegment=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(e){this._onMediaSegment=e},enumerable:!1,configurable:!0}),e.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},e.prototype.seek=function(e){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},e.prototype.remux=function(e,t){if(!this._onMediaSegment)throw new c.a("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(e,t),t&&this._remuxVideo(t),e&&this._remuxAudio(e)},e.prototype._onTrackMetadataReceived=function(e,t){var a=null,n="mp4",i=t.codec;if("audio"===e)this._audioMeta=t,"mp3"===t.codec&&this._mp3UseMpegAudio?(n="mpeg",i="",a=new Uint8Array):a=De.generateInitSegment(t);else{if("video"!==e)return;this._videoMeta=t,a=De.generateInitSegment(t)}if(!this._onInitSegment)throw new c.a("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(e,{type:e,data:a.buffer,codec:i,container:e+"/"+n,mediaDuration:t.duration})},e.prototype._calculateDtsBase=function(e,t){this._dtsBaseInited||(e&&e.samples&&e.samples.length&&(this._audioDtsBase=e.samples[0].dts),t&&t.samples&&t.samples.length&&(this._videoDtsBase=t.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},e.prototype.getTimestampBase=function(){if(this._dtsBaseInited)return this._dtsBase},e.prototype.flushStashedSamples=function(){var e=this._videoStashedLastSample,t=this._audioStashedLastSample,a={type:"video",id:1,sequenceNumber:0,samples:[],length:0};null!=e&&(a.samples.push(e),a.length=e.length);var n={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};null!=t&&(n.samples.push(t),n.length=t.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(a,!0),this._remuxAudio(n,!0)},e.prototype._remuxAudio=function(e,t){if(null!=this._audioMeta){var a,n=e,i=n.samples,s=void 0,l=-1,d=this._audioMeta.refSampleDuration,u="mp3"===this._audioMeta.codec&&this._mp3UseMpegAudio,c=this._dtsBaseInited&&void 0===this._audioNextDts,h=!1;if(i&&0!==i.length&&(1!==i.length||t)){var p=0,f=null,_=0;u?(p=0,_=n.length):(p=8,_=8+n.length);var m=null;if(i.length>1&&(_-=(m=i.pop()).length),null!=this._audioStashedLastSample){var g=this._audioStashedLastSample;this._audioStashedLastSample=null,i.unshift(g),_+=g.length}null!=m&&(this._audioStashedLastSample=m);var v=i[0].dts-this._dtsBase;if(this._audioNextDts)s=v-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())s=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&"mp3"!==this._audioMeta.originalCodec&&(h=!0);else{var y=this._audioSegmentInfoList.getLastSampleBefore(v);if(null!=y){var b=v-(y.originalDts+y.duration);b<=3&&(b=0),s=v-(y.dts+y.duration+b)}else s=0}if(h){var S=v-s,A=this._videoSegmentInfoList.getLastSegmentBefore(v);if(null!=A&&A.beginDts<S){if(O=xe.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount)){var E=A.beginDts,w=S-A.beginDts;r.a.v(this.TAG,"InsertPrefixSilentAudio: dts: "+E+", duration: "+w),i.unshift({unit:O,dts:E,pts:E}),_+=O.byteLength}}else h=!1}for(var T=[],C=0;C<i.length;C++){var R=(g=i[C]).unit,D=g.dts-this._dtsBase,x=(E=D,!1),L=null,k=0;if(!(D<-.001)){if("mp3"!==this._audioMeta.codec){var B=D;if(this._audioNextDts&&(B=this._audioNextDts),(s=D-B)<=-3*d){r.a.w(this.TAG,"Dropping 1 audio frame (originalDts: "+D+" ms ,curRefDts: "+B+" ms)  due to dtsCorrection: "+s+" ms overlap.");continue}if(s>=3*d&&this._fillAudioTimestampGap&&!o.a.safari){x=!0;var O,M=Math.floor(s/d);r.a.w(this.TAG,"Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.\noriginalDts: "+D+" ms, curRefDts: "+B+" ms, dtsCorrection: "+Math.round(s)+" ms, generate: "+M+" frames"),E=Math.floor(B),k=Math.floor(B+d)-E,null==(O=xe.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount))&&(r.a.w(this.TAG,"Unable to generate silent frame for "+this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame"),O=R),L=[];for(var I=0;I<M;I++){B+=d;var P=Math.floor(B),U=Math.floor(B+d)-P,N={dts:P,pts:P,cts:0,unit:O,size:O.byteLength,duration:U,originalDts:D,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};L.push(N),_+=N.size}this._audioNextDts=B+d}else E=Math.floor(B),k=Math.floor(B+d)-E,this._audioNextDts=B+d}else E=D-s,k=C!==i.length-1?i[C+1].dts-this._dtsBase-s-E:null!=m?m.dts-this._dtsBase-s-E:T.length>=1?T[T.length-1].duration:Math.floor(d),this._audioNextDts=E+k;-1===l&&(l=E),T.push({dts:E,pts:E,cts:0,unit:g.unit,size:g.unit.byteLength,duration:k,originalDts:D,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),x&&T.push.apply(T,L)}}if(0===T.length)return n.samples=[],void(n.length=0);for(u?f=new Uint8Array(_):((f=new Uint8Array(_))[0]=_>>>24&255,f[1]=_>>>16&255,f[2]=_>>>8&255,f[3]=255&_,f.set(De.types.mdat,4)),C=0;C<T.length;C++)R=T[C].unit,f.set(R,p),p+=R.byteLength;var V=T[T.length-1];a=V.dts+V.duration;var j=new Le.b;j.beginDts=l,j.endDts=a,j.beginPts=l,j.endPts=a,j.originalBeginDts=T[0].originalDts,j.originalEndDts=V.originalDts+V.duration,j.firstSample=new Le.d(T[0].dts,T[0].pts,T[0].duration,T[0].originalDts,!1),j.lastSample=new Le.d(V.dts,V.pts,V.duration,V.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(j),n.samples=T,n.sequenceNumber++;var z=null;z=u?new Uint8Array:De.moof(n,l),n.samples=[],n.length=0;var F={type:"audio",data:this._mergeBoxes(z,f).buffer,sampleCount:T.length,info:j};u&&c&&(F.timestampOffset=l),this._onMediaSegment("audio",F)}}},e.prototype._remuxVideo=function(e,t){if(null!=this._videoMeta){var a,n,i=e,r=i.samples,o=void 0,s=-1,l=-1;if(r&&0!==r.length&&(1!==r.length||t)){var d=8,u=null,c=8+e.length,h=null;if(r.length>1&&(c-=(h=r.pop()).length),null!=this._videoStashedLastSample){var p=this._videoStashedLastSample;this._videoStashedLastSample=null,r.unshift(p),c+=p.length}null!=h&&(this._videoStashedLastSample=h);var f=r[0].dts-this._dtsBase;if(this._videoNextDts)o=f-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())o=0;else{var _=this._videoSegmentInfoList.getLastSampleBefore(f);if(null!=_){var m=f-(_.originalDts+_.duration);m<=3&&(m=0),o=f-(_.dts+_.duration+m)}else o=0}for(var g=new Le.b,v=[],y=0;y<r.length;y++){var b=(p=r[y]).dts-this._dtsBase,S=p.isKeyframe,A=b-o,E=p.cts,w=A+E;-1===s&&(s=A,l=w);var T=0;if(T=y!==r.length-1?r[y+1].dts-this._dtsBase-o-A:null!=h?h.dts-this._dtsBase-o-A:v.length>=1?v[v.length-1].duration:Math.floor(this._videoMeta.refSampleDuration),S){var C=new Le.d(A,w,T,p.dts,!0);C.fileposition=p.fileposition,g.appendSyncPoint(C)}v.push({dts:A,pts:w,cts:E,units:p.units,size:p.length,isKeyframe:S,duration:T,originalDts:b,flags:{isLeading:0,dependsOn:S?2:1,isDependedOn:S?1:0,hasRedundancy:0,isNonSync:S?0:1}})}for((u=new Uint8Array(c))[0]=c>>>24&255,u[1]=c>>>16&255,u[2]=c>>>8&255,u[3]=255&c,u.set(De.types.mdat,4),y=0;y<v.length;y++)for(var R=v[y].units;R.length;){var D=R.shift().data;u.set(D,d),d+=D.byteLength}var x=v[v.length-1];if(a=x.dts+x.duration,n=x.pts+x.duration,this._videoNextDts=a,g.beginDts=s,g.endDts=a,g.beginPts=l,g.endPts=n,g.originalBeginDts=v[0].originalDts,g.originalEndDts=x.originalDts+x.duration,g.firstSample=new Le.d(v[0].dts,v[0].pts,v[0].duration,v[0].originalDts,v[0].isKeyframe),g.lastSample=new Le.d(x.dts,x.pts,x.duration,x.originalDts,x.isKeyframe),this._isLive||this._videoSegmentInfoList.append(g),i.samples=v,i.sequenceNumber++,this._forceFirstIDR){var L=v[0].flags;L.dependsOn=2,L.isNonSync=0}var k=De.moof(i,s);i.samples=[],i.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(k,u).buffer,sampleCount:v.length,info:g})}}},e.prototype._mergeBoxes=function(e,t){var a=new Uint8Array(e.byteLength+t.byteLength);return a.set(e,0),a.set(t,e.byteLength),a},e}(),Be=a(11),Oe=a(1),Me=function(){function e(e,t){this.TAG="TransmuxingController",this._emitter=new i.a,this._config=t,e.segments||(e.segments=[{duration:e.duration,filesize:e.filesize,url:e.url}]),"boolean"!=typeof e.cors&&(e.cors=!0),"boolean"!=typeof e.withCredentials&&(e.withCredentials=!1),this._mediaDataSource=e,this._currentSegmentIndex=0;var a=0;this._mediaDataSource.segments.forEach((function(n){n.timestampBase=a,a+=n.duration,n.cors=e.cors,n.withCredentials=e.withCredentials,t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy)})),isNaN(a)||this._mediaDataSource.duration===a||(this._mediaDataSource.duration=a),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return e.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},e.prototype._loadSegment=function(e,t){this._currentSegmentIndex=e;var a=this._mediaDataSource.segments[e],n=this._ioctl=new Be.a(a,this._config,e);n.onError=this._onIOException.bind(this),n.onSeeked=this._onIOSeeked.bind(this),n.onComplete=this._onIOComplete.bind(this),n.onRedirect=this._onIORedirect.bind(this),n.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),t?this._demuxer.bindDataSource(this._ioctl):n.onDataArrival=this._onInitChunkArrival.bind(this),n.open(t)},e.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},e.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},e.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},e.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},e.prototype.seek=function(e){if(null!=this._mediaInfo&&this._mediaInfo.isSeekable()){var t=this._searchSegmentIndexContains(e);if(t===this._currentSegmentIndex){var a=this._mediaInfo.segments[t];if(null==a)this._pendingSeekTime=e;else{var n=a.getNearestKeyframe(e);this._remuxer.seek(n.milliseconds),this._ioctl.seek(n.fileposition),this._pendingResolveSeekPoint=n.milliseconds}}else{var i=this._mediaInfo.segments[t];null==i?(this._pendingSeekTime=e,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(t)):(n=i.getNearestKeyframe(e),this._internalAbort(),this._remuxer.seek(e),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[t].timestampBase,this._loadSegment(t,n.fileposition),this._pendingResolveSeekPoint=n.milliseconds,this._reportSegmentMediaInfo(t))}this._enableStatisticsReporter()}},e.prototype._searchSegmentIndexContains=function(e){for(var t=this._mediaDataSource.segments,a=t.length-1,n=0;n<t.length;n++)if(e<t[n].timestampBase){a=n-1;break}return a},e.prototype._onInitChunkArrival=function(e,t){var a=this,n=0;if(t>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,n=this._demuxer.parseChunks(e,t);else{var i=null;(i=w.probe(e)).match&&(this._setupFLVDemuxerRemuxer(i),n=this._demuxer.parseChunks(e,t)),i.match||i.needMoreData||(i=Te.probe(e)).match&&(this._setupTSDemuxerRemuxer(i),n=this._demuxer.parseChunks(e,t)),i.match||i.needMoreData||(i=null,r.a.e(this.TAG,"Non MPEG-TS/FLV, Unsupported media type!"),Promise.resolve().then((function(){a._internalAbort()})),this._emitter.emit(Oe.a.DEMUX_ERROR,m.a.FORMAT_UNSUPPORTED,"Non MPEG-TS/FLV, Unsupported media type!"))}return n},e.prototype._setupFLVDemuxerRemuxer=function(e){this._demuxer=new w(e,this._config),this._remuxer||(this._remuxer=new ke(this._config));var t=this._mediaDataSource;null==t.duration||isNaN(t.duration)||(this._demuxer.overridedDuration=t.duration),"boolean"==typeof t.hasAudio&&(this._demuxer.overridedHasAudio=t.hasAudio),"boolean"==typeof t.hasVideo&&(this._demuxer.overridedHasVideo=t.hasVideo),this._demuxer.timestampBase=t.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},e.prototype._setupTSDemuxerRemuxer=function(e){var t=this._demuxer=new Te(e,this._config);this._remuxer||(this._remuxer=new ke(this._config)),t.onError=this._onDemuxException.bind(this),t.onMediaInfo=this._onMediaInfo.bind(this),t.onMetaDataArrived=this._onMetaDataArrived.bind(this),t.onTimedID3Metadata=this._onTimedID3Metadata.bind(this),t.onSynchronousKLVMetadata=this._onSynchronousKLVMetadata.bind(this),t.onAsynchronousKLVMetadata=this._onAsynchronousKLVMetadata.bind(this),t.onSMPTE2038Metadata=this._onSMPTE2038Metadata.bind(this),t.onSCTE35Metadata=this._onSCTE35Metadata.bind(this),t.onPESPrivateDataDescriptor=this._onPESPrivateDataDescriptor.bind(this),t.onPESPrivateData=this._onPESPrivateData.bind(this),this._remuxer.bindDataSource(this._demuxer),this._demuxer.bindDataSource(this._ioctl),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},e.prototype._onMediaInfo=function(e){var t=this;null==this._mediaInfo&&(this._mediaInfo=Object.assign({},e),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,s.a.prototype));var a=Object.assign({},e);Object.setPrototypeOf(a,s.a.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=a,this._reportSegmentMediaInfo(this._currentSegmentIndex),null!=this._pendingSeekTime&&Promise.resolve().then((function(){var e=t._pendingSeekTime;t._pendingSeekTime=null,t.seek(e)}))},e.prototype._onMetaDataArrived=function(e){this._emitter.emit(Oe.a.METADATA_ARRIVED,e)},e.prototype._onScriptDataArrived=function(e){this._emitter.emit(Oe.a.SCRIPTDATA_ARRIVED,e)},e.prototype._onTimedID3Metadata=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.dts&&(e.dts-=t),this._emitter.emit(Oe.a.TIMED_ID3_METADATA_ARRIVED,e))},e.prototype._onSynchronousKLVMetadata=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.dts&&(e.dts-=t),this._emitter.emit(Oe.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,e))},e.prototype._onAsynchronousKLVMetadata=function(e){this._emitter.emit(Oe.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,e)},e.prototype._onSMPTE2038Metadata=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.dts&&(e.dts-=t),null!=e.nearest_pts&&(e.nearest_pts-=t),this._emitter.emit(Oe.a.SMPTE2038_METADATA_ARRIVED,e))},e.prototype._onSCTE35Metadata=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.nearest_pts&&(e.nearest_pts-=t),this._emitter.emit(Oe.a.SCTE35_METADATA_ARRIVED,e))},e.prototype._onPESPrivateDataDescriptor=function(e){this._emitter.emit(Oe.a.PES_PRIVATE_DATA_DESCRIPTOR,e)},e.prototype._onPESPrivateData=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.nearest_pts&&(e.nearest_pts-=t),null!=e.dts&&(e.dts-=t),this._emitter.emit(Oe.a.PES_PRIVATE_DATA_ARRIVED,e))},e.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},e.prototype._onIOComplete=function(e){var t=e+1;t<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer&&this._remuxer.flushStashedSamples(),this._loadSegment(t)):(this._remuxer&&this._remuxer.flushStashedSamples(),this._emitter.emit(Oe.a.LOADING_COMPLETE),this._disableStatisticsReporter())},e.prototype._onIORedirect=function(e){var t=this._ioctl.extraData;this._mediaDataSource.segments[t].redirectedURL=e},e.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(Oe.a.RECOVERED_EARLY_EOF)},e.prototype._onIOException=function(e,t){r.a.e(this.TAG,"IOException: type = "+e+", code = "+t.code+", msg = "+t.msg),this._emitter.emit(Oe.a.IO_ERROR,e,t),this._disableStatisticsReporter()},e.prototype._onDemuxException=function(e,t){r.a.e(this.TAG,"DemuxException: type = "+e+", info = "+t),this._emitter.emit(Oe.a.DEMUX_ERROR,e,t)},e.prototype._onRemuxerInitSegmentArrival=function(e,t){this._emitter.emit(Oe.a.INIT_SEGMENT,e,t)},e.prototype._onRemuxerMediaSegmentArrival=function(e,t){if(null==this._pendingSeekTime&&(this._emitter.emit(Oe.a.MEDIA_SEGMENT,e,t),null!=this._pendingResolveSeekPoint&&"video"===e)){var a=t.info.syncPoints,n=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,o.a.safari&&a.length>0&&a[0].originalDts===n&&(n=a[0].pts),this._emitter.emit(Oe.a.RECOMMEND_SEEKPOINT,n)}},e.prototype._enableStatisticsReporter=function(){null==this._statisticsReporter&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},e.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype._reportSegmentMediaInfo=function(e){var t=this._mediaInfo.segments[e],a=Object.assign({},t);a.duration=this._mediaInfo.duration,a.segmentCount=this._mediaInfo.segmentCount,delete a.segments,delete a.keyframesIndex,this._emitter.emit(Oe.a.MEDIA_INFO,a)},e.prototype._reportStatisticsInfo=function(){var e={};e.url=this._ioctl.currentURL,e.hasRedirect=this._ioctl.hasRedirect,e.hasRedirect&&(e.redirectedURL=this._ioctl.currentRedirectedURL),e.speed=this._ioctl.currentSpeed,e.loaderType=this._ioctl.loaderType,e.currentSegmentIndex=this._currentSegmentIndex,e.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(Oe.a.STATISTICS_INFO,e)},e}();t.a=Me},function(e,t,a){var n,i=a(0),r=function(){function e(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return e.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},e.prototype.addBytes=function(e){0===this._firstCheckpoint?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=e,this._totalBytes+=e):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=e,this._totalBytes+=e):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=e,this._totalBytes+=e,this._lastCheckpoint=this._now())},Object.defineProperty(e.prototype,"currentKBps",{get:function(){this.addBytes(0);var e=(this._now()-this._lastCheckpoint)/1e3;return 0==e&&(e=1),this._intervalBytes/e/1024},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),0!==this._lastSecondBytes?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"averageKBps",{get:function(){var e=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/e/1024},enumerable:!1,configurable:!0}),e}(),o=a(2),s=a(4),l=a(3),d=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),u=function(e){function t(t,a){var n=e.call(this,"fetch-stream-loader")||this;return n.TAG="FetchStreamLoader",n._seekHandler=t,n._config=a,n._needStash=!0,n._requestAbort=!1,n._abortController=null,n._contentLength=null,n._receivedLength=0,n}return d(t,e),t.isSupported=function(){try{var e=s.a.msedge&&s.a.version.minor>=15048,t=!s.a.msedge||e;return self.fetch&&self.ReadableStream&&t}catch(e){return!1}},t.prototype.destroy=function(){this.isWorking()&&this.abort(),e.prototype.destroy.call(this)},t.prototype.open=function(e,t){var a=this;this._dataSource=e,this._range=t;var n=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(n=e.redirectedURL);var i=this._seekHandler.getConfig(n,t),r=new self.Headers;if("object"==typeof i.headers){var s=i.headers;for(var d in s)s.hasOwnProperty(d)&&r.append(d,s[d])}var u={method:"GET",headers:r,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if("object"==typeof this._config.headers)for(var d in this._config.headers)r.append(d,this._config.headers[d]);!1===e.cors&&(u.mode="same-origin"),e.withCredentials&&(u.credentials="include"),e.referrerPolicy&&(u.referrerPolicy=e.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,u.signal=this._abortController.signal),this._status=o.c.kConnecting,self.fetch(i.url,u).then((function(e){if(a._requestAbort)return a._status=o.c.kIdle,void e.body.cancel();if(e.ok&&e.status>=200&&e.status<=299){if(e.url!==i.url&&a._onURLRedirect){var t=a._seekHandler.removeURLParameters(e.url);a._onURLRedirect(t)}var n=e.headers.get("Content-Length");return null!=n&&(a._contentLength=parseInt(n),0!==a._contentLength&&a._onContentLengthKnown&&a._onContentLengthKnown(a._contentLength)),a._pump.call(a,e.body.getReader())}if(a._status=o.c.kError,!a._onError)throw new l.d("FetchStreamLoader: Http code invalid, "+e.status+" "+e.statusText);a._onError(o.b.HTTP_STATUS_CODE_INVALID,{code:e.status,msg:e.statusText})})).catch((function(e){if(!a._abortController||!a._abortController.signal.aborted){if(a._status=o.c.kError,!a._onError)throw e;a._onError(o.b.EXCEPTION,{code:-1,msg:e.message})}}))},t.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==o.c.kBuffering||!s.a.chrome)&&this._abortController)try{this._abortController.abort()}catch(e){}},t.prototype._pump=function(e){var t=this;return e.read().then((function(a){if(a.done)if(null!==t._contentLength&&t._receivedLength<t._contentLength){t._status=o.c.kError;var n=o.b.EARLY_EOF,i={code:-1,msg:"Fetch stream meet Early-EOF"};if(!t._onError)throw new l.d(i.msg);t._onError(n,i)}else t._status=o.c.kComplete,t._onComplete&&t._onComplete(t._range.from,t._range.from+t._receivedLength-1);else{if(t._abortController&&t._abortController.signal.aborted)return void(t._status=o.c.kComplete);if(!0===t._requestAbort)return t._status=o.c.kComplete,e.cancel();t._status=o.c.kBuffering;var r=a.value.buffer,s=t._range.from+t._receivedLength;t._receivedLength+=r.byteLength,t._onDataArrival&&t._onDataArrival(r,s,t._receivedLength),t._pump(e)}})).catch((function(e){if(t._abortController&&t._abortController.signal.aborted)t._status=o.c.kComplete;else if(11!==e.code||!s.a.msedge){t._status=o.c.kError;var a=0,n=null;if(19!==e.code&&"network error"!==e.message||!(null===t._contentLength||null!==t._contentLength&&t._receivedLength<t._contentLength)?(a=o.b.EXCEPTION,n={code:e.code,msg:e.message}):(a=o.b.EARLY_EOF,n={code:e.code,msg:"Fetch stream meet Early-EOF"}),!t._onError)throw new l.d(n.msg);t._onError(a,n)}}))},t}(o.a),c=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),h=function(e){function t(t,a){var n=e.call(this,"xhr-moz-chunked-loader")||this;return n.TAG="MozChunkedLoader",n._seekHandler=t,n._config=a,n._needStash=!0,n._xhr=null,n._requestAbort=!1,n._contentLength=null,n._receivedLength=0,n}return c(t,e),t.isSupported=function(){try{var e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="moz-chunked-arraybuffer","moz-chunked-arraybuffer"===e.responseType}catch(e){return i.a.w("MozChunkedLoader",e.message),!1}},t.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),e.prototype.destroy.call(this)},t.prototype.open=function(e,t){this._dataSource=e,this._range=t;var a=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(a=e.redirectedURL);var n=this._seekHandler.getConfig(a,t);this._requestURL=n.url;var i=this._xhr=new XMLHttpRequest;if(i.open("GET",n.url,!0),i.responseType="moz-chunked-arraybuffer",i.onreadystatechange=this._onReadyStateChange.bind(this),i.onprogress=this._onProgress.bind(this),i.onloadend=this._onLoadEnd.bind(this),i.onerror=this._onXhrError.bind(this),e.withCredentials&&(i.withCredentials=!0),"object"==typeof n.headers){var r=n.headers;for(var s in r)r.hasOwnProperty(s)&&i.setRequestHeader(s,r[s])}if("object"==typeof this._config.headers)for(var s in r=this._config.headers)r.hasOwnProperty(s)&&i.setRequestHeader(s,r[s]);this._status=o.c.kConnecting,i.send()},t.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=o.c.kComplete},t.prototype._onReadyStateChange=function(e){var t=e.target;if(2===t.readyState){if(null!=t.responseURL&&t.responseURL!==this._requestURL&&this._onURLRedirect){var a=this._seekHandler.removeURLParameters(t.responseURL);this._onURLRedirect(a)}if(0!==t.status&&(t.status<200||t.status>299)){if(this._status=o.c.kError,!this._onError)throw new l.d("MozChunkedLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(o.b.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}else this._status=o.c.kBuffering}},t.prototype._onProgress=function(e){if(this._status!==o.c.kError){null===this._contentLength&&null!==e.total&&0!==e.total&&(this._contentLength=e.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var t=e.target.response,a=this._range.from+this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,a,this._receivedLength)}},t.prototype._onLoadEnd=function(e){!0!==this._requestAbort?this._status!==o.c.kError&&(this._status=o.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1},t.prototype._onXhrError=function(e){this._status=o.c.kError;var t=0,a=null;if(this._contentLength&&e.loaded<this._contentLength?(t=o.b.EARLY_EOF,a={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(t=o.b.EXCEPTION,a={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new l.d(a.msg);this._onError(t,a)},t}(o.a),p=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),f=function(e){function t(t,a){var n=e.call(this,"xhr-range-loader")||this;return n.TAG="RangeLoader",n._seekHandler=t,n._config=a,n._needStash=!1,n._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],n._currentChunkSizeKB=384,n._currentSpeedNormalized=0,n._zeroSpeedChunkCount=0,n._xhr=null,n._speedSampler=new r,n._requestAbort=!1,n._waitForTotalLength=!1,n._totalLengthReceived=!1,n._currentRequestURL=null,n._currentRedirectedURL=null,n._currentRequestRange=null,n._totalLength=null,n._contentLength=null,n._receivedLength=0,n._lastTimeLoaded=0,n}return p(t,e),t.isSupported=function(){try{var e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="arraybuffer","arraybuffer"===e.responseType}catch(e){return i.a.w("RangeLoader",e.message),!1}},t.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),e.prototype.destroy.call(this)},Object.defineProperty(t.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),t.prototype.open=function(e,t){this._dataSource=e,this._range=t,this._status=o.c.kConnecting;var a=!1;null!=this._dataSource.filesize&&0!==this._dataSource.filesize&&(a=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||a?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))},t.prototype._openSubRange=function(){var e=1024*this._currentChunkSizeKB,t=this._range.from+this._receivedLength,a=t+e;null!=this._contentLength&&a-this._range.from>=this._contentLength&&(a=this._range.from+this._contentLength-1),this._currentRequestRange={from:t,to:a},this._internalOpen(this._dataSource,this._currentRequestRange)},t.prototype._internalOpen=function(e,t){this._lastTimeLoaded=0;var a=e.url;this._config.reuseRedirectedURL&&(null!=this._currentRedirectedURL?a=this._currentRedirectedURL:null!=e.redirectedURL&&(a=e.redirectedURL));var n=this._seekHandler.getConfig(a,t);this._currentRequestURL=n.url;var i=this._xhr=new XMLHttpRequest;if(i.open("GET",n.url,!0),i.responseType="arraybuffer",i.onreadystatechange=this._onReadyStateChange.bind(this),i.onprogress=this._onProgress.bind(this),i.onload=this._onLoad.bind(this),i.onerror=this._onXhrError.bind(this),e.withCredentials&&(i.withCredentials=!0),"object"==typeof n.headers){var r=n.headers;for(var o in r)r.hasOwnProperty(o)&&i.setRequestHeader(o,r[o])}if("object"==typeof this._config.headers)for(var o in r=this._config.headers)r.hasOwnProperty(o)&&i.setRequestHeader(o,r[o]);i.send()},t.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=o.c.kComplete},t.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},t.prototype._onReadyStateChange=function(e){var t=e.target;if(2===t.readyState){if(null!=t.responseURL){var a=this._seekHandler.removeURLParameters(t.responseURL);t.responseURL!==this._currentRequestURL&&a!==this._currentRedirectedURL&&(this._currentRedirectedURL=a,this._onURLRedirect&&this._onURLRedirect(a))}if(t.status>=200&&t.status<=299){if(this._waitForTotalLength)return;this._status=o.c.kBuffering}else{if(this._status=o.c.kError,!this._onError)throw new l.d("RangeLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(o.b.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}}},t.prototype._onProgress=function(e){if(this._status!==o.c.kError){if(null===this._contentLength){var t=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,t=!0;var a=e.total;this._internalAbort(),null!=a&0!==a&&(this._totalLength=a)}if(-1===this._range.to?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,t)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var n=e.loaded-this._lastTimeLoaded;this._lastTimeLoaded=e.loaded,this._speedSampler.addBytes(n)}},t.prototype._normalizeSpeed=function(e){var t=this._chunkSizeKBList,a=t.length-1,n=0,i=0,r=a;if(e<t[0])return t[0];for(;i<=r;){if((n=i+Math.floor((r-i)/2))===a||e>=t[n]&&e<t[n+1])return t[n];t[n]<e?i=n+1:r=n-1}},t.prototype._onLoad=function(e){if(this._status!==o.c.kError)if(this._waitForTotalLength)this._waitForTotalLength=!1;else{this._lastTimeLoaded=0;var t=this._speedSampler.lastSecondKBps;if(0===t&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(t=this._speedSampler.currentKBps)),0!==t){var a=this._normalizeSpeed(t);this._currentSpeedNormalized!==a&&(this._currentSpeedNormalized=a,this._currentChunkSizeKB=a)}var n=e.target.response,i=this._range.from+this._receivedLength;this._receivedLength+=n.byteLength;var r=!1;null!=this._contentLength&&this._receivedLength<this._contentLength?this._openSubRange():r=!0,this._onDataArrival&&this._onDataArrival(n,i,this._receivedLength),r&&(this._status=o.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},t.prototype._onXhrError=function(e){this._status=o.c.kError;var t=0,a=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(t=o.b.EARLY_EOF,a={code:-1,msg:"RangeLoader meet Early-Eof"}):(t=o.b.EXCEPTION,a={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new l.d(a.msg);this._onError(t,a)},t}(o.a),_=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),m=function(e){function t(){var t=e.call(this,"websocket-loader")||this;return t.TAG="WebSocketLoader",t._needStash=!0,t._ws=null,t._requestAbort=!1,t._receivedLength=0,t}return _(t,e),t.isSupported=function(){try{return void 0!==self.WebSocket}catch(e){return!1}},t.prototype.destroy=function(){this._ws&&this.abort(),e.prototype.destroy.call(this)},t.prototype.open=function(e){try{var t=this._ws=new self.WebSocket(e.url);t.binaryType="arraybuffer",t.onopen=this._onWebSocketOpen.bind(this),t.onclose=this._onWebSocketClose.bind(this),t.onmessage=this._onWebSocketMessage.bind(this),t.onerror=this._onWebSocketError.bind(this),this._status=o.c.kConnecting}catch(e){this._status=o.c.kError;var a={code:e.code,msg:e.message};if(!this._onError)throw new l.d(a.msg);this._onError(o.b.EXCEPTION,a)}},t.prototype.abort=function(){var e=this._ws;!e||0!==e.readyState&&1!==e.readyState||(this._requestAbort=!0,e.close()),this._ws=null,this._status=o.c.kComplete},t.prototype._onWebSocketOpen=function(e){this._status=o.c.kBuffering},t.prototype._onWebSocketClose=function(e){!0!==this._requestAbort?(this._status=o.c.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1},t.prototype._onWebSocketMessage=function(e){var t=this;if(e.data instanceof ArrayBuffer)this._dispatchArrayBuffer(e.data);else if(e.data instanceof Blob){var a=new FileReader;a.onload=function(){t._dispatchArrayBuffer(a.result)},a.readAsArrayBuffer(e.data)}else{this._status=o.c.kError;var n={code:-1,msg:"Unsupported WebSocket message type: "+e.data.constructor.name};if(!this._onError)throw new l.d(n.msg);this._onError(o.b.EXCEPTION,n)}},t.prototype._dispatchArrayBuffer=function(e){var t=e,a=this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,a,this._receivedLength)},t.prototype._onWebSocketError=function(e){this._status=o.c.kError;var t={code:e.code,msg:e.message};if(!this._onError)throw new l.d(t.msg);this._onError(o.b.EXCEPTION,t)},t}(o.a),g=function(){function e(e){this._zeroStart=e||!1}return e.prototype.getConfig=function(e,t){var a={};if(0!==t.from||-1!==t.to){var n=void 0;n=-1!==t.to?"bytes="+t.from.toString()+"-"+t.to.toString():"bytes="+t.from.toString()+"-",a.Range=n}else this._zeroStart&&(a.Range="bytes=0-");return{url:e,headers:a}},e.prototype.removeURLParameters=function(e){return e},e}(),v=function(){function e(e,t){this._startName=e,this._endName=t}return e.prototype.getConfig=function(e,t){var a=e;if(0!==t.from||-1!==t.to){var n=!0;-1===a.indexOf("?")&&(a+="?",n=!1),n&&(a+="&"),a+=this._startName+"="+t.from.toString(),-1!==t.to&&(a+="&"+this._endName+"="+t.to.toString())}return{url:a,headers:{}}},e.prototype.removeURLParameters=function(e){var t=e.split("?")[0],a=void 0,n=e.indexOf("?");-1!==n&&(a=e.substring(n+1));var i="";if(null!=a&&a.length>0)for(var r=a.split("&"),o=0;o<r.length;o++){var s=r[o].split("="),l=o>0;s[0]!==this._startName&&s[0]!==this._endName&&(l&&(i+="&"),i+=r[o])}return 0===i.length?t:t+"?"+i},e}(),y=function(){function e(e,t,a){this.TAG="IOController",this._config=t,this._extraData=a,this._stashInitialSize=65536,null!=t.stashInitialSize&&t.stashInitialSize>0&&(this._stashInitialSize=t.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=3145728,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,!1===t.enableStashBuffer&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=e,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(e.url),this._refTotalLength=e.filesize?e.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new r,this._speedNormalizeList=[32,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return e.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},e.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},e.prototype.isPaused=function(){return this._paused},Object.defineProperty(e.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"extraData",{get:function(){return this._extraData},set:function(e){this._extraData=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(e){this._onSeeked=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onComplete",{get:function(){return this._onComplete},set:function(e){this._onComplete=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(e){this._onRedirect=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(e){this._onRecoveredEarlyEof=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasRedirect",{get:function(){return null!=this._redirectedURL||null!=this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentSpeed",{get:function(){return this._loaderClass===f?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),e.prototype._selectSeekHandler=function(){var e=this._config;if("range"===e.seekType)this._seekHandler=new g(this._config.rangeLoadZeroStart);else if("param"===e.seekType){var t=e.seekParamStart||"bstart",a=e.seekParamEnd||"bend";this._seekHandler=new v(t,a)}else{if("custom"!==e.seekType)throw new l.b("Invalid seekType in config: "+e.seekType);if("function"!=typeof e.customSeekHandler)throw new l.b("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new e.customSeekHandler}},e.prototype._selectLoader=function(){if(null!=this._config.customLoader)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=m;else if(u.isSupported())this._loaderClass=u;else if(h.isSupported())this._loaderClass=h;else{if(!f.isSupported())throw new l.d("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=f}},e.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),!1===this._loader.needStashBuffer&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},e.prototype.open=function(e){this._currentRange={from:0,to:-1},e&&(this._currentRange.from=e),this._speedSampler.reset(),e||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},e.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},e.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),0!==this._stashUsed?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},e.prototype.resume=function(){if(this._paused){this._paused=!1;var e=this._resumeFrom;this._resumeFrom=0,this._internalSeek(e,!0)}},e.prototype.seek=function(e){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(e,!0)},e.prototype._internalSeek=function(e,t){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(t),this._loader.destroy(),this._loader=null;var a={from:e,to:-1};this._currentRange={from:a.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,a),this._onSeeked&&this._onSeeked()},e.prototype.updateUrl=function(e){if(!e||"string"!=typeof e||0===e.length)throw new l.b("Url must be a non-empty string!");this._dataSource.url=e},e.prototype._expandBuffer=function(e){for(var t=this._stashSize;t+1048576<e;)t*=2;if((t+=1048576)!==this._bufferSize){var a=new ArrayBuffer(t);if(this._stashUsed>0){var n=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(a,0,t).set(n,0)}this._stashBuffer=a,this._bufferSize=t}},e.prototype._normalizeSpeed=function(e){var t=this._speedNormalizeList,a=t.length-1,n=0,i=0,r=a;if(e<t[0])return t[0];for(;i<=r;){if((n=i+Math.floor((r-i)/2))===a||e>=t[n]&&e<t[n+1])return t[n];t[n]<e?i=n+1:r=n-1}},e.prototype._adjustStashSize=function(e){var t=0;(t=this._config.isLive?e/8:e<512?e:e>=512&&e<=1024?Math.floor(1.5*e):2*e)>8192&&(t=8192);var a=1024*t+1048576;this._bufferSize<a&&this._expandBuffer(a),this._stashSize=1024*t},e.prototype._dispatchChunks=function(e,t){return this._currentRange.to=t+e.byteLength-1,this._onDataArrival(e,t)},e.prototype._onURLRedirect=function(e){this._redirectedURL=e,this._onRedirect&&this._onRedirect(e)},e.prototype._onContentLengthKnown=function(e){e&&this._fullRequestFlag&&(this._totalLength=e,this._fullRequestFlag=!1)},e.prototype._onLoaderChunkArrival=function(e,t,a){if(!this._onDataArrival)throw new l.a("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(e.byteLength);var n=this._speedSampler.lastSecondKBps;if(0!==n){var i=this._normalizeSpeed(n);this._speedNormalized!==i&&(this._speedNormalized=i,this._adjustStashSize(i))}if(this._enableStash)if(0===this._stashUsed&&0===this._stashByteStart&&(this._stashByteStart=t),this._stashUsed+e.byteLength<=this._stashSize)(s=new Uint8Array(this._stashBuffer,0,this._stashSize)).set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength;else if(s=new Uint8Array(this._stashBuffer,0,this._bufferSize),this._stashUsed>0){var r=this._stashBuffer.slice(0,this._stashUsed);(d=this._dispatchChunks(r,this._stashByteStart))<r.byteLength?d>0&&(u=new Uint8Array(r,d),s.set(u,0),this._stashUsed=u.byteLength,this._stashByteStart+=d):(this._stashUsed=0,this._stashByteStart+=d),this._stashUsed+e.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+e.byteLength),s=new Uint8Array(this._stashBuffer,0,this._bufferSize)),s.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else(d=this._dispatchChunks(e,t))<e.byteLength&&((o=e.byteLength-d)>this._bufferSize&&(this._expandBuffer(o),s=new Uint8Array(this._stashBuffer,0,this._bufferSize)),s.set(new Uint8Array(e,d),0),this._stashUsed+=o,this._stashByteStart=t+d);else if(0===this._stashUsed){var o;(d=this._dispatchChunks(e,t))<e.byteLength&&((o=e.byteLength-d)>this._bufferSize&&this._expandBuffer(o),(s=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(e,d),0),this._stashUsed+=o,this._stashByteStart=t+d)}else{var s,d;if(this._stashUsed+e.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+e.byteLength),(s=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength,(d=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart))<this._stashUsed&&d>0){var u=new Uint8Array(this._stashBuffer,d);s.set(u,0)}this._stashUsed-=d,this._stashByteStart+=d}}},e.prototype._flushStashBuffer=function(e){if(this._stashUsed>0){var t=this._stashBuffer.slice(0,this._stashUsed),a=this._dispatchChunks(t,this._stashByteStart),n=t.byteLength-a;if(a<t.byteLength){if(!e){if(a>0){var r=new Uint8Array(this._stashBuffer,0,this._bufferSize),o=new Uint8Array(t,a);r.set(o,0),this._stashUsed=o.byteLength,this._stashByteStart+=a}return 0}i.a.w(this.TAG,n+" bytes unconsumed data remain when flush buffer, dropped")}return this._stashUsed=0,this._stashByteStart=0,n}return 0},e.prototype._onLoaderComplete=function(e,t){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},e.prototype._onLoaderError=function(e,t){switch(i.a.e(this.TAG,"Loader error, code = "+t.code+", msg = "+t.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,e=o.b.UNRECOVERABLE_EARLY_EOF),e){case o.b.EARLY_EOF:if(!this._config.isLive&&this._totalLength){var a=this._currentRange.to+1;return void(a<this._totalLength&&(i.a.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(a,!1)))}e=o.b.UNRECOVERABLE_EARLY_EOF;case o.b.UNRECOVERABLE_EARLY_EOF:case o.b.CONNECTING_TIMEOUT:case o.b.HTTP_STATUS_CODE_INVALID:case o.b.EXCEPTION:}if(!this._onError)throw new l.d("IOException: "+t.msg);this._onError(e,t)},e}();t.a=y},function(e,t,a){var n=function(){function e(){}return e.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Object.assign=Object.assign||function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),a=1;a<arguments.length;a++){var n=arguments[a];if(null!=n)for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}return t},"function"!=typeof self.Promise&&a(15).polyfill()},e}();n.install(),t.a=n},function(e,t,a){function n(e){var t={};function a(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=t,a.i=function(e){return e},a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},a.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a.oe=function(e){throw e};var n=a(a.s=ENTRY_MODULE);return n.default||n}function i(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function r(e,t,n){var r={};r[n]=[];var o=t.toString(),s=o.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!s)return r;for(var l,d=s[1],u=new RegExp("(\\\\n|\\W)"+i(d)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");l=u.exec(o);)"dll-reference"!==l[3]&&r[n].push(l[3]);for(u=new RegExp("\\("+i(d)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");l=u.exec(o);)e[l[2]]||(r[n].push(l[1]),e[l[2]]=a(l[1]).m),r[l[2]]=r[l[2]]||[],r[l[2]].push(l[4]);for(var c,h=Object.keys(r),p=0;p<h.length;p++)for(var f=0;f<r[h[p]].length;f++)c=r[h[p]][f],isNaN(1*c)||(r[h[p]][f]=1*r[h[p]][f]);return r}function o(e){return Object.keys(e).reduce((function(t,a){return t||e[a].length>0}),!1)}e.exports=function(e,t){t=t||{};var i={main:a.m},s=t.all?{main:Object.keys(i.main)}:function(e,t){for(var a={main:[t]},n={main:[]},i={main:{}};o(a);)for(var s=Object.keys(a),l=0;l<s.length;l++){var d=s[l],u=a[d].pop();if(i[d]=i[d]||{},!i[d][u]&&e[d][u]){i[d][u]=!0,n[d]=n[d]||[],n[d].push(u);for(var c=r(e,e[d][u],d),h=Object.keys(c),p=0;p<h.length;p++)a[h[p]]=a[h[p]]||[],a[h[p]]=a[h[p]].concat(c[h[p]])}}return n}(i,e),l="";Object.keys(s).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;s[e][t];)t++;s[e].push(t),i[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",l=l+"var "+e+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+s[e].map((function(t){return JSON.stringify(t)+": "+i[e][t].toString()})).join(",")+"});\n"})),l=l+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+s.main.map((function(e){return JSON.stringify(e)+": "+i.main[e].toString()})).join(",")+"}))(self);";var d=new window.Blob([l],{type:"text/javascript"});if(t.bare)return d;var u=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(d),c=new window.Worker(u);return c.objectURL=u,c}},function(e,t,a){e.exports=a(19).default},function(e,t,a){(function(t,a){var n;n=function(){function e(e){return"function"==typeof e}var n=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=0,r=void 0,o=void 0,s=function(e,t){f[i]=e,f[i+1]=t,2===(i+=2)&&(o?o(_):b())},l="undefined"!=typeof window?window:void 0,d=l||{},u=d.MutationObserver||d.WebKitMutationObserver,c="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){var e=setTimeout;return function(){return e(_,1)}}var f=new Array(1e3);function _(){for(var e=0;e<i;e+=2)(0,f[e])(f[e+1]),f[e]=void 0,f[e+1]=void 0;i=0}var m,g,v,y,b=void 0;function S(e,t){var a=this,n=new this.constructor(w);void 0===n[E]&&M(n);var i=a._state;if(i){var r=arguments[i-1];s((function(){return B(i,n,r,a._result)}))}else L(a,n,e,t);return n}function A(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(w);return C(t,e),t}c?b=function(){return t.nextTick(_)}:u?(g=0,v=new u(_),y=document.createTextNode(""),v.observe(y,{characterData:!0}),b=function(){y.data=g=++g%2}):h?((m=new MessageChannel).port1.onmessage=_,b=function(){return m.port2.postMessage(0)}):b=void 0===l?function(){try{var e=Function("return this")().require("vertx");return void 0!==(r=e.runOnLoop||e.runOnContext)?function(){r(_)}:p()}catch(e){return p()}}():p();var E=Math.random().toString(36).substring(2);function w(){}function T(t,a,n){a.constructor===t.constructor&&n===S&&a.constructor.resolve===A?function(e,t){1===t._state?D(e,t._result):2===t._state?x(e,t._result):L(t,void 0,(function(t){return C(e,t)}),(function(t){return x(e,t)}))}(t,a):void 0===n?D(t,a):e(n)?function(e,t,a){s((function(e){var n=!1,i=function(e,t,a,n){try{e.call(t,a,n)}catch(e){return e}}(a,t,(function(a){n||(n=!0,t!==a?C(e,a):D(e,a))}),(function(t){n||(n=!0,x(e,t))}),e._label);!n&&i&&(n=!0,x(e,i))}),e)}(t,a,n):D(t,a)}function C(e,t){if(e===t)x(e,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(n=t),null===n||"object"!==i&&"function"!==i)D(e,t);else{var a=void 0;try{a=t.then}catch(t){return void x(e,t)}T(e,t,a)}var n,i}function R(e){e._onerror&&e._onerror(e._result),k(e)}function D(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&s(k,e))}function x(e,t){void 0===e._state&&(e._state=2,e._result=t,s(R,e))}function L(e,t,a,n){var i=e._subscribers,r=i.length;e._onerror=null,i[r]=t,i[r+1]=a,i[r+2]=n,0===r&&e._state&&s(k,e)}function k(e){var t=e._subscribers,a=e._state;if(0!==t.length){for(var n=void 0,i=void 0,r=e._result,o=0;o<t.length;o+=3)n=t[o],i=t[o+a],n?B(a,n,i,r):i(r);e._subscribers.length=0}}function B(t,a,n,i){var r=e(n),o=void 0,s=void 0,l=!0;if(r){try{o=n(i)}catch(e){l=!1,s=e}if(a===o)return void x(a,new TypeError("A promises callback cannot return that same promise."))}else o=i;void 0!==a._state||(r&&l?C(a,o):!1===l?x(a,s):1===t?D(a,o):2===t&&x(a,o))}var O=0;function M(e){e[E]=O++,e._state=void 0,e._result=void 0,e._subscribers=[]}var I=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(w),this.promise[E]||M(this.promise),n(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?D(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&D(this.promise,this._result))):x(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var a=this._instanceConstructor,n=a.resolve;if(n===A){var i=void 0,r=void 0,o=!1;try{i=e.then}catch(e){o=!0,r=e}if(i===S&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(a===P){var s=new a(w);o?x(s,r):T(s,e,i),this._willSettleAt(s,t)}else this._willSettleAt(new a((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,a){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?x(n,a):this._result[t]=a),0===this._remaining&&D(n,this._result)},e.prototype._willSettleAt=function(e,t){var a=this;L(e,void 0,(function(e){return a._settledAt(1,t,e)}),(function(e){return a._settledAt(2,t,e)}))},e}(),P=function(){function t(e){this[E]=O++,this._result=this._state=void 0,this._subscribers=[],w!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){C(e,t)}),(function(t){x(e,t)}))}catch(t){x(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var a=this.constructor;return e(t)?this.then((function(e){return a.resolve(t()).then((function(){return e}))}),(function(e){return a.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return P.prototype.then=S,P.all=function(e){return new I(this,e).promise},P.race=function(e){var t=this;return n(e)?new t((function(a,n){for(var i=e.length,r=0;r<i;r++)t.resolve(e[r]).then(a,n)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},P.resolve=A,P.reject=function(e){var t=new this(w);return x(t,e),t},P._setScheduler=function(e){o=e},P._setAsap=function(e){s=e},P._asap=s,P.polyfill=function(){var e=void 0;if(void 0!==a)e=a;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=P},P.Promise=P,P},e.exports=n()}).call(this,a(16),a(17))},function(e,t){var a,n,i=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(a===setTimeout)return setTimeout(e,0);if((a===r||!a)&&setTimeout)return a=setTimeout,setTimeout(e,0);try{return a(e,0)}catch(t){try{return a.call(null,e,0)}catch(t){return a.call(this,e,0)}}}!function(){try{a="function"==typeof setTimeout?setTimeout:r}catch(e){a=r}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var l,d=[],u=!1,c=-1;function h(){u&&l&&(u=!1,l.length?d=l.concat(d):c=-1,d.length&&p())}function p(){if(!u){var e=s(h);u=!0;for(var t=d.length;t;){for(l=d,d=[];++c<t;)l&&l[c].run();c=-1,t=d.length}l=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function _(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];d.push(new f(e,t)),1!==d.length||u||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=_,i.addListener=_,i.once=_,i.off=_,i.removeListener=_,i.removeAllListeners=_,i.emit=_,i.prependListener=_,i.prependOnceListener=_,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch(e){"object"==typeof window&&(a=window)}e.exports=a},function(e,t,a){a.r(t);var n=a(9),i=a(12),r=a(10),o=a(1);t.default=function(e){var t=null,a=function(t,a){e.postMessage({msg:"logcat_callback",data:{type:t,logcat:a}})}.bind(this);function s(t,a){var n={msg:o.a.INIT_SEGMENT,data:{type:t,data:a}};e.postMessage(n,[a.data])}function l(t,a){var n={msg:o.a.MEDIA_SEGMENT,data:{type:t,data:a}};e.postMessage(n,[a.data])}function d(){var t={msg:o.a.LOADING_COMPLETE};e.postMessage(t)}function u(){var t={msg:o.a.RECOVERED_EARLY_EOF};e.postMessage(t)}function c(t){var a={msg:o.a.MEDIA_INFO,data:t};e.postMessage(a)}function h(t){var a={msg:o.a.METADATA_ARRIVED,data:t};e.postMessage(a)}function p(t){var a={msg:o.a.SCRIPTDATA_ARRIVED,data:t};e.postMessage(a)}function f(t){var a={msg:o.a.TIMED_ID3_METADATA_ARRIVED,data:t};e.postMessage(a)}function _(t){var a={msg:o.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,data:t};e.postMessage(a)}function m(t){var a={msg:o.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,data:t};e.postMessage(a)}function g(t){var a={msg:o.a.SMPTE2038_METADATA_ARRIVED,data:t};e.postMessage(a)}function v(t){var a={msg:o.a.SCTE35_METADATA_ARRIVED,data:t};e.postMessage(a)}function y(t){var a={msg:o.a.PES_PRIVATE_DATA_DESCRIPTOR,data:t};e.postMessage(a)}function b(t){var a={msg:o.a.PES_PRIVATE_DATA_ARRIVED,data:t};e.postMessage(a)}function S(t){var a={msg:o.a.STATISTICS_INFO,data:t};e.postMessage(a)}function A(t,a){e.postMessage({msg:o.a.IO_ERROR,data:{type:t,info:a}})}function E(t,a){e.postMessage({msg:o.a.DEMUX_ERROR,data:{type:t,info:a}})}function w(t){e.postMessage({msg:o.a.RECOMMEND_SEEKPOINT,data:t})}i.a.install(),e.addEventListener("message",(function(i){switch(i.data.cmd){case"init":(t=new r.a(i.data.param[0],i.data.param[1])).on(o.a.IO_ERROR,A.bind(this)),t.on(o.a.DEMUX_ERROR,E.bind(this)),t.on(o.a.INIT_SEGMENT,s.bind(this)),t.on(o.a.MEDIA_SEGMENT,l.bind(this)),t.on(o.a.LOADING_COMPLETE,d.bind(this)),t.on(o.a.RECOVERED_EARLY_EOF,u.bind(this)),t.on(o.a.MEDIA_INFO,c.bind(this)),t.on(o.a.METADATA_ARRIVED,h.bind(this)),t.on(o.a.SCRIPTDATA_ARRIVED,p.bind(this)),t.on(o.a.TIMED_ID3_METADATA_ARRIVED,f.bind(this)),t.on(o.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,_.bind(this)),t.on(o.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,m.bind(this)),t.on(o.a.SMPTE2038_METADATA_ARRIVED,g.bind(this)),t.on(o.a.SCTE35_METADATA_ARRIVED,v.bind(this)),t.on(o.a.PES_PRIVATE_DATA_DESCRIPTOR,y.bind(this)),t.on(o.a.PES_PRIVATE_DATA_ARRIVED,b.bind(this)),t.on(o.a.STATISTICS_INFO,S.bind(this)),t.on(o.a.RECOMMEND_SEEKPOINT,w.bind(this));break;case"destroy":t&&(t.destroy(),t=null),e.postMessage({msg:"destroyed"});break;case"start":t.start();break;case"stop":t.stop();break;case"seek":t.seek(i.data.param);break;case"pause":t.pause();break;case"resume":t.resume();break;case"logging_config":var T=i.data.param;n.a.applyConfig(T),!0===T.enableCallback?n.a.addLogListener(a):n.a.removeLogListener(a)}}))}},function(e,t,a){a.r(t);var n=a(12),i=a(11),r={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,liveBufferLatencyChasing:!1,liveBufferLatencyMaxLatency:1.5,liveBufferLatencyMinRemain:.5,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function o(){return Object.assign({},r)}var s=function(){function e(){}return e.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},e.supportMSEH265Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"')},e.supportNetworkStreamIO=function(){var e=new i.a({},o()),t=e.loaderType;return e.destroy(),"fetch-stream-loader"==t||"xhr-moz-chunked-loader"==t},e.getNetworkLoaderTypeName=function(){var e=new i.a({},o()),t=e.loaderType;return e.destroy(),t},e.supportNativeMediaPlayback=function(t){null==e.videoElement&&(e.videoElement=window.document.createElement("video"));var a=e.videoElement.canPlayType(t);return"probably"===a||"maybe"==a},e.getFeatureList=function(){var t={msePlayback:!1,mseLivePlayback:!1,mseH265Playback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeMP4H265Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return t.msePlayback=e.supportMSEH264Playback(),t.networkStreamIO=e.supportNetworkStreamIO(),t.networkLoaderName=e.getNetworkLoaderTypeName(),t.mseLivePlayback=t.msePlayback&&t.networkStreamIO,t.mseH265Playback=e.supportMSEH265Playback(),t.nativeMP4H264Playback=e.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),t.nativeMP4H265Playback=e.supportNativeMediaPlayback('video/mp4; codecs="hvc1.1.6.L93.B0"'),t.nativeWebmVP8Playback=e.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),t.nativeWebmVP9Playback=e.supportNativeMediaPlayback('video/webm; codecs="vp9"'),t},e}(),l=a(2),d=a(6),u=a.n(d),c=a(0),h=a(4),p={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",TIMED_ID3_METADATA_ARRIVED:"timed_id3_metadata_arrived",SYNCHRONOUS_KLV_METADATA_ARRIVED:"synchronous_klv_metadata_arrived",ASYNCHRONOUS_KLV_METADATA_ARRIVED:"asynchronous_klv_metadata_arrived",SMPTE2038_METADATA_ARRIVED:"smpte2038_metadata_arrived",SCTE35_METADATA_ARRIVED:"scte35_metadata_arrived",PES_PRIVATE_DATA_DESCRIPTOR:"pes_private_data_descriptor",PES_PRIVATE_DATA_ARRIVED:"pes_private_data_arrived",STATISTICS_INFO:"statistics_info",DESTROYING:"destroying"},f=a(13),_=a.n(f),m=a(9),g=a(10),v=a(1),y=a(8),b=function(){function e(e,t){if(this.TAG="Transmuxer",this._emitter=new u.a,t.enableWorker&&"undefined"!=typeof Worker)try{this._worker=_()(18),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[e,t]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},m.a.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:m.a.getConfig()})}catch(a){c.a.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new g.a(e,t)}else this._controller=new g.a(e,t);if(this._controller){var a=this._controller;a.on(v.a.IO_ERROR,this._onIOError.bind(this)),a.on(v.a.DEMUX_ERROR,this._onDemuxError.bind(this)),a.on(v.a.INIT_SEGMENT,this._onInitSegment.bind(this)),a.on(v.a.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),a.on(v.a.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),a.on(v.a.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),a.on(v.a.MEDIA_INFO,this._onMediaInfo.bind(this)),a.on(v.a.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),a.on(v.a.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),a.on(v.a.TIMED_ID3_METADATA_ARRIVED,this._onTimedID3MetadataArrived.bind(this)),a.on(v.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,this._onSynchronousKLVMetadataArrived.bind(this)),a.on(v.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,this._onAsynchronousKLVMetadataArrived.bind(this)),a.on(v.a.SMPTE2038_METADATA_ARRIVED,this._onSMPTE2038MetadataArrived.bind(this)),a.on(v.a.SCTE35_METADATA_ARRIVED,this._onSCTE35MetadataArrived.bind(this)),a.on(v.a.PES_PRIVATE_DATA_DESCRIPTOR,this._onPESPrivateDataDescriptor.bind(this)),a.on(v.a.PES_PRIVATE_DATA_ARRIVED,this._onPESPrivateDataArrived.bind(this)),a.on(v.a.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),a.on(v.a.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return e.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),m.a.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.hasWorker=function(){return null!=this._worker},e.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},e.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},e.prototype.seek=function(e){this._worker?this._worker.postMessage({cmd:"seek",param:e}):this._controller.seek(e)},e.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},e.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},e.prototype._onInitSegment=function(e,t){var a=this;Promise.resolve().then((function(){a._emitter.emit(v.a.INIT_SEGMENT,e,t)}))},e.prototype._onMediaSegment=function(e,t){var a=this;Promise.resolve().then((function(){a._emitter.emit(v.a.MEDIA_SEGMENT,e,t)}))},e.prototype._onLoadingComplete=function(){var e=this;Promise.resolve().then((function(){e._emitter.emit(v.a.LOADING_COMPLETE)}))},e.prototype._onRecoveredEarlyEof=function(){var e=this;Promise.resolve().then((function(){e._emitter.emit(v.a.RECOVERED_EARLY_EOF)}))},e.prototype._onMediaInfo=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.MEDIA_INFO,e)}))},e.prototype._onMetaDataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.METADATA_ARRIVED,e)}))},e.prototype._onScriptDataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.SCRIPTDATA_ARRIVED,e)}))},e.prototype._onTimedID3MetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.TIMED_ID3_METADATA_ARRIVED,e)}))},e.prototype._onSynchronousKLVMetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,e)}))},e.prototype._onAsynchronousKLVMetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,e)}))},e.prototype._onSMPTE2038MetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.SMPTE2038_METADATA_ARRIVED,e)}))},e.prototype._onSCTE35MetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.SCTE35_METADATA_ARRIVED,e)}))},e.prototype._onPESPrivateDataDescriptor=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.PES_PRIVATE_DATA_DESCRIPTOR,e)}))},e.prototype._onPESPrivateDataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.PES_PRIVATE_DATA_ARRIVED,e)}))},e.prototype._onStatisticsInfo=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.STATISTICS_INFO,e)}))},e.prototype._onIOError=function(e,t){var a=this;Promise.resolve().then((function(){a._emitter.emit(v.a.IO_ERROR,e,t)}))},e.prototype._onDemuxError=function(e,t){var a=this;Promise.resolve().then((function(){a._emitter.emit(v.a.DEMUX_ERROR,e,t)}))},e.prototype._onRecommendSeekpoint=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.RECOMMEND_SEEKPOINT,e)}))},e.prototype._onLoggingConfigChanged=function(e){this._worker&&this._worker.postMessage({cmd:"logging_config",param:e})},e.prototype._onWorkerMessage=function(e){var t=e.data,a=t.data;if("destroyed"===t.msg||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(t.msg){case v.a.INIT_SEGMENT:case v.a.MEDIA_SEGMENT:this._emitter.emit(t.msg,a.type,a.data);break;case v.a.LOADING_COMPLETE:case v.a.RECOVERED_EARLY_EOF:this._emitter.emit(t.msg);break;case v.a.MEDIA_INFO:Object.setPrototypeOf(a,y.a.prototype),this._emitter.emit(t.msg,a);break;case v.a.METADATA_ARRIVED:case v.a.SCRIPTDATA_ARRIVED:case v.a.TIMED_ID3_METADATA_ARRIVED:case v.a.SYNCHRONOUS_KLV_METADATA_ARRIVED:case v.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED:case v.a.SMPTE2038_METADATA_ARRIVED:case v.a.SCTE35_METADATA_ARRIVED:case v.a.PES_PRIVATE_DATA_DESCRIPTOR:case v.a.PES_PRIVATE_DATA_ARRIVED:case v.a.STATISTICS_INFO:this._emitter.emit(t.msg,a);break;case v.a.IO_ERROR:case v.a.DEMUX_ERROR:this._emitter.emit(t.msg,a.type,a.info);break;case v.a.RECOMMEND_SEEKPOINT:this._emitter.emit(t.msg,a);break;case"logcat_callback":c.a.emitter.emit("log",a.type,a.logcat)}},e}(),S={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"},A=a(7),E=a(3),w=function(){function e(e){this.TAG="MSEController",this._config=e,this._emitter=new u.a,this._config.isLive&&null==this._config.autoCleanupSourceBuffer&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new A.a}return e.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.attachMediaElement=function(e){if(this._mediaSource)throw new E.a("MediaSource has been attached to an HTMLMediaElement!");var t=this._mediaSource=new window.MediaSource;t.addEventListener("sourceopen",this.e.onSourceOpen),t.addEventListener("sourceended",this.e.onSourceEnded),t.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=e,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),e.src=this._mediaSourceObjectURL},e.prototype.detachMediaElement=function(){if(this._mediaSource){var e=this._mediaSource;for(var t in this._sourceBuffers){var a=this._pendingSegments[t];a.splice(0,a.length),this._pendingSegments[t]=null,this._pendingRemoveRanges[t]=null,this._lastInitSegments[t]=null;var n=this._sourceBuffers[t];if(n){if("closed"!==e.readyState){try{e.removeSourceBuffer(n)}catch(e){c.a.e(this.TAG,e.message)}n.removeEventListener("error",this.e.onSourceBufferError),n.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[t]=null,this._sourceBuffers[t]=null}}if("open"===e.readyState)try{e.endOfStream()}catch(e){c.a.e(this.TAG,e.message)}e.removeEventListener("sourceopen",this.e.onSourceOpen),e.removeEventListener("sourceended",this.e.onSourceEnded),e.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},e.prototype.appendInitSegment=function(e,t){if(!this._mediaSource||"open"!==this._mediaSource.readyState)return this._pendingSourceBufferInit.push(e),void this._pendingSegments[e.type].push(e);var a=e,n=""+a.container;a.codec&&a.codec.length>0&&(n+=";codecs="+a.codec);var i=!1;if(c.a.v(this.TAG,"Received Initialization Segment, mimeType: "+n),this._lastInitSegments[a.type]=a,n!==this._mimeTypes[a.type]){if(this._mimeTypes[a.type])c.a.v(this.TAG,"Notice: "+a.type+" mimeType changed, origin: "+this._mimeTypes[a.type]+", target: "+n);else{i=!0;try{var r=this._sourceBuffers[a.type]=this._mediaSource.addSourceBuffer(n);r.addEventListener("error",this.e.onSourceBufferError),r.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(e){return c.a.e(this.TAG,e.message),void this._emitter.emit(S.ERROR,{code:e.code,msg:e.message})}}this._mimeTypes[a.type]=n}t||this._pendingSegments[a.type].push(a),i||this._sourceBuffers[a.type]&&!this._sourceBuffers[a.type].updating&&this._doAppendSegments(),h.a.safari&&"audio/mpeg"===a.container&&a.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=a.mediaDuration/1e3,this._updateMediaSourceDuration())},e.prototype.appendMediaSegment=function(e){var t=e;this._pendingSegments[t.type].push(t),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var a=this._sourceBuffers[t.type];!a||a.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()},e.prototype.seek=function(e){for(var t in this._sourceBuffers)if(this._sourceBuffers[t]){var a=this._sourceBuffers[t];if("open"===this._mediaSource.readyState)try{a.abort()}catch(e){c.a.e(this.TAG,e.message)}this._idrList.clear();var n=this._pendingSegments[t];if(n.splice(0,n.length),"closed"!==this._mediaSource.readyState){for(var i=0;i<a.buffered.length;i++){var r=a.buffered.start(i),o=a.buffered.end(i);this._pendingRemoveRanges[t].push({start:r,end:o})}if(a.updating||this._doRemoveRanges(),h.a.safari){var s=this._lastInitSegments[t];s&&(this._pendingSegments[t].push(s),a.updating||this._doAppendSegments())}}}},e.prototype.endOfStream=function(){var e=this._mediaSource,t=this._sourceBuffers;e&&"open"===e.readyState?t.video&&t.video.updating||t.audio&&t.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,e.endOfStream()):e&&"closed"===e.readyState&&this._hasPendingSegments()&&(this._hasPendingEos=!0)},e.prototype.getNearestKeyframe=function(e){return this._idrList.getLastSyncPointBeforeDts(e)},e.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var e=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var a=this._sourceBuffers[t];if(a){var n=a.buffered;if(n.length>=1&&e-n.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},e.prototype._doCleanupSourceBuffer=function(){var e=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var a=this._sourceBuffers[t];if(a){for(var n=a.buffered,i=!1,r=0;r<n.length;r++){var o=n.start(r),s=n.end(r);if(o<=e&&e<s+3){if(e-o>=this._config.autoCleanupMaxBackwardDuration){i=!0;var l=e-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[t].push({start:o,end:l})}}else s<e&&(i=!0,this._pendingRemoveRanges[t].push({start:o,end:s}))}i&&!a.updating&&this._doRemoveRanges()}}},e.prototype._updateMediaSourceDuration=function(){var e=this._sourceBuffers;if(0!==this._mediaElement.readyState&&"open"===this._mediaSource.readyState&&!(e.video&&e.video.updating||e.audio&&e.audio.updating)){var t=this._mediaSource.duration,a=this._pendingMediaDuration;a>0&&(isNaN(t)||a>t)&&(c.a.v(this.TAG,"Update MediaSource duration from "+t+" to "+a),this._mediaSource.duration=a),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},e.prototype._doRemoveRanges=function(){for(var e in this._pendingRemoveRanges)if(this._sourceBuffers[e]&&!this._sourceBuffers[e].updating)for(var t=this._sourceBuffers[e],a=this._pendingRemoveRanges[e];a.length&&!t.updating;){var n=a.shift();t.remove(n.start,n.end)}},e.prototype._doAppendSegments=function(){var e=this._pendingSegments;for(var t in e)if(this._sourceBuffers[t]&&!this._sourceBuffers[t].updating&&e[t].length>0){var a=e[t].shift();if(a.timestampOffset){var n=this._sourceBuffers[t].timestampOffset,i=a.timestampOffset/1e3;Math.abs(n-i)>.1&&(c.a.v(this.TAG,"Update MPEG audio timestampOffset from "+n+" to "+i),this._sourceBuffers[t].timestampOffset=i),delete a.timestampOffset}if(!a.data||0===a.data.byteLength)continue;try{this._sourceBuffers[t].appendBuffer(a.data),this._isBufferFull=!1,"video"===t&&a.hasOwnProperty("info")&&this._idrList.appendArray(a.info.syncPoints)}catch(e){this._pendingSegments[t].unshift(a),22===e.code?(this._isBufferFull||this._emitter.emit(S.BUFFER_FULL),this._isBufferFull=!0):(c.a.e(this.TAG,e.message),this._emitter.emit(S.ERROR,{code:e.code,msg:e.message}))}}},e.prototype._onSourceOpen=function(){if(c.a.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var e=this._pendingSourceBufferInit;e.length;){var t=e.shift();this.appendInitSegment(t,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(S.SOURCE_OPEN)},e.prototype._onSourceEnded=function(){c.a.v(this.TAG,"MediaSource onSourceEnded")},e.prototype._onSourceClose=function(){c.a.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&null!=this.e&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},e.prototype._hasPendingSegments=function(){var e=this._pendingSegments;return e.video.length>0||e.audio.length>0},e.prototype._hasPendingRemoveRanges=function(){var e=this._pendingRemoveRanges;return e.video.length>0||e.audio.length>0},e.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(S.UPDATE_END)},e.prototype._onSourceBufferError=function(e){c.a.e(this.TAG,"SourceBuffer Error: "+e)},e}(),T=a(5),C={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},R={NETWORK_EXCEPTION:l.b.EXCEPTION,NETWORK_STATUS_CODE_INVALID:l.b.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:l.b.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:l.b.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:T.a.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:T.a.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:T.a.CODEC_UNSUPPORTED},D=function(){function e(e,t){this.TAG="MSEPlayer",this._type="MSEPlayer",this._emitter=new u.a,this._config=o(),"object"==typeof t&&Object.assign(this._config,t);var a=e.type.toLowerCase();if("mse"!==a&&"mpegts"!==a&&"m2ts"!==a&&"flv"!==a)throw new E.b("MSEPlayer requires an mpegts/m2ts/flv MediaDataSource input!");!0===e.isLive&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=e,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var n=h.a.chrome&&(h.a.version.major<50||50===h.a.version.major&&h.a.version.build<2661);this._alwaysSeekKeyframe=!!(n||h.a.msedge||h.a.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return e.prototype.destroy=function(){this._emitter.emit(p.DESTROYING),null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){var a=this;e===p.MEDIA_INFO?null!=this._mediaInfo&&Promise.resolve().then((function(){a._emitter.emit(p.MEDIA_INFO,a.mediaInfo)})):e===p.STATISTICS_INFO&&null!=this._statisticsInfo&&Promise.resolve().then((function(){a._emitter.emit(p.STATISTICS_INFO,a.statisticsInfo)})),this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.attachMediaElement=function(e){var t=this;if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),e.addEventListener("seeking",this.e.onvSeeking),e.addEventListener("canplay",this.e.onvCanPlay),e.addEventListener("stalled",this.e.onvStalled),e.addEventListener("progress",this.e.onvProgress),this._msectl=new w(this._config),this._msectl.on(S.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(S.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(S.SOURCE_OPEN,(function(){t._mseSourceOpened=!0,t._hasPendingLoad&&(t._hasPendingLoad=!1,t.load())})),this._msectl.on(S.ERROR,(function(e){t._emitter.emit(p.ERROR,C.MEDIA_ERROR,R.MEDIA_MSE_ERROR,e)})),this._msectl.attachMediaElement(e),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}},e.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},e.prototype.load=function(){var e=this;if(!this._mediaElement)throw new E.a("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new E.a("MSEPlayer.load() has been called, please call unload() first!");this._hasPendingLoad||(this._config.deferLoadAfterSourceOpen&&!1===this._mseSourceOpened?this._hasPendingLoad=!0:(this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new b(this._mediaDataSource,this._config),this._transmuxer.on(v.a.INIT_SEGMENT,(function(t,a){e._msectl.appendInitSegment(a)})),this._transmuxer.on(v.a.MEDIA_SEGMENT,(function(t,a){if(e._msectl.appendMediaSegment(a),e._config.lazyLoad&&!e._config.isLive){var n=e._mediaElement.currentTime;a.info.endDts>=1e3*(n+e._config.lazyLoadMaxDuration)&&null==e._progressChecker&&(c.a.v(e.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),e._suspendTransmuxer())}})),this._transmuxer.on(v.a.LOADING_COMPLETE,(function(){e._msectl.endOfStream(),e._emitter.emit(p.LOADING_COMPLETE)})),this._transmuxer.on(v.a.RECOVERED_EARLY_EOF,(function(){e._emitter.emit(p.RECOVERED_EARLY_EOF)})),this._transmuxer.on(v.a.IO_ERROR,(function(t,a){e._emitter.emit(p.ERROR,C.NETWORK_ERROR,t,a)})),this._transmuxer.on(v.a.DEMUX_ERROR,(function(t,a){e._emitter.emit(p.ERROR,C.MEDIA_ERROR,t,{code:-1,msg:a})})),this._transmuxer.on(v.a.MEDIA_INFO,(function(t){e._mediaInfo=t,e._emitter.emit(p.MEDIA_INFO,Object.assign({},t))})),this._transmuxer.on(v.a.METADATA_ARRIVED,(function(t){e._emitter.emit(p.METADATA_ARRIVED,t)})),this._transmuxer.on(v.a.SCRIPTDATA_ARRIVED,(function(t){e._emitter.emit(p.SCRIPTDATA_ARRIVED,t)})),this._transmuxer.on(v.a.TIMED_ID3_METADATA_ARRIVED,(function(t){e._emitter.emit(p.TIMED_ID3_METADATA_ARRIVED,t)})),this._transmuxer.on(v.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,(function(t){e._emitter.emit(p.SYNCHRONOUS_KLV_METADATA_ARRIVED,t)})),this._transmuxer.on(v.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,(function(t){e._emitter.emit(p.ASYNCHRONOUS_KLV_METADATA_ARRIVED,t)})),this._transmuxer.on(v.a.SMPTE2038_METADATA_ARRIVED,(function(t){e._emitter.emit(p.SMPTE2038_METADATA_ARRIVED,t)})),this._transmuxer.on(v.a.SCTE35_METADATA_ARRIVED,(function(t){e._emitter.emit(p.SCTE35_METADATA_ARRIVED,t)})),this._transmuxer.on(v.a.PES_PRIVATE_DATA_DESCRIPTOR,(function(t){e._emitter.emit(p.PES_PRIVATE_DATA_DESCRIPTOR,t)})),this._transmuxer.on(v.a.PES_PRIVATE_DATA_ARRIVED,(function(t){e._emitter.emit(p.PES_PRIVATE_DATA_ARRIVED,t)})),this._transmuxer.on(v.a.STATISTICS_INFO,(function(t){e._statisticsInfo=e._fillStatisticsInfo(t),e._emitter.emit(p.STATISTICS_INFO,Object.assign({},e._statisticsInfo))})),this._transmuxer.on(v.a.RECOMMEND_SEEKPOINT,(function(t){e._mediaElement&&!e._config.accurateSeek&&(e._requestSetTime=!0,e._mediaElement.currentTime=t/1e3)})),this._transmuxer.open()))},e.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},e.prototype.play=function(){return this._mediaElement.play()},e.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(e){this._mediaElement.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(e){this._mediaElement.muted=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(e){this._mediaElement?this._internalSeek(e):this._pendingSeekTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statisticsInfo",{get:function(){return null==this._statisticsInfo&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),e.prototype._fillStatisticsInfo=function(e){if(e.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return e;var t=!0,a=0,n=0;if(this._mediaElement.getVideoPlaybackQuality){var i=this._mediaElement.getVideoPlaybackQuality();a=i.totalVideoFrames,n=i.droppedVideoFrames}else null!=this._mediaElement.webkitDecodedFrameCount?(a=this._mediaElement.webkitDecodedFrameCount,n=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=a,e.droppedFrames=n),e},e.prototype._onmseUpdateEnd=function(){var e=this._mediaElement.buffered,t=this._mediaElement.currentTime;if(this._config.isLive&&this._config.liveBufferLatencyChasing&&e.length>0&&!this._mediaElement.paused){var a=e.end(e.length-1);if(a>this._config.liveBufferLatencyMaxLatency&&a-t>this._config.liveBufferLatencyMaxLatency){var n=a-this._config.liveBufferLatencyMinRemain;this.currentTime=n}}if(this._config.lazyLoad&&!this._config.isLive){for(var i=0,r=0;r<e.length;r++){var o=e.start(r),s=e.end(r);if(o<=t&&t<s){i=s;break}}i>=t+this._config.lazyLoadMaxDuration&&null==this._progressChecker&&(c.a.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},e.prototype._onmseBufferFull=function(){c.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),null==this._progressChecker&&this._suspendTransmuxer()},e.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),null==this._progressChecker&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},e.prototype._checkProgressAndResume=function(){for(var e=this._mediaElement.currentTime,t=this._mediaElement.buffered,a=!1,n=0;n<t.length;n++){var i=t.start(n),r=t.end(n);if(e>=i&&e<r){e>=r-this._config.lazyLoadRecoverDuration&&(a=!0);break}}a&&(window.clearInterval(this._progressChecker),this._progressChecker=null,a&&(c.a.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},e.prototype._isTimepointBuffered=function(e){for(var t=this._mediaElement.buffered,a=0;a<t.length;a++){var n=t.start(a),i=t.end(a);if(e>=n&&e<i)return!0}return!1},e.prototype._internalSeek=function(e){var t=this._isTimepointBuffered(e),a=!1,n=0;if(e<1&&this._mediaElement.buffered.length>0){var i=this._mediaElement.buffered.start(0);(i<1&&e<i||h.a.safari)&&(a=!0,n=h.a.safari?.1:i)}if(a)this._requestSetTime=!0,this._mediaElement.currentTime=n;else if(t){if(this._alwaysSeekKeyframe){var r=this._msectl.getNearestKeyframe(Math.floor(1e3*e));this._requestSetTime=!0,this._mediaElement.currentTime=null!=r?r.dts/1e3:e}else this._requestSetTime=!0,this._mediaElement.currentTime=e;null!=this._progressChecker&&this._checkProgressAndResume()}else null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(e),this._transmuxer.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e)},e.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var e=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(e)||(null!=this._progressChecker&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(e),this._transmuxer.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},e.prototype._checkAndResumeStuckPlayback=function(e){var t=this._mediaElement;if(e||!this._receivedCanPlay||t.readyState<2){var a=t.buffered;a.length>0&&t.currentTime<a.start(0)&&(c.a.w(this.TAG,"Playback seems stuck at "+t.currentTime+", seek to "+a.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=a.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},e.prototype._onvLoadedMetadata=function(e){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},e.prototype._onvSeeking=function(e){var t=this._mediaElement.currentTime,a=this._mediaElement.buffered;if(this._requestSetTime)this._requestSetTime=!1;else{if(t<1&&a.length>0){var n=a.start(0);if(n<1&&t<n||h.a.safari)return this._requestSetTime=!0,void(this._mediaElement.currentTime=h.a.safari?.1:n)}if(this._isTimepointBuffered(t)){if(this._alwaysSeekKeyframe){var i=this._msectl.getNearestKeyframe(Math.floor(1e3*t));null!=i&&(this._requestSetTime=!0,this._mediaElement.currentTime=i.dts/1e3)}null!=this._progressChecker&&this._checkProgressAndResume()}else this._seekpointRecord={seekPoint:t,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}},e.prototype._onvCanPlay=function(e){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},e.prototype._onvStalled=function(e){this._checkAndResumeStuckPlayback(!0)},e.prototype._onvProgress=function(e){this._checkAndResumeStuckPlayback()},e}(),x=function(){function e(e,t){this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new u.a,this._config=o(),"object"==typeof t&&Object.assign(this._config,t);var a=e.type.toLowerCase();if("mse"===a||"mpegts"===a||"m2ts"===a||"flv"===a)throw new E.b("NativePlayer does't support mse/mpegts/m2ts/flv MediaDataSource input!");if(e.hasOwnProperty("segments"))throw new E.b("NativePlayer("+e.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=e,this._mediaElement=null}return e.prototype.destroy=function(){this._emitter.emit(p.DESTROYING),this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){var a=this;e===p.MEDIA_INFO?null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then((function(){a._emitter.emit(p.MEDIA_INFO,a.mediaInfo)})):e===p.STATISTICS_INFO&&null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then((function(){a._emitter.emit(p.STATISTICS_INFO,a.statisticsInfo)})),this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.attachMediaElement=function(e){if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}},e.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype.load=function(){if(!this._mediaElement)throw new E.a("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},e.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype.play=function(){return this._mediaElement.play()},e.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(e){this._mediaElement.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(e){this._mediaElement.muted=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(e){this._mediaElement?this._mediaElement.currentTime=e:this._pendingSeekTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mediaInfo",{get:function(){var e={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(e.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(e.width=this._mediaElement.videoWidth,e.height=this._mediaElement.videoHeight)),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statisticsInfo",{get:function(){var e={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return e;var t=!0,a=0,n=0;if(this._mediaElement.getVideoPlaybackQuality){var i=this._mediaElement.getVideoPlaybackQuality();a=i.totalVideoFrames,n=i.droppedVideoFrames}else null!=this._mediaElement.webkitDecodedFrameCount?(a=this._mediaElement.webkitDecodedFrameCount,n=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=a,e.droppedFrames=n),e},enumerable:!1,configurable:!0}),e.prototype._onvLoadedMetadata=function(e){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(p.MEDIA_INFO,this.mediaInfo)},e.prototype._reportStatisticsInfo=function(){this._emitter.emit(p.STATISTICS_INFO,this.statisticsInfo)},e}();n.a.install();var L={createPlayer:function(e,t){var a=e;if(null==a||"object"!=typeof a)throw new E.b("MediaDataSource must be an javascript object!");if(!a.hasOwnProperty("type"))throw new E.b("MediaDataSource must has type field to indicate video file type!");switch(a.type){case"mse":case"mpegts":case"m2ts":case"flv":return new D(a,t);default:return new x(a,t)}},isSupported:function(){return s.supportMSEH264Playback()},getFeatureList:function(){return s.getFeatureList()}};L.BaseLoader=l.a,L.LoaderStatus=l.c,L.LoaderErrors=l.b,L.Events=p,L.ErrorTypes=C,L.ErrorDetails=R,L.MSEPlayer=D,L.NativePlayer=x,L.LoggingControl=m.a,Object.defineProperty(L,"version",{enumerable:!0,get:function(){return"1.7.3"}}),t.default=L}]);var bl=Wo(yl.exports);const Sl=Ce("video-player");var Al=o({name:"NextVideoPlayer",props:{className:{type:String,default:""},style:{type:Object,default:()=>({})},type:{type:String,default:"mp4",values:["mp4","m3u8","flv","mpegts"]},src:{type:String,default:""},tensorflow:{type:Object}},emits:["play","error","detector"],setup(e,{emit:t,expose:n}){const{lang:i}=pi(),r={"zh-cn":ye,en:be,"zh-tw":Se};r[i.value]?ve.addLanguage("zh-CN",r[i.value]):ve.addLanguage("zh-CN",ye);const o=w(e.src),d=a(),u=a(),c=a(),h=a(),p=a(),f=a(null),_=a(null),m=e=>{const t=s({render:()=>S("span",{class:"screemshot-btn",onClick:()=>((e,t)=>{const a=fe(_e(),"YYYY-MM-DD_HH-mm-ss").value,n=e.el().getElementsByTagName("video")[0],i=document.createElement("canvas"),r=n.videoWidth,o=n.videoHeight;i.width=r,i.height=o;const s=i.getContext("2d"),l=r/o,d=i.width/i.height,u=r,c=o;let h,p,f,_;l>d?(f=i.width,_=i.width/l,h=0,p=Math.round((i.height-_)/2)):l===d?(f=i.width,_=i.height,h=0,p=0):l<d&&(f=i.height*l,_=i.height,h=Math.round((i.width-f)/2),p=0),s.drawImage(n,0,0,u,c,h,p,f,_),t&&s.drawImage(t,0,0);const m="image/png";let g=i.toDataURL(m,.92).replace(m,"image/octet-stream");g=g.replace(/^data:image\/[^;]+/,"data:application/octet-stream");const v=document.createElement("a");v.href=g,v.download=a+"_screenshot.png",v.click()})(c.value,_.value)},[S(I,{color:"#FFFFFF",size:"22px"},{default:()=>S($i)})])});c.value.on("loadedmetadata",(()=>{T(t,e)}))},g=(t,a)=>{if(!e.tensorflow)return;const{modelUrl:n,classNames:i}=e.tensorflow;if(!n)throw new Error("模型文件地址不能未空！");if(!i||!i.length)throw new Error("模型类别不能未空！");t.innerHTML="",ge.loadGraphModel(n).then((e=>{const n=document.createElement("canvas");n.className=Sl.b("recongition"),t.appendChild(n);const r=n.getContext("2d"),o=document.createElement("canvas").getContext("2d");a.ontimeupdate=()=>{const{videoWidth:t,videoHeight:s,offsetTop:l,offsetLeft:d}=a;n.width=t,n.height=s,n.style.top=l+"px",n.style.left=d+"px",Ai(a,e,r,ge,i,[],o)},f.value=e,_.value=n}))};A((()=>{f.value&&(ge.dispose(),f.value.dispose(),f.value=null),c.value&&(c.value.mse&&(c.value.mse.endOfStream(),c.value.mse.unload(),c.value.mse=null),c.value.pause(),c.value.dispose(),c.value=null),h.value&&(h.value.pause(),h.value.unload(),h.value.detachMediaElement(),h.value.destroy(),h.value=null),p.value&&(p.value.pause(),p.value.unload(),p.value.detachMediaElement(),p.value.destroy(),p.value=null),d.value&&T(null,d.value)}));const v=a=>{if(!a)return(()=>{const e=d.value,a=document.createElement("video");a.className="video-js vjs-default-skin",a.setAttribute("autoplay","true"),a.setAttribute("muted","true"),u.value=a,e.appendChild(a),c.value=ve(a,{techOrder:["html5"],controls:!0,fluid:!0,preload:"auto",language:"zh-CN",sources:[]});const n=document.createElement("div");e.children[0].appendChild(n),c.value.on("play",(()=>{t("play",a,e),g(n,a)})),m(e)})(),!1;const n=e.type;"m3u8"===n?(e=>{const a=d.value,n=document.createElement("video");n.className="video-js vjs-default-skin",n.setAttribute("autoplay","true"),n.setAttribute("muted","true"),u.value=n,a.appendChild(n);const i={techOrder:["html5"],flvjs:{mediaDataSource:{cors:!0,withCredentials:!1}},controls:!0,fluid:!0,preload:"auto",language:"zh-CN",sources:[{src:e,type:"application/x-mpegURL"}]};c.value=ve(n,i);const r=document.createElement("div");a.children[0].appendChild(r),c.value.on("play",(()=>{t("play",n,a),g(r,n)})),m(a)})(a):"mp4"===n?(e=>{const a=d.value,n=document.createElement("video");n.className="video-js vjs-default-skin",n.setAttribute("autoplay","true"),n.setAttribute("muted","true"),u.value=n,a.appendChild(n);const i={techOrder:["html5"],controls:!0,fluid:!0,preload:"auto",language:"zh-CN",sources:[{src:e,type:"video/mp4"}]};c.value=ve(n,i);const r=document.createElement("div");a.children[0].appendChild(r),c.value.on("play",(()=>{t("play",n,a),g(r,n)})),m(a)})(a):"mpegts"===n?(e=>{const a=window.mpegts||bl;if(a&&a.getFeatureList().mseLivePlayback){const n=d.value,i=document.createElement("video");i.className="video-js vjs-default-skin",i.setAttribute("autoplay","true"),i.setAttribute("muted","true"),u.value=i,n.appendChild(i);const r={controls:!0,autoplay:!0,fluid:!0,muted:!0,liveui:!0,preload:"auto",language:"zh-CN"};c.value=ve(i,r),p.value=a.createPlayer({enableWorker:!0,type:"flv",isLive:!0,url:e}),p.value.attachMediaElement(i),p.value.load(),p.value.play(),p.value.on("error",(()=>{t("error",i)})),m(n);const o=document.createElement("div");n.children[0].appendChild(o),p.value.on("metadata_arrived",(()=>{t("play",i,n),g(o,i)}))}})(a):"flv"===n&&(e=>{const a=d.value,n=document.createElement("video");n.className="video-js vjs-default-skin",n.setAttribute("autoplay","true"),n.setAttribute("muted","true"),u.value=n,a.appendChild(n);const i={techOrder:["html5"],flvjs:{mediaDataSource:{cors:!0,withCredentials:!1}},controls:!0,fluid:!0,preload:"auto",language:"zh-CN",sources:[{src:e,type:"video/x-flv"}]};c.value=ve(n,i);const r=document.createElement("div");a.children[0].appendChild(r),c.value.on("play",(()=>{t("play",n,a),g(r,n)})),m(a)})(a)};E((()=>{C((()=>{v(o)}))}));n({getElement:()=>{const e=d.value,t=e.children[0];return{videoElement:u.value,container:e,palyerContainer:t}}});return()=>s(l,null,[s("div",{ref:d,class:[Sl.b(),e.className],style:e.style},null)])}});const El=Ti(Al);const wl=Ti(o({name:"NextDragResize",props:{},setup:()=>()=>s(l,null,[s(l,null,null)])}));var Tl=Object.freeze({__proto__:null,NextContainer:qo,NextCrudTable:_l,NextDialog:tl,NextDragResize:wl,NextForm:ul,NextLayout:jo,NextMenu:yo,NextSpinLoading:ml,NextTabs:Go,NextTextEllipsis:ki,NextUpload:vl,NextVideoPlayer:El});const Cl=e=>{e.directive("zoom",{mounted(e,t){if(!t.value)return!1;const a="string"==typeof(n=t.value)||!Ge(n)&&je(n)&&"[object String]"==Ve(n)?[t.value,".el-dialog__body",!1,!0]:t.value;var n;a[1]=a[1]?a[1]:".el-dialog__body",a[2]=void 0!==a[2]&&a[2],a[3]=void 0===a[3]||a[3],C((()=>{const e=document.querySelector(a[1]),t=document.querySelector(a[0]),n=document.createElement("div");n.className="dialog-zoom",n.onmouseenter=()=>{n.onmousedown=n=>{const i=n.clientX,r=n.clientY,o=e.offsetWidth,s=e.offsetHeight,l=t.offsetWidth,d=t.offsetHeight;document.onmousemove=n=>{n.preventDefault();const u=o+2*(n.clientX-i),c=s+(n.clientY-r);if(e.style.width=`${u}px`,e.style.height=`${c}px`,a[2]){const e=d+(n.clientY-r);t.style.height=`${e}px`}if(a[3]){const e=l+2*(n.clientX-i);t.style.width=`${e}px`}},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null}}},t.appendChild(n)}))}})},Rl="0.1.17",Dl=function(e){Object.keys(Tl).forEach((t=>{const a=Tl[t];e.component(a.name,a)})),(e=>{Cl(e)})(e)};var xl={version:Rl,install:Dl};export{qo as NextContainer,_l as NextCrudTable,tl as NextDialog,wl as NextDragResize,ul as NextForm,jo as NextLayout,yo as NextMenu,ml as NextSpinLoading,Go as NextTabs,ki as NextTextEllipsis,vl as NextUpload,El as NextVideoPlayer,ci as buildLocaleContext,ui as buildTranslator,xl as default,Ae as defaultNamespace,Dl as install,hi as localeContextKey,li as localeLang,we as namespaceContextKey,vi as nextUseCssTheme,gi as nextUseCssVar,di as translate,yi as updateThemeColor,Si as updateThemeColorCssVar,wi as useDetectVideo,Te as useGetDerivedNamespace,fi as useLanguage,pi as useLocale,Ce as useNamespace,Rl as version};
