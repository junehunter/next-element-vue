!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("vue"),require("element-plus"),require("@vueuse/core"),require("@tensorflow/tfjs"),require("video.js"),require("video.js/dist/video-js.css"),require("video.js/dist/lang/zh-CN.json"),require("video.js/dist/lang/en.json"),require("video.js/dist/lang/zh-TW.json")):"function"==typeof define&&define.amd?define(["exports","vue","element-plus","@vueuse/core","@tensorflow/tfjs","video.js","video.js/dist/video-js.css","video.js/dist/lang/zh-CN.json","video.js/dist/lang/en.json","video.js/dist/lang/zh-TW.json"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).NEXT_ELEMENT={},e.Vue,e.ElementPlus,e.VueuseCore,e.tf,e.videojs,null,e.zhCN,e.En,e.zhTW)}(this,(function(e,t,a,n,i,r,o,s,l,d){"use strict";function c(e){var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var n=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,n.get?n:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var u=c(i);const h="next",p=(e,t,a,n,i)=>{let r=`${e}-${t}`;return a&&(r+=`-${a}`),n&&(r+=`__${n}`),i&&(r+=`--${i}`),r},f=Symbol("namespaceContextKey"),_=e=>{const a=e||(t.getCurrentInstance()?t.inject(f,t.ref(h)):t.ref(h));return t.computed((()=>t.unref(a)||h))},m=(e,t)=>{const a=_(t);return{namespace:a,b:(t="")=>p(a.value,e,t,"",""),e:t=>t?p(a.value,e,"",t,""):"",m:t=>t?p(a.value,e,"","",t):"",be:(t,n)=>t&&n?p(a.value,e,t,n,""):"",em:(t,n)=>t&&n?p(a.value,e,"",t,n):"",bm:(t,n)=>t&&n?p(a.value,e,t,"",n):"",bem:(t,n,i)=>t&&n&&i?p(a.value,e,t,n,i):"",bf:(...t)=>{let n=`${a.value}-${e}`;for(const e in t){const a=t[e];a&&(n+="-"+a)}return n},is:(e,...t)=>{const a=!(t.length>=1)||t[0];return e&&a?`is-${e}`:""},cssVar:e=>{const t={};for(const n in e)e[n]&&(t[`--${a.value}-${n}`]=e[n]);return t},cssVarName:e=>`--${a.value}-${e}`,cssVarBlock:t=>{const n={};for(const i in t)t[i]&&(n[`--${a.value}-${e}-${i}`]=t[i]);return n},cssVarBlockName:t=>`--${a.value}-${e}-${t}`}};var g="object"==typeof global&&global&&global.Object===Object&&global,v="object"==typeof self&&self&&self.Object===Object&&self,y=g||v||Function("return this")(),b=y.Symbol,E=Object.prototype,S=E.hasOwnProperty,A=E.toString,w=b?b.toStringTag:void 0;var C=Object.prototype.toString;var T="[object Null]",R="[object Undefined]",D=b?b.toStringTag:void 0;function k(e){return null==e?void 0===e?R:T:D&&D in Object(e)?function(e){var t=S.call(e,w),a=e[w];try{e[w]=void 0;var n=!0}catch(e){}var i=A.call(e);return n&&(t?e[w]=a:delete e[w]),i}(e):function(e){return C.call(e)}(e)}function x(e){return null!=e&&"object"==typeof e}var L="[object Symbol]";function N(e){return"symbol"==typeof e||x(e)&&k(e)==L}var B=Array.isArray,V=1/0,M=b?b.prototype:void 0,O=M?M.toString:void 0;function I(e){if("string"==typeof e)return e;if(B(e))return function(e,t){for(var a=-1,n=null==e?0:e.length,i=Array(n);++a<n;)i[a]=t(e[a],a,e);return i}(e,I)+"";if(N(e))return O?O.call(e):"";var t=e+"";return"0"==t&&1/e==-V?"-0":t}function P(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function U(e){return e}var j="[object AsyncFunction]",F="[object Function]",z="[object GeneratorFunction]",G="[object Proxy]";function H(e){if(!P(e))return!1;var t=k(e);return t==F||t==z||t==j||t==G}var q,W=y["__core-js_shared__"],K=(q=/[^.]+$/.exec(W&&W.keys&&W.keys.IE_PROTO||""))?"Symbol(src)_1."+q:"";var Y=Function.prototype.toString;function $(e){if(null!=e){try{return Y.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var X=/^\[object .+?Constructor\]$/,Z=Function.prototype,J=Object.prototype,Q=Z.toString,ee=J.hasOwnProperty,te=RegExp("^"+Q.call(ee).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ae(e){return!(!P(e)||(t=e,K&&K in t))&&(H(e)?te:X).test($(e));var t}function ne(e,t){var a=function(e,t){return null==e?void 0:e[t]}(e,t);return ae(a)?a:void 0}var ie=ne(y,"WeakMap"),re=Object.create,oe=function(){function e(){}return function(t){if(!P(t))return{};if(re)return re(t);e.prototype=t;var a=new e;return e.prototype=void 0,a}}(),se=oe;var le=Date.now;var de,ce,ue,he=function(){try{var e=ne(Object,"defineProperty");return e({},"",{}),e}catch(e){}}(),pe=he,fe=pe?function(e,t){return pe(e,"toString",{configurable:!0,enumerable:!1,value:(a=t,function(){return a}),writable:!0});var a}:U,_e=(de=fe,ce=0,ue=0,function(){var e=le(),t=16-(e-ue);if(ue=e,t>0){if(++ce>=800)return arguments[0]}else ce=0;return de.apply(void 0,arguments)}),me=_e,ge=9007199254740991,ve=/^(?:0|[1-9]\d*)$/;function ye(e,t){var a=typeof e;return!!(t=null==t?ge:t)&&("number"==a||"symbol"!=a&&ve.test(e))&&e>-1&&e%1==0&&e<t}function be(e,t,a){"__proto__"==t&&pe?pe(e,t,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[t]=a}function Ee(e,t){return e===t||e!=e&&t!=t}var Se=Object.prototype.hasOwnProperty;function Ae(e,t,a){var n=e[t];Se.call(e,t)&&Ee(n,a)&&(void 0!==a||t in e)||be(e,t,a)}var we=Math.max;function Ce(e,t){return me(function(e,t,a){return t=we(void 0===t?e.length-1:t,0),function(){for(var n=arguments,i=-1,r=we(n.length-t,0),o=Array(r);++i<r;)o[i]=n[t+i];i=-1;for(var s=Array(t+1);++i<t;)s[i]=n[i];return s[t]=a(o),function(e,t,a){switch(a.length){case 0:return e.call(t);case 1:return e.call(t,a[0]);case 2:return e.call(t,a[0],a[1]);case 3:return e.call(t,a[0],a[1],a[2])}return e.apply(t,a)}(e,this,s)}}(e,t,U),e+"")}var Te=9007199254740991;function Re(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Te}function De(e){return null!=e&&Re(e.length)&&!H(e)}function ke(e){return Ce((function(t,a){var n=-1,i=a.length,r=i>1?a[i-1]:void 0,o=i>2?a[2]:void 0;for(r=e.length>3&&"function"==typeof r?(i--,r):void 0,o&&function(e,t,a){if(!P(a))return!1;var n=typeof t;return!!("number"==n?De(a)&&ye(t,a.length):"string"==n&&t in a)&&Ee(a[t],e)}(a[0],a[1],o)&&(r=i<3?void 0:r,i=1),t=Object(t);++n<i;){var s=a[n];s&&e(t,s,n,r)}return t}))}var xe=Object.prototype;function Le(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||xe)}function Ne(e){return x(e)&&"[object Arguments]"==k(e)}var Be=Object.prototype,Ve=Be.hasOwnProperty,Me=Be.propertyIsEnumerable,Oe=Ne(function(){return arguments}())?Ne:function(e){return x(e)&&Ve.call(e,"callee")&&!Me.call(e,"callee")},Ie=Oe;var Pe="object"==typeof e&&e&&!e.nodeType&&e,Ue=Pe&&"object"==typeof module&&module&&!module.nodeType&&module,je=Ue&&Ue.exports===Pe?y.Buffer:void 0,Fe=(je?je.isBuffer:void 0)||function(){return!1},ze={};ze["[object Float32Array]"]=ze["[object Float64Array]"]=ze["[object Int8Array]"]=ze["[object Int16Array]"]=ze["[object Int32Array]"]=ze["[object Uint8Array]"]=ze["[object Uint8ClampedArray]"]=ze["[object Uint16Array]"]=ze["[object Uint32Array]"]=!0,ze["[object Arguments]"]=ze["[object Array]"]=ze["[object ArrayBuffer]"]=ze["[object Boolean]"]=ze["[object DataView]"]=ze["[object Date]"]=ze["[object Error]"]=ze["[object Function]"]=ze["[object Map]"]=ze["[object Number]"]=ze["[object Object]"]=ze["[object RegExp]"]=ze["[object Set]"]=ze["[object String]"]=ze["[object WeakMap]"]=!1;var Ge="object"==typeof e&&e&&!e.nodeType&&e,He=Ge&&"object"==typeof module&&module&&!module.nodeType&&module,qe=He&&He.exports===Ge&&g.process,We=function(){try{var e=He&&He.require&&He.require("util").types;return e||qe&&qe.binding&&qe.binding("util")}catch(e){}}(),Ke=We&&We.isTypedArray,Ye=Ke?function(e){return function(t){return e(t)}}(Ke):function(e){return x(e)&&Re(e.length)&&!!ze[k(e)]},$e=Ye,Xe=Object.prototype.hasOwnProperty;function Ze(e,t){var a=B(e),n=!a&&Ie(e),i=!a&&!n&&Fe(e),r=!a&&!n&&!i&&$e(e),o=a||n||i||r,s=o?function(e,t){for(var a=-1,n=Array(e);++a<e;)n[a]=t(a);return n}(e.length,String):[],l=s.length;for(var d in e)!t&&!Xe.call(e,d)||o&&("length"==d||i&&("offset"==d||"parent"==d)||r&&("buffer"==d||"byteLength"==d||"byteOffset"==d)||ye(d,l))||s.push(d);return s}function Je(e,t){return function(a){return e(t(a))}}var Qe=Je(Object.keys,Object),et=Object.prototype.hasOwnProperty;function tt(e){return De(e)?Ze(e):function(e){if(!Le(e))return Qe(e);var t=[];for(var a in Object(e))et.call(e,a)&&"constructor"!=a&&t.push(a);return t}(e)}var at=Object.prototype.hasOwnProperty;function nt(e){if(!P(e))return function(e){var t=[];if(null!=e)for(var a in Object(e))t.push(a);return t}(e);var t=Le(e),a=[];for(var n in e)("constructor"!=n||!t&&at.call(e,n))&&a.push(n);return a}function it(e){return De(e)?Ze(e,!0):nt(e)}var rt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ot=/^\w*$/;var st=ne(Object,"create");var lt=Object.prototype.hasOwnProperty;var dt=Object.prototype.hasOwnProperty;function ct(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var n=e[t];this.set(n[0],n[1])}}function ut(e,t){for(var a=e.length;a--;)if(Ee(e[a][0],t))return a;return-1}ct.prototype.clear=function(){this.__data__=st?st(null):{},this.size=0},ct.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ct.prototype.get=function(e){var t=this.__data__;if(st){var a=t[e];return"__lodash_hash_undefined__"===a?void 0:a}return lt.call(t,e)?t[e]:void 0},ct.prototype.has=function(e){var t=this.__data__;return st?void 0!==t[e]:dt.call(t,e)},ct.prototype.set=function(e,t){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=st&&void 0===t?"__lodash_hash_undefined__":t,this};var ht=Array.prototype.splice;function pt(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var n=e[t];this.set(n[0],n[1])}}pt.prototype.clear=function(){this.__data__=[],this.size=0},pt.prototype.delete=function(e){var t=this.__data__,a=ut(t,e);return!(a<0)&&(a==t.length-1?t.pop():ht.call(t,a,1),--this.size,!0)},pt.prototype.get=function(e){var t=this.__data__,a=ut(t,e);return a<0?void 0:t[a][1]},pt.prototype.has=function(e){return ut(this.__data__,e)>-1},pt.prototype.set=function(e,t){var a=this.__data__,n=ut(a,e);return n<0?(++this.size,a.push([e,t])):a[n][1]=t,this};var ft=ne(y,"Map");function _t(e,t){var a,n,i=e.__data__;return("string"==(n=typeof(a=t))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==a:null===a)?i["string"==typeof t?"string":"hash"]:i.map}function mt(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var n=e[t];this.set(n[0],n[1])}}mt.prototype.clear=function(){this.size=0,this.__data__={hash:new ct,map:new(ft||pt),string:new ct}},mt.prototype.delete=function(e){var t=_t(this,e).delete(e);return this.size-=t?1:0,t},mt.prototype.get=function(e){return _t(this,e).get(e)},mt.prototype.has=function(e){return _t(this,e).has(e)},mt.prototype.set=function(e,t){var a=_t(this,e),n=a.size;return a.set(e,t),this.size+=a.size==n?0:1,this};var gt="Expected a function";function vt(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(gt);var a=function(){var n=arguments,i=t?t.apply(this,n):n[0],r=a.cache;if(r.has(i))return r.get(i);var o=e.apply(this,n);return a.cache=r.set(i,o)||r,o};return a.cache=new(vt.Cache||mt),a}vt.Cache=mt;var yt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bt=/\\(\\)?/g,Et=function(e){var t=vt(e,(function(e){return 500===a.size&&a.clear(),e})),a=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(yt,(function(e,a,n,i){t.push(n?i.replace(bt,"$1"):a||e)})),t})),St=Et;function At(e,t){return B(e)?e:function(e,t){if(B(e))return!1;var a=typeof e;return!("number"!=a&&"symbol"!=a&&"boolean"!=a&&null!=e&&!N(e))||ot.test(e)||!rt.test(e)||null!=t&&e in Object(t)}(e,t)?[e]:St(function(e){return null==e?"":I(e)}(e))}var wt=1/0;function Ct(e){if("string"==typeof e||N(e))return e;var t=e+"";return"0"==t&&1/e==-wt?"-0":t}function Tt(e,t,a){var n=null==e?void 0:function(e,t){for(var a=0,n=(t=At(t,e)).length;null!=e&&a<n;)e=e[Ct(t[a++])];return a&&a==n?e:void 0}(e,t);return void 0===n?a:n}var Rt=Je(Object.getPrototypeOf,Object),Dt="[object Object]",kt=Function.prototype,xt=Object.prototype,Lt=kt.toString,Nt=xt.hasOwnProperty,Bt=Lt.call(Object);function Vt(e){var t=this.__data__=new pt(e);this.size=t.size}Vt.prototype.clear=function(){this.__data__=new pt,this.size=0},Vt.prototype.delete=function(e){var t=this.__data__,a=t.delete(e);return this.size=t.size,a},Vt.prototype.get=function(e){return this.__data__.get(e)},Vt.prototype.has=function(e){return this.__data__.has(e)},Vt.prototype.set=function(e,t){var a=this.__data__;if(a instanceof pt){var n=a.__data__;if(!ft||n.length<199)return n.push([e,t]),this.size=++a.size,this;a=this.__data__=new mt(n)}return a.set(e,t),this.size=a.size,this};var Mt="object"==typeof e&&e&&!e.nodeType&&e,Ot=Mt&&"object"==typeof module&&module&&!module.nodeType&&module,It=Ot&&Ot.exports===Mt?y.Buffer:void 0,Pt=It?It.allocUnsafe:void 0;var Ut=Object.prototype.propertyIsEnumerable,jt=Object.getOwnPropertySymbols,Ft=jt?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var a=-1,n=null==e?0:e.length,i=0,r=[];++a<n;){var o=e[a];t(o,a,e)&&(r[i++]=o)}return r}(jt(e),(function(t){return Ut.call(e,t)})))}:function(){return[]},zt=Ft;function Gt(e){return function(e,t,a){var n=t(e);return B(e)?n:function(e,t){for(var a=-1,n=t.length,i=e.length;++a<n;)e[i+a]=t[a];return e}(n,a(e))}(e,tt,zt)}var Ht=ne(y,"DataView"),qt=ne(y,"Promise"),Wt=ne(y,"Set"),Kt="[object Map]",Yt="[object Promise]",$t="[object Set]",Xt="[object WeakMap]",Zt="[object DataView]",Jt=$(Ht),Qt=$(ft),ea=$(qt),ta=$(Wt),aa=$(ie),na=k;(Ht&&na(new Ht(new ArrayBuffer(1)))!=Zt||ft&&na(new ft)!=Kt||qt&&na(qt.resolve())!=Yt||Wt&&na(new Wt)!=$t||ie&&na(new ie)!=Xt)&&(na=function(e){var t=k(e),a="[object Object]"==t?e.constructor:void 0,n=a?$(a):"";if(n)switch(n){case Jt:return Zt;case Qt:return Kt;case ea:return Yt;case ta:return $t;case aa:return Xt}return t});var ia=na,ra=y.Uint8Array;function oa(e,t){var a,n,i=t?(a=e.buffer,n=new a.constructor(a.byteLength),new ra(n).set(new ra(a)),n):e.buffer;return new e.constructor(i,e.byteOffset,e.length)}function sa(e){var t=-1,a=null==e?0:e.length;for(this.__data__=new mt;++t<a;)this.add(e[t])}function la(e,t){for(var a=-1,n=null==e?0:e.length;++a<n;)if(t(e[a],a,e))return!0;return!1}sa.prototype.add=sa.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},sa.prototype.has=function(e){return this.__data__.has(e)};var da=1,ca=2;function ua(e,t,a,n,i,r){var o=a&da,s=e.length,l=t.length;if(s!=l&&!(o&&l>s))return!1;var d=r.get(e),c=r.get(t);if(d&&c)return d==t&&c==e;var u=-1,h=!0,p=a&ca?new sa:void 0;for(r.set(e,t),r.set(t,e);++u<s;){var f=e[u],_=t[u];if(n)var m=o?n(_,f,u,t,e,r):n(f,_,u,e,t,r);if(void 0!==m){if(m)continue;h=!1;break}if(p){if(!la(t,(function(e,t){if(o=t,!p.has(o)&&(f===e||i(f,e,a,n,r)))return p.push(t);var o}))){h=!1;break}}else if(f!==_&&!i(f,_,a,n,r)){h=!1;break}}return r.delete(e),r.delete(t),h}function ha(e){var t=-1,a=Array(e.size);return e.forEach((function(e,n){a[++t]=[n,e]})),a}function pa(e){var t=-1,a=Array(e.size);return e.forEach((function(e){a[++t]=e})),a}var fa=1,_a=2,ma="[object Boolean]",ga="[object Date]",va="[object Error]",ya="[object Map]",ba="[object Number]",Ea="[object RegExp]",Sa="[object Set]",Aa="[object String]",wa="[object Symbol]",Ca="[object ArrayBuffer]",Ta="[object DataView]",Ra=b?b.prototype:void 0,Da=Ra?Ra.valueOf:void 0;var ka=1,xa=Object.prototype.hasOwnProperty;var La=1,Na="[object Arguments]",Ba="[object Array]",Va="[object Object]",Ma=Object.prototype.hasOwnProperty;function Oa(e,t,a,n,i,r){var o=B(e),s=B(t),l=o?Ba:ia(e),d=s?Ba:ia(t),c=(l=l==Na?Va:l)==Va,u=(d=d==Na?Va:d)==Va,h=l==d;if(h&&Fe(e)){if(!Fe(t))return!1;o=!0,c=!1}if(h&&!c)return r||(r=new Vt),o||$e(e)?ua(e,t,a,n,i,r):function(e,t,a,n,i,r,o){switch(a){case Ta:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Ca:return!(e.byteLength!=t.byteLength||!r(new ra(e),new ra(t)));case ma:case ga:case ba:return Ee(+e,+t);case va:return e.name==t.name&&e.message==t.message;case Ea:case Aa:return e==t+"";case ya:var s=ha;case Sa:var l=n&fa;if(s||(s=pa),e.size!=t.size&&!l)return!1;var d=o.get(e);if(d)return d==t;n|=_a,o.set(e,t);var c=ua(s(e),s(t),n,i,r,o);return o.delete(e),c;case wa:if(Da)return Da.call(e)==Da.call(t)}return!1}(e,t,l,a,n,i,r);if(!(a&La)){var p=c&&Ma.call(e,"__wrapped__"),f=u&&Ma.call(t,"__wrapped__");if(p||f){var _=p?e.value():e,m=f?t.value():t;return r||(r=new Vt),i(_,m,a,n,r)}}return!!h&&(r||(r=new Vt),function(e,t,a,n,i,r){var o=a&ka,s=Gt(e),l=s.length;if(l!=Gt(t).length&&!o)return!1;for(var d=l;d--;){var c=s[d];if(!(o?c in t:xa.call(t,c)))return!1}var u=r.get(e),h=r.get(t);if(u&&h)return u==t&&h==e;var p=!0;r.set(e,t),r.set(t,e);for(var f=o;++d<l;){var _=e[c=s[d]],m=t[c];if(n)var g=o?n(m,_,c,t,e,r):n(_,m,c,e,t,r);if(!(void 0===g?_===m||i(_,m,a,n,r):g)){p=!1;break}f||(f="constructor"==c)}if(p&&!f){var v=e.constructor,y=t.constructor;v==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof v&&v instanceof v&&"function"==typeof y&&y instanceof y||(p=!1)}return r.delete(e),r.delete(t),p}(e,t,a,n,i,r))}function Ia(e,t,a,n,i){return e===t||(null==e||null==t||!x(e)&&!x(t)?e!=e&&t!=t:Oa(e,t,a,n,Ia,i))}var Pa,Ua=function(e,t,a){for(var n=-1,i=Object(e),r=a(e),o=r.length;o--;){var s=r[Pa?o:++n];if(!1===t(i[s],s,i))break}return e},ja=Ua;function Fa(e,t,a){(void 0!==a&&!Ee(e[t],a)||void 0===a&&!(t in e))&&be(e,t,a)}function za(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function Ga(e){return function(e,t,a,n){var i=!a;a||(a={});for(var r=-1,o=t.length;++r<o;){var s=t[r],l=n?n(a[s],e[s],s,a,e):void 0;void 0===l&&(l=e[s]),i?be(a,s,l):Ae(a,s,l)}return a}(e,it(e))}function Ha(e,t,a,n,i,r,o){var s=za(e,a),l=za(t,a),d=o.get(l);if(d)Fa(e,a,d);else{var c,u=r?r(s,l,a+"",e,t,o):void 0,h=void 0===u;if(h){var p=B(l),f=!p&&Fe(l),_=!p&&!f&&$e(l);u=l,p||f||_?B(s)?u=s:x(c=s)&&De(c)?u=function(e,t){var a=-1,n=e.length;for(t||(t=Array(n));++a<n;)t[a]=e[a];return t}(s):f?(h=!1,u=function(e,t){if(t)return e.slice();var a=e.length,n=Pt?Pt(a):new e.constructor(a);return e.copy(n),n}(l,!0)):_?(h=!1,u=oa(l,!0)):u=[]:function(e){if(!x(e)||k(e)!=Dt)return!1;var t=Rt(e);if(null===t)return!0;var a=Nt.call(t,"constructor")&&t.constructor;return"function"==typeof a&&a instanceof a&&Lt.call(a)==Bt}(l)||Ie(l)?(u=s,Ie(s)?u=Ga(s):P(s)&&!H(s)||(u=function(e){return"function"!=typeof e.constructor||Le(e)?{}:se(Rt(e))}(l))):h=!1}h&&(o.set(l,u),i(u,l,n,r,o),o.delete(l)),Fa(e,a,u)}}function qa(e,t,a,n,i){e!==t&&ja(t,(function(r,o){if(i||(i=new Vt),P(r))Ha(e,t,o,a,qa,n,i);else{var s=n?n(za(e,o),r,o+"",e,t,i):void 0;void 0===s&&(s=r),Fa(e,o,s)}}),it)}var Wa=ke((function(e,t,a,n){qa(e,t,a,n)})),Ka=Wa;var Ya=ke((function(e,t,a){qa(e,t,a)})),$a=Ya,Xa={name:"zh-cn",next:{loading:"加载中...",table:{search:"查询",clear:"清空",add:"新增",delete:"删除",batchDelete:"批量删除",export:"导出",edit:"编辑",view:"查看",unfoldSearch:"展开搜索",foldSearch:"收起搜索",notData:"暂无数据",operation:"操作",selection:"选择",selectionAll:"全选",setting:{title:"设置列",label:"列名",hide:"隐藏",filter:"筛选",sort:"排序"},message:{tip:"提示",batchDeleteTip:"您确定要批量删除吗?",cancelBatchDelete:"取消批量删除操作",deleteTip:"您确定要删除该数据吗?",cancelDelete:"取消删除操作",confirmButtonText:"确 定",cancelButtonText:"取 消"}},form:{input:"请输入",select:"请选择",requiredInput:" 必填",requiredSelect:" 必选",submit:"提 交",cancel:"取 消",reset:"重 置",confirm:"确 定",tableSelect:" 选择",selectFile:"选择文件"},date:{oneWeekAge:"一周以前",oneMonthAge:"一个月以前",threeMonthsAge:"三个月以前",oneYearAge:"一年以前",threeYearsAge:"三年以前",rangeSeparator:"至",startPlaceholder:"开始时间",endPlaceholder:"结束时间"},layout:{home:"首页",personal:"个人中心",logOut:"退出登录",tabsOther:"关闭其他",tabsLeft:"关闭左侧",tabsRight:"关闭右侧",tabsAll:"关闭全部",systemSetting:"系统配置"}}},Za={name:"en",next:{loading:"loading...",table:{search:"search",clear:"clear",add:"add",delete:"del",batchDelete:"batch delete",export:"export",edit:"edit",view:"view",unfoldSearch:"unfold search",foldSearch:"fold search",notData:"not data",operation:"operations",selection:"selection",selectionAll:"select all",setting:{title:"column setting",label:"column name",hide:"hide",filter:"filter",sort:"srot"},message:{tip:"tip",batchDeleteTip:"Are you sure you want to delete them in bulk ?",cancelBatchDelete:"Cancel batch deletion",deleteTip:"Are you sure you want to delete this data ?",cancelDelete:"Cancel delete",confirmButtonText:"OK",cancelButtonText:"Cancel"}},form:{input:"please input ",select:"please select ",requiredInput:" required",requiredSelect:" required",submit:"Submit",cancel:"Cancel",reset:"reset",confirm:"confirm",tableSelect:" select",selectFile:"select file"},date:{oneWeekAge:"one week age",oneMonthAge:"one month age",threeMonthsAge:"three months age",oneYearAge:"one year age",threeYearsAge:"three years age",rangeSeparator:"to",startPlaceholder:"start time",endPlaceholder:"end time"},layout:{home:"Home",personal:"Personal",logOut:"LogOut",tabsOther:"close other",tabsLeft:"close left",tabsRight:"close right",tabsAll:"close all",systemSetting:"system setting"}}},Ja={name:"zh-tw",next:{loading:"加載中...",table:{search:"查詢",clear:"清空",add:"新增",delete:"刪除",batchDelete:"批量刪除",export:"導出",edit:"編輯",view:"查看",unfoldSearch:"展開搜索",foldSearch:"收起搜索",notData:"暫無數據",operation:"操作",selection:"选择",selectionAll:"全选",setting:{title:"設置列",label:"列名",hide:"隱藏",filter:"篩選",sort:"排序"},message:{tip:"提示",batchDeleteTip:"您確定要批量刪除嗎?",cancelBatchDelete:"取消批量刪除操作",deleteTip:"您确定要删除该数据吗?",cancelDelete:"取消删除操作",confirmButtonText:"確 定",cancelButtonText:"取 消"}},form:{input:"請輸入",select:"請選擇",requiredInput:" 必填",requiredSelect:" 必選",submit:"提 交",cancel:"取 消",reset:"重 置",confirm:"确 定",tableSelect:" 選擇",selectFile:"選擇文件"},date:{oneWeekAge:"一周以前",oneMonthAge:"一个月以前",threeMonthsAge:"三个月以前",oneYearAge:"一年以前",threeYearsAge:"三年以前",rangeSeparator:"至",startPlaceholder:"開始時間",endPlaceholder:"結束時間"},layout:{home:"首頁",personal:"個人中心",logOut:"退出登錄",tabsOther:"關閉其他",tabsLeft:"關閉左側",tabsRight:"關閉右側",tabsAll:"關閉全部",systemSetting:"系統配置"}}};const Qa={[Xa.name]:{...Xa},[Za.name]:{...Za},[Ja.name]:{...Ja}},en=(e,t,a)=>Tt(a,e,e).replace(/\{(\w+)\}/g,((e,a)=>`${t?.[a]??`{${a}}`}`)),tn=e=>(a,n)=>en(a,n,t.unref(e)),an=e=>{const a=t.computed((()=>t.unref(e).name)),n=t.isRef(e)?e:t.ref(e),i=Qa[a.value]||Qa["zh-cn"];return n.value.next=i.next,{lang:a,locale:n,t:tn(e)}},nn=a.localeContextKey,rn=e=>{const a=e||t.inject(nn,t.ref());return an(t.computed((()=>a?.value||Xa)))};function on(){return{hexToRgb:e=>{let t="";if(!/^\#?[0-9A-Fa-f]{6}$/.test(e))return a.ElMessage.warning("输入错误的hex"),"";t=(e=e.replace("#","")).match(/../g);for(let e=0;e<3;e++)t[e]=parseInt(t[e],16);return t},rgbToHex:(e,t,n)=>{let i=/^\d{1,3}$/;if(!i.test(e)||!i.test(t)||!i.test(n))return a.ElMessage.warning("输入错误的rgb颜色值"),"";let r=[e.toString(16),t.toString(16),n.toString(16)];for(let e=0;e<3;e++)1==r[e].length&&(r[e]=`0${r[e]}`);return`#${r.join("")}`},getDarkColor:(e,t)=>{if(!/^\#?[0-9A-Fa-f]{6}$/.test(e))return a.ElMessage.warning("输入错误的hex颜色值"),"";let n=on().hexToRgb(e);for(let e=0;e<3;e++)n[e]=Math.floor(n[e]*(1-t));return on().rgbToHex(n[0],n[1],n[2])},getLightColor:(e,t)=>{if(!/^\#?[0-9A-Fa-f]{6}$/.test(e))return a.ElMessage.warning("输入错误的hex颜色值"),"";let n=on().hexToRgb(e);for(let e=0;e<3;e++)n[e]=Math.floor((255-n[e])*t+n[e]);return on().rgbToHex(n[0],n[1],n[2])}}}const{getLightColor:sn}=on(),ln=(e,t)=>{document.documentElement.style.setProperty(e,t)},dn=(e,t)=>{ln(e,t);for(let a=1;a<10;a++)ln(e+"-light-"+a,sn(t,a/10));ln(`${e}-dark-2`,t)},cn={themeColor:"--el-color-primary",headerBarColor:"--next-layout-bg-color",headerBarFontColor:"--next-layout-font-color"},un=e=>{for(const t in cn){const a=cn[t];e[t]&&dn(a,e[t])}const t=document.documentElement;e.isDark?t.setAttribute("data-theme","dark"):t.setAttribute("data-theme","")},hn=async(e,t,a,n,i,r=[],o,s)=>{const{videoWidth:l,videoHeight:d}=e;if(!l||!d)return;let[c,u]=t.inputs[0].shape.slice(1,3),h=n.tidy((()=>n.image.resizeBilinear(n.browser.fromPixels(e),[c,u]).div(255).expandDims(0)));a.clearRect(0,0,l,d),o.clearRect(0,0,l,d),await t.executeAsync(h).then((async t=>{let[c,u,p,f]=t;for(let t=0;t<f.dataSync()[0];++t){let[n,h,f,_]=c.dataSync().slice(4*t,4*(t+1));n=n<0||n>1?parseInt(n):n,f=f<0||f>1?parseInt(f):f,h=h<0||h>1?parseInt(h):h,_=_<0||_>1?parseInt(_):_,n=Math.round(Math.abs(n)*l),f=Math.round(Math.abs(f)*l),h=Math.round(Math.abs(h)*d),_=Math.round(Math.abs(_)*d);const m=f-n,g=_-h,v=n,y=h;let b=p.dataSync()[t],E=u.dataSync()[t].toFixed(2);const S=(e,t,a)=>{const n=`#${(1<<24|Math.floor(256*Math.random())<<16|Math.floor(256*Math.random())<<8|Math.floor(256*Math.random())).toString(16).slice(1)}`;a.strokeStyle=n,a.lineWidth=2,a.beginPath(),a.rect(v,y,m,g),a.stroke(),a.font="bold 16px Arial",a.fillStyle=n,a.fillText(`${e} ${t}`,v+10,y<20?20:y-10)};if(r?.length)for(let t=0;t<r.length;t++){const n=r[t];if(n.cls==b&&Number(E)>n.score){const t=i.find((e=>e.value==b));if(t){const n=t.label;S(n,E,await pn(e,o)),S(n,E,a),s&&s(n,E)}}}else if(E>.5){const e=i.find((e=>e.value==b));if(e){S(e.label||"",E,a)}}}h.dispose(),n.dispose(t)}))},pn=(e,t)=>{const a=e.videoWidth,n=e.videoHeight,i=a/n,r=a/n,o=a,s=n;let l,d,c,u;return i>r?(c=a,u=a/i,l=0,d=Math.round((n-u)/2)):i===r?(c=a,u=n,l=0,d=0):i<r&&(c=n*i,u=n,l=Math.round((a-c)/2),d=0),t.drawImage(e,0,0,o,s,l,d,c,u),t},fn=(e,t)=>{if(e.install=a=>{for(const n of[e,...Object.values(t??{})])a.component(n.name,n)},t)for(const[a,n]of Object.entries(t))e[a]=n;return e},_n="header-menu",mn="header-tools-prefix",gn="header-tools-suffix";var vn={logo:"",title:"Next Element Vue",userName:"Admin",language:"zh-cn",languageDropdown:[{value:"zh-cn",label:"简体中文"},{value:"en",label:"English"},{value:"zh-tw",label:"繁體中文"}],userDropdown:[{value:"/",label:"next.layout.home"},{value:"/personal",label:"next.layout.personal"},{value:"logOut",label:"next.layout.logOut",divided:!0}],showTabs:!0,activeTab:"/",tabs:[],menuTree:[],menuRouter:!0,menuMode:"horizontal",setting:{layout:"transverse",themeColor:"#c71585",headerBarColor:"#282c34",headerBarFontColor:"#FFFFFF",isHeaderBarColorGradual:!1,asidebarColor:"#282c34",asidebarFontColor:"#ffffff",isAsidebarColorGradual:!1,isDark:!1}};const yn=m("text-ellipsis");const bn=fn(t.defineComponent({name:"NextTextEllipsis",props:{content:{type:String,default:""},disabled:{type:Boolean,default:!1},width:{type:[String,Number],default:""},placement:{type:String,default:"top"},textAlign:{type:String,default:"left"},class:{type:String,default:""}},setup(e,{slots:n}){const i=t.ref(!1),r=t.computed((()=>{const t=e.width;let a={textAlign:e.textAlign};return t&&("string"==typeof t?a.width=t:"number"==typeof t&&(a.width=t+"px")),a})),o=t.ref(),s=()=>{try{const e=o.value;e&&e.scrollWidth&&e.scrollWidth>e.offsetWidth?i.value=!0:i.value=!1}catch(e){i.value=!1}};return()=>t.createVNode(t.Fragment,null,[t.createVNode("div",{class:[yn.b(),e.class],style:r.value,onMouseenter:s},[i.value?t.createVNode(a.ElTooltip,{effect:"dark",content:e.content,placement:e.placement,disabled:e.disabled},{default:()=>[t.createVNode("span",{class:yn.e("text"),ref:o},[n.default?n.default():e.content])]}):t.createVNode("span",{class:yn.e("text"),ref:o},[n.default?n.default():e.content])])])}}));var En=t.defineComponent({setup(){const e=t.inject("__ns__",{}),a=t.inject("options",{}),{t:n}=rn();return()=>t.createVNode(t.Fragment,null,[t.createVNode("div",{class:e.bf("header","logo")},[a.logo&&t.createVNode("img",{class:e.be("header-logo","img"),src:a.logo,alt:"logo"},null),a.title&&t.createVNode("p",{class:e.be("header-logo","title")},[t.createVNode(bn,{content:n(a.title)},null)])])])}}),Sn=(e,t)=>{let a=e.__vccOpts||e;for(let[e,n]of t)a[e]=n;return a},An={name:"ArrowDown"},wn={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Cn=[t.createElementVNode("path",{fill:"currentColor",d:"M831.872 340.864 512 652.672 192.128 340.864a30.592 30.592 0 0 0-42.752 0 29.12 29.12 0 0 0 0 41.6L489.664 714.24a32 32 0 0 0 44.672 0l340.288-331.712a29.12 29.12 0 0 0 0-41.728 30.592 30.592 0 0 0-42.752 0z"},null,-1)];var Tn=Sn(An,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",wn,Cn)}],["__file","arrow-down.vue"]]),Rn={name:"ArrowUp"},Dn={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},kn=[t.createElementVNode("path",{fill:"currentColor",d:"m488.832 344.32-339.84 356.672a32 32 0 0 0 0 44.16l.384.384a29.44 29.44 0 0 0 42.688 0l320-335.872 319.872 335.872a29.44 29.44 0 0 0 42.688 0l.384-.384a32 32 0 0 0 0-44.16L535.168 344.32a32 32 0 0 0-46.336 0z"},null,-1)];var xn=Sn(Rn,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",Dn,kn)}],["__file","arrow-up.vue"]]),Ln={name:"Back"},Nn={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Bn=[t.createElementVNode("path",{fill:"currentColor",d:"M224 480h640a32 32 0 1 1 0 64H224a32 32 0 0 1 0-64z"},null,-1),t.createElementVNode("path",{fill:"currentColor",d:"m237.248 512 265.408 265.344a32 32 0 0 1-45.312 45.312l-288-288a32 32 0 0 1 0-45.312l288-288a32 32 0 1 1 45.312 45.312L237.248 512z"},null,-1)];var Vn=Sn(Ln,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",Nn,Bn)}],["__file","back.vue"]]),Mn={name:"Camera"},On={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},In=[t.createElementVNode("path",{fill:"currentColor",d:"M896 256H128v576h768V256zm-199.424-64-32.064-64h-304.96l-32 64h369.024zM96 192h160l46.336-92.608A64 64 0 0 1 359.552 64h304.96a64 64 0 0 1 57.216 35.328L768.192 192H928a32 32 0 0 1 32 32v640a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V224a32 32 0 0 1 32-32zm416 512a160 160 0 1 0 0-320 160 160 0 0 0 0 320zm0 64a224 224 0 1 1 0-448 224 224 0 0 1 0 448z"},null,-1)];var Pn=Sn(Mn,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",On,In)}],["__file","camera.vue"]]),Un={name:"Close"},jn={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Fn=[t.createElementVNode("path",{fill:"currentColor",d:"M764.288 214.592 512 466.88 259.712 214.592a31.936 31.936 0 0 0-45.12 45.12L466.752 512 214.528 764.224a31.936 31.936 0 1 0 45.12 45.184L512 557.184l252.288 252.288a31.936 31.936 0 0 0 45.12-45.12L557.12 512.064l252.288-252.352a31.936 31.936 0 1 0-45.12-45.184z"},null,-1)];var zn=Sn(Un,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",jn,Fn)}],["__file","close.vue"]]),Gn={name:"DArrowLeft"},Hn={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},qn=[t.createElementVNode("path",{fill:"currentColor",d:"M529.408 149.376a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L259.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L197.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224zm256 0a29.12 29.12 0 0 1 41.728 0 30.592 30.592 0 0 1 0 42.688L515.264 511.936l311.872 319.936a30.592 30.592 0 0 1-.512 43.264 29.12 29.12 0 0 1-41.216-.512L453.76 534.272a32 32 0 0 1 0-44.672l331.648-340.224z"},null,-1)];var Wn=Sn(Gn,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",Hn,qn)}],["__file","d-arrow-left.vue"]]),Kn={name:"DArrowRight"},Yn={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},$n=[t.createElementVNode("path",{fill:"currentColor",d:"M452.864 149.312a29.12 29.12 0 0 1 41.728.064L826.24 489.664a32 32 0 0 1 0 44.672L494.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L764.736 512 452.864 192a30.592 30.592 0 0 1 0-42.688zm-256 0a29.12 29.12 0 0 1 41.728.064L570.24 489.664a32 32 0 0 1 0 44.672L238.592 874.624a29.12 29.12 0 0 1-41.728 0 30.592 30.592 0 0 1 0-42.752L508.736 512 196.864 192a30.592 30.592 0 0 1 0-42.688z"},null,-1)];var Xn=Sn(Kn,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",Yn,$n)}],["__file","d-arrow-right.vue"]]),Zn={name:"Delete"},Jn={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Qn=[t.createElementVNode("path",{fill:"currentColor",d:"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32V256zm448-64v-64H416v64h192zM224 896h576V256H224v640zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32zm192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32z"},null,-1)];var ei=Sn(Zn,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",Jn,Qn)}],["__file","delete.vue"]]),ti={name:"EditPen"},ai={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},ni=[t.createElementVNode("path",{fill:"currentColor",d:"m199.04 672.64 193.984 112 224-387.968-193.92-112-224 388.032zm-23.872 60.16 32.896 148.288 144.896-45.696L175.168 732.8zM455.04 229.248l193.92 112 56.704-98.112-193.984-112-56.64 98.112zM104.32 708.8l384-665.024 304.768 175.936L409.152 884.8h.064l-248.448 78.336L104.32 708.8zm384 254.272v-64h448v64h-448z"},null,-1)];var ii=Sn(ti,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",ai,ni)}],["__file","edit-pen.vue"]]),ri={name:"FullScreen"},oi={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},si=[t.createElementVNode("path",{fill:"currentColor",d:"m160 96.064 192 .192a32 32 0 0 1 0 64l-192-.192V352a32 32 0 0 1-64 0V96h64v.064zm0 831.872V928H96V672a32 32 0 1 1 64 0v191.936l192-.192a32 32 0 1 1 0 64l-192 .192zM864 96.064V96h64v256a32 32 0 1 1-64 0V160.064l-192 .192a32 32 0 1 1 0-64l192-.192zm0 831.872-192-.192a32 32 0 0 1 0-64l192 .192V672a32 32 0 1 1 64 0v256h-64v-.064z"},null,-1)];var li=Sn(ri,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",oi,si)}],["__file","full-screen.vue"]]),di={name:"InfoFilled"},ci={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},ui=[t.createElementVNode("path",{fill:"currentColor",d:"M512 64a448 448 0 1 1 0 896.064A448 448 0 0 1 512 64zm67.2 275.072c33.28 0 60.288-23.104 60.288-57.344s-27.072-57.344-60.288-57.344c-33.28 0-60.16 23.104-60.16 57.344s26.88 57.344 60.16 57.344zM590.912 699.2c0-6.848 2.368-24.64 1.024-34.752l-52.608 60.544c-10.88 11.456-24.512 19.392-30.912 17.28a12.992 12.992 0 0 1-8.256-14.72l87.68-276.992c7.168-35.136-12.544-67.2-54.336-71.296-44.096 0-108.992 44.736-148.48 101.504 0 6.784-1.28 23.68.064 33.792l52.544-60.608c10.88-11.328 23.552-19.328 29.952-17.152a12.8 12.8 0 0 1 7.808 16.128L388.48 728.576c-10.048 32.256 8.96 63.872 55.04 71.04 67.84 0 107.904-43.648 147.456-100.416z"},null,-1)];var hi=Sn(di,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",ci,ui)}],["__file","info-filled.vue"]]),pi={name:"MoonNight"},fi={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},_i=[t.createElementVNode("path",{fill:"currentColor",d:"M384 512a448 448 0 0 1 215.872-383.296A384 384 0 0 0 213.76 640h188.8A448.256 448.256 0 0 1 384 512zM171.136 704a448 448 0 0 1 636.992-575.296A384 384 0 0 0 499.328 704h-328.32z"},null,-1),t.createElementVNode("path",{fill:"currentColor",d:"M32 640h960q32 0 32 32t-32 32H32q-32 0-32-32t32-32zm128 128h384a32 32 0 1 1 0 64H160a32 32 0 1 1 0-64zm160 127.68 224 .256a32 32 0 0 1 32 32V928a32 32 0 0 1-32 32l-224-.384a32 32 0 0 1-32-32v-.064a32 32 0 0 1 32-32z"},null,-1)];var mi=Sn(pi,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",fi,_i)}],["__file","moon-night.vue"]]),gi={name:"Picture"},vi={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},yi=[t.createElementVNode("path",{fill:"currentColor",d:"M160 160v704h704V160H160zm-32-64h768a32 32 0 0 1 32 32v768a32 32 0 0 1-32 32H128a32 32 0 0 1-32-32V128a32 32 0 0 1 32-32z"},null,-1),t.createElementVNode("path",{fill:"currentColor",d:"M384 288q64 0 64 64t-64 64q-64 0-64-64t64-64zM185.408 876.992l-50.816-38.912L350.72 556.032a96 96 0 0 1 134.592-17.856l1.856 1.472 122.88 99.136a32 32 0 0 0 44.992-4.864l216-269.888 49.92 39.936-215.808 269.824-.256.32a96 96 0 0 1-135.04 14.464l-122.88-99.072-.64-.512a32 32 0 0 0-44.8 5.952L185.408 876.992z"},null,-1)];var bi=Sn(gi,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",vi,yi)}],["__file","picture.vue"]]),Ei={name:"Plus"},Si={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Ai=[t.createElementVNode("path",{fill:"currentColor",d:"M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64h352z"},null,-1)];var wi=Sn(Ei,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",Si,Ai)}],["__file","plus.vue"]]),Ci={name:"Refresh"},Ti={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Ri=[t.createElementVNode("path",{fill:"currentColor",d:"M771.776 794.88A384 384 0 0 1 128 512h64a320 320 0 0 0 555.712 216.448H654.72a32 32 0 1 1 0-64h149.056a32 32 0 0 1 32 32v148.928a32 32 0 1 1-64 0v-50.56zM276.288 295.616h92.992a32 32 0 0 1 0 64H220.16a32 32 0 0 1-32-32V178.56a32 32 0 0 1 64 0v50.56A384 384 0 0 1 896.128 512h-64a320 320 0 0 0-555.776-216.384z"},null,-1)];var Di=Sn(Ci,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",Ti,Ri)}],["__file","refresh.vue"]]),ki={name:"Right"},xi={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Li=[t.createElementVNode("path",{fill:"currentColor",d:"M754.752 480H160a32 32 0 1 0 0 64h594.752L521.344 777.344a32 32 0 0 0 45.312 45.312l288-288a32 32 0 0 0 0-45.312l-288-288a32 32 0 1 0-45.312 45.312L754.752 480z"},null,-1)];var Ni=Sn(ki,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",xi,Li)}],["__file","right.vue"]]),Bi={name:"Search"},Vi={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Mi=[t.createElementVNode("path",{fill:"currentColor",d:"m795.904 750.72 124.992 124.928a32 32 0 0 1-45.248 45.248L750.656 795.904a416 416 0 1 1 45.248-45.248zM480 832a352 352 0 1 0 0-704 352 352 0 0 0 0 704z"},null,-1)];var Oi=Sn(Bi,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",Vi,Mi)}],["__file","search.vue"]]),Ii={name:"Setting"},Pi={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Ui=[t.createElementVNode("path",{fill:"currentColor",d:"M600.704 64a32 32 0 0 1 30.464 22.208l35.2 109.376c14.784 7.232 28.928 15.36 42.432 24.512l112.384-24.192a32 32 0 0 1 34.432 15.36L944.32 364.8a32 32 0 0 1-4.032 37.504l-77.12 85.12a357.12 357.12 0 0 1 0 49.024l77.12 85.248a32 32 0 0 1 4.032 37.504l-88.704 153.6a32 32 0 0 1-34.432 15.296L708.8 803.904c-13.44 9.088-27.648 17.28-42.368 24.512l-35.264 109.376A32 32 0 0 1 600.704 960H423.296a32 32 0 0 1-30.464-22.208L357.696 828.48a351.616 351.616 0 0 1-42.56-24.64l-112.32 24.256a32 32 0 0 1-34.432-15.36L79.68 659.2a32 32 0 0 1 4.032-37.504l77.12-85.248a357.12 357.12 0 0 1 0-48.896l-77.12-85.248A32 32 0 0 1 79.68 364.8l88.704-153.6a32 32 0 0 1 34.432-15.296l112.32 24.256c13.568-9.152 27.776-17.408 42.56-24.64l35.2-109.312A32 32 0 0 1 423.232 64H600.64zm-23.424 64H446.72l-36.352 113.088-24.512 11.968a294.113 294.113 0 0 0-34.816 20.096l-22.656 15.36-116.224-25.088-65.28 113.152 79.68 88.192-1.92 27.136a293.12 293.12 0 0 0 0 40.192l1.92 27.136-79.808 88.192 65.344 113.152 116.224-25.024 22.656 15.296a294.113 294.113 0 0 0 34.816 20.096l24.512 11.968L446.72 896h130.688l36.48-113.152 24.448-11.904a288.282 288.282 0 0 0 34.752-20.096l22.592-15.296 116.288 25.024 65.28-113.152-79.744-88.192 1.92-27.136a293.12 293.12 0 0 0 0-40.256l-1.92-27.136 79.808-88.128-65.344-113.152-116.288 24.96-22.592-15.232a287.616 287.616 0 0 0-34.752-20.096l-24.448-11.904L577.344 128zM512 320a192 192 0 1 1 0 384 192 192 0 0 1 0-384zm0 64a128 128 0 1 0 0 256 128 128 0 0 0 0-256z"},null,-1)];var ji=Sn(Ii,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",Pi,Ui)}],["__file","setting.vue"]]),Fi={name:"Sunny"},zi={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Gi=[t.createElementVNode("path",{fill:"currentColor",d:"M512 704a192 192 0 1 0 0-384 192 192 0 0 0 0 384zm0 64a256 256 0 1 1 0-512 256 256 0 0 1 0 512zm0-704a32 32 0 0 1 32 32v64a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 768a32 32 0 0 1 32 32v64a32 32 0 1 1-64 0v-64a32 32 0 0 1 32-32zM195.2 195.2a32 32 0 0 1 45.248 0l45.248 45.248a32 32 0 1 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm543.104 543.104a32 32 0 0 1 45.248 0l45.248 45.248a32 32 0 0 1-45.248 45.248l-45.248-45.248a32 32 0 0 1 0-45.248zM64 512a32 32 0 0 1 32-32h64a32 32 0 0 1 0 64H96a32 32 0 0 1-32-32zm768 0a32 32 0 0 1 32-32h64a32 32 0 1 1 0 64h-64a32 32 0 0 1-32-32zM195.2 828.8a32 32 0 0 1 0-45.248l45.248-45.248a32 32 0 0 1 45.248 45.248L240.448 828.8a32 32 0 0 1-45.248 0zm543.104-543.104a32 32 0 0 1 0-45.248l45.248-45.248a32 32 0 0 1 45.248 45.248l-45.248 45.248a32 32 0 0 1-45.248 0z"},null,-1)];var Hi=Sn(Fi,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",zi,Gi)}],["__file","sunny.vue"]]),qi={name:"Tools"},Wi={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Ki=[t.createElementVNode("path",{fill:"currentColor",d:"M764.416 254.72a351.68 351.68 0 0 1 86.336 149.184H960v192.064H850.752a351.68 351.68 0 0 1-86.336 149.312l54.72 94.72-166.272 96-54.592-94.72a352.64 352.64 0 0 1-172.48 0L371.136 936l-166.272-96 54.72-94.72a351.68 351.68 0 0 1-86.336-149.312H64v-192h109.248a351.68 351.68 0 0 1 86.336-149.312L204.8 160l166.208-96h.192l54.656 94.592a352.64 352.64 0 0 1 172.48 0L652.8 64h.128L819.2 160l-54.72 94.72zM704 499.968a192 192 0 1 0-384 0 192 192 0 0 0 384 0z"},null,-1)];var Yi=Sn(qi,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",Wi,Ki)}],["__file","tools.vue"]]),$i={name:"View"},Xi={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},Zi=[t.createElementVNode("path",{fill:"currentColor",d:"M512 160c320 0 512 352 512 352S832 864 512 864 0 512 0 512s192-352 512-352zm0 64c-225.28 0-384.128 208.064-436.8 288 52.608 79.872 211.456 288 436.8 288 225.28 0 384.128-208.064 436.8-288-52.608-79.872-211.456-288-436.8-288zm0 64a224 224 0 1 1 0 448 224 224 0 0 1 0-448zm0 64a160.192 160.192 0 0 0-160 160c0 88.192 71.744 160 160 160s160-71.808 160-160-71.744-160-160-160z"},null,-1)];var Ji=Sn($i,[["render",function(e,a,n,i,r,o){return t.openBlock(),t.createElementBlock("svg",Xi,Zi)}],["__file","view.vue"]]),Qi=t.defineComponent({setup(){},render(){const e=t.inject("__slots__",{}),n=t.inject("__ns__",{}),i=t.inject("options",{}),r=t.inject("updateOptions",null),o=t.reactive({...i.setting}),s=()=>{const e={...i,setting:{...o}};r(e)},l=e=>{if(!e)return a.ElMessage({type:"warning",message:"主题颜色不能为空"}),!1;o.themeColor=e,dn("--el-color-primary",e),s()},d=()=>{const e=document.documentElement;o.isDark?e.setAttribute("data-theme","dark"):e.setAttribute("data-theme",""),s()},c=(e,t,a)=>{o[t]=e,ln(a,e),s()},u=[{type:"defaults",text:"默认"},{type:"classic",text:"经典"},{type:"transverse",text:"横向"},{type:"columns",text:"分栏"}];return t.createVNode(a.ElScrollbar,null,{default:()=>[t.createVNode(a.ElDivider,{"border-style":"dashed"},{default:()=>[t.createTextVNode("全局主题")]}),t.createVNode("div",{class:n.b("config-bar-item")},[t.createVNode("span",{class:n.be("config-bar-item","label")},[t.createTextVNode("主题颜色")]),t.createVNode("div",{class:n.be("config-bar-item","value")},[t.createVNode(a.ElColorPicker,{modelValue:o.themeColor,"onUpdate:modelValue":e=>o.themeColor=e,predefine:["#409eff","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","#FB07A0"],onChange:l},null)])]),t.createVNode("div",{class:n.b("config-bar-item")},[t.createVNode("span",{class:n.be("config-bar-item","label")},[t.createTextVNode("暗黑模式")]),t.createVNode("div",{class:n.be("config-bar-item","value")},[t.createVNode(a.ElSwitch,{modelValue:o.isDark,"onUpdate:modelValue":e=>o.isDark=e,"inline-prompt":!0,size:"large","active-icon":mi,"inactive-icon":Hi,"active-color":"#1f1f1f","inactive-color":"#dcdfe6",onChange:d},null)])]),t.createVNode("div",{class:n.b("config-bar-item")},[t.createVNode("span",{class:n.be("config-bar-item","label")},[t.createTextVNode("顶栏背景颜色")]),t.createVNode("div",{class:n.be("config-bar-item","value")},[t.createVNode(a.ElColorPicker,{modelValue:o.headerBarColor,"onUpdate:modelValue":e=>o.headerBarColor=e,predefine:["#282c34","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","#FB07A0"],onChange:e=>c(e,"headerBarColor","--next-layout-bg-color")},null)])]),t.createVNode("div",{class:n.b("config-bar-item")},[t.createVNode("span",{class:n.be("config-bar-item","label")},[t.createTextVNode("顶栏字体颜色")]),t.createVNode("div",{class:n.be("config-bar-item","value")},[t.createVNode(a.ElColorPicker,{modelValue:o.headerBarFontColor,"onUpdate:modelValue":e=>o.headerBarFontColor=e,predefine:["#282c34","#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585","#FB07A0"],onChange:e=>c(e,"headerBarFontColor","--next-layout-font-color")},null)])]),t.createVNode("div",{class:n.b("config-bar-item")},[t.createVNode("span",{class:n.be("config-bar-item","label")},[t.createTextVNode("顶栏背景渐变")]),t.createVNode("div",{class:n.be("config-bar-item","value")},[t.createVNode(t.resolveComponent("el-switch"),{modelValue:o.isHeaderBarColorGradual,"onUpdate:modelValue":e=>o.isHeaderBarColorGradual=e,onChange:s},null)])]),t.createVNode(a.ElDivider,{"border-style":"dashed"},{default:()=>[t.createTextVNode("布局方式")]}),t.createVNode("ul",{class:n.b("config-bar-layout")},[u.map((e=>t.createVNode("li",{class:[n.be("config-bar-layout",e.type),n.is("active",o.layout===e.type)],onClick:t=>((e,t)=>{e.stopPropagation(),o.layout=t.type,s()})(t,e)},[t.createVNode("div",{class:"layout-wrap"},[t.createVNode("div",{class:"layout-box"},[t.createVNode("p",{class:"layout-text"},[e.text])])]),t.createVNode("aside",null,null)])))]),t.createVNode("div",{class:n.b("config-bar-item"),style:{"margin-top":"20px"}},[t.createVNode("span",{class:n.be("config-bar-item","label")},[t.createTextVNode("是否显示标签栏")]),t.createVNode("div",{class:n.be("config-bar-item","value")},[t.createVNode(t.resolveComponent("el-switch"),{modelValue:i.showTabs,"onUpdate:modelValue":e=>i.showTabs=e},null)])]),e.setting?.()]})}});function er(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!t.isVNode(e)}var tr=t.defineComponent({setup(){const e=t.inject(nn,t.ref()),a=t.inject("options",{}),{t:i}=rn(),{toggle:r,isFullscreen:o}=n.useFullscreen(),s=t.ref(t.computed((()=>a.language)).value),l=t.ref(!1);return{locale:e,config:a,t:i,toggle:r,isFullscreen:o,language:s,settingDrawer:l}},render(){const e=t.inject("__ns__",{}),n=this.config,i=t.inject("__emit__",{}),r=this.$slots,o=this.t,s=this.isFullscreen,l=n.profile,d=n.userDropdown,c=n.languageDropdown,u=()=>{this.settingDrawer=!1};return t.createVNode(t.Fragment,null,[t.createVNode("ul",{class:e.b("header-tools")},[r[mn]?.(),t.createVNode("li",null,[t.createVNode(a.ElDropdown,{"show-timeout":70,"hide-timeout":50,trigger:"click",onCommand:e=>{this.language=e,i("changeLanguage",e),n.onChangeLanguage&&n.onChangeLanguage(e)}},{default:()=>t.createVNode("div",null,[t.createVNode(a.ElIcon,{size:16},{default:()=>[t.createVNode("svg",{class:"icon",viewBox:"0 0 1070 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1855",width:"128",height:"128"},[t.createVNode("path",{d:"M232.58156522 358.13286957C244.86956522 394.4626087 265.17147826 425.984 293.48730435 453.76556522c24.04173913-26.17878261 42.2066087-58.23443478 53.96034782-95.63269565H232.58156522z","p-id":"1856"},null),t.createVNode("path",{d:"M981.61530435 143.36h-448.77913044L507.19165217 6.05495652h-416.72347826c-45.94643478 0-83.34469565 37.39826087-83.34469565 83.34469565v708.42991305c0 45.94643478 37.39826087 83.34469565 83.34469565 83.34469565h379.85947826l-30.45286956 137.30504348h541.74052174c45.94643478 0 83.34469565-37.39826087 83.34469565-83.34469565V226.70469565c0-45.94643478-37.39826087-83.34469565-83.34469565-83.34469565zM415.83304348 564.35756522c-49.152-18.16486957-89.75582609-41.13808696-122.34573913-67.85113044-34.19269565 30.45286957-76.93356522 52.89182609-126.61982609 66.7826087l-17.09634783-28.31582609c48.61773913-12.82226087 89.22156522-32.05565217 121.2772174-59.30295652-33.12417391-33.65843478-56.0973913-72.65947826-68.91965218-117.00313044h-46.48069565v-32.05565217H276.92521739c-7.47965217-13.89078261-17.09634783-27.24730435-28.31582609-40.06956522l32.05565218-11.75373913c11.21947826 14.42504348 21.37043478 31.5213913 30.45286956 51.28904348h115.9346087v32.05565218h-46.48069565c-14.95930435 45.94643478-36.32973913 84.41321739-64.64556522 115.40034782 31.5213913 25.11026087 71.05669565 45.94643478 117.5373913 63.04278261l-17.63060869 27.78156522z m607.45460869 370.24278261c0 22.97321739-18.69913043 41.67234783-41.67234782 41.67234782H492.23234783l20.83617391-95.63269565h156.53843478l-89.22156522-497.39686957-0.53426087 2.67130435-3.73982608-19.76765217 1.06852174 0.53426087-32.58991305-181.64869565H982.14956522c22.97321739 0 41.67234783 18.69913043 41.67234782 41.67234782v707.89565218z","p-id":"1857"},null),t.createVNode("path",{d:"M684.56626087 541.38434783h114.86608696v-30.45286957h-114.86608696V450.02573913h122.34573913v-30.45286956h-158.14121739v219.04695652h162.94956522V608.16695652h-127.15408696v-66.78260869z m239.88313043-65.71408696c-9.61669565 0-18.16486957 1.60278261-26.1787826 5.87686956-7.47965217 3.73982609-14.95930435 9.61669565-20.83617392 17.09634783V479.94434783h-34.72695652v158.67547826h34.72695652v-95.63269566c1.06852174-12.82226087 5.3426087-22.43895652 12.82226087-29.38434782 6.41113043-5.87686957 13.89078261-9.08243478 22.43895652-9.08243478 24.04173913 0 35.79547826 12.82226087 35.79547826 39.00104347v94.56417392h34.72695653v-97.76973913c1.06852174-43.27513043-19.2333913-64.64556522-58.76869566-64.64556522z","p-id":"1858"},null)])]})]),dropdown:()=>{let e;return t.createVNode(a.ElDropdownMenu,null,er(e=c.map((e=>t.createVNode(a.ElDropdownItem,{command:e.value,disabled:this.language===e.value},{default:()=>[e.label]}))))?e:{default:()=>[e]})}})]),t.createVNode("li",null,[t.createVNode("span",{style:{display:"inline-block",lineHeight:1},onClick:this.toggle},[t.createVNode(a.ElIcon,{size:16},{default:()=>[s?t.createVNode("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2676",width:"128",height:"128"},[t.createVNode("path",{d:"M749.248 704H864a32 32 0 1 0 0-64H672a32 32 0 0 0-32 32v192a32 32 0 1 0 64 0v-114.752l137.36 137.36a32 32 0 1 0 45.232-45.264L749.248 704zM320 749.248V864a32 32 0 1 0 64 0V672a32 32 0 0 0-32-32H160a32 32 0 1 0 0 64h114.752l-137.36 137.36a32 32 0 1 0 45.264 45.232L320 749.248zM749.248 320H864a32 32 0 1 1 0 64H672a32 32 0 0 1-32-32V160a32 32 0 1 1 64 0v114.752l137.36-137.36a32 32 0 1 1 45.232 45.264L749.248 320zM320 274.752V160a32 32 0 1 1 64 0v192a32 32 0 0 1-32 32H160a32 32 0 1 1 0-64h114.752l-137.36-137.36a32 32 0 1 1 45.264-45.232L320 274.752z","p-id":"2677"},null)]):t.createVNode("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"2522",width:"128",height:"128"},[t.createVNode("path",{d:"M237.248 192H352a32 32 0 1 0 0-64H160a32 32 0 0 0-32 32v192a32 32 0 1 0 64 0v-114.752l137.36 137.36a32 32 0 1 0 45.232-45.264L237.248 192zM832 237.248V352a32 32 0 1 0 64 0V160a32 32 0 0 0-32-32H672a32 32 0 1 0 0 64h114.752l-137.36 137.36a32 32 0 1 0 45.264 45.232L832 237.248zM237.248 832H352a32 32 0 1 1 0 64H160a32 32 0 0 1-32-32V672a32 32 0 1 1 64 0v114.752l137.36-137.36a32 32 0 1 1 45.232 45.264L237.248 832zM832 786.752V672a32 32 0 1 1 64 0v192a32 32 0 0 1-32 32H672a32 32 0 1 1 0-64h114.752l-137.36-137.36a32 32 0 1 1 45.264-45.232L832 786.752z","p-id":"2523"},null)])]})])]),r[gn]?.(),t.createVNode("li",null,[t.createVNode(a.ElDropdown,{"show-timeout":70,"hide-timeout":80,onCommand:e=>{i("changeUserDropdown",e),n.onChangeUserDropdown&&n.onChangeUserDropdown(e)}},{default:()=>t.createVNode("span",{class:e.be("header-tools","user")},[l?t.createVNode("img",{class:"user-photo",src:l},null):null,t.createVNode("span",null,[n.userName]),t.createVNode(a.ElIcon,{class:"el-icon--right"},{default:()=>[t.createVNode(Tn,null,null)]})]),dropdown:()=>t.createVNode(a.ElDropdownMenu,null,{default:()=>[d?.map((e=>{let n;return t.createVNode(a.ElDropdownItem,{command:e.value,divided:!!e.divided},er(n=o(e.label))?n:{default:()=>[n]})}))]})})]),t.createVNode("li",null,[t.createVNode("span",{style:{display:"inline-block",lineHeight:1},onClick:()=>{this.settingDrawer=!0}},[t.createVNode(a.ElIcon,{size:16},{default:()=>[t.createVNode(ji,null,null)]})])])]),t.createVNode(t.Teleport,{to:"body"},{default:()=>[t.createVNode(a.ElDrawer,{modelValue:this.settingDrawer,"onUpdate:modelValue":e=>this.settingDrawer=e,title:this.t("next.layout.systemSetting"),direction:"rtl",size:"380px",class:e.be("drawer","setting"),"destroy-on-close":!0,beforeClose:u},{default:()=>[t.createVNode(Qi,null,null)]})]})])}});const{getLightColor:ar}=on();var nr=t.defineComponent({setup:()=>({ns:t.inject("ns",{})}),render(){const e=this.$slots,a=this.ns,n=t.inject("options",{}),i=t.computed((()=>{const{isHeaderBarColorGradual:e,headerBarColor:t}=n.setting;return e?{background:`linear-gradient(to bottom , ${t}, ${ar(t,.5)})`}:""}));return t.createVNode("header",{class:a.b("header"),style:i.value},[t.createVNode(En,null,null),t.createVNode("div",{class:a.bf("header","right")},[t.createVNode(tr,null,{default:()=>[e[mn]?.(),e[gn]?.()]})])])}}),ir=t.defineComponent({props:{meta:{type:Object,default:()=>({})}},setup(e){const a=t.inject("ns",{}),{t:n}=rn(),i=e.meta;return()=>t.createVNode(t.Fragment,null,[t.createVNode("span",{class:a.be("item","icon")},[i.icon?t.createVNode("i",{class:i.icon},null):t.createVNode("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"19771",width:"32",height:"32"},[t.createVNode("path",{d:"M512 958.8C265.6 958.8 65.2 758.4 65.2 512S265.6 65.2 512 65.2 958.8 265.6 958.8 512 758.4 958.8 512 958.8z m0-832c-212.4 0-385.2 172.8-385.2 385.2S299.6 897.2 512 897.2 897.2 724.4 897.2 512 724.4 126.8 512 126.8z","p-id":"19772"},null),t.createVNode("path",{d:"M512 512m-169.5 0a169.5 169.5 0 1 0 339 0 169.5 169.5 0 1 0-339 0Z","p-id":"19773"},null)])]),t.createVNode("span",{class:a.be("item","title")},[n(i.title)])])}});const rr=t.defineComponent({name:"NextMenuItem",props:{menuData:{type:Array,required:!0}},setup(e){const n=t.inject("ns",{}),i=t.computed((()=>e.menuData)).value;return()=>t.createVNode(t.Fragment,null,[t.createVNode(t.Fragment,null,[i.map((e=>e.children?.length?t.createVNode(a.ElSubMenu,{"popper-class":n.b("popper"),index:e.path||e.id,teleported:!0},{title:()=>t.createVNode(ir,{meta:e.meta},null),default:()=>t.createVNode(rr,{menuData:e.children},null)}):t.createVNode(a.ElMenuItem,{index:e.path},{default:()=>[t.createVNode(ir,{meta:e.meta},null)]})))])])}}),or=m("menu");const sr=fn(t.defineComponent({name:"NextMenu",props:{className:{type:String,default:""},style:{type:Object,default:()=>({})},router:{type:Boolean,default:!0},mode:{type:String,values:["horizontal","vertical"],default:"horizontal"},menuTree:{type:Array,default:()=>[]}},setup(e){t.provide("ns",or);const n=t.getCurrentInstance().appContext.config.globalProperties.$router,i=n.currentRoute?.value.fullPath,r=t.ref(i);t.watch((()=>n.currentRoute?.value),(e=>{r.value=e.fullPath}));return()=>t.createVNode(t.Fragment,null,[t.createVNode(a.ElMenu,{class:[or.b(),e.className],style:e.style,defaultActive:r.value,router:e.router,mode:e.mode,ellipsis:!0},{default:()=>[t.createVNode(t.Fragment,null,[e.menuTree.map((e=>e.children?.length?t.createVNode(a.ElSubMenu,{"popper-class":or.b("popper"),index:e.path||e.id,teleported:!0},{title:()=>t.createVNode(ir,{meta:e.meta},null),default:()=>t.createVNode(rr,{menuData:e.children},null)}):t.createVNode(a.ElMenuItem,{"popper-class":or.b("popper"),index:e.path},{default:()=>[t.createVNode(ir,{meta:e.meta},null)]})))])]})])}}));var lr=t.defineComponent({setup:()=>({ns:t.inject("ns",{})}),render(){const e=this.$slots,n=this.ns,i=t.inject("options",{});return t.createVNode("aside",{class:n.b("sidebar")},[t.createVNode(a.ElScrollbar,null,{default:()=>[e[_n]?e[_n]():t.createVNode(sr,{mode:"vertical",menuTree:i.menuTree},null)]})])}});const dr=m("layout-defaults");var cr=t.defineComponent({props:{},setup:()=>(t.provide("ns",dr),{}),render(){const e=this.$slots,n=t.inject("options",{}),i=t.inject("__emit__",{});e.menu;const r=t.ref(!!e.tabs);return void 0===e.tabs&&n.showTabs&&(r.value=!0),t.createVNode(a.ElContainer,{class:dr.b()},{default:()=>[t.createVNode(lr,null,null),t.createVNode("div",{class:[dr.b("content")]},[t.createVNode(nr,null,null),n.showTabs?e.tabs?e.tabs?.():t.createVNode(Lr,{tabs:n.tabs,activeTab:n.activeTab,onChange:(...e)=>i("tabsChange",...e),onSelect:(...e)=>i("tabsSelect",...e),onClose:(...e)=>i("tabsClose",...e)},null):null,t.createVNode("main",{class:[dr.bf("main"),dr.is("layout-tabs",r.value)]},[e.default?.()])])]})}});const{getLightColor:ur}=on();var hr=t.defineComponent({setup(e,{slots:a}){const n=t.inject("ns",{}),i=t.inject("options",{}),r=t.computed((()=>{const{isHeaderBarColorGradual:e,headerBarColor:t}=i.setting;return e?{background:`linear-gradient(to bottom , ${t}, ${ur(t,.5)})`}:""}));return()=>t.createVNode(t.Fragment,null,[t.createVNode("header",{class:n.b("header"),style:r.value},[t.createVNode(En,null,null),t.createVNode("div",{class:n.bf("header","menu")},[a[_n]?a[_n]():t.createVNode(sr,{menuTree:i.menuTree,router:i.menuRouter,mode:i.menuMode},null)]),t.createVNode("div",{class:n.bf("header","right")},[t.createVNode(tr,null,{default:()=>[a[mn]?.(),a[gn]?.()]})])])])}});const pr=m("layout-transverse");var fr=t.defineComponent({props:{},setup:()=>(t.provide("ns",pr),{}),render(){const e=this.$slots,a=t.inject("options",{}),n=t.inject("__emit__",{}),i={};e[_n]&&(i[_n]=()=>e[_n]()),e[mn]&&(i[mn]=()=>e[mn]()),e[gn]&&(i[gn]=()=>e[gn]());const r=t.ref(!!e.tabs);return void 0===e.tabs&&a.showTabs&&(r.value=!0),t.createVNode(t.Fragment,null,[t.createVNode(hr,null,(o=i,"function"==typeof o||"[object Object]"===Object.prototype.toString.call(o)&&!t.isVNode(o)?i:{default:()=>[i]})),a.showTabs?e.tabs?e.tabs?.():t.createVNode(Lr,{tabs:a.tabs,activeTab:a.activeTab,onChange:(...e)=>n("tabsChange",...e),onSelect:(...e)=>n("tabsSelect",...e),onClose:(...e)=>n("tabsClose",...e)},null):null,t.createVNode("main",{class:[pr.b("main"),pr.is("layout-tabs",r.value)]},[e.default?.()])]);var o}});const{getLightColor:_r}=on();var mr=t.defineComponent({setup(e,{slots:a}){const n=t.inject("ns",{}),i=t.inject("options",{}),r=t.computed((()=>{const{isHeaderBarColorGradual:e,headerBarColor:t}=i.setting;return e?{background:`linear-gradient(to bottom , ${t}, ${_r(t,.5)})`}:""}));return()=>t.createVNode(t.Fragment,null,[t.createVNode("header",{class:n.b("header"),style:r.value},[t.createVNode(En,null,null),t.createVNode("div",{class:n.bf("header","menu")},null),t.createVNode("div",{class:n.bf("header","right")},[t.createVNode(tr,null,{default:()=>[a[mn]?.(),a[gn]?.()]})])])])}}),gr=t.defineComponent({setup:()=>({ns:t.inject("ns",{})}),render(){const e=this.$slots,a=this.ns,n=t.inject("options",{});return t.createVNode("aside",{class:a.b("sidebar")},[e[_n]?e[_n]():t.createVNode(sr,{mode:"vertical",menuTree:n.menuTree},null)])}});const vr=m("layout-columns");var yr=t.defineComponent({props:{},setup:()=>(t.provide("ns",vr),{}),render(){const e=this.$slots,n=t.inject("options",{}),i=t.inject("__emit__",{}),r={};e[_n]&&(r[_n]=()=>e[_n]()),e[mn]&&(r[mn]=()=>e[mn]()),e[gn]&&(r[gn]=()=>e[gn]());const o=t.ref(!!e.tabs);return void 0===e.tabs&&n.showTabs&&(o.value=!0),t.createVNode(a.ElContainer,{class:vr.b()},{default:()=>{return[t.createVNode(gr,null,null),t.createVNode("div",{class:[vr.b("content")]},[t.createVNode(mr,null,(a=r,"function"==typeof a||"[object Object]"===Object.prototype.toString.call(a)&&!t.isVNode(a)?r:{default:()=>[r]})),n.showTabs?e.tabs?e.tabs?.():t.createVNode(Lr,{tabs:n.tabs,activeTab:n.activeTab,onChange:(...e)=>i("tabsChange",...e),onSelect:(...e)=>i("tabsSelect",...e),onClose:(...e)=>i("tabsClose",...e)},null):null,t.createVNode("main",{class:[vr.bf("main"),vr.is("layout-tabs",o.value)]},[e.default?.()])])];var a}})}});const{getLightColor:br}=on();var Er=t.defineComponent({setup(e,{slots:a}){const n=t.inject("ns",{}),i=t.inject("options",{}),r=t.computed((()=>{const{isHeaderBarColorGradual:e,headerBarColor:t}=i.setting;return e?{background:`linear-gradient(to bottom , ${t}, ${br(t,.5)})`}:""}));return()=>t.createVNode(t.Fragment,null,[t.createVNode("header",{class:n.b("header"),style:r.value},[t.createVNode(En,null,null),t.createVNode("div",{class:n.bf("header","menu")},[a[_n]?.()]),t.createVNode("div",{class:n.bf("header","right")},[t.createVNode(tr,null,{default:()=>[a[mn]?.(),a[gn]?.()]})])])])}}),Sr=t.defineComponent({setup:()=>({ns:t.inject("ns",{})}),render(){const e=this.$slots,n=this.ns,i=t.inject("options",{});return t.createVNode("aside",{class:n.b("sidebar")},[t.createVNode(a.ElScrollbar,null,{default:()=>[e[_n]?e[_n]():t.createVNode(sr,{mode:"vertical",menuTree:i.menuTree},null)]})])}});const Ar=m("layout-classic");var wr=t.defineComponent({props:{},setup:()=>(t.provide("ns",Ar),{ns:Ar}),render(){const e=this.$slots,a=t.inject("options",{}),n=t.inject("__emit__",{});e.menu;const i=t.ref(!!e.tabs);return void 0===e.tabs&&a.showTabs&&(i.value=!0),t.createVNode(t.Fragment,null,[t.createVNode(Er,null,null),t.createVNode("div",{class:[Ar.b("content"),Ar.is("layout-tabs",i.value)]},[t.createVNode(Sr,null,null),t.createVNode("div",{class:Ar.b("container")},[a.showTabs?e.tabs?e.tabs?.():t.createVNode(Lr,{tabs:a.tabs,activeTab:a.activeTab,onChange:(...e)=>n("tabsChange",...e),onSelect:(...e)=>n("tabsSelect",...e),onClose:(...e)=>n("tabsClose",...e)},null):null,t.createVNode("main",{class:[Ar.b("main")]},[e.default?.()])])])])}});const Cr=m("layout"),Tr={defaults:t.markRaw(cr),transverse:t.markRaw(fr),columns:t.markRaw(yr),classic:t.markRaw(wr)},Rr=(e,t)=>{if(Array.isArray(e))return t};const Dr=fn(t.defineComponent({name:"NextLayout",props:{className:{type:String,default:""},style:{type:Object,default:()=>({})},options:{type:Object,default:()=>({})}},emits:["changeLanguage","changeUserDropdown","changeOptions","tabsChange","tabsSelect","tabsClose"],setup(e,{slots:a,emit:n}){const i=t.ref(Ka(vn,e.options,Rr));t.provide("options",i.value),t.provide("__ns__",Cr),t.provide("__emit__",n),t.provide("__slots__",a);const r=e=>{i.value=Ka(i.value,e,Rr),un(i.value?.setting),n("changeOptions",i.value)};return t.provide("updateOptions",r),t.watch((()=>e.options),(e=>{r(e)}),{deep:!0,immediate:!0}),{options:i.value,updateOptions:r}},render(){const e=this.$props,a=this.$slots,n=this.options.setting?.layout||"transverse",i=t.ref(Tr[n]);t.watchEffect((()=>{i.value=Tr[n],i.value||(i.value=Tr.transverse)}));const r={};for(const e in a)Object.prototype.hasOwnProperty.call(a,e)&&(r[e]=()=>a[e]?.());return t.createVNode("div",{class:[Cr.b(),e.className],style:e.style},[t.h(i.value,{},{...r})])}})),kr=m("tabs");var xr=t.defineComponent({name:"NextTabs",props:{activeTab:{type:[String,Number],default:"/"},tabs:{type:Array,default:()=>[]}},emits:["change","select","close"],setup(e,{emit:n}){const{t:i}=rn(),r=t.getCurrentInstance().appContext.config.globalProperties.$router,o=t.computed((()=>r.currentRoute.value.fullPath)),s=t.computed((()=>e.tabs)),l=s.value?.findIndex((e=>e.path===o.value));if(l<0){const e=s.value[0];e&&e.path&&r.replace({path:e.path})}const d=t.ref(l),c=t.ref(s.value),u=e=>{const t=o.value,a=c.value.length,i=c.value.findIndex((e=>e.path===t));switch(e){case"other":i>-1&&(d.value=1,c.value=[c.value[0],c.value[i]]);break;case"left":if(i>-1){const e=c.value.slice(i);e.unshift(c.value[0]),c.value=e,d.value=1}break;case"right":if(i>-1&&i<a-1){const e=c.value.slice(0,i+1);c.value=e}break;case"all":const e=c.value[0];d.value=0,c.value=[e],h(null,e,d.value)}n("change",d.value,c.value,e)},h=(e,t,a)=>{e?.stopPropagation(),d.value=a;let i={path:t.path,query:t.query,params:t.params};r.push(i),n("select",t,a)};t.watch((()=>r.currentRoute?.value),(e=>{const{tagTitle:t}=e.query,a={name:e.name,title:t||e.meta?.title,path:e.path,meta:e.meta,params:e.params,query:e.query},i=c.value.findIndex((t=>t.path===e.path));i>-1?(d.value=i,c.value[i]=a):(d.value=c.value.length,c.value.push(a)),n("change",d.value,c.value,"add")}));const p=()=>t.createVNode("nav",{class:kr.b()},[t.createVNode(a.ElScrollbar,null,{default:()=>[t.createVNode("ul",{class:kr.b("list")},[c.value.map(((e,s)=>e?t.createVNode("li",{class:["tab-item",kr.is("active",d.value===s)],onClick:t=>h(t,e,s)},[t.createVNode("i",{class:["tab-icon",e.meta?.icon]},null),t.createVNode("span",null,[i(e.title)]),e.meta?.isAffix||"/"===e.path?null:t.createVNode("span",{onClick:t=>((e,t,a)=>{e.stopPropagation();const i=o.value;if(i===t.path){const e=c.value[a-1];r.push({path:e.path,query:e.query||{},params:e.params||{}}),n("close",e,c.value)}c.value.splice(a,1);const s=c.value.findIndex((e=>e.path===i))||0;d.value=s>-1?s:0,n("change",d.value,c.value,"close")})(t,e,s)},[t.createVNode(a.ElIcon,{class:"tab-close"},{default:()=>[t.createVNode(zn,null,null)]})])]):null))])]}),t.createVNode(a.ElDropdown,{"show-timeout":80,"hide-timeout":80,onCommand:u},{default:()=>t.createVNode("span",{class:kr.b("tab-more")},[t.createVNode("i",{class:[kr.be("tab-more","box"),kr.be("tab-more","top")]},null),t.createVNode("i",{class:[kr.be("tab-more","box"),kr.be("tab-more","bottom")]},null)]),dropdown:()=>t.createVNode(a.ElDropdownMenu,null,{default:()=>[t.createVNode(a.ElDropdownItem,{command:"other"},{default:()=>[t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(zn,null,null)]}),t.createVNode("span",null,[i("next.layout.tabsOther")])]}),t.createVNode(a.ElDropdownItem,{command:"left"},{default:()=>[t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(Vn,null,null)]}),t.createVNode("span",null,[i("next.layout.tabsLeft")])]}),t.createVNode(a.ElDropdownItem,{command:"right"},{default:()=>[t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(Ni,null,null)]}),t.createVNode("span",null,[i("next.layout.tabsRight")])]}),t.createVNode(a.ElDropdownItem,{command:"all"},{default:()=>[t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(zn,null,null)]}),t.createVNode("span",null,[i("next.layout.tabsAll")])]})]})})]);return()=>t.createVNode(t.Fragment,null,[p()])}});const Lr=fn(xr),Nr=m("container");const Br=fn(t.defineComponent({name:"NextContainer",props:{className:{type:String,default:""},style:{type:Object,default:()=>({})},scrollbar:{type:Boolean,default:!1},padding:{type:[Boolean,String,Number],default:!0},card:{type:Boolean,default:!1}},setup(e,{slots:n}){const i=t.computed((()=>{let t={};const a=e.padding;return"boolean"==typeof a?t=a?{padding:"15px"}:{}:"string"==typeof a?t={padding:a}:"number"==typeof a&&(t={padding:a+"px"}),t}));return()=>e.scrollbar?t.createVNode(a.ElScrollbar,{class:[Nr.b(),e.className],style:e.style},{default:()=>[n.default?.()]}):t.createVNode("div",{class:[Nr.b(),e.className],style:{...i.value,...e.style}},[e.card?t.createVNode("div",{class:Nr.b("card")},[n.default?.()]):n.default?.()])}}));function Vr(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Mr={exports:{}};(Mr.exports={}).forEach=function(e,t){for(var a=0;a<e.length;a++){var n=t(e[a]);if(n)return n}};var Or=Mr.exports,Ir={exports:{}},Pr=Ir.exports={};Pr.isIE=function(e){return(-1!==(t=navigator.userAgent.toLowerCase()).indexOf("msie")||-1!==t.indexOf("trident")||-1!==t.indexOf(" edge/"))&&(!e||e===function(){var e=3,t=document.createElement("div"),a=t.getElementsByTagName("i");do{t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e"}while(a[0]);return e>4?e:undefined}());var t},Pr.isLegacyOpera=function(){return!!window.opera};var Ur=Ir.exports,jr={exports:{}};(jr.exports={}).getOption=function(e,t,a){var n=e[t];if(null==n&&void 0!==a)return a;return n};var Fr=jr.exports;function zr(){var e={},t=0,a=0,n=0;return{add:function(i,r){r||(r=i,i=0),i>a?a=i:i<n&&(n=i),e[i]||(e[i]=[]),e[i].push(r),t++},process:function(){for(var t=n;t<=a;t++)for(var i=e[t],r=0;r<i.length;r++){(0,i[r])()}},size:function(){return t}}}var Gr="_erd";function Hr(e){return e[Gr]}var qr={initState:function(e){return e[Gr]={},Hr(e)},getState:Hr,cleanState:function(e){delete e[Gr]}},Wr=Ur,Kr=Or.forEach,Yr=Or.forEach,$r=function(e){var t=e.stateHandler.getState;return{isDetectable:function(e){var a=t(e);return a&&!!a.isDetectable},markAsDetectable:function(e){t(e).isDetectable=!0},isBusy:function(e){return!!t(e).busy},markBusy:function(e,a){t(e).busy=!!a}}},Xr=function(e){var t={};function a(a){var n=e.get(a);return void 0===n?[]:t[n]||[]}return{get:a,add:function(a,n){var i=e.get(a);t[i]||(t[i]=[]),t[i].push(n)},removeListener:function(e,t){for(var n=a(e),i=0,r=n.length;i<r;++i)if(n[i]===t){n.splice(i,1);break}},removeAllListeners:function(e){var t=a(e);t&&(t.length=0)}}},Zr=function(){var e=1;return{generate:function(){return e++}}},Jr=function(e){var t=e.idGenerator,a=e.stateHandler.getState;return{get:function(e){var t=a(e);return t&&void 0!==t.id?t.id:null},set:function(e){var n=a(e);if(!n)throw new Error("setId required the element to have a resize detection state.");var i=t.generate();return n.id=i,i}}},Qr=function(e){function t(){}var a={log:t,warn:t,error:t};if(!e&&window.console){var n=function(e,t){e[t]=function(){var e=console[t];if(e.apply)e.apply(console,arguments);else for(var a=0;a<arguments.length;a++)e(arguments[a])}};n(a,"log"),n(a,"warn"),n(a,"error")}return a},eo=Ur,to=function(e){var t=(e=e||{}).reporter,a=Fr.getOption(e,"async",!0),n=Fr.getOption(e,"auto",!0);n&&!a&&(t&&t.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),a=!0);var i,r=zr(),o=!1;function s(){for(o=!0;r.size();){var e=r;r=zr(),e.process()}o=!1}function l(){var e;e=s,i=setTimeout(e,0)}return{add:function(e,t){!o&&n&&a&&0===r.size()&&l(),r.add(e,t)},force:function(e){o||(void 0===e&&(e=a),i&&(clearTimeout(i),i=null),e?l():s())}}},ao=qr,no=function(e){var t=(e=e||{}).reporter,a=e.batchProcessor,n=e.stateHandler.getState;if(!t)throw new Error("Missing required dependency: reporter.");function i(t){var a=e.important?" !important; ":"; ";return(t.join(a)+a).trim()}function r(e){return n(e).object}return{makeDetectable:function(e,r,o){o||(o=r,r=e,e=null),(e=e||{}).debug,Wr.isIE(8)?o(r):function(r,o){var s=i(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),l=!1,d=window.getComputedStyle(r),c=r.offsetWidth,u=r.offsetHeight;function h(){function a(){if("static"===d.position){r.style.setProperty("position","relative",e.important?"important":"");var a=function(t,a,n,i){var r=n[i];"auto"!==r&&"0"!==function(e){return e.replace(/[^-\d\.]/g,"")}(r)&&(t.warn("An element that is positioned static has style."+i+"="+r+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+i+" will be set to 0. Element: ",a),a.style.setProperty(i,"0",e.important?"important":""))};a(t,r,d,"top"),a(t,r,d,"right"),a(t,r,d,"bottom"),a(t,r,d,"left")}}""!==d.position&&(a(),l=!0);var i=document.createElement("object");i.style.cssText=s,i.tabIndex=-1,i.type="text/html",i.setAttribute("aria-hidden","true"),i.onload=function(){l||a(),function e(t,a){if(!t.contentDocument){var i=n(t);return i.checkForObjectDocumentTimeoutId&&window.clearTimeout(i.checkForObjectDocumentTimeoutId),void(i.checkForObjectDocumentTimeoutId=setTimeout((function(){i.checkForObjectDocumentTimeoutId=0,e(t,a)}),100))}a(t.contentDocument)}(this,(function(e){o(r)}))},Wr.isIE()||(i.data="about:blank"),n(r)&&(r.appendChild(i),n(r).object=i,Wr.isIE()&&(i.data="about:blank"))}n(r).startSize={width:c,height:u},a?a.add(h):h()}(r,o)},addListener:function(e,t){function a(){t(e)}if(Wr.isIE(8))n(e).object={proxy:a},e.attachEvent("onresize",a);else{var i=r(e);if(!i)throw new Error("Element is not detectable by this strategy.");i.contentDocument.defaultView.addEventListener("resize",a)}},uninstall:function(e){if(n(e)){var t=r(e);t&&(Wr.isIE(8)?e.detachEvent("onresize",t.proxy):e.removeChild(t),n(e).checkForObjectDocumentTimeoutId&&window.clearTimeout(n(e).checkForObjectDocumentTimeoutId),delete n(e).object)}}}},io=function(e){var t=(e=e||{}).reporter,a=e.batchProcessor,n=e.stateHandler.getState;e.stateHandler.hasState;var i=e.idHandler;if(!a)throw new Error("Missing required dependency: batchProcessor");if(!t)throw new Error("Missing required dependency: reporter.");var r=function(){var e=500,t=500,a=document.createElement("div");a.style.cssText=l(["position: absolute","width: 1000px","height: 1000px","visibility: hidden","margin: 0","padding: 0"]);var n=document.createElement("div");n.style.cssText=l(["position: absolute","width: 500px","height: 500px","overflow: scroll","visibility: none","top: -1500px","left: -1500px","visibility: hidden","margin: 0","padding: 0"]),n.appendChild(a),document.body.insertBefore(n,document.body.firstChild);var i=e-n.clientWidth,r=t-n.clientHeight;return document.body.removeChild(n),{width:i,height:r}}(),o="erd_scroll_detection_container";function s(e){!function(e,t,a){function n(a,n){n=n||function(t){e.head.appendChild(t)};var i=e.createElement("style");return i.innerHTML=a,i.id=t,n(i),i}if(!e.getElementById(t)){var i=a+"_animation",r=a+"_animation_active",o="/* Created by the element-resize-detector library. */\n";o+="."+a+" > div::-webkit-scrollbar { "+l(["display: none"])+" }\n\n",o+="."+r+" { "+l(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+i,"animation-name: "+i])+" }\n",o+="@-webkit-keyframes "+i+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }\n",n(o+="@keyframes "+i+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }")}}(e,"erd_scroll_detection_scrollbar_style",o)}function l(t){var a=e.important?" !important; ":"; ";return(t.join(a)+a).trim()}function d(e,a,n){if(e.addEventListener)e.addEventListener(a,n);else{if(!e.attachEvent)return t.error("[scroll] Don't know how to add event listeners.");e.attachEvent("on"+a,n)}}function c(e,a,n){if(e.removeEventListener)e.removeEventListener(a,n);else{if(!e.detachEvent)return t.error("[scroll] Don't know how to remove event listeners.");e.detachEvent("on"+a,n)}}function u(e){return n(e).container.childNodes[0].childNodes[0].childNodes[0]}function h(e){return n(e).container.childNodes[0].childNodes[0].childNodes[1]}return s(window.document),{makeDetectable:function(e,s,c){function p(){if(e.debug){var a=Array.prototype.slice.call(arguments);if(a.unshift(i.get(s),"Scroll: "),t.log.apply)t.log.apply(null,a);else for(var n=0;n<a.length;n++)t.log(a[n])}}function f(e){var t=n(e).container.childNodes[0],a=window.getComputedStyle(t);return!a.width||-1===a.width.indexOf("px")}function _(){var e=window.getComputedStyle(s),t={};return t.position=e.position,t.width=s.offsetWidth,t.height=s.offsetHeight,t.top=e.top,t.right=e.right,t.bottom=e.bottom,t.left=e.left,t.widthCSS=e.width,t.heightCSS=e.height,t}function m(){if(p("storeStyle invoked."),n(s)){var e=_();n(s).style=e}else p("Aborting because element has been uninstalled")}function g(e,t,a){n(e).lastWidth=t,n(e).lastHeight=a}function v(){return 2*r.width+1}function y(){return 2*r.height+1}function b(e){return e+10+v()}function E(e){return e+10+y()}function S(e,t,a){var n=u(e),i=h(e),r=b(t),o=E(a),s=function(e){return 2*e+v()}(t),l=function(e){return 2*e+y()}(a);n.scrollLeft=r,n.scrollTop=o,i.scrollLeft=s,i.scrollTop=l}function A(){var e=n(s).container;if(!e){(e=document.createElement("div")).className=o,e.style.cssText=l(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),n(s).container=e,function(e){e.className+=" "+o+"_animation_active"}(e),s.appendChild(e);var t=function(){n(s).onRendered&&n(s).onRendered()};d(e,"animationstart",t),n(s).onAnimationStart=t}return e}function w(){if(p("Injecting elements"),n(s)){!function(){var a=n(s).style;if("static"===a.position){s.style.setProperty("position","relative",e.important?"important":"");var i=function(e,t,a,n){var i=a[n];"auto"!==i&&"0"!==function(e){return e.replace(/[^-\d\.]/g,"")}(i)&&(e.warn("An element that is positioned static has style."+n+"="+i+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+n+" will be set to 0. Element: ",t),t.style[n]=0)};i(t,s,a,"top"),i(t,s,a,"right"),i(t,s,a,"bottom"),i(t,s,a,"left")}}();var a=n(s).container;a||(a=A());var i,c,u,h,f=r.width,_=r.height,m=l(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),g=l(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(["left: "+(i=(i=-(1+f))?i+"px":"0"),"top: "+(c=(c=-(1+_))?c+"px":"0"),"right: "+(h=(h=-f)?h+"px":"0"),"bottom: "+(u=(u=-_)?u+"px":"0")])),v=l(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),y=l(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),b=l(["position: absolute","left: 0","top: 0"]),E=l(["position: absolute","width: 200%","height: 200%"]),S=document.createElement("div"),w=document.createElement("div"),C=document.createElement("div"),T=document.createElement("div"),R=document.createElement("div"),D=document.createElement("div");S.dir="ltr",S.style.cssText=m,S.className=o,w.className=o,w.style.cssText=g,C.style.cssText=v,T.style.cssText=b,R.style.cssText=y,D.style.cssText=E,C.appendChild(T),R.appendChild(D),w.appendChild(C),w.appendChild(R),S.appendChild(w),a.appendChild(S),d(C,"scroll",k),d(R,"scroll",x),n(s).onExpandScroll=k,n(s).onShrinkScroll=x}else p("Aborting because element has been uninstalled");function k(){var e=n(s);e&&e.onExpand?e.onExpand():p("Aborting expand scroll handler: element has been uninstalled")}function x(){var e=n(s);e&&e.onShrink?e.onShrink():p("Aborting shrink scroll handler: element has been uninstalled")}}function C(){function r(t,a,n){var i=function(e){return u(e).childNodes[0]}(t),r=b(a),o=E(n);i.style.setProperty("width",r+"px",e.important?"important":""),i.style.setProperty("height",o+"px",e.important?"important":"")}function o(o){var d=s.offsetWidth,c=s.offsetHeight,u=d!==n(s).lastWidth||c!==n(s).lastHeight;p("Storing current size",d,c),g(s,d,c),a.add(0,(function(){if(u)if(n(s))if(l()){if(e.debug){var a=s.offsetWidth,o=s.offsetHeight;a===d&&o===c||t.warn(i.get(s),"Scroll: Size changed before updating detector elements.")}r(s,d,c)}else p("Aborting because element container has not been initialized");else p("Aborting because element has been uninstalled")})),a.add(1,(function(){n(s)?l()?S(s,d,c):p("Aborting because element container has not been initialized"):p("Aborting because element has been uninstalled")})),u&&o&&a.add(2,(function(){n(s)?l()?o():p("Aborting because element container has not been initialized"):p("Aborting because element has been uninstalled")}))}function l(){return!!n(s).container}function d(){p("notifyListenersIfNeeded invoked");var e=n(s);return void 0===n(s).lastNotifiedWidth&&e.lastWidth===e.startSize.width&&e.lastHeight===e.startSize.height?p("Not notifying: Size is the same as the start size, and there has been no notification yet."):e.lastWidth===e.lastNotifiedWidth&&e.lastHeight===e.lastNotifiedHeight?p("Not notifying: Size already notified"):(p("Current size not notified, notifying..."),e.lastNotifiedWidth=e.lastWidth,e.lastNotifiedHeight=e.lastHeight,void Kr(n(s).listeners,(function(e){e(s)})))}function c(){p("Scroll detected."),f(s)?p("Scroll event fired while unrendered. Ignoring..."):o(d)}if(p("registerListenersAndPositionElements invoked."),n(s)){n(s).onRendered=function(){if(p("startanimation triggered."),f(s))p("Ignoring since element is still unrendered...");else{p("Element rendered.");var e=u(s),t=h(s);0!==e.scrollLeft&&0!==e.scrollTop&&0!==t.scrollLeft&&0!==t.scrollTop||(p("Scrollbars out of sync. Updating detector elements..."),o(d))}},n(s).onExpand=c,n(s).onShrink=c;var _=n(s).style;r(s,_.width,_.height)}else p("Aborting because element has been uninstalled")}function T(){if(p("finalizeDomMutation invoked."),n(s)){var e=n(s).style;g(s,e.width,e.height),S(s,e.width,e.height)}else p("Aborting because element has been uninstalled")}function R(){c(s)}function D(){var e;p("Installing..."),n(s).listeners=[],e=_(),n(s).startSize={width:e.width,height:e.height},p("Element start size",n(s).startSize),a.add(0,m),a.add(1,w),a.add(2,C),a.add(3,T),a.add(4,R)}c||(c=s,s=e,e=null),e=e||{},p("Making detectable..."),!function(e){return!function(e){var t=e.getRootNode&&e.getRootNode().contains(e);return e===e.ownerDocument.body||e.ownerDocument.body.contains(e)||t}(e)||null===window.getComputedStyle(e)}(s)?D():(p("Element is detached"),A(),p("Waiting until element is attached..."),n(s).onRendered=function(){p("Element is now attached"),D()})},addListener:function(e,t){if(!n(e).listeners.push)throw new Error("Cannot add listener to an element that is not detectable.");n(e).listeners.push(t)},uninstall:function(e){var t=n(e);t&&(t.onExpandScroll&&c(u(e),"scroll",t.onExpandScroll),t.onShrinkScroll&&c(h(e),"scroll",t.onShrinkScroll),t.onAnimationStart&&c(t.container,"animationstart",t.onAnimationStart),t.container&&e.removeChild(t.container))},initDocument:s}};function ro(e){return Array.isArray(e)||void 0!==e.length}function oo(e){if(Array.isArray(e))return e;var t=[];return Yr(e,(function(e){t.push(e)})),t}function so(e){return e&&1===e.nodeType}var lo=function(e){var t;if((e=e||{}).idHandler)t={get:function(t){return e.idHandler.get(t,!0)},set:e.idHandler.set};else{var a=Zr(),n=Jr({idGenerator:a,stateHandler:ao});t=n}var i=e.reporter;i||(i=Qr(!1===i));var r=co(e,"batchProcessor",to({reporter:i})),o={};o.callOnAdd=!!co(e,"callOnAdd",!0),o.debug=!!co(e,"debug",!1);var s,l=Xr(t),d=$r({stateHandler:ao}),c=co(e,"strategy","object"),u=co(e,"important",!1),h={reporter:i,batchProcessor:r,stateHandler:ao,idHandler:t,important:u};if("scroll"===c&&(eo.isLegacyOpera()?(i.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),c="object"):eo.isIE(9)&&(i.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),c="object")),"scroll"===c)s=io(h);else{if("object"!==c)throw new Error("Invalid strategy name: "+c);s=no(h)}var p={};return{listenTo:function(e,a,n){function r(e){var t=l.get(e);Yr(t,(function(t){t(e)}))}function c(e,t,a){l.add(t,a),e&&a(t)}if(n||(n=a,a=e,e={}),!a)throw new Error("At least one element required.");if(!n)throw new Error("Listener required.");if(so(a))a=[a];else{if(!ro(a))return i.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");a=oo(a)}var h=0,f=co(e,"callOnAdd",o.callOnAdd),_=co(e,"onReady",(function(){})),m=co(e,"debug",o.debug);Yr(a,(function(e){ao.getState(e)||(ao.initState(e),t.set(e));var o=t.get(e);if(m&&i.log("Attaching listener to element",o,e),!d.isDetectable(e))return m&&i.log(o,"Not detectable."),d.isBusy(e)?(m&&i.log(o,"System busy making it detectable"),c(f,e,n),p[o]=p[o]||[],void p[o].push((function(){++h===a.length&&_()}))):(m&&i.log(o,"Making detectable..."),d.markBusy(e,!0),s.makeDetectable({debug:m,important:u},e,(function(e){if(m&&i.log(o,"onElementDetectable"),ao.getState(e)){d.markAsDetectable(e),d.markBusy(e,!1),s.addListener(e,r),c(f,e,n);var t=ao.getState(e);if(t&&t.startSize){var l=e.offsetWidth,u=e.offsetHeight;t.startSize.width===l&&t.startSize.height===u||r(e)}p[o]&&Yr(p[o],(function(e){e()}))}else m&&i.log(o,"Element uninstalled before being detectable.");delete p[o],++h===a.length&&_()})));m&&i.log(o,"Already detecable, adding listener."),c(f,e,n),h++})),h===a.length&&_()},removeListener:l.removeListener,removeAllListeners:l.removeAllListeners,uninstall:function(e){if(!e)return i.error("At least one element is required.");if(so(e))e=[e];else{if(!ro(e))return i.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");e=oo(e)}Yr(e,(function(e){l.removeAllListeners(e),s.uninstall(e),ao.cleanState(e)}))},initDocument:function(e){s.initDocument&&s.initDocument(e)}}};function co(e,t,a){var n=e[t];return null==n&&void 0!==a?a:n}var uo=Vr(lo);const ho=(e,a)=>{const n=uo();let i=null;n.listenTo(e,(()=>{null!==i&&clearTimeout(i),i=setTimeout((()=>{a&&a(e),clearTimeout(i)}),200)})),t.onUnmounted((()=>{n.removeListener(e,(()=>{}))}))},po=e=>{if(null==e)return e;let t;if("object"==typeof e){t=Array.isArray(e)?[]:{};for(let a in e)"object"==typeof e[a]?t[a]=po(e[a]):t[a]=e[a]}else t=e;return t},fo=(e,t)=>{const a=[],n=new Map;for(const i of e){const e=i[t];n.has(e)||(n.set(e,!0),a.push(i))}return a},_o=e=>null!=e&&("string"==typeof e?""!==e.trim():!1!==e),mo=(...e)=>{let t=null;for(let a=0;a<e.length;a++){const n=e[a];if(null!=n){t=n;break}}return t},go=(e,t,a)=>(Object.defineProperty(e,a,{get:()=>t[a]}),{target:e,source:t});var vo={className:{type:String,default:""},style:{type:Object,default:()=>({})},options:{type:Object,default:()=>({})},loading:{type:Boolean,default:!1},data:{type:Array,default:()=>[]},page:{type:Object,default:()=>({pageIndex:1,pageSize:10,total:0})},rowStyle:{type:Function,default:void 0},rowClassName:{type:Function,default:void 0},cellStyle:{type:Function,default:void 0},cellClassName:{type:Function,default:void 0},headerRowStyle:{type:Function,default:void 0},headerRowClassName:{type:Function,default:void 0},headerCellStyle:{type:Function,default:void 0},headerCellClassName:{type:Function,default:void 0},spanMethod:{type:Function,default:void 0}};const yo=["menu-left-prefix","menu-left-suffix","menu-right-prefix","menu-right-suffix"],bo=["operation-column-prefix","operation-column-suffix"];var Eo={initLoadData:!0,defaultContentHeight:300,fullscreenchangeContentHeight:!1,rowKey:"id",size:"default",fit:!0,stripe:!0,border:!0,index:!0,selection:!0,headerAlign:"center",cellAlign:"center",columnMinWidth:"100px",columns:[],showSearchForm:!0,showHeaderMenu:!0,showSearchLabel:!0,searchSpan:4,searchGutter:20,searchLabelWidth:"5em",searchColumnMinWidth:300,searchColumns:[],addBtn:!0,viewBtn:!0,delBtn:!0,editBtn:!0,batchDelBtn:!1,refreshBtn:!0,settingBtn:!0,operations:!0,operationsWidth:260,operationsBtnPlain:!1,operationsBtnText:!0,operationsBtnSize:"small",addBtnText:"",isPagination:!0,dialogTitle:"",dialogWidth:"60%",dialogFullscreen:!1,closeOnClickModal:!1,formColumns:[],formLabelWidth:"5em",formSpan:12,formColumnMinWidth:350};const So="column-",Ao=e=>So+e,wo="search-",Co=e=>wo+e,To="form-",Ro=e=>To+e,Do=m("spin-loading");var ko=t.defineComponent({name:"NextSpinLoading",props:{loading:{type:Boolean,default:!1},tip:{type:String,default:""}},setup(){const{t:e}=rn();return{t:e}},render(){const e=this.t,a=this.$slots,n=this.$props,i=n.tip||e("next.loading");return t.createVNode("div",{class:Do.b()},[n.loading?t.createVNode("div",{class:Do.b("mask")},[t.createVNode("span",{class:Do.b("mask-dot")},[t.createVNode("i",{class:Do.be("mask","dot-item")},null),t.createVNode("i",{class:Do.be("mask","dot-item")},null),t.createVNode("i",{class:Do.be("mask","dot-item")},null),t.createVNode("i",{class:Do.be("mask","dot-item")},null)]),t.createVNode("span",{class:Do.be("mask","text")},[i])]):null,a.default?.()])}}),xo=t.defineComponent({name:"SearchColumn",props:{searchSpan:{type:Number,default:4},columns:{type:Array,default:()=>[]},formParams:{type:Object,default:()=>{}}},setup(e,{slots:n}){const i=t.inject("options",{}),r=t.isRef(i)?t.unref(i):i,{t:o}=rn(),s=t.inject("ns",{}),l=t.ref(e.columns);t.watch((()=>e.columns),(()=>{l.value=e.columns}),{deep:!0});const d=t.reactive(e.formParams),c=e=>e.getTime()>Date.now(),u=[{text:o("next.date.oneWeekAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-6048e5),[t,e]}},{text:o("next.date.oneMonthAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-2592e6),[t,e]}},{text:o("next.date.threeMonthsAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-7776e6),[t,e]}},{text:o("next.date.oneYearAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-31536e6),[t,e]}},{text:o("next.date.threeYearsAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-94608e6),[t,e]}}],h=(e,t)=>{d.value[t]=e},p=e=>{const i=mo(e.searchDisabled,e.disabled,!1);if(n[Co(e.prop)])return n[Co(e.prop)]({column:e});if("input"===e.type||!e.type){const n=o("next.form.input")+(e.searchPlaceholder||e.searchLabel||e.label);return t.createVNode(a.ElInput,{modelValue:d[e.prop],"onUpdate:modelValue":t=>d[e.prop]=t,clearable:!0,disabled:i,placeholder:n},{prefix:e.prefix?()=>e.prefix(d,e):null,suffix:e.suffix?()=>e.suffix(d,e):null,prepend:e.prepend?()=>e.prepend(d,e):null,append:e.append?()=>e.append(d,e):null})}if("inputInteger"===e.type){const n=o("next.form.input")+(e.searchPlaceholder||e.searchLabel||e.label);return t.createVNode(a.ElInput,{modelValue:d[e.prop],"onUpdate:modelValue":t=>d[e.prop]=t,clearable:!0,disabled:i,placeholder:n,onInput:t=>((e,t)=>{const a=e.replace(/\D/g,"");d.value[t]=a})(t,e.prop)},{prefix:e.prefix?()=>e.prefix(d,e):null,suffix:e.suffix?()=>e.suffix(d,e):null,prepend:e.prepend?()=>e.prepend(d,e):null,append:e.append?()=>e.append(d,e):null})}if("inputNumber"===e.type){const n=o("next.form.input")+(e.searchPlaceholder||e.searchLabel||e.label);return t.createVNode(a.ElInput,{modelValue:d[e.prop],"onUpdate:modelValue":t=>d[e.prop]=t,clearable:!0,disabled:i,placeholder:n,onInput:t=>((e,t)=>{let a=e;a=a.replace(/[^0-9\.]/g,""),a=a.replace(/^\./,"0."),a=a.replace(/\.{2,}/g,"."),a=a.replace(".","DUMMY"),a=a.replace(/\./g,""),a=a.replace("DUMMY","."),d.value[t]=a})(t,e.prop)},{prefix:e.prefix?()=>e.prefix(d,e):null,suffix:e.suffix?()=>e.suffix(d,e):null,prepend:e.prepend?()=>e.prepend(d,e):null,append:e.append?()=>e.append(d,e):null})}if("select"===e.type){const n=o("next.form.select")+(e.searchPlaceholder||e.searchLabel||e.label);return t.createVNode(a.ElSelect,{modelValue:d[e.prop],"onUpdate:modelValue":t=>d[e.prop]=t,clearable:!0,disabled:i,placeholder:n,multiple:e.searchMultiple||!1,"collapse-tags":!0,"collapse-tags-tooltip":!0},{default:()=>[e.dicData&&e.dicData.map((e=>t.createVNode(a.ElOption,{value:e.value,label:e.label},null)))]})}if("date"===e.type){const n=o("next.form.select")+(e.searchPlaceholder||e.searchLabel||e.label);return t.createVNode(a.ElDatePicker,{modelValue:d[e.prop],"onUpdate:modelValue":t=>d[e.prop]=t,type:"date","value-format":e.searchFormat||"YYYY-MM-DD",format:e.searchFormat||"YYYY-MM-DD",clearable:!0,"disabled-date":e.searchDisabledDate||c,disabled:i,placeholder:n,editable:e.searchEditable||!1},null)}if("datetimerange"===e.type)return t.createVNode(a.ElDatePicker,{modelValue:d[e.prop],"onUpdate:modelValue":t=>d[e.prop]=t,type:"datetimerange","value-format":e.searchFormat||"YYYY-MM-DD HH:mm:ss",format:e.searchFormat||"YYYY-MM-DD HH:mm:ss",clearable:!0,"range-separator":o("next.date.rangeSeparator"),"start-placeholder":o("next.date.startPlaceholder"),"end-placeholder":o("next.date.endPlaceholder"),"disabled-date":e.searchDisabledDate||c,disabled:i,editable:e.searchEditable||!1,shortcuts:e.searchShortcuts||u},null);if("numberRange"===e.type){const n=d[e.prop],i=t.ref(n[0]),r=t.ref(n[1]),l=t.ref(e.searchMin),c=t.ref(e.searchMax),u=t.ref(!0),p=t=>{i.value=t,h([i.value,r.value],e.prop)},f=t=>{r.value=t,h([i.value,r.value],e.prop)};return t.createVNode("div",{class:s.b("header-search-item-number-range")},[t.createVNode(a.ElInputNumber,{modelValue:i.value,"onUpdate:modelValue":e=>i.value=e,min:l.value,max:c.value,controls:u.value,onChange:p},null),t.createVNode("span",{class:"number-range-division"},[o("next.date.rangeSeparator")]),t.createVNode(a.ElInputNumber,{modelValue:r.value,"onUpdate:modelValue":e=>r.value=e,min:l.value,max:c.value,controls:u.value,onChange:f},null)])}};return()=>t.createVNode(t.Fragment,null,[t.createVNode(t.Fragment,null,[l.value.map((n=>!n.hide&&t.createVNode(a.ElCol,{span:e.searchSpan,class:s.b("header-search-item")},{default:()=>[t.createVNode(a.ElFormItem,null,{label:()=>n.label&&mo(r.showSearchLabel,!0)?t.createVNode(bn,{width:r.searchLabelWidth,content:n.label,textAlign:"right"},null):null,default:()=>p(n)})]})))])])}});function Lo(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!t.isVNode(e)}var No=t.defineComponent({name:"HeaderSearch",props:{columns:{type:Array,default:()=>[]}},emits:["confirmSearch","clearSearch","zoomResize"],setup(e,{emit:n,slots:i}){const r=t.inject("options",{}),o=t.isRef(r)?t.unref(r):r,s=t.inject("ns",{}),{t:l}=rn(),d=t.inject("searchFormSlots"),c={};d.value.forEach((e=>{c[e]=(...t)=>i[e]&&i[e](...t)}));const u=t.reactive({}),h=t.ref(e.columns),p=()=>{h.value.forEach((e=>{u[e.prop]="",_o(e.defaultValue)&&(u[e.prop]=e.defaultValue)}))};p();const f=()=>{n("confirmSearch",u)},_=()=>{p(),f(),n("clearSearch")},m=t.ref(o.searchSpan),g=h.value.length,v=t.ref(g),y=t.ref(h.value),b=t.ref([]),E=t.ref(!1),{proxy:S}=t.getCurrentInstance();t.onMounted((()=>{const e=S.$refs.tableSearchForm?.$el;e&&ho(e,(e=>{(e=>{const t=e.clientWidth,a=o.searchColumnMinWidth;let n=Math.floor(t/a);m.value=Math.ceil(24/n);const i=24%m.value;if(i&&(m.value=i,n=24/m.value),v.value=n,g>=v.value){const e=v.value-1;y.value=h.value.slice(0,e),b.value=h.value.slice(e)}else y.value=h.value,b.value=[];const r=Math.floor(t/n);E.value=r<a})(e),n("zoomResize")}))}));const A=t.ref(!1),w=()=>{A.value=!A.value};return()=>t.createVNode(t.Fragment,null,[h.value.length?t.createVNode(a.ElForm,{ref:"tableSearchForm",inline:!0,size:o.size,model:u,class:s.b("header")},{default:()=>[t.createVNode(a.ElRow,{gutter:o.searchGutter,class:s.b("header-search")},{default:()=>[t.createVNode(xo,{searchSpan:m.value,columns:y.value,formParams:u},Lo(c)?c:{default:()=>[c]}),A.value?t.createVNode(xo,{searchSpan:m.value,columns:b.value,formParams:u},Lo(c)?c:{default:()=>[c]}):null,t.createVNode(a.ElCol,{span:m.value,class:s.b("header-search-btns")},{default:()=>[t.createVNode(a.ElFormItem,null,{default:()=>[t.createVNode(a.ElButton,{type:"primary",onClick:f},{icon:()=>t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(Oi,null,null)]}),default:()=>l("next.table.search")}),t.createVNode(a.ElButton,{onClick:_},{icon:()=>t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(ei,null,null)]}),default:()=>l("next.table.clear")}),b.value.length?E.value?t.createVNode(a.ElButton,{type:"primary",text:!0,bg:!0,circle:!0,class:s.b("header-search-expandBtn"),onClick:w},{icon:()=>A.value?t.createVNode(Wn,null,null):t.createVNode(Xn,null,null)}):t.createVNode(a.ElButton,{type:"primary",text:!0,bg:!0,class:s.b("header-search-expandBtn"),onClick:w},{icon:()=>A.value?t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(xn,null,null)]}):t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(Tn,null,null)]}),default:()=>A.value?l("next.table.foldSearch"):l("next.table.unfoldSearch")}):null]})]})]})]}):null])}}),Bo=t.defineComponent({name:"DrawerSetting",setup:()=>({visible:t.ref(!1)}),render(){const e=t.inject("options",{}),n=t.isRef(e)?t.unref(e):e,i=t.ref(n.columns),{t:r}=rn(),o=t.inject("ns",{});return t.createVNode(a.ElDrawer,{modelValue:this.visible,"onUpdate:modelValue":e=>this.visible=e,title:r("next.table.setting.title"),"append-to-body":!0,size:"450px",class:o.b("setting-drawer")},{default:()=>[t.createVNode(a.ElScrollbar,{class:o.be("setting-drawer","container")},{default:()=>[t.createVNode(a.ElTable,{data:i.value,border:!0,style:{width:"100%"}},{default:()=>[t.createVNode(a.ElTableColumn,{prop:"label",label:r("next.table.setting.label"),align:"center"},{default:({row:e})=>t.createVNode(bn,{content:r(e.label)},null)}),t.createVNode(a.ElTableColumn,{prop:"hide",label:r("next.table.setting.hide"),align:"center",width:"70px"},{default:({row:e})=>t.createVNode(a.ElCheckbox,{modelValue:e.hide,"onUpdate:modelValue":t=>e.hide=t},null)}),t.createVNode(a.ElTableColumn,{prop:"filter",label:r("next.table.setting.filter"),align:"center",width:"70px"},{default:({row:e})=>t.createVNode(a.ElCheckbox,{modelValue:e.filter,"onUpdate:modelValue":t=>e.filter=t},null)}),t.createVNode(a.ElTableColumn,{prop:"sort",label:r("next.table.setting.sort"),align:"center",width:"70px"},{default:({row:e})=>t.createVNode(a.ElCheckbox,{modelValue:e.sortable,"onUpdate:modelValue":t=>e.sortable=t},null)})]})]})]})}}),Vo=t.defineComponent({name:"HeaderMenu",setup:()=>({}),emits:["clickAdd","clickRefresh","deleteRows"],render(){const e=t.inject("options",{}),n=t.isRef(e)?t.unref(e):e,{t:i}=rn(),r=t.inject("ns",{}),o=t.inject("multipleSelection"),s=t.computed((()=>o.value.length)),l=t.ref();return t.createVNode("div",{class:r.b("header-menu")},[t.createVNode("div",{class:r.b("header-menu-left")},[this.$slots["menu-left-prefix"]?.(),n.addBtn&&t.createVNode(a.ElButton,{type:"primary",onClick:()=>{this.$emit("clickAdd")}},{icon:()=>t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(wi,null,null)]}),default:()=>i("next.table.add")}),n.batchDelBtn&&t.createVNode(a.ElButton,{type:"danger",disabled:!s.value,onClick:()=>{const e=t.unref(t.toRaw(o.value.map((e=>t.toRaw(e)))));a.ElMessageBox.confirm(i("next.table.message.batchDeleteTip"),i("next.table.message.tip"),{type:"warning",showClose:!1,center:!1,confirmButtonText:i("next.table.message.confirmButtonText"),cancelButtonText:i("next.table.message.cancelButtonText")}).then((()=>{this.$emit("deleteRows",e)})).catch((()=>{a.ElMessage({type:"info",message:i("next.table.message.cancelBatchDelete")})}))}},{icon:()=>t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(ei,null,null)]}),default:()=>i("next.table.batchDelete")}),this.$slots["menu-left-suffix"]?.()]),t.createVNode("div",{class:r.b("header-menu-right")},[this.$slots["menu-right-prefix"]?.(),n.refreshBtn&&t.createVNode(a.ElButton,{circle:!0,onClick:()=>{this.$emit("clickRefresh")}},{icon:()=>t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(Di,null,null)]})}),n.settingBtn&&t.createVNode(a.ElButton,{circle:!0,onClick:()=>{l.value.visible=!0}},{icon:()=>t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(Yi,null,null)]})}),this.$slots["menu-right-suffix"]?.()]),t.createVNode(Bo,{ref:l},null)])}});const Mo=t.defineComponent({name:"TableColumnDynamic",props:{columnOption:{type:Object,default:()=>({})}},setup(e,{slots:n}){const i=t.inject("columnSlots"),r={};i.value.forEach((e=>{r[e]=(...t)=>n[e]&&n[e](...t)}));const o=t.inject("options",{}),s=t.isRef(o)?t.unref(o):o,l=e.columnOption,d=(e,t)=>{const a=t.find((t=>t.value==e));return a?a.label:e},c=(e,a)=>l.children?.length>0?t.createVNode(t.Fragment,null,[l.children.map((e=>{return t.createVNode(Mo,{columnOption:e},"function"==typeof(a=r)||"[object Object]"===Object.prototype.toString.call(a)&&!t.isVNode(a)?r:{default:()=>[r]});var a}))]):n[Ao(l.prop)]?n[Ao(l.prop)]({row:e,index:a}):l.dicData?.length>0?t.createVNode("span",null,[d(e[l.prop],l.dicData)]):null;return()=>t.createVNode(t.Fragment,null,[!l.hide&&t.createVNode(a.ElTableColumn,{prop:l.prop,label:l.label,headerAlign:l.headerAlign||s.headerAlign,align:l.align||s.cellAlign,minWidth:l.minWidth||s.columnMinWidth||"auto",width:l.width||"auto",fixed:l.fixed,sortable:l.sortable||!1,formatter:l.formatter||null,showOverflowTooltip:mo(l.showOverflowTooltip,!0)},{default:({row:e,$index:t})=>c(e,t)})])}});var Oo=t.defineComponent({name:"TableColumnOperations",emits:["editRow","viewRow","deleteRow"],setup(e,{emit:n,slots:i}){const r=t.inject("options"),o=t.isRef(r)?t.unref(r):r,{t:s}=rn(),l=t.computed((()=>{const{operationsBtnPlain:e,operationsBtnText:t}=o;return t||e})),d=()=>{const e=o.operationsBtnText,r=o.operationsBtnPlain,d=o.operationsBtnSize;return t.createVNode(a.ElTableColumn,{fixed:"right",label:s("next.table.operation"),width:o.operationsWidth,headerAlign:o.headerAlign,align:o.cellAlign},{default:c=>t.createVNode(t.Fragment,null,[i["operation-column-prefix"]?.(c,{text:e,plain:r,size:d}),o.editBtn?t.createVNode(a.ElTooltip,{enterable:!1,effect:"dark",content:s("next.table.edit"),placement:"top",disabled:l.value},{default:()=>[t.createVNode(a.ElButton,{text:e,plain:r,class:l.value?"":"operations-btn",size:d,type:"primary",onClick:()=>(e=>{n("editRow",e)})(c)},{icon:()=>t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(ii,null,null)]}),default:()=>s("next.table.edit")})]}):null,o.viewBtn?t.createVNode(a.ElTooltip,{enterable:!1,effect:"dark",content:s("next.table.view"),placement:"top",disabled:l.value},{default:()=>[t.createVNode(a.ElButton,{text:e,plain:r,class:l.value?"":"operations-btn",size:d,type:"primary",onClick:()=>(e=>{n("viewRow",e)})(c)},{icon:()=>t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(Ji,null,null)]}),default:()=>s("next.table.view")})]}):null,o.delBtn?t.createVNode(a.ElTooltip,{enterable:!1,effect:"dark",content:s("next.table.delete"),placement:"top",disabled:l.value},{default:()=>[t.createVNode(a.ElButton,{text:e,plain:r,class:l.value?"":"operations-btn",size:d,type:"danger",onClick:()=>(e=>{a.ElMessageBox.confirm(s("next.table.message.deleteTip"),s("next.table.message.tip"),{type:"warning",showClose:!1,center:!1,confirmButtonText:s("next.table.message.confirmButtonText"),cancelButtonText:s("next.table.message.cancelButtonText")}).then((()=>{n("deleteRow",e)})).catch((()=>{a.ElMessage({type:"info",message:s("next.table.message.cancelDelete")})}))})(c)},{icon:()=>t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(ei,null,null)]}),default:()=>s("next.table.delete")})]}):null,i["operation-column-suffix"]?.(c,{text:e,plain:r,size:d})])})};return()=>t.createVNode(t.Fragment,null,[d()])}}),Io=t.defineComponent({name:"FooterPagination",props:{page:{type:Object,default:()=>{}}},emits:["change"],setup(e,{emit:n}){const i=t.inject("options",{}),r=t.isRef(i)?t.unref(i):i,o=e.page,s=e=>{o.pageIndex=e,n("change",o)},l=e=>{o.pageSize=e,n("change",o)};return()=>t.createVNode(t.Fragment,null,[t.createVNode(a.ElPagination,{currentPage:o.pageIndex,"onUpdate:currentPage":e=>o.pageIndex=e,pageSize:o.pageSize,"onUpdate:pageSize":e=>o.pageSize=e,total:o.total,small:"small"===r.size,layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,20,30,40,50,100],"onCurrent-change":s,"onSize-change":l},null)])}});const Po=m("dialog");var Uo=t.defineComponent({name:"NextDialog",props:{modelValue:{type:Boolean,default:!1},title:{type:String,default:""},fullscreen:{type:Boolean,default:!1},fullscreenBtn:{type:Boolean,default:!0},width:{type:[String,Number],default:"50%"},closeOnClickModal:{type:Boolean,default:!0},appendToBody:{type:Boolean,default:!1},draggable:{type:Boolean,default:!0},zoomSize:{type:Boolean,default:!0},destroyOnClose:{type:Boolean,default:!0},modal:{type:Boolean,default:!0},top:{type:String,default:"15vh"}},emits:["close"],setup(e,{emit:n,slots:i}){const r=t.ref(e.modelValue);t.watch((()=>e.modelValue),(e=>{r.value=e}));const o=()=>{r.value=!1,n("close")},s=t.ref(e.fullscreen);return()=>t.createVNode(t.Fragment,null,[t.createVNode(a.ElDialog,{modelValue:r.value,"onUpdate:modelValue":e=>r.value=e,class:Po.b(),title:e.title,appendToBody:e.appendToBody,"destroy-on-close":!0,fullscreen:s.value,"lock-scroll":!0,modal:e.modal,"show-close":!1,closeOnClickModal:e.closeOnClickModal,width:e.width,top:e.top,draggable:e.draggable,destroyOnClose:e.destroyOnClose,onClose:o},{default:()=>[i.default?.()],header:({close:n,titleId:i,titleClass:r})=>t.createVNode("div",{class:Po.b("header")},[t.createVNode("h4",{id:i,class:r},[e.title]),t.createVNode("div",{class:Po.e("header-right")},[e.fullscreenBtn&&t.createVNode("span",{class:"icon-fullscreen",onClick:()=>s.value=!s.value},[t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(li,null,null)]})]),t.createVNode("span",{class:"icon-close",onClick:n},[t.createVNode(a.ElIcon,{size:"18"},{default:()=>[t.createVNode(zn,null,null)]})])])])})])}});const jo={selection:!1,selectType:"radio",addBtn:!1,viewBtn:!1,delBtn:!1,editBtn:!1,batchDelBtn:!1,dialogWidth:"60%",dialogFullscreen:!1,closeOnClickModal:!1,refreshBtn:!0,settingBtn:!0,operations:!1};var Fo={size:"default",colSpan:8,labelWidth:"6em",columnMinWidth:350,columns:[],formDatum:{},tableSelectConfig:jo,isEditing:!0,showResetBtn:!0};const zo=m("form");var Go=t.defineComponent({name:"NumberRangePicker",props:{modelValue:{type:[Array,String,Number,Boolean,Object],default:function(){return[null,null]}},min:{type:Number,default:0},max:{type:Number,default:100},disabled:{type:Boolean,default:!1}},emits:["change"],setup(e,{emit:n}){const i=e.disabled,{t:r}=rn(),o=t.ref(Array.isArray(e.modelValue)&&e.modelValue[0]||0),s=t.ref(Array.isArray(e.modelValue)&&e.modelValue[1]||0),l=t.ref(e.min),d=t.ref(e.max),c=e=>{o.value=e,n("change",[o.value,s.value])},u=e=>{s.value=e,n("change",[o.value,s.value])},h=t.ref(!0),p=t.ref();t.onMounted((()=>{const e=p.value;ho(e,(e=>{const t=e.clientWidth;h.value=t>200}))}));return()=>t.createVNode(t.Fragment,null,[t.createVNode("div",{ref:p,class:zo.e("number-range")},[t.createVNode(a.ElInputNumber,{modelValue:o.value,"onUpdate:modelValue":e=>o.value=e,min:l.value,max:d.value,controls:h.value,disabled:i,onChange:c},null),t.createVNode("span",{class:zo.em("number-range","division")},[r("next.date.rangeSeparator")]),t.createVNode(a.ElInputNumber,{modelValue:s.value,"onUpdate:modelValue":e=>s.value=e,min:l.value,max:d.value,controls:h.value,disabled:i,onChange:u},null)])])}});const Ho=fn(Uo);function qo(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!t.isVNode(e)}const Wo=m("form"),Ko=t.defineComponent({name:"InputTableSelect",props:{modelValue:{type:[Array,String,Number,Boolean,Object],default:function(){return[]}},column:{type:Object,default:()=>({})},disabled:{type:Boolean,default:!1},formParams:{type:Object,default:()=>({})}},emits:["select"],setup(e,{emit:n}){const{t:i}=rn(),r=e.disabled,o=e.column,s=o.placeholder||i("next.form.select")+o.label,l=po(Eo),d=po(jo),c=$a(l,d,o.tableSelect),u=t.reactive({visible:!1,title:o.label+i("next.form.tableSelect"),dialogWidth:c.dialogWidth}),h=()=>{u.visible=!0},p=()=>{u.visible=!1},f=t.reactive({loading:!1,page:{pageIndex:1,pageSize:20,total:0},data:[]}),_=e=>{f.loading=!0,c.loadData?.(e,(e=>{f.data=e.data||[],f.page.total=e.total||0,f.loading=!1}))},m=t.ref([]);o.tableSelectDefaultValue?.(e.formParams,o,(e=>{e?.length&&(o.tableSelectRows=e,m.value=e)}));const g=t.ref(""),v=t.computed((()=>"radio"===c.selectType?!g.value:0===m.value.length)),y=e=>m.value.includes(e),b=()=>{m.value=[],g.value=""},E=()=>{const e=t.toRaw(m.value);p(),n("select",e)},S=(e,t)=>{o.addEditData?.(e,t)},A=(e,n)=>{const i=c.rowKey,r=mo(e[i],n);return"checkbox"===c.selectType?t.createVNode(a.ElCheckbox,{modelValue:y(t.toRaw(e)),onChange:a=>((e,t)=>{if(e)m.value.push(t);else{const e=m.value.indexOf(t);-1!==e&&m.value.splice(e,1)}})(a,t.toRaw(e))},null):t.createVNode(a.ElRadio,{label:r,onChange:()=>{g.value=r,m.value=[e]}},null)},{value:w,label:C}=o.tableSelectProps||{},T=t.ref([]),R=t.ref([]),D=()=>{const e=fo(m.value,w).map((e=>({value:e[w||"value"],label:e[C||"label"]})));e.length>1?(T.value=e.splice(0,1),R.value=e):(T.value=e,R.value=[])};t.watch((()=>o.tableSelectRows),(()=>{D()}),{deep:!0,immediate:!0});const k=(e,a)=>{const i=t.toRaw(m.value);i.splice(a,1),m.value=i,D(),n("select",i)},x=()=>{let e,n;return t.createVNode(t.Fragment,null,[t.createVNode("div",{class:["el-input",Wo.e("input-table"),Wo.is("disabled",r)]},[t.createVNode("div",{class:"el-input__wrapper"},[T?.value.length?t.createVNode("span",{class:Wo.em("input-table","value")},[T.value.map(((e,n)=>t.createVNode(a.ElTag,{closable:!r,onClose:()=>k(0,n)},{default:()=>[e.label]}))),R?.value?.length?t.createVNode(a.ElTooltip,{"popper-class":Wo.e("tooltip-tags"),placement:"bottom",effect:"light"},{default:()=>t.createVNode(a.ElTag,null,{default:()=>[t.createTextVNode("+ "),R.value.length]}),content:()=>R.value.map(((e,n)=>t.createVNode(a.ElTag,{closable:!r,onClose:()=>k(0,n+1)},{default:()=>[e.label]})))}):null]):t.createVNode("span",{class:Wo.em("input-table","placeholder")},[s])]),t.createVNode(a.ElButton,{type:"primary",class:Wo.em("input-table","append"),disabled:r,icon:Oi,onClick:h},null)]),t.createVNode(Ho,{modelValue:u.visible,"onUpdate:modelValue":e=>u.visible=e,title:u.title,closeOnClickModal:c.closeOnClickModal,width:c.dialogWidth,modal:!1,onClose:p},{default:()=>[t.createVNode("div",{class:Wo.em("input-table","content")},[t.createVNode(a.ElRadioGroup,{modelValue:g.value},{default:()=>[t.createVNode(is,{options:c,loading:f.loading,data:f.data,page:f.page,"onConfirm-search":_,"onClick-add-edit":S},{default:()=>[t.createVNode(a.ElTableColumn,{fixed:"left",label:i("next.table.selection"),width:55,headerAlign:c.headerAlign,align:c.cellAlign},{default:({row:e,$index:t})=>A(e,t)})]})]})]),t.createVNode("div",{class:Wo.em("input-table","footer")},[t.createVNode(a.ElButton,{onClick:b},qo(e=i("next.form.reset"))?e:{default:()=>[e]}),t.createVNode(a.ElButton,{type:"primary",disabled:v.value,onClick:E},qo(n=i("next.form.confirm"))?n:{default:()=>[n]})])]})])};return()=>t.createVNode(t.Fragment,null,[x()])}}),Yo=m("form");var $o=t.defineComponent({name:"UploadImage",props:{className:{type:String,default:""},style:{type:Object,default:()=>({})},modelValue:{type:String,default:""},disabled:{type:Boolean,default:!1},listType:{type:String,values:["text","picture","picture-card"],default:"picture-card"},accept:{type:String,default:"image/*"}},emits:["change"],setup(e){const{appContext:a}=t.getCurrentInstance(),{t:n}=rn();return{t:n,appContext:a,defaultPreviewSrcList:po(e.modelValue),uploadfilesPreview:t.ref([])}},render(){const e=this.$slots,n=this.$props,i=this.$emit,r=this.t,o=n.disabled,s=this.uploadfilesPreview;let l=null;return t.createVNode(t.Fragment,null,[(()=>{const e=this.defaultPreviewSrcList;let n=[];return"string"==typeof e?n=[e]:"[object Array]"===Object.prototype.toString.call(e)&&(n=e),n=n.filter((e=>!!e)),n.length?t.createVNode(a.ElImage,{class:Yo.e("preview-image"),src:n[0],previewSrcList:n,"preview-teleported":!0,fit:"cover",style:{width:"146px",height:"146px"}},{default:()=>t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(bi,null,null)]})}):null})(),o?null:t.createVNode(a.ElUpload,{class:[Yo.b("upload-image"),n.className],style:n.style,"list-type":n.listType,"auto-upload":!1,"on-preview":e=>{const n=document.getElementsByTagName("body")[0],i=s.value.findIndex((t=>t.url===e.url))||0;l&&(t.render(null,l),n.removeChild(l)),l=document.createElement("div"),n.appendChild(l);const r=t.createVNode({render:()=>t.h(t.Teleport,{to:"body"},[t.h(a.ElImageViewer,{initialIndex:i,"url-list":s.value.map((e=>e.url)),onClose:()=>{t.render(null,l)}})])});l.appContext=this.appContext,t.render(r,l)},onChange:(e,t)=>{s.value=t,i("change",e,t)}},{trigger:()=>e.default?e.default():"picture-card"===n.listType?t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(wi,null,null)]}):t.createVNode(a.ElButton,{link:!0,text:!0,type:"primary"},{default:()=>[t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(wi,null,null)]}),t.createVNode("em",null,[r("next.form.selectFile")])]})})])}});function Xo(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!t.isVNode(e)}const Zo=m("form");var Jo=t.defineComponent({name:"NextForm",props:{options:{type:Object,default:()=>({})},columns:{type:Array,default:()=>[]},formDatum:{type:Object,default:()=>({})}},emits:["submit","close"],setup(e,{slots:n,emit:i,expose:r}){const o=po(Fo),s=t.reactive($a(o,e.options)),l=t.computed((()=>"boolean"!=typeof s.isEditing||s.isEditing)),{t:d}=rn(),c=t.ref(s.colSpan),u=t.reactive(e.formDatum)||{},h=t.reactive($a({},u)),p=t.ref([]),f=t.reactive({});t.watch((()=>[e.columns,e.formDatum]),(()=>{(()=>{const t=e.columns;p.value=t;for(let e=0;e<t.length;e++){const a=t[e],n=u[a.prop];_o(n)?h[a.prop]=n:h[a.prop]=_o(a.defaultValue)?a.defaultValue:"";const{label:i}=a;if(a.rules)f[a.prop]=a.rules;else if(a.required){const e=[];e.push({required:!0,message:i+d("next.form.requiredInput"),trigger:["blur","change"]}),f[a.prop]=e}!a.dicData?.length&&a.loadDicData&&a.loadDicData(a,(e=>{e?.length&&(a.dicData=e)})),"boolean"==typeof a.disabled&&a.disabled||(a.disabled=!l.value)}})()}),{deep:!0,immediate:!0});const _=fo(p.value,"prop");t.onMounted((()=>{const e=m.value?.$el;let t=null;ho(e,(e=>{null!==t&&clearTimeout(t),t=setTimeout((()=>{c.value=((e,t=350)=>{const a=e.clientWidth;let n=Math.floor(a/t);return n>4&&(n=4),Math.ceil(24/n)})(e,s.columnMinWidth),clearTimeout(t)}),200)}))}));const m=t.ref(),g=t.ref(!1),v=async()=>{const e=m.value;e&&await e.validate(((e,a)=>{if(e){const e=t.toRaw(h);g.value=!0,i("submit",e,(()=>{g.value=!1,i("close")}),(()=>{g.value=!1}))}}))},y=()=>{const e=m.value;e&&e.resetFields()},b=e=>e.getTime()>Date.now(),E=[{text:d("next.date.oneWeekAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-6048e5),[t,e]}},{text:d("next.date.oneMonthAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-2592e6),[t,e]}},{text:d("next.date.threeMonthsAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-7776e6),[t,e]}},{text:d("next.date.oneYearAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-31536e6),[t,e]}},{text:d("next.date.threeYearsAge"),value:()=>{const e=new Date,t=new Date;return t.setTime(t.getTime()-94608e6),[t,e]}}],S=e=>{if(n[Ro(e.prop)])return n[Ro(e.prop)]({column:e,formParams:h});if("input"===e.type||!e.type){const n=e.placeholder||d("next.form.input")+e.label;return t.createVNode(a.ElInput,{modelValue:h[e.prop],"onUpdate:modelValue":t=>h[e.prop]=t,clearable:!0,readonly:mo(e.readonly,!1),disabled:e.disabled,placeholder:n,onChange:t=>e.onChange?.(t,e,h,_)},{prefix:e.prefix?()=>e.prefix(h,e):null,suffix:e.suffix?()=>e.suffix(h,e):null,prepend:e.prepend?()=>e.prepend(h,e):null,append:e.append?()=>e.append(h,e):null})}if("inputInteger"===e.type){const n=e.placeholder||d("next.form.input")+e.label;return t.createVNode(a.ElInput,{modelValue:h[e.prop],"onUpdate:modelValue":t=>h[e.prop]=t,clearable:!0,readonly:mo(e.readonly,!1),disabled:e.disabled,placeholder:n,onInput:t=>((e,t)=>{const a=e.replace(/\D/g,"");h[t]=Number(a)})(t,e.prop),onChange:t=>e.onChange?.(t,e,h,_)},{prefix:e.prefix?()=>e.prefix(h,e):null,suffix:e.suffix?()=>e.suffix(h,e):null,prepend:e.prepend?()=>e.prepend(h,e):null,append:e.append?()=>e.append(h,e):null})}if("inputNumber"===e.type){const n=e.placeholder||d("next.form.input")+e.label;return t.createVNode(a.ElInput,{modelValue:h[e.prop],"onUpdate:modelValue":t=>h[e.prop]=t,clearable:!0,readonly:mo(e.readonly,!1),disabled:e.disabled,placeholder:n,onInput:t=>((e,t)=>{let a=e;a=a.replace(/[^0-9\.]/g,""),a=a.replace(/^\./,"0."),a=a.replace(/\.{2,}/g,"."),a=a.replace(".","DUMMY"),a=a.replace(/\./g,""),a=a.replace("DUMMY","."),h[t]=Number(a)})(t,e.prop),onChange:t=>e.onChange?.(t,e,h,_)},{prefix:e.prefix?()=>e.prefix(h,e):null,suffix:e.suffix?()=>e.suffix(h,e):null,prepend:e.prepend?()=>e.prepend(h,e):null,append:e.append?()=>e.append(h,e):null})}if("textarea"===e.type){const n=e.placeholder||d("next.form.input")+e.label;return t.createVNode(a.ElInput,{modelValue:h[e.prop],"onUpdate:modelValue":t=>h[e.prop]=t,type:"textarea",clearable:!0,readonly:mo(e.readonly,!1),disabled:e.disabled,placeholder:n,onChange:t=>e.onChange?.(t,e,h,_)},{prefix:e.prefix?()=>e.prefix(h,e):null,suffix:e.suffix?()=>e.suffix(h,e):null,prepend:e.prepend?()=>e.prepend(h,e):null,append:e.append?()=>e.append(h,e):null})}if("select"===e.type){const n=e.placeholder||d("next.form.select")+e.label;return t.createVNode(a.ElSelect,{modelValue:h[e.prop],"onUpdate:modelValue":t=>h[e.prop]=t,placeholder:n,clearable:!0,disabled:e.disabled,multiple:mo(e.multiple,!1),"collapse-tags-tooltip":!0,onChange:t=>e.onChange?.(t,e,h,_)},{default:()=>[e.dicData&&e.dicData.map((e=>t.createVNode(a.ElOption,{key:e.value,value:e.value,label:e.label,disabled:mo(e.disabled,!1)},null)))]})}if("time"===e.type){const n=e.placeholder||d("next.form.select")+e.label;return t.createVNode(a.ElTimeSelect,{modelValue:h[e.prop],"onUpdate:modelValue":t=>h[e.prop]=t,start:"00:00",step:"00:30",end:"23:59",editable:!1,disabled:e.disabled,placeholder:n,onChange:t=>e.onChange?.(t,e,h,_)},{prefix:()=>e.prefix?e.prefix(h,e):null,suffix:()=>e.suffix?e.suffix(h,e):null})}if("radio"===e.type)return t.createVNode(a.ElRadioGroup,{modelValue:h[e.prop],"onUpdate:modelValue":t=>h[e.prop]=t,disabled:e.disabled,onChange:t=>e.onChange?.(t,e,h,_)},{default:()=>[e.dicData&&e.dicData.map((e=>t.createVNode(a.ElRadio,{key:e.value,label:e.value,disabled:mo(e.disabled,!1)},{default:()=>[e.label]})))]});if("checkbox"===e.type)return _o(h[e.prop])||(h[e.prop]=[]),t.createVNode(a.ElCheckboxGroup,{modelValue:h[e.prop],"onUpdate:modelValue":t=>h[e.prop]=t,disabled:e.disabled,onChange:t=>e.onChange?.(t,e,h,_)},{default:()=>[e.dicData&&e.dicData.map((e=>t.createVNode(a.ElCheckbox,{key:e.value,label:e.value,disabled:mo(e.disabled,!1)},{default:()=>[e.label]})))]});if("date"===e.type){const n=e.placeholder||d("next.form.select")+e.label;return t.createVNode(a.ElDatePicker,{modelValue:h[e.prop],"onUpdate:modelValue":[t=>h[e.prop]=t,t=>e.onChange?.(t,e,h,_)],placeholder:n,type:"date",valueFormat:e.format||"YYYY-MM-DD",format:e.format||"YYYY-MM-DD",clearable:!0,disabledDate:e.disabledDate||b,disabled:e.disabled,editable:e.editable},null)}if("datetime"===e.type){const n=e.placeholder||d("next.form.select")+e.label;return t.createVNode(a.ElDatePicker,{modelValue:h[e.prop],"onUpdate:modelValue":[t=>h[e.prop]=t,t=>e.onChange?.(t,e,h,_)],placeholder:n,type:"datetime",valueFormat:e.format||"YYYY-MM-DD HH:mm:ss",format:e.format||"YYYY-MM-DD HH:mm:ss",clearable:!0,disabledDate:e.disabledDate||b,disabled:e.disabled,editable:e.editable},null)}if("datetimerange"===e.type){const n=e.placeholder||d("next.form.select")+e.label;return t.createVNode(a.ElDatePicker,{modelValue:h[e.prop],"onUpdate:modelValue":[t=>h[e.prop]=t,t=>e.onChange?.(t,e,h,_)],placeholder:n,type:"datetimerange",valueFormat:e.format||"YYYY-MM-DD HH:mm:ss",format:e.format||"YYYY-MM-DD HH:mm:ss",clearable:!0,"range-separator":d("next.date.rangeSeparator"),"start-placeholder":d("next.date.startPlaceholder"),"end-placeholder":d("next.date.endPlaceholder"),disabledDate:e.disabledDate||b,disabled:e.disabled,editable:e.editable,shortcuts:e.shortcuts||E},null)}return"numberRange"===e.type?t.createVNode(Go,{modelValue:h[e.prop],"onUpdate:modelValue":t=>h[e.prop]=t,disabled:e.disabled,onChange:t=>{return a=t,n=e.prop,Array.isArray(h[n])||(h[n]=[]),void(h[n]=Number(a));var a,n}},null):"inputTableSelect"===e.type?t.createVNode(Ko,{modelValue:h[e.prop],"onUpdate:modelValue":t=>h[e.prop]=t,formParams:h,column:e,disabled:e.disabled,onSelect:t=>((e,t)=>{e&&(t.tableSelectRows=e);const{value:a}=t.tableSelectProps||{};h[t.prop]=e.map((e=>e[a||"value"])),t.onTableSelect?.(h,e,t)})(t,e)},null):"uploadImage"===e.type?t.createVNode($o,{modelValue:h[e.prop],"onUpdate:modelValue":t=>h[e.prop]=t,disabled:e.disabled,onChange:(...t)=>e.onChange?.(...t,e,h,_)},null):void 0};r({formParams:t.toRaw(h),ruleFormRef:m,formColumns:_});const A=()=>{let e,n,i;return t.createVNode(a.ElForm,{ref:m,class:Zo.b(),inline:!1,model:h,size:s.size},{default:()=>[t.createVNode(a.ElRow,{gutter:20},Xo(e=_.map((e=>!e.hide&&t.createVNode(a.ElCol,{span:mo(e.span,c.value)},{default:()=>[t.createVNode(a.ElFormItem,{prop:e.prop,required:e.required,rules:f[e.prop],style:{"--form-label-width":mo(s.formLabelWidth,s.labelWidth)}},{label:()=>e.label?t.createVNode(t.Fragment,null,[t.createVNode(bn,{content:d(e.label),class:Zo.e("item-label")},null),e.tip?t.createVNode(a.ElTooltip,{effect:"dark",content:e.tip,placement:"top"},{default:()=>[t.createVNode(a.ElIcon,{style:{"margin-left":"5px"},color:"#f3d19e"},{default:()=>[t.createVNode(hi,null,null)]})]}):null]):null,default:()=>S(e)})]}))))?e:{default:()=>[e]}),l.value&&t.createVNode("div",{class:Zo.e("footer")},[t.createVNode(a.ElButton,{type:"primary",loading:g.value,onClick:v},Xo(n=d("next.form.submit"))?n:{default:()=>[n]}),s.showResetBtn?t.createVNode(a.ElButton,{onClick:y},Xo(i=d("next.form.reset"))?i:{default:()=>[i]}):null])]})};return()=>t.createVNode(t.Fragment,null,[A()])}});const Qo=fn(Jo);var es=t.defineComponent({name:"AddEditForm",props:{formDatum:{type:Object,default:()=>({})},isEditing:{type:Boolean,default:!0},columns:{type:Array,default:()=>[]}},emits:["close","submit"],setup(e,{slots:a,emit:n,expose:i}){const r=t.inject("addEditFormSlots"),o={};r.value.forEach((e=>{o[e]=(...t)=>a[e]&&a[e](...t)}));const s=t.inject("options",{}),l=po(t.isRef(s)?t.unref(s):s);l.columnMinWidth=l.formColumnMinWidth,l.isEditing=e.isEditing;const d=t.ref(),c=po(t.isRef(e.formDatum)?t.unref(e.formDatum):e.formDatum),u=po(e.columns).map((e=>(e.hide=mo(e.formHide,e.hide,!1),e))),h=(...e)=>{n("submit",...e)};i({getFormExpose:()=>({formParams:d.value?.formParams,formColumns:d.value?.formColumns})});const p=()=>{return t.createVNode(Qo,{ref:d,options:l,columns:u,formDatum:c,onClose:()=>n("close"),onSubmit:h},"function"==typeof(e=o)||"[object Object]"===Object.prototype.toString.call(e)&&!t.isVNode(e)?o:{default:()=>[o]});var e};return()=>t.createVNode(t.Fragment,null,[p()])}});function ts(e){return"function"==typeof e||"[object Object]"===Object.prototype.toString.call(e)&&!t.isVNode(e)}const as=m("crud-table");var ns=t.defineComponent({name:"NextCrudTable",props:vo,emits:["confirm-search","clear-search","change-pagination","selection-change","row-click","row-contextmenu","row-dblclick","cell-click","cell-dblclick","cell-contextmenu","cell-mouse-enter","cell-mouse-leave","expand-change","click-add-edit","close-add-edit","view-add-edit","delete-rows","delete-row","submit-form"],setup(e,{emit:n,slots:i,expose:r}){const o=po(Eo),s=t.computed((()=>{const a=t.unref(e.options);return $a(o,a)})),l=t.unref(s);t.provide("options",t.computed((()=>s.value))),t.provide("ns",as);const{t:d}=rn(),c=t.ref(l.columns),u=t.ref([]),h=t.ref([]),p=e=>{((e,a)=>{const n=t.reactive(e.columns),i=e=>{!e.dicData?.length&&e.loadDicData&&e.loadDicData(e,(t=>{t?.length&&(e.dicData=t)}))},r=e=>{let t=[];return e.forEach((e=>{i(e),t.push(e),e.children?.length&&(t.push(...r(e.children)),e.children&&delete e.children)})),t},o=r(n),s=e.formColumns.map((e=>(i(e),e))),l=o.concat(s).map((e=>{const t={prop:e.prop,label:mo(e.formLabel,e.label,""),type:mo(e.formType,e.type,""),defaultValue:mo(e.formDefaultValue,e.defaultValue,""),placeholder:mo(e.formPlaceholder,""),required:mo(e.formRequired,e.required,!1),sort:mo(e.formSort,e.sort,null),prefix:mo(e.formPrefix,e.prefix,null),suffix:mo(e.formSuffix,e.suffix,null),prepend:mo(e.formPrepend,e.prepend,null),append:mo(e.formAppend,e.append,null),hide:mo(e.formHide,e.hide,!1),disabled:mo(e.formDisabled,e.disabled,!1),readonly:mo(e.formReadonly,e.readonly,!1),span:mo(e.formSpan,e.span,null),dicData:mo(e.formDicData,e.dicData,[]),loadDicData:mo(e.formLoadDicData,e.loadDicData,null),onChange:mo(e.onChangeForm,e.onChange,null),tableSelect:mo(e.tableSelect,{}),tableSelectRows:mo(e.tableSelectRows,[]),tableSelectProps:mo(e.tableSelectProps,null),tableSelectDefaultValue:mo(e.tableSelectDefaultValue,null),onTableSelect:mo(e.onTableSelect,null)};return!e.dicData?.length&&e.loadDicData&&go(t,e,"dicData"),t})).filter((e=>e.sort&&e.prop)).sort(((e,t)=>e.sort-t.sort)),d=(e,t)=>{const a={prop:e.prop,type:mo(e.searchType,e.type),label:mo(e.searchLabel,e.label),defaultValue:mo(e.searchDefaultValue,e.defaultValue,null),placeholder:mo(e.searchPlaceholder,e.placeholder,null),dicData:mo(e.searchDicData,e.dicData,[]),loadDicData:mo(e.searchLoadDicData,e.loadDicData,null),disabled:mo(e.searchDisabled,e.disabled,!1),readonly:mo(e.searchReadonly,e.readonly,!1),prefix:mo(e.searchPrefix,e.prefix,null),suffix:mo(e.searchSuffix,e.suffix,null),prepend:mo(e.searchPrepend,e.prepend,null),append:mo(e.searchAppend,e.append,null),hide:mo(e.searchHide,!1),sort:mo(e.searchSort,e.sort,t)};return!e.dicData?.length&&e.loadDicData&&go(a,e,"dicData"),a},c=e.searchColumns.map(((e,t)=>(i(e),d(e,t)))),u=c.length,h=c.concat((e=>{let t=[];return e.forEach(((e,a)=>{e.searchType&&t.push(d(e,a+u))})),t})(o)),p=fo(h.sort(((e,t)=>e.sort-t.sort)),"prop");a&&a({formColumns:l,searchColumns:p,columns:n})})(e,(({formColumns:e,searchColumns:t,columns:a})=>{u.value=t,h.value=e,c.value=a}))},f=t.ref(e.data),_=t.ref((()=>{const e=u.value;let t={};for(let a=0;a<e.length;a++){const n=e[a];_o(n.defaultValue)&&(t[n.prop]=n.defaultValue)}return t})()),m=a=>{const i=po(t.toRaw(a));Ia(_.value,i)||(e.page.pageIndex=1,_.value=i),n("confirm-search",i)},g=()=>{n("clear-search")},v=()=>{m(_.value)};t.watch((()=>e.data),(e=>{f.value=e}),{immediate:!0}),t.watch((()=>s),(e=>{p(e.value)}),{deep:!0,immediate:!0});const y=t.ref(l.defaultContentHeight),b=t.ref(),E=t.ref(),S=t.ref(),A=t.ref(),w=t.ref(null),C=()=>{t.nextTick((()=>{const e=(b.value?.clientHeight||0)-((E.value?.clientHeight||0)+(A.value?.clientHeight||0));y.value=e}))},T=e=>{"F11"!==e.key&&"fullscreenchange"!==e.type||C()};t.onMounted((()=>{ho(b.value,(()=>{C()})),l.initLoadData&&m(_.value),l.fullscreenchangeContentHeight&&(document.addEventListener("fullscreenchange",T),document.addEventListener("keydown",T))})),t.onUnmounted((()=>{l.fullscreenchangeContentHeight&&(document.removeEventListener("fullscreenchange",T),document.removeEventListener("keydown",T))}));const R=t=>{e.page.pageIndex=t.pageIndex,e.page.pageSize=t.pageSize,n("change-pagination",t),m(_.value)},D=t.ref([]),k=e=>{D.value=e,n("selection-change",D.value)};t.provide("multipleSelection",D);const x=t.reactive({visible:!1,title:d("next.table.add"),rowInfo:{},isEditing:!0}),L=(e={})=>{const{dialogTitle:a}=l;x.isEditing=!0,x.title=a+" "+d("next.table.add"),x.rowInfo=e,n("click-add-edit",e),t.nextTick((()=>{x.visible=!0}))},N=e=>{n("delete-rows",e,(()=>{v()}))},B=e=>{n("delete-row",e,(()=>{v()}))},V=e=>{const{dialogTitle:a}=l;x.isEditing=!0,x.title=a+" "+d("next.table.edit"),x.rowInfo=e.row,n("click-add-edit",e.row),t.nextTick((()=>{x.visible=!0}))},M=e=>{const{dialogTitle:a}=l;x.isEditing=!1,x.title=a+" "+d("next.table.view"),x.rowInfo=e.row,n("view-add-edit",e.row),t.nextTick((()=>{x.visible=!0}))},O=()=>{x.visible=!1,x.title="",x.rowInfo={},n("close-add-edit")},I=(...e)=>{n("submit-form",...e)},P=t.ref([]),U=t.ref([]),j=t.ref([]);for(const e in i)e.includes(So)?P.value.push(e):e.includes(wo)?U.value.push(e):e.includes(To)&&j.value.push(e);t.provide("columnSlots",P),t.provide("searchFormSlots",U),t.provide("addEditFormSlots",j);const F=t=>{const{pageIndex:a,pageSize:n}=e.page;return(a-1)*n+(t+1)},z=t.computed((()=>{const{total:t}=e.page,a=document.createElement("span");a.innerText=t,a.style.visibility="hidden",document.body.appendChild(a);const n=a.getBoundingClientRect().width,i=Math.ceil(n)+25;return document.body.removeChild(a),i>50?i:50})),G={};U.value.forEach((e=>{G[e]=(...t)=>i[e]&&i[e](...t)}));const H={};P.value.forEach((e=>{H[e]=(...t)=>i[e]&&i[e](...t)}));const q={};j.value.forEach((e=>{q[e]=(...t)=>i[e]&&i[e](...t)}));const W={};yo.forEach((e=>{W[e]=(...t)=>i[e]&&i[e](...t)}));const K={};bo.forEach((e=>{K[e]=(...t)=>i[e]&&i[e](...t)}));r({onClickRowAdd:L,columns:c.value,getFormExpose:()=>w.value?.getFormExpose(),updateColumns:e=>{p(e)}});return()=>t.createVNode(t.Fragment,null,[t.createVNode(t.Fragment,null,[t.createVNode("div",{ref:b,class:[as.b(),e.className],style:e.style},[l.showSearchForm||l.showHeaderMenu?t.createVNode("header",{ref:E,class:as.b("header")},[l.showSearchForm&&t.createVNode(No,{columns:u.value,onZoomResize:C,onConfirmSearch:m,onClearSearch:g},ts(G)?G:{default:()=>[G]}),l.showHeaderMenu&&t.createVNode(Vo,{onClickAdd:L,onDeleteRows:N,onClickRefresh:v},ts(W)?W:{default:()=>[W]}),i["table-head-tip"]?.()]):null,t.createVNode(ko,{loading:e.loading},{default:()=>[t.createVNode("div",{ref:S,class:as.b("content")},[t.createVNode(a.ElTable,{data:f.value,height:y.value,rowKey:l.rowKey,border:l.border,stripe:l.stripe,fit:l.fit,size:l.size,"row-style":l.rowStyle,"row-class-name":l.rowClassName,"cell-style":l.cellStyle,"cell-class-name":l.cellClassName,"header-row-style":l.headerRowStyle,"header-row-class-name":l.headerRowClassName,"header-cell-style":l.headerCellStyle,"header-cell-class-name":l.headerCellClassName,"span-method":e.spanMethod,"onSelection-change":k,"onRow-click":(...e)=>n("row-click",...e),"onRow-contextmenu":(...e)=>n("row-contextmenu",...e),"onRow-dblclick":(...e)=>n("row-dblclick",...e),"onCell-click":(...e)=>n("cell-click",...e),"onCell-dblclick":(...e)=>n("cell-dblclick",...e),"onCell-contextmenu":(...e)=>n("cell-contextmenu",...e),"onCell-mouse-enter":(...e)=>n("cell-mouse-enter",...e),"onCell-mouse-leave":(...e)=>n("cell-mouse-leave",...e),"onExpand-change":(...e)=>n("expand-change",...e)},{default:()=>[l.index?t.createVNode(a.ElTableColumn,{type:"index",label:"#",width:z.value,index:F,fixed:"left",headerAlign:l.headerAlign,align:l.cellAlign},null):null,l.selection?t.createVNode(a.ElTableColumn,{type:"selection",fixed:"left",label:d("next.table.selectionAll"),width:55,headerAlign:l.headerAlign,align:l.cellAlign},null):null,i.default?.(),c.value.map((e=>t.createVNode(Mo,{columnOption:e,key:e.prop},ts(H)?H:{default:()=>[H]}))),l.operations?t.createVNode(Oo,{onEditRow:V,onViewRow:M,onDeleteRow:B},ts(K)?K:{default:()=>[K]}):null],empty:()=>t.createVNode(a.ElEmpty,{imageSize:y.value>220?100:50,description:d("next.table.notData")},null)})])]}),l.isPagination?t.createVNode("div",{ref:A,class:as.b("footer")},[t.createVNode(Io,{page:e.page,onChange:R},null),i["table-footer-tip"]?.()]):null,t.createVNode(Uo,{modelValue:x.visible,"onUpdate:modelValue":e=>x.visible=e,title:x.title,width:l.dialogWidth,fullscreen:l.dialogFullscreen,closeOnClickModal:l.closeOnClickModal,onClose:O},{default:()=>t.createVNode(es,{ref:w,formDatum:x.rowInfo,columns:h.value,isEditing:x.isEditing,onClose:O,onSubmit:I},ts(q)?q:{default:()=>[q]})})])])])}});const is=fn(ns),rs=fn(ko),os=m("upload");const ss=fn(t.defineComponent({name:"NextUpload",props:{className:{type:String,default:""},style:{type:Object,default:()=>({})},listType:{type:String,values:["text","picture","picture-card"],default:"picture-card"},accept:{type:String,default:"image/*"}},emits:["change"],setup(){const{appContext:e}=t.getCurrentInstance(),{t:a}=rn();return{t:a,appContext:e}},render(){const e=this.$slots,n=this.$props,i=this.$emit,r=this.t,o=t.ref([]),s=document.getElementsByTagName("body")[0];let l=null;return t.createVNode(a.ElUpload,{class:[os.b(),n.className],style:n.style,"list-type":n.listType,"auto-upload":!1,"on-preview":e=>{const n=o.value.findIndex((t=>t.url===e.url))||0;l&&(t.render(null,l),s.removeChild(l)),l=document.createElement("div"),s.appendChild(l);const i=t.createVNode({render:()=>t.h(t.Teleport,{to:"body"},[t.h(a.ElImageViewer,{initialIndex:n,"url-list":o.value.map((e=>e.url)),onClose:()=>{t.render(null,l)}})])});l.appContext=this.appContext,t.render(i,l)},onChange:(e,t)=>{o.value=t,i("change",e,t)}},{trigger:()=>e.default?e.default():"picture-card"===n.listType?t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(wi,null,null)]}):t.createVNode(a.ElButton,{link:!0,text:!0,type:"primary"},{default:()=>[t.createVNode(a.ElIcon,null,{default:()=>[t.createVNode(wi,null,null)]}),t.createVNode("em",null,[r("next.form.selectFile")])]})})}}));var ls={exports:{}};!function(e,t){window,e.exports=function(e){var t={};function a(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,a),i.l=!0,i.exports}return a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(n,i,function(t){return e[t]}.bind(null,i));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=14)}([function(e,t,a){var n=a(6),i=a.n(n),r=function(){function e(){}return e.e=function(t,a){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var n="["+t+"] > "+a;e.ENABLE_CALLBACK&&e.emitter.emit("log","error",n),e.ENABLE_ERROR&&(console.error||console.warn)},e.i=function(t,a){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var n="["+t+"] > "+a;e.ENABLE_CALLBACK&&e.emitter.emit("log","info",n),e.ENABLE_INFO&&console.info},e.w=function(t,a){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var n="["+t+"] > "+a;e.ENABLE_CALLBACK&&e.emitter.emit("log","warn",n),e.ENABLE_WARN&&console.warn},e.d=function(t,a){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var n="["+t+"] > "+a;e.ENABLE_CALLBACK&&e.emitter.emit("log","debug",n),e.ENABLE_DEBUG&&console.debug},e.v=function(t,a){t&&!e.FORCE_GLOBAL_TAG||(t=e.GLOBAL_TAG);var n="["+t+"] > "+a;e.ENABLE_CALLBACK&&e.emitter.emit("log","verbose",n),e.ENABLE_VERBOSE},e}();r.GLOBAL_TAG="mpegts.js",r.FORCE_GLOBAL_TAG=!1,r.ENABLE_ERROR=!0,r.ENABLE_INFO=!0,r.ENABLE_WARN=!0,r.ENABLE_DEBUG=!0,r.ENABLE_VERBOSE=!0,r.ENABLE_CALLBACK=!1,r.emitter=new i.a,t.a=r},function(e,t,a){t.a={IO_ERROR:"io_error",DEMUX_ERROR:"demux_error",INIT_SEGMENT:"init_segment",MEDIA_SEGMENT:"media_segment",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",TIMED_ID3_METADATA_ARRIVED:"timed_id3_metadata_arrived",SYNCHRONOUS_KLV_METADATA_ARRIVED:"synchronous_klv_metadata_arrived",ASYNCHRONOUS_KLV_METADATA_ARRIVED:"asynchronous_klv_metadata_arrived",SMPTE2038_METADATA_ARRIVED:"smpte2038_metadata_arrived",SCTE35_METADATA_ARRIVED:"scte35_metadata_arrived",PES_PRIVATE_DATA_DESCRIPTOR:"pes_private_data_descriptor",PES_PRIVATE_DATA_ARRIVED:"pes_private_data_arrived",STATISTICS_INFO:"statistics_info",RECOMMEND_SEEKPOINT:"recommend_seekpoint"}},function(e,t,a){a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return o}));var n=a(3),i={kIdle:0,kConnecting:1,kBuffering:2,kError:3,kComplete:4},r={OK:"OK",EXCEPTION:"Exception",HTTP_STATUS_CODE_INVALID:"HttpStatusCodeInvalid",CONNECTING_TIMEOUT:"ConnectingTimeout",EARLY_EOF:"EarlyEof",UNRECOVERABLE_EARLY_EOF:"UnrecoverableEarlyEof"},o=function(){function e(e){this._type=e||"undefined",this._status=i.kIdle,this._needStash=!1,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null}return e.prototype.destroy=function(){this._status=i.kIdle,this._onContentLengthKnown=null,this._onURLRedirect=null,this._onDataArrival=null,this._onError=null,this._onComplete=null},e.prototype.isWorking=function(){return this._status===i.kConnecting||this._status===i.kBuffering},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"status",{get:function(){return this._status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"needStashBuffer",{get:function(){return this._needStash},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onContentLengthKnown",{get:function(){return this._onContentLengthKnown},set:function(e){this._onContentLengthKnown=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onURLRedirect",{get:function(){return this._onURLRedirect},set:function(e){this._onURLRedirect=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onComplete",{get:function(){return this._onComplete},set:function(e){this._onComplete=e},enumerable:!1,configurable:!0}),e.prototype.open=function(e,t){throw new n.c("Unimplemented abstract function!")},e.prototype.abort=function(){throw new n.c("Unimplemented abstract function!")},e}()},function(e,t,a){a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return o})),a.d(t,"b",(function(){return s})),a.d(t,"c",(function(){return l}));var n,i=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),r=function(){function e(e){this._message=e}return Object.defineProperty(e.prototype,"name",{get:function(){return"RuntimeException"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"message",{get:function(){return this._message},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this.name+": "+this.message},e}(),o=function(e){function t(t){return e.call(this,t)||this}return i(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"IllegalStateException"},enumerable:!1,configurable:!0}),t}(r),s=function(e){function t(t){return e.call(this,t)||this}return i(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"InvalidArgumentException"},enumerable:!1,configurable:!0}),t}(r),l=function(e){function t(t){return e.call(this,t)||this}return i(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return"NotImplementedException"},enumerable:!1,configurable:!0}),t}(r)},function(e,t,a){var n={};!function(){var e=self.navigator.userAgent.toLowerCase(),t=/(edge)\/([\w.]+)/.exec(e)||/(opr)[\/]([\w.]+)/.exec(e)||/(chrome)[ \/]([\w.]+)/.exec(e)||/(iemobile)[\/]([\w.]+)/.exec(e)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(firefox)[ \/]([\w.]+)/.exec(e)||[],a=/(ipad)/.exec(e)||/(ipod)/.exec(e)||/(windows phone)/.exec(e)||/(iphone)/.exec(e)||/(kindle)/.exec(e)||/(android)/.exec(e)||/(windows)/.exec(e)||/(mac)/.exec(e)||/(linux)/.exec(e)||/(cros)/.exec(e)||[],i={browser:t[5]||t[3]||t[1]||"",version:t[2]||t[4]||"0",majorVersion:t[4]||t[2]||"0",platform:a[0]||""},r={};if(i.browser){r[i.browser]=!0;var o=i.majorVersion.split(".");r.version={major:parseInt(i.majorVersion,10),string:i.version},o.length>1&&(r.version.minor=parseInt(o[1],10)),o.length>2&&(r.version.build=parseInt(o[2],10))}for(var s in i.platform&&(r[i.platform]=!0),(r.chrome||r.opr||r.safari)&&(r.webkit=!0),(r.rv||r.iemobile)&&(r.rv&&delete r.rv,i.browser="msie",r.msie=!0),r.edge&&(delete r.edge,i.browser="msedge",r.msedge=!0),r.opr&&(i.browser="opera",r.opera=!0),r.safari&&r.android&&(i.browser="android",r.android=!0),r.name=i.browser,r.platform=i.platform,n)n.hasOwnProperty(s)&&delete n[s];Object.assign(n,r)}(),t.a=n},function(e,t,a){t.a={OK:"OK",FORMAT_ERROR:"FormatError",FORMAT_UNSUPPORTED:"FormatUnsupported",CODEC_UNSUPPORTED:"CodecUnsupported"}},function(e,t,a){var n,i="object"==typeof Reflect?Reflect:null,r=i&&"function"==typeof i.apply?i.apply:function(e,t,a){return Function.prototype.apply.call(e,t,a)};n=i&&"function"==typeof i.ownKeys?i.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise((function(a,n){function i(a){e.removeListener(t,r),n(a)}function r(){"function"==typeof e.removeListener&&e.removeListener("error",i),a([].slice.call(arguments))}g(e,t,r,{once:!0}),"error"!==t&&function(e,t,a){"function"==typeof e.on&&g(e,"error",t,a)}(e,i,{once:!0})}))},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function d(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function u(e,t,a,n){var i,r,o;if(d(a),void 0===(r=e._events)?(r=e._events=Object.create(null),e._eventsCount=0):(void 0!==r.newListener&&(e.emit("newListener",t,a.listener?a.listener:a),r=e._events),o=r[t]),void 0===o)o=r[t]=a,++e._eventsCount;else if("function"==typeof o?o=r[t]=n?[a,o]:[o,a]:n?o.unshift(a):o.push(a),(i=c(e))>0&&o.length>i&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=o.length,console&&console.warn}return e}function h(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(e,t,a){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:a},i=h.bind(n);return i.listener=a,n.wrapFn=i,i}function f(e,t,a){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"==typeof i?a?[i.listener||i]:[i]:a?function(e){for(var t=new Array(e.length),a=0;a<t.length;++a)t[a]=e[a].listener||e[a];return t}(i):m(i,i.length)}function _(e){var t=this._events;if(void 0!==t){var a=t[e];if("function"==typeof a)return 1;if(void 0!==a)return a.length}return 0}function m(e,t){for(var a=new Array(t),n=0;n<t;++n)a[n]=e[n];return a}function g(e,t,a,n){if("function"==typeof e.on)n.once?e.once(t,a):e.on(t,a);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(r){n.once&&e.removeEventListener(t,i),a(r)}))}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return c(this)},s.prototype.emit=function(e){for(var t=[],a=1;a<arguments.length;a++)t.push(arguments[a]);var n="error"===e,i=this._events;if(void 0!==i)n=n&&void 0===i.error;else if(!n)return!1;if(n){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=i[e];if(void 0===l)return!1;if("function"==typeof l)r(l,this,t);else{var d=l.length,c=m(l,d);for(a=0;a<d;++a)r(c[a],this,t)}return!0},s.prototype.addListener=function(e,t){return u(this,e,t,!1)},s.prototype.on=s.prototype.addListener,s.prototype.prependListener=function(e,t){return u(this,e,t,!0)},s.prototype.once=function(e,t){return d(t),this.on(e,p(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return d(t),this.prependListener(e,p(this,e,t)),this},s.prototype.removeListener=function(e,t){var a,n,i,r,o;if(d(t),void 0===(n=this._events))return this;if(void 0===(a=n[e]))return this;if(a===t||a.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,a.listener||t));else if("function"!=typeof a){for(i=-1,r=a.length-1;r>=0;r--)if(a[r]===t||a[r].listener===t){o=a[r].listener,i=r;break}if(i<0)return this;0===i?a.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(a,i),1===a.length&&(n[e]=a[0]),void 0!==n.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.off=s.prototype.removeListener,s.prototype.removeAllListeners=function(e){var t,a,n;if(void 0===(a=this._events))return this;if(void 0===a.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==a[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete a[e]),this;if(0===arguments.length){var i,r=Object.keys(a);for(n=0;n<r.length;++n)"removeListener"!==(i=r[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=a[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},s.prototype.listeners=function(e){return f(this,e,!0)},s.prototype.rawListeners=function(e){return f(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):_.call(e,t)},s.prototype.listenerCount=_,s.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}},function(e,t,a){a.d(t,"d",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return o}));var n=function(e,t,a,n,i){this.dts=e,this.pts=t,this.duration=a,this.originalDts=n,this.isSyncPoint=i,this.fileposition=null},i=function(){function e(){this.beginDts=0,this.endDts=0,this.beginPts=0,this.endPts=0,this.originalBeginDts=0,this.originalEndDts=0,this.syncPoints=[],this.firstSample=null,this.lastSample=null}return e.prototype.appendSyncPoint=function(e){e.isSyncPoint=!0,this.syncPoints.push(e)},e}(),r=function(){function e(){this._list=[]}return e.prototype.clear=function(){this._list=[]},e.prototype.appendArray=function(e){var t=this._list;0!==e.length&&(t.length>0&&e[0].originalDts<t[t.length-1].originalDts&&this.clear(),Array.prototype.push.apply(t,e))},e.prototype.getLastSyncPointBeforeDts=function(e){if(0==this._list.length)return null;var t=this._list,a=0,n=t.length-1,i=0,r=0,o=n;for(e<t[0].dts&&(a=0,r=o+1);r<=o;){if((i=r+Math.floor((o-r)/2))===n||e>=t[i].dts&&e<t[i+1].dts){a=i;break}t[i].dts<e?r=i+1:o=i-1}return this._list[a]},e}(),o=function(){function e(e){this._type=e,this._list=[],this._lastAppendLocation=-1}return Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this._list.length},enumerable:!1,configurable:!0}),e.prototype.isEmpty=function(){return 0===this._list.length},e.prototype.clear=function(){this._list=[],this._lastAppendLocation=-1},e.prototype._searchNearestSegmentBefore=function(e){var t=this._list;if(0===t.length)return-2;var a=t.length-1,n=0,i=0,r=a,o=0;if(e<t[0].originalBeginDts)return-1;for(;i<=r;){if((n=i+Math.floor((r-i)/2))===a||e>t[n].lastSample.originalDts&&e<t[n+1].originalBeginDts){o=n;break}t[n].originalBeginDts<e?i=n+1:r=n-1}return o},e.prototype._searchNearestSegmentAfter=function(e){return this._searchNearestSegmentBefore(e)+1},e.prototype.append=function(e){var t=this._list,a=e,n=this._lastAppendLocation,i=0;-1!==n&&n<t.length&&a.originalBeginDts>=t[n].lastSample.originalDts&&(n===t.length-1||n<t.length-1&&a.originalBeginDts<t[n+1].originalBeginDts)?i=n+1:t.length>0&&(i=this._searchNearestSegmentBefore(a.originalBeginDts)+1),this._lastAppendLocation=i,this._list.splice(i,0,a)},e.prototype.getLastSegmentBefore=function(e){var t=this._searchNearestSegmentBefore(e);return t>=0?this._list[t]:null},e.prototype.getLastSampleBefore=function(e){var t=this.getLastSegmentBefore(e);return null!=t?t.lastSample:null},e.prototype.getLastSyncPointBefore=function(e){for(var t=this._searchNearestSegmentBefore(e),a=this._list[t].syncPoints;0===a.length&&t>0;)t--,a=this._list[t].syncPoints;return a.length>0?a[a.length-1]:null},e}()},function(e,t,a){var n=function(){function e(){this.mimeType=null,this.duration=null,this.hasAudio=null,this.hasVideo=null,this.audioCodec=null,this.videoCodec=null,this.audioDataRate=null,this.videoDataRate=null,this.audioSampleRate=null,this.audioChannelCount=null,this.width=null,this.height=null,this.fps=null,this.profile=null,this.level=null,this.refFrames=null,this.chromaFormat=null,this.sarNum=null,this.sarDen=null,this.metadata=null,this.segments=null,this.segmentCount=null,this.hasKeyframesIndex=null,this.keyframesIndex=null}return e.prototype.isComplete=function(){var e=!1===this.hasAudio||!0===this.hasAudio&&null!=this.audioCodec&&null!=this.audioSampleRate&&null!=this.audioChannelCount,t=!1===this.hasVideo||!0===this.hasVideo&&null!=this.videoCodec&&null!=this.width&&null!=this.height&&null!=this.fps&&null!=this.profile&&null!=this.level&&null!=this.refFrames&&null!=this.chromaFormat&&null!=this.sarNum&&null!=this.sarDen;return null!=this.mimeType&&e&&t},e.prototype.isSeekable=function(){return!0===this.hasKeyframesIndex},e.prototype.getNearestKeyframe=function(e){if(null==this.keyframesIndex)return null;var t=this.keyframesIndex,a=this._search(t.times,e);return{index:a,milliseconds:t.times[a],fileposition:t.filepositions[a]}},e.prototype._search=function(e,t){var a=0,n=e.length-1,i=0,r=0,o=n;for(t<e[0]&&(a=0,r=o+1);r<=o;){if((i=r+Math.floor((o-r)/2))===n||t>=e[i]&&t<e[i+1]){a=i;break}e[i]<t?r=i+1:o=i-1}return a},e}();t.a=n},function(e,t,a){var n=a(6),i=a.n(n),r=a(0),o=function(){function e(){}return Object.defineProperty(e,"forceGlobalTag",{get:function(){return r.a.FORCE_GLOBAL_TAG},set:function(t){r.a.FORCE_GLOBAL_TAG=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"globalTag",{get:function(){return r.a.GLOBAL_TAG},set:function(t){r.a.GLOBAL_TAG=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableAll",{get:function(){return r.a.ENABLE_VERBOSE&&r.a.ENABLE_DEBUG&&r.a.ENABLE_INFO&&r.a.ENABLE_WARN&&r.a.ENABLE_ERROR},set:function(t){r.a.ENABLE_VERBOSE=t,r.a.ENABLE_DEBUG=t,r.a.ENABLE_INFO=t,r.a.ENABLE_WARN=t,r.a.ENABLE_ERROR=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableDebug",{get:function(){return r.a.ENABLE_DEBUG},set:function(t){r.a.ENABLE_DEBUG=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableVerbose",{get:function(){return r.a.ENABLE_VERBOSE},set:function(t){r.a.ENABLE_VERBOSE=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableInfo",{get:function(){return r.a.ENABLE_INFO},set:function(t){r.a.ENABLE_INFO=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableWarn",{get:function(){return r.a.ENABLE_WARN},set:function(t){r.a.ENABLE_WARN=t,e._notifyChange()},enumerable:!1,configurable:!0}),Object.defineProperty(e,"enableError",{get:function(){return r.a.ENABLE_ERROR},set:function(t){r.a.ENABLE_ERROR=t,e._notifyChange()},enumerable:!1,configurable:!0}),e.getConfig=function(){return{globalTag:r.a.GLOBAL_TAG,forceGlobalTag:r.a.FORCE_GLOBAL_TAG,enableVerbose:r.a.ENABLE_VERBOSE,enableDebug:r.a.ENABLE_DEBUG,enableInfo:r.a.ENABLE_INFO,enableWarn:r.a.ENABLE_WARN,enableError:r.a.ENABLE_ERROR,enableCallback:r.a.ENABLE_CALLBACK}},e.applyConfig=function(e){r.a.GLOBAL_TAG=e.globalTag,r.a.FORCE_GLOBAL_TAG=e.forceGlobalTag,r.a.ENABLE_VERBOSE=e.enableVerbose,r.a.ENABLE_DEBUG=e.enableDebug,r.a.ENABLE_INFO=e.enableInfo,r.a.ENABLE_WARN=e.enableWarn,r.a.ENABLE_ERROR=e.enableError,r.a.ENABLE_CALLBACK=e.enableCallback},e._notifyChange=function(){var t=e.emitter;if(t.listenerCount("change")>0){var a=e.getConfig();t.emit("change",a)}},e.registerListener=function(t){e.emitter.addListener("change",t)},e.removeListener=function(t){e.emitter.removeListener("change",t)},e.addLogListener=function(t){r.a.emitter.addListener("log",t),r.a.emitter.listenerCount("log")>0&&(r.a.ENABLE_CALLBACK=!0,e._notifyChange())},e.removeLogListener=function(t){r.a.emitter.removeListener("log",t),0===r.a.emitter.listenerCount("log")&&(r.a.ENABLE_CALLBACK=!1,e._notifyChange())},e}();o.emitter=new i.a,t.a=o},function(e,t,a){var n=a(6),i=a.n(n),r=a(0),o=a(4),s=a(8);function l(e,t,a){var n=e;if(t+a<n.length){for(;a--;)if(128!=(192&n[++t]))return!1;return!0}return!1}var d,c=function(e){for(var t=[],a=e,n=0,i=e.length;n<i;)if(a[n]<128)t.push(String.fromCharCode(a[n])),++n;else{if(a[n]<192);else if(a[n]<224){if(l(a,n,1)&&(r=(31&a[n])<<6|63&a[n+1])>=128){t.push(String.fromCharCode(65535&r)),n+=2;continue}}else if(a[n]<240){if(l(a,n,2)&&(r=(15&a[n])<<12|(63&a[n+1])<<6|63&a[n+2])>=2048&&55296!=(63488&r)){t.push(String.fromCharCode(65535&r)),n+=3;continue}}else if(a[n]<248){var r;if(l(a,n,3)&&(r=(7&a[n])<<18|(63&a[n+1])<<12|(63&a[n+2])<<6|63&a[n+3])>65536&&r<1114112){r-=65536,t.push(String.fromCharCode(r>>>10|55296)),t.push(String.fromCharCode(1023&r|56320)),n+=4;continue}}t.push(String.fromCharCode(65533)),++n}return t.join("")},u=a(3),h=(d=new ArrayBuffer(2),new DataView(d).setInt16(0,256,!0),256===new Int16Array(d)[0]),p=function(){function e(){}return e.parseScriptData=function(t,a,n){var i={};try{var o=e.parseValue(t,a,n),s=e.parseValue(t,a+o.size,n-o.size);i[o.data]=s.data}catch(e){r.a.e("AMF",e.toString())}return i},e.parseObject=function(t,a,n){if(n<3)throw new u.a("Data not enough when parse ScriptDataObject");var i=e.parseString(t,a,n),r=e.parseValue(t,a+i.size,n-i.size),o=r.objectEnd;return{data:{name:i.data,value:r.data},size:i.size+r.size,objectEnd:o}},e.parseVariable=function(t,a,n){return e.parseObject(t,a,n)},e.parseString=function(e,t,a){if(a<2)throw new u.a("Data not enough when parse String");var n=new DataView(e,t,a).getUint16(0,!h);return{data:n>0?c(new Uint8Array(e,t+2,n)):"",size:2+n}},e.parseLongString=function(e,t,a){if(a<4)throw new u.a("Data not enough when parse LongString");var n=new DataView(e,t,a).getUint32(0,!h);return{data:n>0?c(new Uint8Array(e,t+4,n)):"",size:4+n}},e.parseDate=function(e,t,a){if(a<10)throw new u.a("Data size invalid when parse Date");var n=new DataView(e,t,a),i=n.getFloat64(0,!h),r=n.getInt16(8,!h);return{data:new Date(i+=60*r*1e3),size:10}},e.parseValue=function(t,a,n){if(n<1)throw new u.a("Data not enough when parse Value");var i,o=new DataView(t,a,n),s=1,l=o.getUint8(0),d=!1;try{switch(l){case 0:i=o.getFloat64(1,!h),s+=8;break;case 1:i=!!o.getUint8(1),s+=1;break;case 2:var c=e.parseString(t,a+1,n-1);i=c.data,s+=c.size;break;case 3:i={};var p=0;for(9==(16777215&o.getUint32(n-4,!h))&&(p=3);s<n-4;){var f=e.parseObject(t,a+s,n-s-p);if(f.objectEnd)break;i[f.data.name]=f.data.value,s+=f.size}s<=n-3&&9==(16777215&o.getUint32(s-1,!h))&&(s+=3);break;case 8:for(i={},s+=4,p=0,9==(16777215&o.getUint32(n-4,!h))&&(p=3);s<n-8;){var _=e.parseVariable(t,a+s,n-s-p);if(_.objectEnd)break;i[_.data.name]=_.data.value,s+=_.size}s<=n-3&&9==(16777215&o.getUint32(s-1,!h))&&(s+=3);break;case 9:i=void 0,s=1,d=!0;break;case 10:i=[];var m=o.getUint32(1,!h);s+=4;for(var g=0;g<m;g++){var v=e.parseValue(t,a+s,n-s);i.push(v.data),s+=v.size}break;case 11:var y=e.parseDate(t,a+1,n-1);i=y.data,s+=y.size;break;case 12:var b=e.parseString(t,a+1,n-1);i=b.data,s+=b.size;break;default:s=n,r.a.w("AMF","Unsupported AMF value type "+l)}}catch(e){r.a.e("AMF",e.toString())}return{data:i,size:s,objectEnd:d}},e}(),f=function(){function e(e){this.TAG="ExpGolomb",this._buffer=e,this._buffer_index=0,this._total_bytes=e.byteLength,this._total_bits=8*e.byteLength,this._current_word=0,this._current_word_bits_left=0}return e.prototype.destroy=function(){this._buffer=null},e.prototype._fillCurrentWord=function(){var e=this._total_bytes-this._buffer_index;if(e<=0)throw new u.a("ExpGolomb: _fillCurrentWord() but no bytes available");var t=Math.min(4,e),a=new Uint8Array(4);a.set(this._buffer.subarray(this._buffer_index,this._buffer_index+t)),this._current_word=new DataView(a.buffer).getUint32(0,!1),this._buffer_index+=t,this._current_word_bits_left=8*t},e.prototype.readBits=function(e){if(e>32)throw new u.b("ExpGolomb: readBits() bits exceeded max 32bits!");if(e<=this._current_word_bits_left){var t=this._current_word>>>32-e;return this._current_word<<=e,this._current_word_bits_left-=e,t}var a=this._current_word_bits_left?this._current_word:0;a>>>=32-this._current_word_bits_left;var n=e-this._current_word_bits_left;this._fillCurrentWord();var i=Math.min(n,this._current_word_bits_left),r=this._current_word>>>32-i;return this._current_word<<=i,this._current_word_bits_left-=i,a<<i|r},e.prototype.readBool=function(){return 1===this.readBits(1)},e.prototype.readByte=function(){return this.readBits(8)},e.prototype._skipLeadingZero=function(){var e;for(e=0;e<this._current_word_bits_left;e++)if(0!=(this._current_word&2147483648>>>e))return this._current_word<<=e,this._current_word_bits_left-=e,e;return this._fillCurrentWord(),e+this._skipLeadingZero()},e.prototype.readUEG=function(){var e=this._skipLeadingZero();return this.readBits(e+1)-1},e.prototype.readSEG=function(){var e=this.readUEG();return 1&e?e+1>>>1:-1*(e>>>1)},e}(),_=function(){function e(){}return e._ebsp2rbsp=function(e){for(var t=e,a=t.byteLength,n=new Uint8Array(a),i=0,r=0;r<a;r++)r>=2&&3===t[r]&&0===t[r-1]&&0===t[r-2]||(n[i]=t[r],i++);return new Uint8Array(n.buffer,0,i)},e.parseSPS=function(t){for(var a=t.subarray(1,4),n="avc1.",i=0;i<3;i++){var r=a[i].toString(16);r.length<2&&(r="0"+r),n+=r}var o=e._ebsp2rbsp(t),s=new f(o);s.readByte();var l=s.readByte();s.readByte();var d=s.readByte();s.readUEG();var c=e.getProfileString(l),u=e.getLevelString(d),h=1,p=420,_=8,m=8;if((100===l||110===l||122===l||244===l||44===l||83===l||86===l||118===l||128===l||138===l||144===l)&&(3===(h=s.readUEG())&&s.readBits(1),h<=3&&(p=[0,420,422,444][h]),_=s.readUEG()+8,m=s.readUEG()+8,s.readBits(1),s.readBool()))for(var g=3!==h?8:12,v=0;v<g;v++)s.readBool()&&(v<6?e._skipScalingList(s,16):e._skipScalingList(s,64));s.readUEG();var y=s.readUEG();if(0===y)s.readUEG();else if(1===y){s.readBits(1),s.readSEG(),s.readSEG();var b=s.readUEG();for(v=0;v<b;v++)s.readSEG()}var E=s.readUEG();s.readBits(1);var S=s.readUEG(),A=s.readUEG(),w=s.readBits(1);0===w&&s.readBits(1),s.readBits(1);var C=0,T=0,R=0,D=0;s.readBool()&&(C=s.readUEG(),T=s.readUEG(),R=s.readUEG(),D=s.readUEG());var k=1,x=1,L=0,N=!0,B=0,V=0;if(s.readBool()){if(s.readBool()){var M=s.readByte();M>0&&M<16?(k=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][M-1],x=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][M-1]):255===M&&(k=s.readByte()<<8|s.readByte(),x=s.readByte()<<8|s.readByte())}if(s.readBool()&&s.readBool(),s.readBool()&&(s.readBits(4),s.readBool()&&s.readBits(24)),s.readBool()&&(s.readUEG(),s.readUEG()),s.readBool()){var O=s.readBits(32),I=s.readBits(32);N=s.readBool(),L=(B=I)/(V=2*O)}}var P=1;1===k&&1===x||(P=k/x);var U=0,j=0;0===h?(U=1,j=2-w):(U=3===h?1:2,j=(1===h?2:1)*(2-w));var F=16*(S+1),z=16*(A+1)*(2-w);F-=(C+T)*U,z-=(R+D)*j;var G=Math.ceil(F*P);return s.destroy(),s=null,{codec_mimetype:n,profile_idc:l,level_idc:d,profile_string:c,level_string:u,chroma_format_idc:h,bit_depth:_,bit_depth_luma:_,bit_depth_chroma:m,ref_frames:E,chroma_format:p,chroma_format_string:e.getChromaFormatString(p),frame_rate:{fixed:N,fps:L,fps_den:V,fps_num:B},sar_ratio:{width:k,height:x},codec_size:{width:F,height:z},present_size:{width:G,height:z}}},e._skipScalingList=function(e,t){for(var a=8,n=8,i=0;i<t;i++)0!==n&&(n=(a+e.readSEG()+256)%256),a=0===n?a:n},e.getProfileString=function(e){switch(e){case 66:return"Baseline";case 77:return"Main";case 88:return"Extended";case 100:return"High";case 110:return"High10";case 122:return"High422";case 244:return"High444";default:return"Unknown"}},e.getLevelString=function(e){return(e/10).toFixed(1)},e.getChromaFormatString=function(e){switch(e){case 420:return"4:2:0";case 422:return"4:2:2";case 444:return"4:4:4";default:return"Unknown"}},e}(),m=a(5),g=function(){function e(){}return e._ebsp2rbsp=function(e){for(var t=e,a=t.byteLength,n=new Uint8Array(a),i=0,r=0;r<a;r++)r>=2&&3===t[r]&&0===t[r-1]&&0===t[r-2]||(n[i]=t[r],i++);return new Uint8Array(n.buffer,0,i)},e.parseVPS=function(t){var a=e._ebsp2rbsp(t),n=new f(a);return n.readByte(),n.readByte(),n.readBits(4),n.readBits(2),n.readBits(6),{num_temporal_layers:n.readBits(3)+1,temporal_id_nested:n.readBool()}},e.parseSPS=function(t){var a=e._ebsp2rbsp(t),n=new f(a);n.readByte(),n.readByte();for(var i=0,r=0,o=0,s=0,l=(n.readBits(4),n.readBits(3)),d=(n.readBool(),n.readBits(2)),c=n.readBool(),u=n.readBits(5),h=n.readByte(),p=n.readByte(),_=n.readByte(),m=n.readByte(),g=n.readByte(),v=n.readByte(),y=n.readByte(),b=n.readByte(),E=n.readByte(),S=n.readByte(),A=n.readByte(),w=[],C=[],T=0;T<l;T++)w.push(n.readBool()),C.push(n.readBool());if(l>0)for(T=l;T<8;T++)n.readBits(2);for(T=0;T<l;T++)w[T]&&(n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte(),n.readByte()),C[T]&&n.readByte();n.readUEG();var R=n.readUEG();3==R&&n.readBits(1);var D=n.readUEG(),k=n.readUEG();n.readBool()&&(i+=n.readUEG(),r+=n.readUEG(),o+=n.readUEG(),s+=n.readUEG());var x=n.readUEG(),L=n.readUEG(),N=n.readUEG();for(T=n.readBool()?0:l;T<=l;T++)n.readUEG(),n.readUEG(),n.readUEG();if(n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG(),n.readBool()&&n.readBool())for(var B=0;B<4;B++)for(var V=0;V<(3===B?2:6);V++)if(n.readBool()){var M=Math.min(64,1<<4+(B<<1));for(B>1&&n.readSEG(),T=0;T<M;T++)n.readSEG()}else n.readUEG();n.readBool(),n.readBool(),n.readBool()&&(n.readByte(),n.readUEG(),n.readUEG(),n.readBool());var O=n.readUEG(),I=0;for(T=0;T<O;T++){var P=!1;if(0!==T&&(P=n.readBool()),P){T===O&&n.readUEG(),n.readBool(),n.readUEG();for(var U=0,j=0;j<=I;j++){var F=n.readBool(),z=!1;F||(z=n.readBool()),(F||z)&&U++}I=U}else{var G=n.readUEG(),H=n.readUEG();for(I=G+H,j=0;j<G;j++)n.readUEG(),n.readBool();for(j=0;j<H;j++)n.readUEG(),n.readBool()}}if(n.readBool()){var q=n.readUEG();for(T=0;T<q;T++){for(j=0;j<N+4;j++)n.readBits(1);n.readBits(1)}}var W=0,K=1,Y=1,$=!1,X=1,Z=1;if(n.readBool(),n.readBool(),n.readBool()){if(n.readBool()){var J=n.readByte();J>0&&J<=16?(K=[1,12,10,16,40,24,20,32,80,18,15,64,160,4,3,2][J-1],Y=[1,11,11,11,33,11,11,11,33,11,11,33,99,3,2,1][J-1]):255===J&&(K=n.readBits(16),Y=n.readBits(16))}if(n.readBool()&&n.readBool(),n.readBool()&&(n.readBits(3),n.readBool(),n.readBool()&&(n.readByte(),n.readByte(),n.readByte())),n.readBool()&&(n.readUEG(),n.readUEG()),n.readBool(),n.readBool(),n.readBool(),n.readBool()&&(n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG()),n.readBool()&&(X=n.readBits(32),Z=n.readBits(32),n.readBool()&&n.readUEG(),n.readBool())){var Q=!1,ee=!1,te=!1;for(Q=n.readBool(),ee=n.readBool(),(Q||ee)&&((te=n.readBool())&&(n.readByte(),n.readBits(5),n.readBool(),n.readBits(5)),n.readBits(4),n.readBits(4),te&&n.readBits(4),n.readBits(5),n.readBits(5),n.readBits(5)),T=0;T<=l;T++){var ae=n.readBool();$=ae;var ne=!0,ie=1;ae||(ne=n.readBool());var re=!1;if(ne?n.readUEG():re=n.readBool(),re||(ie=n.readUEG()+1),Q){for(j=0;j<ie;j++)n.readUEG(),n.readUEG(),te&&(n.readUEG(),n.readUEG());n.readBool()}if(ee){for(j=0;j<ie;j++)n.readUEG(),n.readUEG(),te&&(n.readUEG(),n.readUEG());n.readBool()}}}n.readBool()&&(n.readBool(),n.readBool(),n.readBool(),W=n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG(),n.readUEG())}n.readBool();var oe="hvc1."+u+".1.L"+A+".B0",se=D-(i+r)*(1===R||2===R?2:1),le=k-(o+s)*(1===R?2:1),de=1;return 1!==K&&1!==Y&&(de=K/Y),n.destroy(),n=null,{codec_mimetype:oe,level_string:e.getLevelString(A),profile_idc:u,bit_depth:x+8,ref_frames:1,chroma_format:R,chroma_format_string:e.getChromaFormatString(R),general_level_idc:A,general_profile_space:d,general_tier_flag:c,general_profile_idc:u,general_profile_compatibility_flags_1:h,general_profile_compatibility_flags_2:p,general_profile_compatibility_flags_3:_,general_profile_compatibility_flags_4:m,general_constraint_indicator_flags_1:g,general_constraint_indicator_flags_2:v,general_constraint_indicator_flags_3:y,general_constraint_indicator_flags_4:b,general_constraint_indicator_flags_5:E,general_constraint_indicator_flags_6:S,min_spatial_segmentation_idc:W,constant_frame_rate:0,chroma_format_idc:R,bit_depth_luma_minus8:x,bit_depth_chroma_minus8:L,frame_rate:{fixed:$,fps:Z/X,fps_den:X,fps_num:Z},sar_ratio:{width:K,height:Y},codec_size:{width:se,height:le},present_size:{width:se*de,height:le}}},e.parsePPS=function(t){var a=e._ebsp2rbsp(t),n=new f(a);n.readByte(),n.readByte(),n.readUEG(),n.readUEG(),n.readBool(),n.readBool(),n.readBits(3),n.readBool(),n.readBool(),n.readUEG(),n.readUEG(),n.readSEG(),n.readBool(),n.readBool(),n.readBool()&&n.readUEG(),n.readSEG(),n.readSEG(),n.readBool(),n.readBool(),n.readBool(),n.readBool();var i=n.readBool(),r=n.readBool(),o=1;return r&&i?o=0:r?o=3:i&&(o=2),{parallelismType:o}},e.getChromaFormatString=function(e){switch(e){case 0:return"4:0:0";case 1:return"4:2:0";case 2:return"4:2:2";case 3:return"4:4:4";default:return"Unknown"}},e.getProfileString=function(e){switch(e){case 1:return"Main";case 2:return"Main10";case 3:return"MainSP";case 4:return"Rext";case 9:return"SCC";default:return"Unknown"}},e.getLevelString=function(e){return(e/30).toFixed(1)},e}();function v(e){return e.byteOffset%2==0&&e.byteLength%2==0}function y(e){return e.byteOffset%4==0&&e.byteLength%4==0}function b(e,t){for(var a=0;a<e.length;a++)if(e[a]!==t[a])return!1;return!0}var E,S=function(e,t){return e.byteLength===t.byteLength&&(y(e)&&y(t)?function(e,t){return b(new Uint32Array(e.buffer,e.byteOffset,e.byteLength/4),new Uint32Array(t.buffer,t.byteOffset,t.byteLength/4))}(e,t):v(e)&&v(t)?function(e,t){return b(new Uint16Array(e.buffer,e.byteOffset,e.byteLength/2),new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2))}(e,t):function(e,t){return b(e,t)}(e,t))},A=function(){function e(){}return e.parseOBUs=function(t){for(var a=null,n=0;n<t.byteLength;){t[n];var i=(120&t[n])>>3,r=0!=(4&t[n]),o=0!=(2&t[n]);t[n],n+=1,r&&(n+=1);var s=Number.POSITIVE_INFINITY;if(o){s=0;for(var l=0;s|=(127&t[n])<<7*l,0!=(128&t[n+=1]);l++);}1===i&&(a=e.parseSeuqneceHeader(t.subarray(n,n+s))),n+=s}return a},e.parseSeuqneceHeader=function(t){var a=new f(t),n=a.readBits(3),i=(a.readBool(),a.readBool()),r=!0,o=0,s=0,l=[];if(i)l.push({operating_point_idc:0,level:a.readBits(5),tier:0});else{if(a.readBool()){var d=a.readBits(32),c=a.readBits(32),u=a.readBool();if(u){for(var h=0;0===a.readBits(1);)h+=1;h>=32||a.readBits(h)}o=c,s=d,r=u,a.readBool()&&(a.readBits(5),a.readBits(32),a.readBits(5),a.readBits(5))}for(var p=a.readBool(),_=a.readBits(5),m=0;m<=_;m++){var g=a.readBits(12),v=a.readBits(5),y=v>7?a.readBits(1):0;l.push({operating_point_idc:g,level:v,tier:y}),p&&a.readBool()&&a.readBits(4)}}var b=l[0],E=b.level,S=b.tier,A=a.readBits(4),w=a.readBits(4),C=a.readBits(A+1)+1,T=a.readBits(w+1)+1,R=!1;i||(R=a.readBool()),R&&(a.readBits(4),a.readBits(4)),a.readBool(),a.readBool(),a.readBool();var D=!1;i||(a.readBool(),a.readBool(),a.readBool(),a.readBool(),(D=a.readBool())&&(a.readBool(),a.readBool()),(a.readBool()||a.readBits(1))&&(a.readBool()||a.readBits(1)),D&&a.readBits(3)),a.readBool(),a.readBool(),a.readBool();var k=a.readBool(),x=8;x=2===n&&k?a.readBool()?12:10:k?10:8;var L=!1;1!==n&&(L=a.readBool()),a.readBool()&&(a.readBits(8),a.readBits(8),a.readBits(8));var N=1,B=1;return L?(a.readBits(1),N=1,B=1):(a.readBits(1),0==n?(N=1,B=1):1==n?(N=0,B=0):12==x?a.readBits(1)&&a.readBits(1):(N=1,B=0),N&&B&&a.readBits(2),a.readBits(1)),a.readBool(),a.destroy(),a=null,{codec_mimetype:"av01."+n+"."+e.getLevelString(E,S)+"."+x.toString(10).padStart(2,"0"),level:E,tier:S,level_string:e.getLevelString(E,S),profile_idc:n,profile_string:""+n,bit_depth:x,ref_frames:1,chroma_format:e.getChromaFormat(L,N,B),chroma_format_string:e.getChromaFormatString(L,N,B),frame_rate:{fixed:r,fps:o/s,fps_den:s,fps_num:o},sar_ratio:{width:1,height:1},codec_size:{width:C,height:T},present_size:{width:1*C,height:T}}},e.getLevelString=function(e,t){return e.toString(10).padStart(2,"0")+(0===t?"M":"H")},e.getChromaFormat=function(e,t,a){return e?0:0===t&&0===a?3:1===t&&0===a?2:1===t&&1===a?1:Number.NaN},e.getChromaFormatString=function(e,t,a){return e?"4:0:0":0===t&&0===a?"4:4:4":1===t&&0===a?"4:2:2":1===t&&1===a?"4:2:0":"Unknown"},e}(),w=function(){function e(e,t){this.TAG="FLVDemuxer",this._config=t,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null,this._dataOffset=e.dataOffset,this._firstParse=!0,this._dispatch=!1,this._hasAudio=e.hasAudioTrack,this._hasVideo=e.hasVideoTrack,this._hasAudioFlagOverrided=!1,this._hasVideoFlagOverrided=!1,this._audioInitialMetadataDispatched=!1,this._videoInitialMetadataDispatched=!1,this._mediaInfo=new s.a,this._mediaInfo.hasAudio=this._hasAudio,this._mediaInfo.hasVideo=this._hasVideo,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._naluLengthSize=4,this._timestampBase=0,this._timescale=1e3,this._duration=0,this._durationOverrided=!1,this._referenceFrameRate={fixed:!0,fps:23.976,fps_num:23976,fps_den:1e3},this._flvSoundRateTable=[5500,11025,22050,44100,48e3],this._mpegSamplingRates=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],this._mpegAudioV10SampleRateTable=[44100,48e3,32e3,0],this._mpegAudioV20SampleRateTable=[22050,24e3,16e3,0],this._mpegAudioV25SampleRateTable=[11025,12e3,8e3,0],this._mpegAudioL1BitRateTable=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],this._mpegAudioL2BitRateTable=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],this._mpegAudioL3BitRateTable=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],this._videoTrack={type:"video",id:1,sequenceNumber:0,samples:[],length:0},this._audioTrack={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},this._littleEndian=function(){var e=new ArrayBuffer(2);return new DataView(e).setInt16(0,256,!0),256===new Int16Array(e)[0]}()}return e.prototype.destroy=function(){this._mediaInfo=null,this._metadata=null,this._audioMetadata=null,this._videoMetadata=null,this._videoTrack=null,this._audioTrack=null,this._onError=null,this._onMediaInfo=null,this._onMetaDataArrived=null,this._onScriptDataArrived=null,this._onTrackMetadata=null,this._onDataAvailable=null},e.probe=function(e){var t=new Uint8Array(e);if(t.byteLength<9)return{needMoreData:!0};var a={match:!1};if(70!==t[0]||76!==t[1]||86!==t[2]||1!==t[3])return a;var n,i,r=(4&t[4])>>>2!=0,o=0!=(1&t[4]),s=(n=t)[i=5]<<24|n[i+1]<<16|n[i+2]<<8|n[i+3];return s<9?a:{match:!0,consumed:s,dataOffset:s,hasAudioTrack:r,hasVideoTrack:o}},e.prototype.bindDataSource=function(e){return e.onDataArrival=this.parseChunks.bind(this),this},Object.defineProperty(e.prototype,"onTrackMetadata",{get:function(){return this._onTrackMetadata},set:function(e){this._onTrackMetadata=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMediaInfo",{get:function(){return this._onMediaInfo},set:function(e){this._onMediaInfo=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMetaDataArrived",{get:function(){return this._onMetaDataArrived},set:function(e){this._onMetaDataArrived=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onScriptDataArrived",{get:function(){return this._onScriptDataArrived},set:function(e){this._onScriptDataArrived=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataAvailable",{get:function(){return this._onDataAvailable},set:function(e){this._onDataAvailable=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"timestampBase",{get:function(){return this._timestampBase},set:function(e){this._timestampBase=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedDuration",{get:function(){return this._duration},set:function(e){this._durationOverrided=!0,this._duration=e,this._mediaInfo.duration=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedHasAudio",{set:function(e){this._hasAudioFlagOverrided=!0,this._hasAudio=e,this._mediaInfo.hasAudio=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"overridedHasVideo",{set:function(e){this._hasVideoFlagOverrided=!0,this._hasVideo=e,this._mediaInfo.hasVideo=e},enumerable:!1,configurable:!0}),e.prototype.resetMediaInfo=function(){this._mediaInfo=new s.a},e.prototype._isInitialMetadataDispatched=function(){return this._hasAudio&&this._hasVideo?this._audioInitialMetadataDispatched&&this._videoInitialMetadataDispatched:this._hasAudio&&!this._hasVideo?this._audioInitialMetadataDispatched:!(this._hasAudio||!this._hasVideo)&&this._videoInitialMetadataDispatched},e.prototype.parseChunks=function(t,a){if(!(this._onError&&this._onMediaInfo&&this._onTrackMetadata&&this._onDataAvailable))throw new u.a("Flv: onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var n=0,i=this._littleEndian;if(0===a){if(!(t.byteLength>13))return 0;n=e.probe(t).dataOffset}for(this._firstParse&&(this._firstParse=!1,a+n!==this._dataOffset&&r.a.w(this.TAG,"First time parsing but chunk byteStart invalid!"),0!==(o=new DataView(t,n)).getUint32(0,!i)&&r.a.w(this.TAG,"PrevTagSize0 !== 0 !!!"),n+=4);n<t.byteLength;){this._dispatch=!0;var o=new DataView(t,n);if(n+11+4>t.byteLength)break;var s=o.getUint8(0),l=16777215&o.getUint32(0,!i);if(n+11+l+4>t.byteLength)break;if(8===s||9===s||18===s){var d=o.getUint8(4),c=o.getUint8(5),h=o.getUint8(6)|c<<8|d<<16|o.getUint8(7)<<24;0!=(16777215&o.getUint32(7,!i))&&r.a.w(this.TAG,"Meet tag which has StreamID != 0!");var p=n+11;switch(s){case 8:this._parseAudioData(t,p,l,h);break;case 9:this._parseVideoData(t,p,l,h,a+n);break;case 18:this._parseScriptData(t,p,l)}var f=o.getUint32(11+l,!i);f!==11+l&&r.a.w(this.TAG,"Invalid PrevTagSize "+f),n+=11+l+4}else r.a.w(this.TAG,"Unsupported tag type "+s+", skipped"),n+=11+l+4}return this._isInitialMetadataDispatched()&&this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack),n},e.prototype._parseScriptData=function(e,t,a){var n=p.parseScriptData(e,t,a);if(n.hasOwnProperty("onMetaData")){if(null==n.onMetaData||"object"!=typeof n.onMetaData)return void r.a.w(this.TAG,"Invalid onMetaData structure!");this._metadata&&r.a.w(this.TAG,"Found another onMetaData tag!"),this._metadata=n;var i=this._metadata.onMetaData;if(this._onMetaDataArrived&&this._onMetaDataArrived(Object.assign({},i)),"boolean"==typeof i.hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=i.hasAudio,this._mediaInfo.hasAudio=this._hasAudio),"boolean"==typeof i.hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=i.hasVideo,this._mediaInfo.hasVideo=this._hasVideo),"number"==typeof i.audiodatarate&&(this._mediaInfo.audioDataRate=i.audiodatarate),"number"==typeof i.videodatarate&&(this._mediaInfo.videoDataRate=i.videodatarate),"number"==typeof i.width&&(this._mediaInfo.width=i.width),"number"==typeof i.height&&(this._mediaInfo.height=i.height),"number"==typeof i.duration){if(!this._durationOverrided){var o=Math.floor(i.duration*this._timescale);this._duration=o,this._mediaInfo.duration=o}}else this._mediaInfo.duration=0;if("number"==typeof i.framerate){var s=Math.floor(1e3*i.framerate);if(s>0){var l=s/1e3;this._referenceFrameRate.fixed=!0,this._referenceFrameRate.fps=l,this._referenceFrameRate.fps_num=s,this._referenceFrameRate.fps_den=1e3,this._mediaInfo.fps=l}}if("object"==typeof i.keyframes){this._mediaInfo.hasKeyframesIndex=!0;var d=i.keyframes;this._mediaInfo.keyframesIndex=this._parseKeyframesIndex(d),i.keyframes=null}else this._mediaInfo.hasKeyframesIndex=!1;this._dispatch=!1,this._mediaInfo.metadata=i,r.a.v(this.TAG,"Parsed onMetaData"),this._mediaInfo.isComplete()&&this._onMediaInfo(this._mediaInfo)}Object.keys(n).length>0&&this._onScriptDataArrived&&this._onScriptDataArrived(Object.assign({},n))},e.prototype._parseKeyframesIndex=function(e){for(var t=[],a=[],n=1;n<e.times.length;n++){var i=this._timestampBase+Math.floor(1e3*e.times[n]);t.push(i),a.push(e.filepositions[n])}return{times:t,filepositions:a}},e.prototype._parseAudioData=function(e,t,a,n){if(a<=1)r.a.w(this.TAG,"Flv: Invalid audio packet, missing SoundData payload!");else if(!0!==this._hasAudioFlagOverrided||!1!==this._hasAudio){this._littleEndian;var i=new DataView(e,t,a).getUint8(0),o=i>>>4;if(2===o||10===o){var s=0,l=(12&i)>>>2;if(l>=0&&l<=4){s=this._flvSoundRateTable[l];var d=1&i,c=this._audioMetadata,u=this._audioTrack;if(c||(!1===this._hasAudio&&!1===this._hasAudioFlagOverrided&&(this._hasAudio=!0,this._mediaInfo.hasAudio=!0),(c=this._audioMetadata={}).type="audio",c.id=u.id,c.timescale=this._timescale,c.duration=this._duration,c.audioSampleRate=s,c.channelCount=0===d?1:2),10===o){var h=this._parseAACAudioData(e,t+1,a-1);if(null==h)return;if(0===h.packetType){if(c.config){if(S(h.data.config,c.config))return;r.a.w(this.TAG,"AudioSpecificConfig has been changed, re-generate initialization segment")}var p=h.data;c.audioSampleRate=p.samplingRate,c.channelCount=p.channelCount,c.codec=p.codec,c.originalCodec=p.originalCodec,c.config=p.config,c.refSampleDuration=1024/c.audioSampleRate*c.timescale,r.a.v(this.TAG,"Parsed AudioSpecificConfig"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._audioInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("audio",c),(g=this._mediaInfo).audioCodec=c.originalCodec,g.audioSampleRate=c.audioSampleRate,g.audioChannelCount=c.channelCount,g.hasVideo?null!=g.videoCodec&&(g.mimeType='video/x-flv; codecs="'+g.videoCodec+","+g.audioCodec+'"'):g.mimeType='video/x-flv; codecs="'+g.audioCodec+'"',g.isComplete()&&this._onMediaInfo(g)}else if(1===h.packetType){var f=this._timestampBase+n,_={unit:h.data,length:h.data.byteLength,dts:f,pts:f};u.samples.push(_),u.length+=h.data.length}else r.a.e(this.TAG,"Flv: Unsupported AAC data type "+h.packetType)}else if(2===o){if(!c.codec){var g;if(null==(p=this._parseMP3AudioData(e,t+1,a-1,!0)))return;c.audioSampleRate=p.samplingRate,c.channelCount=p.channelCount,c.codec=p.codec,c.originalCodec=p.originalCodec,c.refSampleDuration=1152/c.audioSampleRate*c.timescale,r.a.v(this.TAG,"Parsed MPEG Audio Frame Header"),this._audioInitialMetadataDispatched=!0,this._onTrackMetadata("audio",c),(g=this._mediaInfo).audioCodec=c.codec,g.audioSampleRate=c.audioSampleRate,g.audioChannelCount=c.channelCount,g.audioDataRate=p.bitRate,g.hasVideo?null!=g.videoCodec&&(g.mimeType='video/x-flv; codecs="'+g.videoCodec+","+g.audioCodec+'"'):g.mimeType='video/x-flv; codecs="'+g.audioCodec+'"',g.isComplete()&&this._onMediaInfo(g)}var v=this._parseMP3AudioData(e,t+1,a-1,!1);if(null==v)return;f=this._timestampBase+n;var y={unit:v,length:v.byteLength,dts:f,pts:f};u.samples.push(y),u.length+=v.length}}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid audio sample rate idx: "+l)}else this._onError(m.a.CODEC_UNSUPPORTED,"Flv: Unsupported audio codec idx: "+o)}},e.prototype._parseAACAudioData=function(e,t,a){if(!(a<=1)){var n={},i=new Uint8Array(e,t,a);return n.packetType=i[0],0===i[0]?n.data=this._parseAACAudioSpecificConfig(e,t+1,a-1):n.data=i.subarray(1),n}r.a.w(this.TAG,"Flv: Invalid AAC packet, missing AACPacketType or/and Data!")},e.prototype._parseAACAudioSpecificConfig=function(e,t,a){var n,i,r=new Uint8Array(e,t,a),o=null,s=0,l=null;if(s=n=r[0]>>>3,(i=(7&r[0])<<1|r[1]>>>7)<0||i>=this._mpegSamplingRates.length)this._onError(m.a.FORMAT_ERROR,"Flv: AAC invalid sampling frequency index!");else{var d=this._mpegSamplingRates[i],c=(120&r[1])>>>3;if(!(c<0||c>=8)){5===s&&(l=(7&r[1])<<1|r[2]>>>7,r[2]);var u=self.navigator.userAgent.toLowerCase();return-1!==u.indexOf("firefox")?i>=6?(s=5,o=new Array(4),l=i-3):(s=2,o=new Array(2),l=i):-1!==u.indexOf("android")?(s=2,o=new Array(2),l=i):(s=5,l=i,o=new Array(4),i>=6?l=i-3:1===c&&(s=2,o=new Array(2),l=i)),o[0]=s<<3,o[0]|=(15&i)>>>1,o[1]=(15&i)<<7,o[1]|=(15&c)<<3,5===s&&(o[1]|=(15&l)>>>1,o[2]=(1&l)<<7,o[2]|=8,o[3]=0),{config:o,samplingRate:d,channelCount:c,codec:"mp4a.40."+s,originalCodec:"mp4a.40."+n}}this._onError(m.a.FORMAT_ERROR,"Flv: AAC invalid channel configuration")}},e.prototype._parseMP3AudioData=function(e,t,a,n){if(!(a<4)){this._littleEndian;var i=new Uint8Array(e,t,a),o=null;if(n){if(255!==i[0])return;var s=i[1]>>>3&3,l=(6&i[1])>>1,d=(240&i[2])>>>4,c=(12&i[2])>>>2,u=3!=(i[3]>>>6&3)?2:1,h=0,p=0;switch(s){case 0:h=this._mpegAudioV25SampleRateTable[c];break;case 2:h=this._mpegAudioV20SampleRateTable[c];break;case 3:h=this._mpegAudioV10SampleRateTable[c]}switch(l){case 1:d<this._mpegAudioL3BitRateTable.length&&(p=this._mpegAudioL3BitRateTable[d]);break;case 2:d<this._mpegAudioL2BitRateTable.length&&(p=this._mpegAudioL2BitRateTable[d]);break;case 3:d<this._mpegAudioL1BitRateTable.length&&(p=this._mpegAudioL1BitRateTable[d])}o={bitRate:p,samplingRate:h,channelCount:u,codec:"mp3",originalCodec:"mp3"}}else o=i;return o}r.a.w(this.TAG,"Flv: Invalid MP3 packet, header missing!")},e.prototype._parseVideoData=function(e,t,a,n,i){if(a<=1)r.a.w(this.TAG,"Flv: Invalid video packet, missing VideoData payload!");else if(!0!==this._hasVideoFlagOverrided||!1!==this._hasVideo){var o=new Uint8Array(e,t,a)[0],s=(112&o)>>>4;if(0!=(128&o)){var l=15&o,d=String.fromCharCode.apply(String,new Uint8Array(e,t,a).slice(1,5));if("hvc1"===d)this._parseEnhancedHEVCVideoPacket(e,t+5,a-5,n,i,s,l);else{if("av01"!==d)return void this._onError(m.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+d);this._parseEnhancedAV1VideoPacket(e,t+5,a-5,n,i,s,l)}}else{var c=15&o;if(7===c)this._parseAVCVideoPacket(e,t+1,a-1,n,i,s);else{if(12!==c)return void this._onError(m.a.CODEC_UNSUPPORTED,"Flv: Unsupported codec in video frame: "+c);this._parseHEVCVideoPacket(e,t+1,a-1,n,i,s)}}}},e.prototype._parseAVCVideoPacket=function(e,t,a,n,i,o){if(a<4)r.a.w(this.TAG,"Flv: Invalid AVC packet, missing AVCPacketType or/and CompositionTime");else{var s=this._littleEndian,l=new DataView(e,t,a),d=l.getUint8(0),c=(16777215&l.getUint32(0,!s))<<8>>8;if(0===d)this._parseAVCDecoderConfigurationRecord(e,t+4,a-4);else if(1===d)this._parseAVCVideoData(e,t+4,a-4,n,i,o,c);else if(2!==d)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid video packet type "+d)}},e.prototype._parseHEVCVideoPacket=function(e,t,a,n,i,o){if(a<4)r.a.w(this.TAG,"Flv: Invalid HEVC packet, missing HEVCPacketType or/and CompositionTime");else{var s=this._littleEndian,l=new DataView(e,t,a),d=l.getUint8(0),c=(16777215&l.getUint32(0,!s))<<8>>8;if(0===d)this._parseHEVCDecoderConfigurationRecord(e,t+4,a-4);else if(1===d)this._parseHEVCVideoData(e,t+4,a-4,n,i,o,c);else if(2!==d)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid video packet type "+d)}},e.prototype._parseEnhancedHEVCVideoPacket=function(e,t,a,n,i,r,o){var s=this._littleEndian,l=new DataView(e,t,a);if(0===o)this._parseHEVCDecoderConfigurationRecord(e,t,a);else if(1===o){var d=(4294967040&l.getUint32(0,!s))>>8;this._parseHEVCVideoData(e,t+3,a-3,n,i,r,d)}else if(3===o)this._parseHEVCVideoData(e,t,a,n,i,r,0);else if(2!==o)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid video packet type "+o)},e.prototype._parseEnhancedAV1VideoPacket=function(e,t,a,n,i,r,o){if(this._littleEndian,0===o)this._parseAV1CodecConfigurationRecord(e,t,a);else if(1===o)this._parseAV1VideoData(e,t,a,n,i,r,0);else{if(5===o)return void this._onError(m.a.FORMAT_ERROR,"Flv: Not Supported MP2T AV1 video packet type "+o);if(2!==o)return void this._onError(m.a.FORMAT_ERROR,"Flv: Invalid video packet type "+o)}},e.prototype._parseAVCDecoderConfigurationRecord=function(e,t,a){if(a<7)r.a.w(this.TAG,"Flv: Invalid AVCDecoderConfigurationRecord, lack of data!");else{var n=this._videoMetadata,i=this._videoTrack,o=this._littleEndian,s=new DataView(e,t,a);if(n){if(void 0!==n.avcc){var l=new Uint8Array(e,t,a);if(S(l,n.avcc))return;r.a.w(this.TAG,"AVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(n=this._videoMetadata={}).type="video",n.id=i.id,n.timescale=this._timescale,n.duration=this._duration;var d=s.getUint8(0),c=s.getUint8(1);if(s.getUint8(2),s.getUint8(3),1===d&&0!==c)if(this._naluLengthSize=1+(3&s.getUint8(4)),3===this._naluLengthSize||4===this._naluLengthSize){var u=31&s.getUint8(5);if(0!==u){u>1&&r.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: SPS Count = "+u);for(var h=6,p=0;p<u;p++){var f=s.getUint16(h,!o);if(h+=2,0!==f){var g=new Uint8Array(e,t+h,f);h+=f;var v=_.parseSPS(g);if(0===p){n.codecWidth=v.codec_size.width,n.codecHeight=v.codec_size.height,n.presentWidth=v.present_size.width,n.presentHeight=v.present_size.height,n.profile=v.profile_string,n.level=v.level_string,n.bitDepth=v.bit_depth,n.chromaFormat=v.chroma_format,n.sarRatio=v.sar_ratio,n.frameRate=v.frame_rate,!1!==v.frame_rate.fixed&&0!==v.frame_rate.fps_num&&0!==v.frame_rate.fps_den||(n.frameRate=this._referenceFrameRate);var y=n.frameRate.fps_den,b=n.frameRate.fps_num;n.refSampleDuration=n.timescale*(y/b);for(var E=g.subarray(1,4),A="avc1.",w=0;w<3;w++){var C=E[w].toString(16);C.length<2&&(C="0"+C),A+=C}n.codec=A;var T=this._mediaInfo;T.width=n.codecWidth,T.height=n.codecHeight,T.fps=n.frameRate.fps,T.profile=n.profile,T.level=n.level,T.refFrames=v.ref_frames,T.chromaFormat=v.chroma_format_string,T.sarNum=n.sarRatio.width,T.sarDen=n.sarRatio.height,T.videoCodec=A,T.hasAudio?null!=T.audioCodec&&(T.mimeType='video/x-flv; codecs="'+T.videoCodec+","+T.audioCodec+'"'):T.mimeType='video/x-flv; codecs="'+T.videoCodec+'"',T.isComplete()&&this._onMediaInfo(T)}}}var R=s.getUint8(h);if(0!==R){for(R>1&&r.a.w(this.TAG,"Flv: Strange AVCDecoderConfigurationRecord: PPS Count = "+R),h++,p=0;p<R;p++)f=s.getUint16(h,!o),h+=2,0!==f&&(h+=f);n.avcc=new Uint8Array(a),n.avcc.set(new Uint8Array(e,t,a),0),r.a.v(this.TAG,"Parsed AVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",n)}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No PPS")}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord: No SPS")}else this._onError(m.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AVCDecoderConfigurationRecord")}},e.prototype._parseHEVCDecoderConfigurationRecord=function(e,t,a){if(a<22)r.a.w(this.TAG,"Flv: Invalid HEVCDecoderConfigurationRecord, lack of data!");else{var n=this._videoMetadata,i=this._videoTrack,o=this._littleEndian,s=new DataView(e,t,a);if(n){if(void 0!==n.hvcc){var l=new Uint8Array(e,t,a);if(S(l,n.hvcc))return;r.a.w(this.TAG,"HEVCDecoderConfigurationRecord has been changed, re-generate initialization segment")}}else!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(n=this._videoMetadata={}).type="video",n.id=i.id,n.timescale=this._timescale,n.duration=this._duration;var d=s.getUint8(0),c=31&s.getUint8(1);if(1===d&&0!==c)if(this._naluLengthSize=1+(3&s.getUint8(21)),3===this._naluLengthSize||4===this._naluLengthSize){for(var u=s.getUint8(22),h=0,p=23;h<u;h++){var f=63&s.getUint8(p+0),_=s.getUint16(p+1,!o);p+=3;for(var v=0;v<_;v++){var y=s.getUint16(p+0,!o);if(0===v)if(33===f){p+=2;var b=new Uint8Array(e,t+p,y),E=g.parseSPS(b);n.codecWidth=E.codec_size.width,n.codecHeight=E.codec_size.height,n.presentWidth=E.present_size.width,n.presentHeight=E.present_size.height,n.profile=E.profile_string,n.level=E.level_string,n.bitDepth=E.bit_depth,n.chromaFormat=E.chroma_format,n.sarRatio=E.sar_ratio,n.frameRate=E.frame_rate,!1!==E.frame_rate.fixed&&0!==E.frame_rate.fps_num&&0!==E.frame_rate.fps_den||(n.frameRate=this._referenceFrameRate);var A=n.frameRate.fps_den,w=n.frameRate.fps_num;n.refSampleDuration=n.timescale*(A/w),n.codec=E.codec_mimetype;var C=this._mediaInfo;C.width=n.codecWidth,C.height=n.codecHeight,C.fps=n.frameRate.fps,C.profile=n.profile,C.level=n.level,C.refFrames=E.ref_frames,C.chromaFormat=E.chroma_format_string,C.sarNum=n.sarRatio.width,C.sarDen=n.sarRatio.height,C.videoCodec=E.codec_mimetype,C.hasAudio?null!=C.audioCodec&&(C.mimeType='video/x-flv; codecs="'+C.videoCodec+","+C.audioCodec+'"'):C.mimeType='video/x-flv; codecs="'+C.videoCodec+'"',C.isComplete()&&this._onMediaInfo(C),p+=y}else p+=2+y;else p+=2+y}}n.hvcc=new Uint8Array(a),n.hvcc.set(new Uint8Array(e,t,a),0),r.a.v(this.TAG,"Parsed HEVCDecoderConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",n)}else this._onError(m.a.FORMAT_ERROR,"Flv: Strange NaluLengthSizeMinusOne: "+(this._naluLengthSize-1));else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid HEVCDecoderConfigurationRecord")}},e.prototype._parseAV1CodecConfigurationRecord=function(e,t,a){if(a<4)r.a.w(this.TAG,"Flv: Invalid AV1CodecConfigurationRecord, lack of data!");else{var n=this._videoMetadata,i=this._videoTrack,o=(this._littleEndian,new DataView(e,t,a));n?void 0!==n.av1c&&r.a.w(this.TAG,"Found another AV1CodecConfigurationRecord!"):(!1===this._hasVideo&&!1===this._hasVideoFlagOverrided&&(this._hasVideo=!0,this._mediaInfo.hasVideo=!0),(n=this._videoMetadata={}).type="video",n.id=i.id,n.timescale=this._timescale,n.duration=this._duration);var s=127&o.getUint8(0);if(o.getUint8(1),o.getUint8(1),o.getUint8(2),1===s){var l=A.parseOBUs(new Uint8Array(e,t+4,a-4));if(null!=l){n.codecWidth=l.codec_size.width,n.codecHeight=l.codec_size.height,n.presentWidth=l.present_size.width,n.presentHeight=l.present_size.height,n.profile=l.profile_string,n.level=l.level_string,n.bitDepth=l.bit_depth,n.chromaFormat=l.chroma_format,n.sarRatio=l.sar_ratio,n.frameRate=l.frame_rate,!1!==l.frame_rate.fixed&&0!==l.frame_rate.fps_num&&0!==l.frame_rate.fps_den||(n.frameRate=this._referenceFrameRate);var d=n.frameRate.fps_den,c=n.frameRate.fps_num;n.refSampleDuration=n.timescale*(d/c),n.codec=l.codec_mimetype;var u=this._mediaInfo;u.width=n.codecWidth,u.height=n.codecHeight,u.fps=n.frameRate.fps,u.profile=n.profile,u.level=n.level,u.refFrames=l.ref_frames,u.chromaFormat=l.chroma_format_string,u.sarNum=n.sarRatio.width,u.sarDen=n.sarRatio.height,u.videoCodec=l.codec_mimetype,u.hasAudio?null!=u.audioCodec&&(u.mimeType='video/x-flv; codecs="'+u.videoCodec+","+u.audioCodec+'"'):u.mimeType='video/x-flv; codecs="'+u.videoCodec+'"',u.isComplete()&&this._onMediaInfo(u),n.av1c=new Uint8Array(a),n.av1c.set(new Uint8Array(e,t,a),0),r.a.v(this.TAG,"Parsed AV1CodecConfigurationRecord"),this._isInitialMetadataDispatched()?this._dispatch&&(this._audioTrack.length||this._videoTrack.length)&&this._onDataAvailable(this._audioTrack,this._videoTrack):this._videoInitialMetadataDispatched=!0,this._dispatch=!1,this._onTrackMetadata("video",n)}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}else this._onError(m.a.FORMAT_ERROR,"Flv: Invalid AV1CodecConfigurationRecord")}},e.prototype._parseAVCVideoData=function(e,t,a,n,i,o,s){for(var l=this._littleEndian,d=new DataView(e,t,a),c=[],u=0,h=0,p=this._naluLengthSize,f=this._timestampBase+n,_=1===o;h<a;){if(h+4>=a){r.a.w(this.TAG,"Malformed Nalu near timestamp "+f+", offset = "+h+", dataSize = "+a);break}var m=d.getUint32(h,!l);if(3===p&&(m>>>=8),m>a-p)return void r.a.w(this.TAG,"Malformed Nalus near timestamp "+f+", NaluSize > DataSize!");var g=31&d.getUint8(h+p);5===g&&(_=!0);var v=new Uint8Array(e,t+h,p+m),y={type:g,data:v};c.push(y),u+=v.byteLength,h+=p+m}if(c.length){var b=this._videoTrack,E={units:c,length:u,isKeyframe:_,dts:f,cts:s,pts:f+s};_&&(E.fileposition=i),b.samples.push(E),b.length+=u}},e.prototype._parseHEVCVideoData=function(e,t,a,n,i,o,s){for(var l=this._littleEndian,d=new DataView(e,t,a),c=[],u=0,h=0,p=this._naluLengthSize,f=this._timestampBase+n,_=1===o;h<a;){if(h+4>=a){r.a.w(this.TAG,"Malformed Nalu near timestamp "+f+", offset = "+h+", dataSize = "+a);break}var m=d.getUint32(h,!l);if(3===p&&(m>>>=8),m>a-p)return void r.a.w(this.TAG,"Malformed Nalus near timestamp "+f+", NaluSize > DataSize!");var g=31&d.getUint8(h+p);19!==g&&20!==g||(_=!0);var v=new Uint8Array(e,t+h,p+m),y={type:g,data:v};c.push(y),u+=v.byteLength,h+=p+m}if(c.length){var b=this._videoTrack,E={units:c,length:u,isKeyframe:_,dts:f,cts:s,pts:f+s};_&&(E.fileposition=i),b.samples.push(E),b.length+=u}},e.prototype._parseAV1VideoData=function(e,t,a,n,i,r,o){this._littleEndian;var s,l=[],d=this._timestampBase+n,c=1===r;if(s=a,l.push({unitType:0,data:new Uint8Array(e,t+0,a)}),l.length){var u=this._videoTrack,h={units:l,length:s,isKeyframe:c,dts:d,cts:o,pts:d+o};c&&(h.fileposition=i),u.samples.push(h),u.length+=s}},e}(),C=function(){function e(){}return e.prototype.destroy=function(){this.onError=null,this.onMediaInfo=null,this.onMetaDataArrived=null,this.onTrackMetadata=null,this.onDataAvailable=null,this.onTimedID3Metadata=null,this.onSynchronousKLVMetadata=null,this.onAsynchronousKLVMetadata=null,this.onSMPTE2038Metadata=null,this.onSCTE35Metadata=null,this.onPESPrivateData=null,this.onPESPrivateDataDescriptor=null},e}(),T=function(){this.program_pmt_pid={}};!function(e){e[e.kMPEG1Audio=3]="kMPEG1Audio",e[e.kMPEG2Audio=4]="kMPEG2Audio",e[e.kPESPrivateData=6]="kPESPrivateData",e[e.kADTSAAC=15]="kADTSAAC",e[e.kLOASAAC=17]="kLOASAAC",e[e.kAC3=129]="kAC3",e[e.kEAC3=135]="kEAC3",e[e.kMetadata=21]="kMetadata",e[e.kSCTE35=134]="kSCTE35",e[e.kH264=27]="kH264",e[e.kH265=36]="kH265"}(E||(E={}));var R,D=function(){this.pid_stream_type={},this.common_pids={h264:void 0,h265:void 0,adts_aac:void 0,loas_aac:void 0,opus:void 0,ac3:void 0,eac3:void 0,mp3:void 0},this.pes_private_data_pids={},this.timed_id3_pids={},this.synchronous_klv_pids={},this.asynchronous_klv_pids={},this.scte_35_pids={},this.smpte2038_pids={}},k=function(){},x=function(){},L=function(){this.slices=[],this.total_length=0,this.expected_length=0,this.file_position=0};!function(e){e[e.kUnspecified=0]="kUnspecified",e[e.kSliceNonIDR=1]="kSliceNonIDR",e[e.kSliceDPA=2]="kSliceDPA",e[e.kSliceDPB=3]="kSliceDPB",e[e.kSliceDPC=4]="kSliceDPC",e[e.kSliceIDR=5]="kSliceIDR",e[e.kSliceSEI=6]="kSliceSEI",e[e.kSliceSPS=7]="kSliceSPS",e[e.kSlicePPS=8]="kSlicePPS",e[e.kSliceAUD=9]="kSliceAUD",e[e.kEndOfSequence=10]="kEndOfSequence",e[e.kEndOfStream=11]="kEndOfStream",e[e.kFiller=12]="kFiller",e[e.kSPSExt=13]="kSPSExt",e[e.kReserved0=14]="kReserved0"}(R||(R={}));var N,B,V=function(){},M=function(e){var t=e.data.byteLength;this.type=e.type,this.data=new Uint8Array(4+t),new DataView(this.data.buffer).setUint32(0,t),this.data.set(e.data,4)},O=function(){function e(e){this.TAG="H264AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=e,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not find H264 startcode until payload end!")}return e.prototype.findNextStartCodeOffset=function(e){for(var t=e,a=this.data_;;){if(t+3>=a.byteLength)return this.eof_flag_=!0,a.byteLength;var n=a[t+0]<<24|a[t+1]<<16|a[t+2]<<8|a[t+3],i=a[t+0]<<16|a[t+1]<<8|a[t+2];if(1===n||1===i)return t;t++}},e.prototype.readNextNaluPayload=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var a=this.current_startcode_offset_,n=31&e[a+=1==(e[a]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3])?4:3],i=(128&e[a])>>>7,r=this.findNextStartCodeOffset(a);if(this.current_startcode_offset_=r,!(n>=R.kReserved0)&&0===i){var o=e.subarray(a,r);(t=new V).type=n,t.data=o}}return t},e}(),I=function(){function e(e,t,a){var n=8+e.byteLength+1+2+t.byteLength,i=!1;66!==e[3]&&77!==e[3]&&88!==e[3]&&(i=!0,n+=4);var r=this.data=new Uint8Array(n);r[0]=1,r[1]=e[1],r[2]=e[2],r[3]=e[3],r[4]=255,r[5]=225;var o=e.byteLength;r[6]=o>>>8,r[7]=255&o;var s=8;r.set(e,8),r[s+=o]=1;var l=t.byteLength;r[s+1]=l>>>8,r[s+2]=255&l,r.set(t,s+3),s+=3+l,i&&(r[s]=252|a.chroma_format_idc,r[s+1]=248|a.bit_depth_luma-8,r[s+2]=248|a.bit_depth_chroma-8,r[s+3]=0,s+=4)}return e.prototype.getData=function(){return this.data},e}();!function(e){e[e.kNull=0]="kNull",e[e.kAACMain=1]="kAACMain",e[e.kAAC_LC=2]="kAAC_LC",e[e.kAAC_SSR=3]="kAAC_SSR",e[e.kAAC_LTP=4]="kAAC_LTP",e[e.kAAC_SBR=5]="kAAC_SBR",e[e.kAAC_Scalable=6]="kAAC_Scalable",e[e.kLayer1=32]="kLayer1",e[e.kLayer2=33]="kLayer2",e[e.kLayer3=34]="kLayer3"}(N||(N={})),function(e){e[e.k96000Hz=0]="k96000Hz",e[e.k88200Hz=1]="k88200Hz",e[e.k64000Hz=2]="k64000Hz",e[e.k48000Hz=3]="k48000Hz",e[e.k44100Hz=4]="k44100Hz",e[e.k32000Hz=5]="k32000Hz",e[e.k24000Hz=6]="k24000Hz",e[e.k22050Hz=7]="k22050Hz",e[e.k16000Hz=8]="k16000Hz",e[e.k12000Hz=9]="k12000Hz",e[e.k11025Hz=10]="k11025Hz",e[e.k8000Hz=11]="k8000Hz",e[e.k7350Hz=12]="k7350Hz"}(B||(B={}));var P,U,j=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],F=(P=function(e,t){return(P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}P(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),z=function(){},G=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return F(t,e),t}(z),H=function(){function e(e){this.TAG="AACADTSParser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not found ADTS syncword until payload end")}return e.prototype.findNextSyncwordOffset=function(e){for(var t=e,a=this.data_;;){if(t+7>=a.byteLength)return this.eof_flag_=!0,a.byteLength;if(4095==(a[t+0]<<8|a[t+1])>>>4)return t;t++}},e.prototype.readNextAACFrame=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var a=this.current_syncword_offset_,n=(8&e[a+1])>>>3,i=(6&e[a+1])>>>1,r=1&e[a+1],o=(192&e[a+2])>>>6,s=(60&e[a+2])>>>2,l=(1&e[a+2])<<2|(192&e[a+3])>>>6,d=(3&e[a+3])<<11|e[a+4]<<3|(224&e[a+5])>>>5;if(e[a+6],a+d>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var c=1===r?7:9,u=d-c;a+=c;var h=this.findNextSyncwordOffset(a+u);if(this.current_syncword_offset_=h,(0===n||1===n)&&0===i){var p=e.subarray(a,a+u);(t=new z).audio_object_type=o+1,t.sampling_freq_index=s,t.sampling_frequency=j[s],t.channel_config=l,t.data=p}}return t},e.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},e.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},e}(),q=function(){function e(e){this.TAG="AACLOASParser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not found LOAS syncword until payload end")}return e.prototype.findNextSyncwordOffset=function(e){for(var t=e,a=this.data_;;){if(t+1>=a.byteLength)return this.eof_flag_=!0,a.byteLength;if(695==(a[t+0]<<3|a[t+1]>>>5))return t;t++}},e.prototype.getLATMValue=function(e){for(var t=e.readBits(2),a=0,n=0;n<=t;n++)a<<=8,a|=e.readByte();return a},e.prototype.readNextAACFrame=function(e){for(var t=this.data_,a=null;null==a&&!this.eof_flag_;){var n=this.current_syncword_offset_,i=(31&t[n+1])<<8|t[n+2];if(n+3+i>=this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var o=new f(t.subarray(n+3,n+3+i)),s=null;if(o.readBool()){if(null==e){r.a.w(this.TAG,"StreamMuxConfig Missing"),this.current_syncword_offset_=this.findNextSyncwordOffset(n+3+i),o.destroy();continue}s=e}else{var l=o.readBool();if(l&&o.readBool()){r.a.e(this.TAG,"audioMuxVersionA is Not Supported"),o.destroy();break}if(l&&this.getLATMValue(o),!o.readBool()){r.a.e(this.TAG,"allStreamsSameTimeFraming zero is Not Supported"),o.destroy();break}if(0!==o.readBits(6)){r.a.e(this.TAG,"more than 2 numSubFrames Not Supported"),o.destroy();break}if(0!==o.readBits(4)){r.a.e(this.TAG,"more than 2 numProgram Not Supported"),o.destroy();break}if(0!==o.readBits(3)){r.a.e(this.TAG,"more than 2 numLayer Not Supported"),o.destroy();break}var d=l?this.getLATMValue(o):0,c=o.readBits(5);d-=5;var u=o.readBits(4);d-=4;var h=o.readBits(4);d-=4,o.readBits(3),(d-=3)>0&&o.readBits(d);var p=o.readBits(3);if(0!==p){r.a.e(this.TAG,"frameLengthType = "+p+". Only frameLengthType = 0 Supported"),o.destroy();break}o.readByte();var _=o.readBool();if(_)if(l)this.getLATMValue(o);else for(;;){var m=o.readBool();if(o.readByte(),!m)break}o.readBool()&&o.readByte(),(s=new G).audio_object_type=c,s.sampling_freq_index=u,s.sampling_frequency=j[s.sampling_freq_index],s.channel_config=h,s.other_data_present=_}for(var g=0;;){var v=o.readByte();if(g+=v,255!==v)break}for(var y=new Uint8Array(g),b=0;b<g;b++)y[b]=o.readByte();(a=new G).audio_object_type=s.audio_object_type,a.sampling_freq_index=s.sampling_freq_index,a.sampling_frequency=j[s.sampling_freq_index],a.channel_config=s.channel_config,a.other_data_present=s.other_data_present,a.data=y,this.current_syncword_offset_=this.findNextSyncwordOffset(n+3+i)}return a},e.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},e.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},e}(),W=function(e){var t=null,a=e.audio_object_type,n=e.audio_object_type,i=e.sampling_freq_index,r=e.channel_config,o=0,s=navigator.userAgent.toLowerCase();-1!==s.indexOf("firefox")?i>=6?(n=5,t=new Array(4),o=i-3):(n=2,t=new Array(2),o=i):-1!==s.indexOf("android")?(n=2,t=new Array(2),o=i):(n=5,o=i,t=new Array(4),i>=6?o=i-3:1===r&&(n=2,t=new Array(2),o=i)),t[0]=n<<3,t[0]|=(15&i)>>>1,t[1]=(15&i)<<7,t[1]|=(15&r)<<3,5===n&&(t[1]|=(15&o)>>>1,t[2]=(1&o)<<7,t[2]|=8,t[3]=0),this.config=t,this.sampling_rate=j[i],this.channel_count=r,this.codec_mimetype="mp4a.40."+n,this.original_codec_mimetype="mp4a.40."+a},K=function(){},Y=function(){};!function(e){e[e.kSpliceNull=0]="kSpliceNull",e[e.kSpliceSchedule=4]="kSpliceSchedule",e[e.kSpliceInsert=5]="kSpliceInsert",e[e.kTimeSignal=6]="kTimeSignal",e[e.kBandwidthReservation=7]="kBandwidthReservation",e[e.kPrivateCommand=255]="kPrivateCommand"}(U||(U={}));var $,X=function(e){var t=e.readBool();return t?(e.readBits(6),{time_specified_flag:t,pts_time:4*e.readBits(31)+e.readBits(2)}):(e.readBits(7),{time_specified_flag:t})},Z=function(e){var t=e.readBool();return e.readBits(6),{auto_return:t,duration:4*e.readBits(31)+e.readBits(2)}},J=function(e,t){var a=t.readBits(8);return e?{component_tag:a}:{component_tag:a,splice_time:X(t)}},Q=function(e){return{component_tag:e.readBits(8),utc_splice_time:e.readBits(32)}},ee=function(e){var t=e.readBits(32),a=e.readBool();e.readBits(7);var n={splice_event_id:t,splice_event_cancel_indicator:a};if(a)return n;if(n.out_of_network_indicator=e.readBool(),n.program_splice_flag=e.readBool(),n.duration_flag=e.readBool(),e.readBits(5),n.program_splice_flag)n.utc_splice_time=e.readBits(32);else{n.component_count=e.readBits(8),n.components=[];for(var i=0;i<n.component_count;i++)n.components.push(Q(e))}return n.duration_flag&&(n.break_duration=Z(e)),n.unique_program_id=e.readBits(16),n.avail_num=e.readBits(8),n.avails_expected=e.readBits(8),n},te=function(e,t,a,n){return{descriptor_tag:e,descriptor_length:t,identifier:a,provider_avail_id:n.readBits(32)}},ae=function(e,t,a,n){var i=n.readBits(8),r=n.readBits(3);n.readBits(5);for(var o="",s=0;s<r;s++)o+=String.fromCharCode(n.readBits(8));return{descriptor_tag:e,descriptor_length:t,identifier:a,preroll:i,dtmf_count:r,DTMF_char:o}},ne=function(e){var t=e.readBits(8);return e.readBits(7),{component_tag:t,pts_offset:4*e.readBits(31)+e.readBits(2)}},ie=function(e,t,a,n){var i=n.readBits(32),r=n.readBool();n.readBits(7);var o={descriptor_tag:e,descriptor_length:t,identifier:a,segmentation_event_id:i,segmentation_event_cancel_indicator:r};if(r)return o;if(o.program_segmentation_flag=n.readBool(),o.segmentation_duration_flag=n.readBool(),o.delivery_not_restricted_flag=n.readBool(),o.delivery_not_restricted_flag?n.readBits(5):(o.web_delivery_allowed_flag=n.readBool(),o.no_regional_blackout_flag=n.readBool(),o.archive_allowed_flag=n.readBool(),o.device_restrictions=n.readBits(2)),!o.program_segmentation_flag){o.component_count=n.readBits(8),o.components=[];for(var s=0;s<o.component_count;s++)o.components.push(ne(n))}o.segmentation_duration_flag&&(o.segmentation_duration=n.readBits(40)),o.segmentation_upid_type=n.readBits(8),o.segmentation_upid_length=n.readBits(8);var l=new Uint8Array(o.segmentation_upid_length);for(s=0;s<o.segmentation_upid_length;s++)l[s]=n.readBits(8);return o.segmentation_upid=l.buffer,o.segmentation_type_id=n.readBits(8),o.segment_num=n.readBits(8),o.segments_expected=n.readBits(8),52!==o.segmentation_type_id&&54!==o.segmentation_type_id&&56!==o.segmentation_type_id&&58!==o.segmentation_type_id||(o.sub_segment_num=n.readBits(8),o.sub_segments_expected=n.readBits(8)),o},re=function(e,t,a,n){return{descriptor_tag:e,descriptor_length:t,identifier:a,TAI_seconds:n.readBits(48),TAI_ns:n.readBits(32),UTC_offset:n.readBits(16)}},oe=function(e){return{component_tag:e.readBits(8),ISO_code:String.fromCharCode(e.readBits(8),e.readBits(8),e.readBits(8)),Bit_Stream_Mode:e.readBits(3),Num_Channels:e.readBits(4),Full_Srvc_Audio:e.readBool()}},se=function(e,t,a,n){for(var i=n.readBits(4),r=[],o=0;o<i;o++)r.push(oe(n));return{descriptor_tag:e,descriptor_length:t,identifier:a,audio_count:i,components:r}},le=function(e){var t=new f(e),a=t.readBits(8),n=t.readBool(),i=t.readBool();t.readBits(2);var r=t.readBits(12),o=t.readBits(8),s=t.readBool(),l=t.readBits(6),d=4*t.readBits(31)+t.readBits(2),c=t.readBits(8),u=t.readBits(12),h=t.readBits(12),p=t.readBits(8),_=null;p===U.kSpliceNull?_={}:p===U.kSpliceSchedule?_=function(e){for(var t=e.readBits(8),a=[],n=0;n<t;n++)a.push(ee(e));return{splice_count:t,events:a}}(t):p===U.kSpliceInsert?_=function(e){var t=e.readBits(32),a=e.readBool();e.readBits(7);var n={splice_event_id:t,splice_event_cancel_indicator:a};if(a)return n;if(n.out_of_network_indicator=e.readBool(),n.program_splice_flag=e.readBool(),n.duration_flag=e.readBool(),n.splice_immediate_flag=e.readBool(),e.readBits(4),n.program_splice_flag&&!n.splice_immediate_flag&&(n.splice_time=X(e)),!n.program_splice_flag){n.component_count=e.readBits(8),n.components=[];for(var i=0;i<n.component_count;i++)n.components.push(J(n.splice_immediate_flag,e))}return n.duration_flag&&(n.break_duration=Z(e)),n.unique_program_id=e.readBits(16),n.avail_num=e.readBits(8),n.avails_expected=e.readBits(8),n}(t):p===U.kTimeSignal?_=function(e){return{splice_time:X(e)}}(t):p===U.kBandwidthReservation?_={}:p===U.kPrivateCommand?_=function(e,t){for(var a=String.fromCharCode(t.readBits(8),t.readBits(8),t.readBits(8),t.readBits(8)),n=new Uint8Array(e-4),i=0;i<e-4;i++)n[i]=t.readBits(8);return{identifier:a,private_data:n.buffer}}(h,t):t.readBits(8*h);for(var m=[],g=t.readBits(16),v=0;v<g;){var y=t.readBits(8),b=t.readBits(8),E=String.fromCharCode(t.readBits(8),t.readBits(8),t.readBits(8),t.readBits(8));0===y?m.push(te(y,b,E,t)):1===y?m.push(ae(y,b,E,t)):2===y?m.push(ie(y,b,E,t)):3===y?m.push(re(y,b,E,t)):4===y?m.push(se(y,b,E,t)):t.readBits(8*(b-4)),v+=2+b}var S={table_id:a,section_syntax_indicator:n,private_indicator:i,section_length:r,protocol_version:o,encrypted_packet:s,encryption_algorithm:l,pts_adjustment:d,cw_index:c,tier:u,splice_command_length:h,splice_command_type:p,splice_command:_,descriptor_loop_length:g,splice_descriptors:m,E_CRC32:s?t.readBits(32):void 0,CRC32:t.readBits(32)};if(p===U.kSpliceInsert){var A=_;if(A.splice_event_cancel_indicator)return{splice_command_type:p,detail:S,data:e};if(A.program_splice_flag&&!A.splice_immediate_flag){var w=A.duration_flag?A.break_duration.auto_return:void 0,C=A.duration_flag?A.break_duration.duration/90:void 0;return A.splice_time.time_specified_flag?{splice_command_type:p,pts:(d+A.splice_time.pts_time)%Math.pow(2,33),auto_return:w,duraiton:C,detail:S,data:e}:{splice_command_type:p,auto_return:w,duraiton:C,detail:S,data:e}}return{splice_command_type:p,auto_return:w=A.duration_flag?A.break_duration.auto_return:void 0,duraiton:C=A.duration_flag?A.break_duration.duration/90:void 0,detail:S,data:e}}if(p===U.kTimeSignal){var T=_;return T.splice_time.time_specified_flag?{splice_command_type:p,pts:(d+T.splice_time.pts_time)%Math.pow(2,33),detail:S,data:e}:{splice_command_type:p,detail:S,data:e}}return{splice_command_type:p,detail:S,data:e}};!function(e){e[e.kSliceIDR_W_RADL=19]="kSliceIDR_W_RADL",e[e.kSliceIDR_N_LP=20]="kSliceIDR_N_LP",e[e.kSliceCRA_NUT=21]="kSliceCRA_NUT",e[e.kSliceVPS=32]="kSliceVPS",e[e.kSliceSPS=33]="kSliceSPS",e[e.kSlicePPS=34]="kSlicePPS",e[e.kSliceAUD=35]="kSliceAUD"}($||($={}));var de=function(){},ce=function(e){var t=e.data.byteLength;this.type=e.type,this.data=new Uint8Array(4+t),new DataView(this.data.buffer).setUint32(0,t),this.data.set(e.data,4)},ue=function(){function e(e){this.TAG="H265AnnexBParser",this.current_startcode_offset_=0,this.eof_flag_=!1,this.data_=e,this.current_startcode_offset_=this.findNextStartCodeOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not find H265 startcode until payload end!")}return e.prototype.findNextStartCodeOffset=function(e){for(var t=e,a=this.data_;;){if(t+3>=a.byteLength)return this.eof_flag_=!0,a.byteLength;var n=a[t+0]<<24|a[t+1]<<16|a[t+2]<<8|a[t+3],i=a[t+0]<<16|a[t+1]<<8|a[t+2];if(1===n||1===i)return t;t++}},e.prototype.readNextNaluPayload=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var a=this.current_startcode_offset_,n=e[a+=1==(e[a]<<24|e[a+1]<<16|e[a+2]<<8|e[a+3])?4:3]>>1&63,i=(128&e[a])>>>7,r=this.findNextStartCodeOffset(a);if(this.current_startcode_offset_=r,0===i){var o=e.subarray(a,r);(t=new de).type=n,t.data=o}}return t},e}(),he=function(){function e(e,t,a,n){var i=23+(5+e.byteLength)+(5+t.byteLength)+(5+a.byteLength),r=this.data=new Uint8Array(i);r[0]=1,r[1]=(3&n.general_profile_space)<<6|(n.general_tier_flag?1:0)<<5|31&n.general_profile_idc,r[2]=n.general_profile_compatibility_flags_1,r[3]=n.general_profile_compatibility_flags_2,r[4]=n.general_profile_compatibility_flags_3,r[5]=n.general_profile_compatibility_flags_4,r[6]=n.general_constraint_indicator_flags_1,r[7]=n.general_constraint_indicator_flags_2,r[8]=n.general_constraint_indicator_flags_3,r[9]=n.general_constraint_indicator_flags_4,r[10]=n.general_constraint_indicator_flags_5,r[11]=n.general_constraint_indicator_flags_6,r[12]=n.general_level_idc,r[13]=240|(3840&n.min_spatial_segmentation_idc)>>8,r[14]=255&n.min_spatial_segmentation_idc,r[15]=252|3&n.parallelismType,r[16]=252|3&n.chroma_format_idc,r[17]=248|7&n.bit_depth_luma_minus8,r[18]=248|7&n.bit_depth_chroma_minus8,r[19]=0,r[20]=0,r[21]=(3&n.constant_frame_rate)<<6|(7&n.num_temporal_layers)<<3|(n.temporal_id_nested?1:0)<<2|3,r[22]=3,r[23]=128|$.kSliceVPS,r[24]=0,r[25]=1,r[26]=(65280&e.byteLength)>>8,r[27]=(255&e.byteLength)>>0,r.set(e,28),r[23+(5+e.byteLength)+0]=128|$.kSliceSPS,r[23+(5+e.byteLength)+1]=0,r[23+(5+e.byteLength)+2]=1,r[23+(5+e.byteLength)+3]=(65280&t.byteLength)>>8,r[23+(5+e.byteLength)+4]=(255&t.byteLength)>>0,r.set(t,23+(5+e.byteLength)+5),r[23+(5+e.byteLength+5+t.byteLength)+0]=128|$.kSlicePPS,r[23+(5+e.byteLength+5+t.byteLength)+1]=0,r[23+(5+e.byteLength+5+t.byteLength)+2]=1,r[23+(5+e.byteLength+5+t.byteLength)+3]=(65280&a.byteLength)>>8,r[23+(5+e.byteLength+5+t.byteLength)+4]=(255&a.byteLength)>>0,r.set(a,23+(5+e.byteLength+5+t.byteLength)+5)}return e.prototype.getData=function(){return this.data},e}(),pe=function(){},fe=function(){},_e=function(){},me=[[64,64,80,80,96,96,112,112,128,128,160,160,192,192,224,224,256,256,320,320,384,384,448,448,512,512,640,640,768,768,896,896,1024,1024,1152,1152,1280,1280],[69,70,87,88,104,105,121,122,139,140,174,175,208,209,243,244,278,279,348,349,417,418,487,488,557,558,696,697,835,836,975,976,1114,1115,1253,1254,1393,1394],[96,96,120,120,144,144,168,168,192,192,240,240,288,288,336,336,384,384,480,480,576,576,672,672,768,768,960,960,1152,1152,1344,1344,1536,1536,1728,1728,1920,1920]],ge=function(){function e(e){this.TAG="AC3Parser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return e.prototype.findNextSyncwordOffset=function(e){for(var t=e,a=this.data_;;){if(t+7>=a.byteLength)return this.eof_flag_=!0,a.byteLength;if(2935==(a[t+0]<<8|a[t+1]<<0))return t;t++}},e.prototype.readNextAC3Frame=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var a=this.current_syncword_offset_,n=e[a+4]>>6,i=[48e3,44200,33e3][n],r=63&e[a+4],o=2*me[n][r];if(a+o>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var s=this.findNextSyncwordOffset(a+o);this.current_syncword_offset_=s;var l=e[a+5]>>3,d=7&e[a+5],c=e[a+6]>>5,u=0;0!=(1&c)&&1!==c&&(u+=2),0!=(4&c)&&(u+=2),2===c&&(u+=2);var h=(e[a+6]<<8|e[a+7]<<0)>>12-u&1,p=[2,1,2,3,3,4,4,5][c]+h;(t=new _e).sampling_frequency=i,t.channel_count=p,t.channel_mode=c,t.bit_stream_identification=l,t.low_frequency_effects_channel_on=h,t.bit_stream_mode=d,t.frame_size_code=r,t.data=e.subarray(a,a+o)}return t},e.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},e.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},e}(),ve=function(e){var t;t=[e.sampling_rate_code<<6|e.bit_stream_identification<<1|e.bit_stream_mode>>2,(3&e.bit_stream_mode)<<6|e.channel_mode<<3|e.low_frequency_effects_channel_on<<2|e.frame_size_code>>4,e.frame_size_code<<4&224],this.config=t,this.sampling_rate=e.sampling_frequency,this.bit_stream_identification=e.bit_stream_identification,this.bit_stream_mode=e.bit_stream_mode,this.low_frequency_effects_channel_on=e.low_frequency_effects_channel_on,this.channel_count=e.channel_count,this.channel_mode=e.channel_mode,this.codec_mimetype="ac-3",this.original_codec_mimetype="ac-3"},ye=function(){},be=function(){function e(e){this.TAG="EAC3Parser",this.data_=e,this.current_syncword_offset_=this.findNextSyncwordOffset(0),this.eof_flag_&&r.a.e(this.TAG,"Could not found AC3 syncword until payload end")}return e.prototype.findNextSyncwordOffset=function(e){for(var t=e,a=this.data_;;){if(t+7>=a.byteLength)return this.eof_flag_=!0,a.byteLength;if(2935==(a[t+0]<<8|a[t+1]<<0))return t;t++}},e.prototype.readNextEAC3Frame=function(){for(var e=this.data_,t=null;null==t&&!this.eof_flag_;){var a=this.current_syncword_offset_,n=new f(e.subarray(a+2)),i=(n.readBits(2),n.readBits(3),n.readBits(11)+1<<1),r=n.readBits(2),o=null,s=null;3===r?(o=[24e3,22060,16e3][r=n.readBits(2)],s=3):(o=[48e3,44100,32e3][r],s=n.readBits(2));var l=n.readBits(3),d=n.readBits(1),c=n.readBits(5);if(a+i>this.data_.byteLength){this.eof_flag_=!0,this.has_last_incomplete_data=!0;break}var u=this.findNextSyncwordOffset(a+i);this.current_syncword_offset_=u;var h=[2,1,2,3,3,4,4,5][l]+d;n.destroy(),(t=new ye).sampling_frequency=o,t.channel_count=h,t.channel_mode=l,t.bit_stream_identification=c,t.low_frequency_effects_channel_on=d,t.frame_size=i,t.num_blks=[1,2,3,6][s],t.data=e.subarray(a,a+i)}return t},e.prototype.hasIncompleteData=function(){return this.has_last_incomplete_data},e.prototype.getIncompleteData=function(){return this.has_last_incomplete_data?this.data_.subarray(this.current_syncword_offset_):null},e}(),Ee=function(e){var t,a=Math.floor(e.frame_size*e.sampling_frequency/(16*e.num_blks));t=[255&a,248&a,e.sampling_rate_code<<6|e.bit_stream_identification<<1|0,0|e.channel_mode<<1|e.low_frequency_effects_channel_on<<0,0],this.config=t,this.sampling_rate=e.sampling_frequency,this.bit_stream_identification=e.bit_stream_identification,this.num_blks=e.num_blks,this.low_frequency_effects_channel_on=e.low_frequency_effects_channel_on,this.channel_count=e.channel_count,this.channel_mode=e.channel_mode,this.codec_mimetype="ec-3",this.original_codec_mimetype="ec-3"},Se=function(){},Ae=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),we=function(){return(we=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var i in t=arguments[a])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},Ce=function(e){function t(t,a){var n=e.call(this)||this;return n.TAG="TSDemuxer",n.first_parse_=!0,n.media_info_=new s.a,n.timescale_=90,n.duration_=0,n.current_pmt_pid_=-1,n.program_pmt_map_={},n.pes_slice_queues_={},n.section_slice_queues_={},n.video_metadata_={vps:void 0,sps:void 0,pps:void 0,details:void 0},n.audio_metadata_={codec:void 0,audio_object_type:void 0,sampling_freq_index:void 0,sampling_frequency:void 0,channel_config:void 0},n.aac_last_sample_pts_=void 0,n.aac_last_incomplete_data_=null,n.has_video_=!1,n.has_audio_=!1,n.video_init_segment_dispatched_=!1,n.audio_init_segment_dispatched_=!1,n.video_metadata_changed_=!1,n.audio_metadata_changed_=!1,n.loas_previous_frame=null,n.video_track_={type:"video",id:1,sequenceNumber:0,samples:[],length:0},n.audio_track_={type:"audio",id:2,sequenceNumber:0,samples:[],length:0},n.ts_packet_size_=t.ts_packet_size,n.sync_offset_=t.sync_offset,n.config_=a,n}return Ae(t,e),t.prototype.destroy=function(){this.media_info_=null,this.pes_slice_queues_=null,this.section_slice_queues_=null,this.video_metadata_=null,this.audio_metadata_=null,this.aac_last_incomplete_data_=null,this.video_track_=null,this.audio_track_=null,e.prototype.destroy.call(this)},t.probe=function(e){var t=new Uint8Array(e),a=-1,n=188;if(t.byteLength<=3*n)return{needMoreData:!0};for(;-1===a;){for(var i=Math.min(1e3,t.byteLength-3*n),o=0;o<i;){if(71===t[o]&&71===t[o+n]&&71===t[o+2*n]){a=o;break}o++}if(-1===a)if(188===n)n=192;else{if(192!==n)break;n=204}}return-1===a?{match:!1}:(192===n&&a>=4?(r.a.v("TSDemuxer","ts_packet_size = 192, m2ts mode"),a-=4):204===n&&r.a.v("TSDemuxer","ts_packet_size = 204, RS encoded MPEG2-TS stream"),{match:!0,consumed:0,ts_packet_size:n,sync_offset:a})},t.prototype.bindDataSource=function(e){return e.onDataArrival=this.parseChunks.bind(this),this},t.prototype.resetMediaInfo=function(){this.media_info_=new s.a},t.prototype.parseChunks=function(e,t){if(!(this.onError&&this.onMediaInfo&&this.onTrackMetadata&&this.onDataAvailable))throw new u.a("onError & onMediaInfo & onTrackMetadata & onDataAvailable callback must be specified");var a=0;for(this.first_parse_&&(this.first_parse_=!1,a=this.sync_offset_);a+this.ts_packet_size_<=e.byteLength;){var n=t+a;192===this.ts_packet_size_&&(a+=4);var i=new Uint8Array(e,a,188),o=i[0];if(71!==o){r.a.e(this.TAG,"sync_byte = "+o+", not 0x47");break}var s=(64&i[1])>>>6,l=(i[1],(31&i[1])<<8|i[2]),d=(48&i[3])>>>4,c=15&i[3],h={},p=4;if(2==d||3==d){var f=i[4];if(5+f===188){a+=188,204===this.ts_packet_size_&&(a+=16);continue}f>0&&(h=this.parseAdaptationField(e,a+4,1+f)),p=5+f}if(1==d||3==d)if(0===l||l===this.current_pmt_pid_||null!=this.pmt_&&this.pmt_.pid_stream_type[l]===E.kSCTE35){var _=188-p;this.handleSectionSlice(e,a+p,_,{pid:l,file_position:n,payload_unit_start_indicator:s,continuity_conunter:c,random_access_indicator:h.random_access_indicator})}else if(null!=this.pmt_&&null!=this.pmt_.pid_stream_type[l]){_=188-p;var m=this.pmt_.pid_stream_type[l];l!==this.pmt_.common_pids.h264&&l!==this.pmt_.common_pids.h265&&l!==this.pmt_.common_pids.adts_aac&&l!==this.pmt_.common_pids.loas_aac&&l!==this.pmt_.common_pids.ac3&&l!==this.pmt_.common_pids.eac3&&l!==this.pmt_.common_pids.opus&&l!==this.pmt_.common_pids.mp3&&!0!==this.pmt_.pes_private_data_pids[l]&&!0!==this.pmt_.timed_id3_pids[l]&&!0!==this.pmt_.synchronous_klv_pids[l]&&!0!==this.pmt_.asynchronous_klv_pids[l]||this.handlePESSlice(e,a+p,_,{pid:l,stream_type:m,file_position:n,payload_unit_start_indicator:s,continuity_conunter:c,random_access_indicator:h.random_access_indicator})}a+=188,204===this.ts_packet_size_&&(a+=16)}return this.dispatchAudioVideoMediaSegment(),a},t.prototype.parseAdaptationField=function(e,t,a){var n=new Uint8Array(e,t,a),i=n[0];return i>0?i>183?(r.a.w(this.TAG,"Illegal adaptation_field_length: "+i),{}):{discontinuity_indicator:(128&n[1])>>>7,random_access_indicator:(64&n[1])>>>6,elementary_stream_priority_indicator:(32&n[1])>>>5}:{}},t.prototype.handleSectionSlice=function(e,t,a,n){var i=new Uint8Array(e,t,a),r=this.section_slice_queues_[n.pid];if(n.payload_unit_start_indicator){var o=i[0];if(null!=r&&0!==r.total_length){var s=new Uint8Array(e,t+1,Math.min(a,o));r.slices.push(s),r.total_length+=s.byteLength,r.total_length===r.expected_length?this.emitSectionSlices(r,n):this.clearSlices(r,n)}for(var l=1+o;l<i.byteLength&&255!==i[l+0];){var d=(15&i[l+1])<<8|i[l+2];this.section_slice_queues_[n.pid]=new L,(r=this.section_slice_queues_[n.pid]).expected_length=d+3,r.file_position=n.file_position,r.random_access_indicator=n.random_access_indicator,s=new Uint8Array(e,t+l,Math.min(a-l,r.expected_length-r.total_length)),r.slices.push(s),r.total_length+=s.byteLength,r.total_length===r.expected_length?this.emitSectionSlices(r,n):r.total_length>=r.expected_length&&this.clearSlices(r,n),l+=s.byteLength}}else null!=r&&0!==r.total_length&&(s=new Uint8Array(e,t,Math.min(a,r.expected_length-r.total_length)),r.slices.push(s),r.total_length+=s.byteLength,r.total_length===r.expected_length?this.emitSectionSlices(r,n):r.total_length>=r.expected_length&&this.clearSlices(r,n))},t.prototype.handlePESSlice=function(e,t,a,n){var i=new Uint8Array(e,t,a),o=i[0]<<16|i[1]<<8|i[2],s=(i[3],i[4]<<8|i[5]);if(n.payload_unit_start_indicator){if(1!==o)return void r.a.e(this.TAG,"handlePESSlice: packet_start_code_prefix should be 1 but with value "+o);var l=this.pes_slice_queues_[n.pid];l&&(0===l.expected_length||l.expected_length===l.total_length?this.emitPESSlices(l,n):this.clearSlices(l,n)),this.pes_slice_queues_[n.pid]=new L,this.pes_slice_queues_[n.pid].file_position=n.file_position,this.pes_slice_queues_[n.pid].random_access_indicator=n.random_access_indicator}if(null!=this.pes_slice_queues_[n.pid]){var d=this.pes_slice_queues_[n.pid];d.slices.push(i),n.payload_unit_start_indicator&&(d.expected_length=0===s?0:s+6),d.total_length+=i.byteLength,d.expected_length>0&&d.expected_length===d.total_length?this.emitPESSlices(d,n):d.expected_length>0&&d.expected_length<d.total_length&&this.clearSlices(d,n)}},t.prototype.emitSectionSlices=function(e,t){for(var a=new Uint8Array(e.total_length),n=0,i=0;n<e.slices.length;n++){var r=e.slices[n];a.set(r,i),i+=r.byteLength}e.slices=[],e.expected_length=-1,e.total_length=0;var o=new x;o.pid=t.pid,o.data=a,o.file_position=e.file_position,o.random_access_indicator=e.random_access_indicator,this.parseSection(o)},t.prototype.emitPESSlices=function(e,t){for(var a=new Uint8Array(e.total_length),n=0,i=0;n<e.slices.length;n++){var r=e.slices[n];a.set(r,i),i+=r.byteLength}e.slices=[],e.expected_length=-1,e.total_length=0;var o=new k;o.pid=t.pid,o.data=a,o.stream_type=t.stream_type,o.file_position=e.file_position,o.random_access_indicator=e.random_access_indicator,this.parsePES(o)},t.prototype.clearSlices=function(e,t){e.slices=[],e.expected_length=-1,e.total_length=0},t.prototype.parseSection=function(e){var t=e.data,a=e.pid;0===a?this.parsePAT(t):a===this.current_pmt_pid_?this.parsePMT(t):null!=this.pmt_&&this.pmt_.scte_35_pids[a]&&this.parseSCTE35(t)},t.prototype.parsePES=function(e){var t=e.data,a=t[0]<<16|t[1]<<8|t[2],n=t[3],i=t[4]<<8|t[5];if(1===a)if(188!==n&&190!==n&&191!==n&&240!==n&&241!==n&&255!==n&&242!==n&&248!==n){t[6];var o=(192&t[7])>>>6,s=t[8],l=void 0,d=void 0;2!==o&&3!==o||(l=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2,d=3===o?536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2:l);var c=9+s,u=void 0;if(0!==i){if(i<3+s)return void r.a.v(this.TAG,"Malformed PES: PES_packet_length < 3 + PES_header_data_length");u=i-3-s}else u=t.byteLength-c;var h=t.subarray(c,c+u);switch(e.stream_type){case E.kMPEG1Audio:case E.kMPEG2Audio:this.parseMP3Payload(h,l);break;case E.kPESPrivateData:this.pmt_.common_pids.opus===e.pid?this.parseOpusPayload(h,l):this.pmt_.common_pids.ac3===e.pid?this.parseAC3Payload(h,l):this.pmt_.common_pids.eac3===e.pid?this.parseEAC3Payload(h,l):this.pmt_.asynchronous_klv_pids[e.pid]?this.parseAsynchronousKLVMetadataPayload(h,e.pid,n):this.pmt_.smpte2038_pids[e.pid]?this.parseSMPTE2038MetadataPayload(h,l,d,e.pid,n):this.parsePESPrivateDataPayload(h,l,d,e.pid,n);break;case E.kADTSAAC:this.parseADTSAACPayload(h,l);break;case E.kLOASAAC:this.parseLOASAACPayload(h,l);break;case E.kAC3:this.parseAC3Payload(h,l);break;case E.kEAC3:this.parseEAC3Payload(h,l);break;case E.kMetadata:this.pmt_.timed_id3_pids[e.pid]?this.parseTimedID3MetadataPayload(h,l,d,e.pid,n):this.pmt_.synchronous_klv_pids[e.pid]&&this.parseSynchronousKLVMetadataPayload(h,l,d,e.pid,n);break;case E.kH264:this.parseH264Payload(h,l,d,e.file_position,e.random_access_indicator);break;case E.kH265:this.parseH265Payload(h,l,d,e.file_position,e.random_access_indicator)}}else 188!==n&&191!==n&&240!==n&&241!==n&&255!==n&&242!==n&&248!==n||e.stream_type!==E.kPESPrivateData||(c=6,u=void 0,u=0!==i?i:t.byteLength-c,h=t.subarray(c,c+u),this.parsePESPrivateDataPayload(h,void 0,void 0,e.pid,n));else r.a.e(this.TAG,"parsePES: packet_start_code_prefix should be 1 but with value "+a)},t.prototype.parsePAT=function(e){var t=e[0];if(0===t){var a=(15&e[1])<<8|e[2],n=(e[3],e[4],(62&e[5])>>>1),i=1&e[5],o=e[6],s=(e[7],null);if(1===i&&0===o)(s=new T).version_number=n;else if(null==(s=this.pat_))return;for(var l=a-5-4,d=-1,c=-1,u=8;u<8+l;u+=4){var h=e[u]<<8|e[u+1],p=(31&e[u+2])<<8|e[u+3];0===h?s.network_pid=p:(s.program_pmt_pid[h]=p,-1===d&&(d=h),-1===c&&(c=p))}1===i&&0===o&&(null==this.pat_&&r.a.v(this.TAG,"Parsed first PAT: "+JSON.stringify(s)),this.pat_=s,this.current_program_=d,this.current_pmt_pid_=c)}else r.a.e(this.TAG,"parsePAT: table_id "+t+" is not corresponded to PAT!")},t.prototype.parsePMT=function(e){var t=e[0];if(2===t){var a=(15&e[1])<<8|e[2],n=e[3]<<8|e[4],i=(62&e[5])>>>1,o=1&e[5],s=e[6],l=(e[7],null);if(1===o&&0===s)(l=new D).program_number=n,l.version_number=i,this.program_pmt_map_[n]=l;else if(null==(l=this.program_pmt_map_[n]))return;e[8],e[9];for(var d=(15&e[10])<<8|e[11],c=12+d,u=a-9-d-4,h=c;h<c+u;){var p=e[h],f=(31&e[h+1])<<8|e[h+2],_=(15&e[h+3])<<8|e[h+4];l.pid_stream_type[f]=p;var m=l.common_pids.h264||l.common_pids.h265,g=l.common_pids.adts_aac||l.common_pids.loas_aac||l.common_pids.ac3||l.common_pids.eac3||l.common_pids.opus||l.common_pids.mp3;if(p!==E.kH264||m)if(p!==E.kH265||m)if(p!==E.kADTSAAC||g)if(p!==E.kLOASAAC||g)if(p!==E.kAC3||g)if(p!==E.kEAC3||g)if(p!==E.kMPEG1Audio&&p!==E.kMPEG2Audio||g)if(p===E.kPESPrivateData){if(l.pes_private_data_pids[f]=!0,_>0){for(var v=h+5;v<h+5+_;){var y=e[v+0],b=e[v+1];if(5===y){var S=String.fromCharCode.apply(String,Array.from(e.subarray(v+2,v+2+b)));"VANC"===S?l.smpte2038_pids[f]=!0:"Opus"===S?l.common_pids.opus=f:"KLVA"===S&&(l.asynchronous_klv_pids[f]=!0)}else if(127===y&&f===l.common_pids.opus){var A=null;if(128===e[v+2]&&(A=e[v+3]),null==A){r.a.e(this.TAG,"Not Supported Opus channel count.");continue}var w={codec:"opus",channel_count:0==(15&A)?2:15&A,channel_config_code:A,sample_rate:48e3},C={codec:"opus",meta:w};0==this.audio_init_segment_dispatched_?(this.audio_metadata_=w,this.dispatchAudioInitSegment(C)):this.detectAudioMetadataChange(C)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(C))}v+=2+b}var T=e.subarray(h+5,h+5+_);this.dispatchPESPrivateDataDescriptor(f,p,T)}}else if(p===E.kMetadata){if(_>0)for(v=h+5;v<h+5+_;){y=e[v+0];var R=e[v+1];if(38===y){var k=e[v+2]<<8|e[v+3]<<0,x=null;65535===k&&(x=String.fromCharCode.apply(String,Array.from(e.subarray(v+4,v+4+4))));var L=null;if(255===e[v+4+(65535===k?4:0)]){var N=4+(65535===k?4:0)+1;L=String.fromCharCode.apply(String,Array.from(e.subarray(v+N,v+N+4)))}"ID3 "===x&&"ID3 "===L?l.timed_id3_pids[f]=!0:"KLVA"===L&&(l.synchronous_klv_pids[f]=!0)}v+=2+R}}else p===E.kSCTE35&&(l.scte_35_pids[f]=!0);else l.common_pids.mp3=f;else l.common_pids.eac3=f;else l.common_pids.ac3=f;else l.common_pids.loas_aac=f;else l.common_pids.adts_aac=f;else l.common_pids.h265=f;else l.common_pids.h264=f;h+=5+_}n===this.current_program_&&(null==this.pmt_&&r.a.v(this.TAG,"Parsed first PMT: "+JSON.stringify(l)),this.pmt_=l,(l.common_pids.h264||l.common_pids.h265)&&(this.has_video_=!0),(l.common_pids.adts_aac||l.common_pids.loas_aac||l.common_pids.ac3||l.common_pids.opus||l.common_pids.mp3)&&(this.has_audio_=!0))}else r.a.e(this.TAG,"parsePMT: table_id "+t+" is not corresponded to PMT!")},t.prototype.parseSCTE35=function(e){var t=le(e);if(null!=t.pts){var a=Math.floor(t.pts/this.timescale_);t.pts=a}else t.nearest_pts=this.aac_last_sample_pts_;this.onSCTE35Metadata&&this.onSCTE35Metadata(t)},t.prototype.parseH264Payload=function(e,t,a,n,i){for(var o=new O(e),s=null,l=[],d=0,c=!1;null!=(s=o.readNextNaluPayload());){var u=new M(s);if(u.type===R.kSliceSPS){var h=_.parseSPS(s.data);this.video_init_segment_dispatched_?!0===this.detectVideoMetadataChange(u,h)&&(r.a.v(this.TAG,"H264: Critical h264 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:u,pps:void 0,details:h}):(this.video_metadata_.sps=u,this.video_metadata_.details=h)}else u.type===R.kSlicePPS?this.video_init_segment_dispatched_&&!this.video_metadata_changed_||(this.video_metadata_.pps=u,this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):(u.type===R.kSliceIDR||u.type===R.kSliceNonIDR&&1===i)&&(c=!0);this.video_init_segment_dispatched_&&(l.push(u),d+=u.data.byteLength)}var p=Math.floor(t/this.timescale_),f=Math.floor(a/this.timescale_);if(l.length){var m=this.video_track_,g={units:l,length:d,isKeyframe:c,dts:f,pts:p,cts:p-f,file_position:n};m.samples.push(g),m.length+=d}},t.prototype.parseH265Payload=function(e,t,a,n,i){for(var o=new ue(e),s=null,l=[],d=0,c=!1;null!=(s=o.readNextNaluPayload());){var u=new ce(s);if(u.type===$.kSliceVPS){if(!this.video_init_segment_dispatched_){var h=g.parseVPS(s.data);this.video_metadata_.vps=u,this.video_metadata_.details=we(we({},this.video_metadata_.details),h)}}else u.type===$.kSliceSPS?(h=g.parseSPS(s.data),this.video_init_segment_dispatched_?!0===this.detectVideoMetadataChange(u,h)&&(r.a.v(this.TAG,"H265: Critical h265 metadata has been changed, attempt to re-generate InitSegment"),this.video_metadata_changed_=!0,this.video_metadata_={vps:void 0,sps:u,pps:void 0,details:h}):(this.video_metadata_.sps=u,this.video_metadata_.details=we(we({},this.video_metadata_.details),h))):u.type===$.kSlicePPS?this.video_init_segment_dispatched_&&!this.video_metadata_changed_||(h=g.parsePPS(s.data),this.video_metadata_.pps=u,this.video_metadata_.details=we(we({},this.video_metadata_.details),h),this.video_metadata_.vps&&this.video_metadata_.sps&&this.video_metadata_.pps&&(this.video_metadata_changed_&&this.dispatchVideoMediaSegment(),this.dispatchVideoInitSegment())):u.type!==$.kSliceIDR_W_RADL&&u.type!==$.kSliceIDR_N_LP&&u.type!==$.kSliceCRA_NUT||(c=!0);this.video_init_segment_dispatched_&&(l.push(u),d+=u.data.byteLength)}var p=Math.floor(t/this.timescale_),f=Math.floor(a/this.timescale_);if(l.length){var _=this.video_track_,m={units:l,length:d,isKeyframe:c,dts:f,pts:p,cts:p-f,file_position:n};_.samples.push(m),_.length+=d}},t.prototype.detectVideoMetadataChange=function(e,t){if(t.codec_mimetype!==this.video_metadata_.details.codec_mimetype)return r.a.v(this.TAG,"Video: Codec mimeType changed from "+this.video_metadata_.details.codec_mimetype+" to "+t.codec_mimetype),!0;if(t.codec_size.width!==this.video_metadata_.details.codec_size.width||t.codec_size.height!==this.video_metadata_.details.codec_size.height){var a=this.video_metadata_.details.codec_size,n=t.codec_size;return r.a.v(this.TAG,"Video: Coded Resolution changed from "+a.width+"x"+a.height+" to "+n.width+"x"+n.height),!0}return t.present_size.width!==this.video_metadata_.details.present_size.width&&(r.a.v(this.TAG,"Video: Present resolution width changed from "+this.video_metadata_.details.present_size.width+" to "+t.present_size.width),!0)},t.prototype.isInitSegmentDispatched=function(){return this.has_video_&&this.has_audio_?this.video_init_segment_dispatched_&&this.audio_init_segment_dispatched_:this.has_video_&&!this.has_audio_?this.video_init_segment_dispatched_:!(this.has_video_||!this.has_audio_)&&this.audio_init_segment_dispatched_},t.prototype.dispatchVideoInitSegment=function(){var e=this.video_metadata_.details,t={type:"video"};t.id=this.video_track_.id,t.timescale=1e3,t.duration=this.duration_,t.codecWidth=e.codec_size.width,t.codecHeight=e.codec_size.height,t.presentWidth=e.present_size.width,t.presentHeight=e.present_size.height,t.profile=e.profile_string,t.level=e.level_string,t.bitDepth=e.bit_depth,t.chromaFormat=e.chroma_format,t.sarRatio=e.sar_ratio,t.frameRate=e.frame_rate;var a=t.frameRate.fps_den,n=t.frameRate.fps_num;if(t.refSampleDuration=a/n*1e3,t.codec=e.codec_mimetype,this.video_metadata_.vps){var i=this.video_metadata_.vps.data.subarray(4),o=this.video_metadata_.sps.data.subarray(4),s=this.video_metadata_.pps.data.subarray(4),l=new he(i,o,s,e);t.hvcc=l.getData(),0==this.video_init_segment_dispatched_&&r.a.v(this.TAG,"Generated first HEVCDecoderConfigurationRecord for mimeType: "+t.codec)}else{o=this.video_metadata_.sps.data.subarray(4),s=this.video_metadata_.pps.data.subarray(4);var d=new I(o,s,e);t.avcc=d.getData(),0==this.video_init_segment_dispatched_&&r.a.v(this.TAG,"Generated first AVCDecoderConfigurationRecord for mimeType: "+t.codec)}this.onTrackMetadata("video",t),this.video_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var c=this.media_info_;c.hasVideo=!0,c.width=t.codecWidth,c.height=t.codecHeight,c.fps=t.frameRate.fps,c.profile=t.profile,c.level=t.level,c.refFrames=e.ref_frames,c.chromaFormat=e.chroma_format_string,c.sarNum=t.sarRatio.width,c.sarDen=t.sarRatio.height,c.videoCodec=t.codec,c.hasAudio&&c.audioCodec?c.mimeType='video/mp2t; codecs="'+c.videoCodec+","+c.audioCodec+'"':c.mimeType='video/mp2t; codecs="'+c.videoCodec+'"',c.isComplete()&&this.onMediaInfo(c)},t.prototype.dispatchVideoMediaSegment=function(){this.isInitSegmentDispatched()&&this.video_track_.length&&this.onDataAvailable(null,this.video_track_)},t.prototype.dispatchAudioMediaSegment=function(){this.isInitSegmentDispatched()&&this.audio_track_.length&&this.onDataAvailable(this.audio_track_,null)},t.prototype.dispatchAudioVideoMediaSegment=function(){this.isInitSegmentDispatched()&&(this.audio_track_.length||this.video_track_.length)&&this.onDataAvailable(this.audio_track_,this.video_track_)},t.prototype.parseADTSAACPayload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var a=new Uint8Array(e.byteLength+this.aac_last_incomplete_data_.byteLength);a.set(this.aac_last_incomplete_data_,0),a.set(e,this.aac_last_incomplete_data_.byteLength),e=a}var n,i;if(null!=t&&(i=t/this.timescale_),"aac"===this.audio_metadata_.codec){if(null==t&&null!=this.aac_last_sample_pts_)n=1024/this.audio_metadata_.sampling_frequency*1e3,i=this.aac_last_sample_pts_+n;else if(null==t)return void r.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.aac_last_sample_pts_){n=1024/this.audio_metadata_.sampling_frequency*1e3;var o=this.aac_last_sample_pts_+n;Math.abs(o-i)>1&&(r.a.w(this.TAG,"AAC: Detected pts overlapped, expected: "+o+"ms, PES pts: "+i+"ms"),i=o)}}for(var s,l=new H(e),d=null,c=i;null!=(d=l.readNextAACFrame());){n=1024/d.sampling_frequency*1e3;var u={codec:"aac",data:d};0==this.audio_init_segment_dispatched_?(this.audio_metadata_={codec:"aac",audio_object_type:d.audio_object_type,sampling_freq_index:d.sampling_freq_index,sampling_frequency:d.sampling_frequency,channel_config:d.channel_config},this.dispatchAudioInitSegment(u)):this.detectAudioMetadataChange(u)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(u)),s=c;var h=Math.floor(c),p={unit:d.data,length:d.data.byteLength,pts:h,dts:h};this.audio_track_.samples.push(p),this.audio_track_.length+=d.data.byteLength,c+=n}l.hasIncompleteData()&&(this.aac_last_incomplete_data_=l.getIncompleteData()),s&&(this.aac_last_sample_pts_=s)}},t.prototype.parseLOASAACPayload=function(e,t){var a;if(!this.has_video_||this.video_init_segment_dispatched_){if(this.aac_last_incomplete_data_){var n=new Uint8Array(e.byteLength+this.aac_last_incomplete_data_.byteLength);n.set(this.aac_last_incomplete_data_,0),n.set(e,this.aac_last_incomplete_data_.byteLength),e=n}var i,o;if(null!=t&&(o=t/this.timescale_),"aac"===this.audio_metadata_.codec){if(null==t&&null!=this.aac_last_sample_pts_)i=1024/this.audio_metadata_.sampling_frequency*1e3,o=this.aac_last_sample_pts_+i;else if(null==t)return void r.a.w(this.TAG,"AAC: Unknown pts");if(this.aac_last_incomplete_data_&&this.aac_last_sample_pts_){i=1024/this.audio_metadata_.sampling_frequency*1e3;var s=this.aac_last_sample_pts_+i;Math.abs(s-o)>1&&(r.a.w(this.TAG,"AAC: Detected pts overlapped, expected: "+s+"ms, PES pts: "+o+"ms"),o=s)}}for(var l,d=new q(e),c=null,u=o;null!=(c=d.readNextAACFrame(null!==(a=this.loas_previous_frame)&&void 0!==a?a:void 0));){this.loas_previous_frame=c,i=1024/c.sampling_frequency*1e3;var h={codec:"aac",data:c};0==this.audio_init_segment_dispatched_?(this.audio_metadata_={codec:"aac",audio_object_type:c.audio_object_type,sampling_freq_index:c.sampling_freq_index,sampling_frequency:c.sampling_frequency,channel_config:c.channel_config},this.dispatchAudioInitSegment(h)):this.detectAudioMetadataChange(h)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(h)),l=u;var p=Math.floor(u),f={unit:c.data,length:c.data.byteLength,pts:p,dts:p};this.audio_track_.samples.push(f),this.audio_track_.length+=c.data.byteLength,u+=i}d.hasIncompleteData()&&(this.aac_last_incomplete_data_=d.getIncompleteData()),l&&(this.aac_last_sample_pts_=l)}},t.prototype.parseAC3Payload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){var a,n;if(null!=t&&(n=t/this.timescale_),"ac-3"===this.audio_metadata_.codec)if(null==t&&null!=this.aac_last_sample_pts_)a=1536/this.audio_metadata_.sampling_frequency*1e3,n=this.aac_last_sample_pts_+a;else if(null==t)return void r.a.w(this.TAG,"AC3: Unknown pts");for(var i,o=new ge(e),s=null,l=n;null!=(s=o.readNextAC3Frame());){a=1536/s.sampling_frequency*1e3;var d={codec:"ac-3",data:s};0==this.audio_init_segment_dispatched_?(this.audio_metadata_={codec:"ac-3",sampling_frequency:s.sampling_frequency,bit_stream_identification:s.bit_stream_identification,bit_stream_mode:s.bit_stream_mode,low_frequency_effects_channel_on:s.low_frequency_effects_channel_on,channel_mode:s.channel_mode},this.dispatchAudioInitSegment(d)):this.detectAudioMetadataChange(d)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(d)),i=l;var c=Math.floor(l),u={unit:s.data,length:s.data.byteLength,pts:c,dts:c};this.audio_track_.samples.push(u),this.audio_track_.length+=s.data.byteLength,l+=a}i&&(this.aac_last_sample_pts_=i)}},t.prototype.parseEAC3Payload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){var a,n;if(null!=t&&(n=t/this.timescale_),"ec-3"===this.audio_metadata_.codec)if(null==t&&null!=this.aac_last_sample_pts_)a=256*this.audio_metadata_.num_blks/this.audio_metadata_.sampling_frequency*1e3,n=this.aac_last_sample_pts_+a;else if(null==t)return void r.a.w(this.TAG,"EAC3: Unknown pts");for(var i,o=new be(e),s=null,l=n;null!=(s=o.readNextEAC3Frame());){a=1536/s.sampling_frequency*1e3;var d={codec:"ec-3",data:s};0==this.audio_init_segment_dispatched_?(this.audio_metadata_={codec:"ec-3",sampling_frequency:s.sampling_frequency,bit_stream_identification:s.bit_stream_identification,low_frequency_effects_channel_on:s.low_frequency_effects_channel_on,num_blks:s.num_blks,channel_mode:s.channel_mode},this.dispatchAudioInitSegment(d)):this.detectAudioMetadataChange(d)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(d)),i=l;var c=Math.floor(l),u={unit:s.data,length:s.data.byteLength,pts:c,dts:c};this.audio_track_.samples.push(u),this.audio_track_.length+=s.data.byteLength,l+=a}i&&(this.aac_last_sample_pts_=i)}},t.prototype.parseOpusPayload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){var a,n;if(null!=t&&(n=t/this.timescale_),"opus"===this.audio_metadata_.codec)if(null==t&&null!=this.aac_last_sample_pts_)a=20,n=this.aac_last_sample_pts_+a;else if(null==t)return void r.a.w(this.TAG,"Opus: Unknown pts");for(var i,o=n,s=0;s<e.length;){a=20;for(var l=0!=(16&e[s+1]),d=0!=(8&e[s+1]),c=s+2,u=0;255===e[c];)u+=255,c+=1;u+=e[c],c+=1,c+=l?2:0,c+=d?2:0,i=o;var h=Math.floor(o),p=e.slice(c,c+u),f={unit:p,length:p.byteLength,pts:h,dts:h};this.audio_track_.samples.push(f),this.audio_track_.length+=p.byteLength,o+=a,s=c+u}i&&(this.aac_last_sample_pts_=i)}},t.prototype.parseMP3Payload=function(e,t){if(!this.has_video_||this.video_init_segment_dispatched_){var a=[0,32,64,96,128,160,192,224,256,288,320,352,384,416,448,-1],n=[0,32,48,56,64,80,96,112,128,160,192,224,256,320,384,-1],i=[0,32,40,48,56,64,80,96,112,128,160,192,224,256,320,-1],r=e[1]>>>3&3,o=(6&e[1])>>1,s=(240&e[2])>>>4,l=(12&e[2])>>>2,d=3!=(e[3]>>>6&3)?2:1,c=0,u=34;switch(r){case 0:c=[11025,12e3,8e3,0][l];break;case 2:c=[22050,24e3,16e3,0][l];break;case 3:c=[44100,48e3,32e3,0][l]}switch(o){case 1:u=34,s<i.length&&i[s];break;case 2:u=33,s<n.length&&n[s];break;case 3:u=32,s<a.length&&a[s]}var h=new fe;h.object_type=u,h.sample_rate=c,h.channel_count=d,h.data=e;var p={codec:"mp3",data:h};0==this.audio_init_segment_dispatched_?(this.audio_metadata_={codec:"mp3",object_type:u,sample_rate:c,channel_count:d},this.dispatchAudioInitSegment(p)):this.detectAudioMetadataChange(p)&&(this.dispatchAudioMediaSegment(),this.dispatchAudioInitSegment(p));var f={unit:e,length:e.byteLength,pts:t/this.timescale_,dts:t/this.timescale_};this.audio_track_.samples.push(f),this.audio_track_.length+=e.byteLength}},t.prototype.detectAudioMetadataChange=function(e){if(e.codec!==this.audio_metadata_.codec)return r.a.v(this.TAG,"Audio: Audio Codecs changed from "+this.audio_metadata_.codec+" to "+e.codec),!0;if("aac"===e.codec&&"aac"===this.audio_metadata_.codec){if((t=e.data).audio_object_type!==this.audio_metadata_.audio_object_type)return r.a.v(this.TAG,"AAC: AudioObjectType changed from "+this.audio_metadata_.audio_object_type+" to "+t.audio_object_type),!0;if(t.sampling_freq_index!==this.audio_metadata_.sampling_freq_index)return r.a.v(this.TAG,"AAC: SamplingFrequencyIndex changed from "+this.audio_metadata_.sampling_freq_index+" to "+t.sampling_freq_index),!0;if(t.channel_config!==this.audio_metadata_.channel_config)return r.a.v(this.TAG,"AAC: Channel configuration changed from "+this.audio_metadata_.channel_config+" to "+t.channel_config),!0}else if("ac-3"===e.codec&&"ac-3"===this.audio_metadata_.codec){var t;if((t=e.data).sampling_frequency!==this.audio_metadata_.sampling_frequency)return r.a.v(this.TAG,"AC3: Sampling Frequency changed from "+this.audio_metadata_.sampling_frequency+" to "+t.sampling_frequency),!0;if(t.bit_stream_identification!==this.audio_metadata_.bit_stream_identification)return r.a.v(this.TAG,"AC3: Bit Stream Identification changed from "+this.audio_metadata_.bit_stream_identification+" to "+t.bit_stream_identification),!0;if(t.bit_stream_mode!==this.audio_metadata_.bit_stream_mode)return r.a.v(this.TAG,"AC3: BitStream Mode changed from "+this.audio_metadata_.bit_stream_mode+" to "+t.bit_stream_mode),!0;if(t.channel_mode!==this.audio_metadata_.channel_mode)return r.a.v(this.TAG,"AC3: Channel Mode changed from "+this.audio_metadata_.channel_mode+" to "+t.channel_mode),!0;if(t.low_frequency_effects_channel_on!==this.audio_metadata_.low_frequency_effects_channel_on)return r.a.v(this.TAG,"AC3: Low Frequency Effects Channel On changed from "+this.audio_metadata_.low_frequency_effects_channel_on+" to "+t.low_frequency_effects_channel_on),!0}else if("opus"===e.codec&&"opus"===this.audio_metadata_.codec){if((a=e.meta).sample_rate!==this.audio_metadata_.sample_rate)return r.a.v(this.TAG,"Opus: SamplingFrequencyIndex changed from "+this.audio_metadata_.sample_rate+" to "+a.sample_rate),!0;if(a.channel_count!==this.audio_metadata_.channel_count)return r.a.v(this.TAG,"Opus: Channel count changed from "+this.audio_metadata_.channel_count+" to "+a.channel_count),!0}else if("mp3"===e.codec&&"mp3"===this.audio_metadata_.codec){var a;if((a=e.data).object_type!==this.audio_metadata_.object_type)return r.a.v(this.TAG,"MP3: AudioObjectType changed from "+this.audio_metadata_.object_type+" to "+a.object_type),!0;if(a.sample_rate!==this.audio_metadata_.sample_rate)return r.a.v(this.TAG,"MP3: SamplingFrequencyIndex changed from "+this.audio_metadata_.sample_rate+" to "+a.sample_rate),!0;if(a.channel_count!==this.audio_metadata_.channel_count)return r.a.v(this.TAG,"MP3: Channel count changed from "+this.audio_metadata_.channel_count+" to "+a.channel_count),!0}return!1},t.prototype.dispatchAudioInitSegment=function(e){var t={type:"audio"};if(t.id=this.audio_track_.id,t.timescale=1e3,t.duration=this.duration_,"aac"===this.audio_metadata_.codec){var a="aac"===e.codec?e.data:null,n=new W(a);t.audioSampleRate=n.sampling_rate,t.channelCount=n.channel_count,t.codec=n.codec_mimetype,t.originalCodec=n.original_codec_mimetype,t.config=n.config,t.refSampleDuration=1024/t.audioSampleRate*t.timescale}else if("ac-3"===this.audio_metadata_.codec){var i="ac-3"===e.codec?e.data:null,o=new ve(i);t.audioSampleRate=o.sampling_rate,t.channelCount=o.channel_count,t.codec=o.codec_mimetype,t.originalCodec=o.original_codec_mimetype,t.config=o.config,t.refSampleDuration=1536/t.audioSampleRate*t.timescale}else if("ec-3"===this.audio_metadata_.codec){var s="ec-3"===e.codec?e.data:null,l=new Ee(s);t.audioSampleRate=l.sampling_rate,t.channelCount=l.channel_count,t.codec=l.codec_mimetype,t.originalCodec=l.original_codec_mimetype,t.config=l.config,t.refSampleDuration=256*l.num_blks/t.audioSampleRate*t.timescale}else"opus"===this.audio_metadata_.codec?(t.audioSampleRate=this.audio_metadata_.sample_rate,t.channelCount=this.audio_metadata_.channel_count,t.channelConfigCode=this.audio_metadata_.channel_config_code,t.codec="opus",t.originalCodec="opus",t.config=void 0,t.refSampleDuration=20):"mp3"===this.audio_metadata_.codec&&(t.audioSampleRate=this.audio_metadata_.sample_rate,t.channelCount=this.audio_metadata_.channel_count,t.codec="mp3",t.originalCodec="mp3",t.config=void 0);0==this.audio_init_segment_dispatched_&&r.a.v(this.TAG,"Generated first AudioSpecificConfig for mimeType: "+t.codec),this.onTrackMetadata("audio",t),this.audio_init_segment_dispatched_=!0,this.video_metadata_changed_=!1;var d=this.media_info_;d.hasAudio=!0,d.audioCodec=t.originalCodec,d.audioSampleRate=t.audioSampleRate,d.audioChannelCount=t.channelCount,d.hasVideo&&d.videoCodec?d.mimeType='video/mp2t; codecs="'+d.videoCodec+","+d.audioCodec+'"':d.mimeType='video/mp2t; codecs="'+d.audioCodec+'"',d.isComplete()&&this.onMediaInfo(d)},t.prototype.dispatchPESPrivateDataDescriptor=function(e,t,a){var n=new Y;n.pid=e,n.stream_type=t,n.descriptor=a,this.onPESPrivateDataDescriptor&&this.onPESPrivateDataDescriptor(n)},t.prototype.parsePESPrivateDataPayload=function(e,t,a,n,i){var r=new K;if(r.pid=n,r.stream_id=i,r.len=e.byteLength,r.data=e,null!=t){var o=Math.floor(t/this.timescale_);r.pts=o}else r.nearest_pts=this.aac_last_sample_pts_;if(null!=a){var s=Math.floor(a/this.timescale_);r.dts=s}this.onPESPrivateData&&this.onPESPrivateData(r)},t.prototype.parseTimedID3MetadataPayload=function(e,t,a,n,i){var r=new K;if(r.pid=n,r.stream_id=i,r.len=e.byteLength,r.data=e,null!=t){var o=Math.floor(t/this.timescale_);r.pts=o}if(null!=a){var s=Math.floor(a/this.timescale_);r.dts=s}this.onTimedID3Metadata&&this.onTimedID3Metadata(r)},t.prototype.parseSynchronousKLVMetadataPayload=function(e,t,a,n,i){var r=new Se;if(r.pid=n,r.stream_id=i,r.len=e.byteLength,r.data=e,null!=t){var o=Math.floor(t/this.timescale_);r.pts=o}if(null!=a){var s=Math.floor(a/this.timescale_);r.dts=s}r.access_units=function(e){for(var t=[],a=0;a+5<e.byteLength;){var n=e[a+0],i=e[a+1],r=e[a+2],o=e[a+3]<<8|e[a+4]<<0,s=e.slice(a+5,a+5+o);t.push({service_id:n,sequence_number:i,flags:r,data:s}),a+=5+o}return t}(e),this.onSynchronousKLVMetadata&&this.onSynchronousKLVMetadata(r)},t.prototype.parseAsynchronousKLVMetadataPayload=function(e,t,a){var n=new K;n.pid=t,n.stream_id=a,n.len=e.byteLength,n.data=e,this.onAsynchronousKLVMetadata&&this.onAsynchronousKLVMetadata(n)},t.prototype.parseSMPTE2038MetadataPayload=function(e,t,a,n,i){var r=new pe;if(r.pid=n,r.stream_id=i,r.len=e.byteLength,r.data=e,null!=t){var o=Math.floor(t/this.timescale_);r.pts=o}if(r.nearest_pts=this.aac_last_sample_pts_,null!=a){var s=Math.floor(a/this.timescale_);r.dts=s}r.ancillaries=function(e){for(var t=new f(e),a=0,n=[];a+=6,0===t.readBits(6);){var i=t.readBool();a+=1;var r=t.readBits(11);a+=11;var o=t.readBits(12);a+=12;var s=255&t.readBits(10);a+=10;var l=255&t.readBits(10);a+=10;var d=255&t.readBits(10);a+=10;for(var c=new Uint8Array(d),u=0;u<d;u++){var h=255&t.readBits(10);a+=10,c[u]=h}t.readBits(10),a+=10;var p="User Defined";65===s?7===l&&(p="SCTE-104"):95===s?220===l?p="ARIB STD-B37 (1SEG)":221===l?p="ARIB STD-B37 (ANALOG)":222===l?p="ARIB STD-B37 (SD)":223===l&&(p="ARIB STD-B37 (HD)"):97===s&&(1===l?p="EIA-708":2===l&&(p="EIA-608")),n.push({yc_indicator:i,line_number:r,horizontal_offset:o,did:s,sdid:l,user_data:c,description:p,information:{}}),t.readBits(8-(a-Math.floor(a/8))%8),a+=(8-(a-Math.floor(a/8)))%8}return t.destroy(),t=null,n}(e),this.onSMPTE2038Metadata&&this.onSMPTE2038Metadata(r)},t}(C),Te=function(){for(var e=0,t=0,a=arguments.length;t<a;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<a;t++)for(var r=arguments[t],o=0,s=r.length;o<s;o++,i++)n[i]=r[o];return n},Re=function(){function e(){}return e.init=function(){for(var t in e.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],hvc1:[],hvcC:[],av01:[],av1C:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[],".mp3":[],Opus:[],dOps:[],"ac-3":[],dac3:[],"ec-3":[],dec3:[]},e.types)e.types.hasOwnProperty(t)&&(e.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var a=e.constants={};a.FTYP=new Uint8Array([105,115,111,109,0,0,0,1,105,115,111,109,97,118,99,49]),a.STSD_PREFIX=new Uint8Array([0,0,0,0,0,0,0,1]),a.STTS=new Uint8Array([0,0,0,0,0,0,0,0]),a.STSC=a.STCO=a.STTS,a.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),a.HDLR_VIDEO=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),a.HDLR_AUDIO=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),a.DREF=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),a.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),a.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])},e.box=function(e){for(var t=8,a=null,n=Array.prototype.slice.call(arguments,1),i=n.length,r=0;r<i;r++)t+=n[r].byteLength;(a=new Uint8Array(t))[0]=t>>>24&255,a[1]=t>>>16&255,a[2]=t>>>8&255,a[3]=255&t,a.set(e,4);var o=8;for(r=0;r<i;r++)a.set(n[r],o),o+=n[r].byteLength;return a},e.generateInitSegment=function(t){var a=e.box(e.types.ftyp,e.constants.FTYP),n=e.moov(t),i=new Uint8Array(a.byteLength+n.byteLength);return i.set(a,0),i.set(n,a.byteLength),i},e.moov=function(t){var a=e.mvhd(t.timescale,t.duration),n=e.trak(t),i=e.mvex(t);return e.box(e.types.moov,a,n,i)},e.mvhd=function(t,a){return e.box(e.types.mvhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t,a>>>24&255,a>>>16&255,a>>>8&255,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]))},e.trak=function(t){return e.box(e.types.trak,e.tkhd(t),e.mdia(t))},e.tkhd=function(t){var a=t.id,n=t.duration,i=t.presentWidth,r=t.presentHeight;return e.box(e.types.tkhd,new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,i>>>8&255,255&i,0,0,r>>>8&255,255&r,0,0]))},e.mdia=function(t){return e.box(e.types.mdia,e.mdhd(t),e.hdlr(t),e.minf(t))},e.mdhd=function(t){var a=t.timescale,n=t.duration;return e.box(e.types.mdhd,new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,n>>>24&255,n>>>16&255,n>>>8&255,255&n,85,196,0,0]))},e.hdlr=function(t){var a=null;return a="audio"===t.type?e.constants.HDLR_AUDIO:e.constants.HDLR_VIDEO,e.box(e.types.hdlr,a)},e.minf=function(t){var a=null;return a="audio"===t.type?e.box(e.types.smhd,e.constants.SMHD):e.box(e.types.vmhd,e.constants.VMHD),e.box(e.types.minf,a,e.dinf(),e.stbl(t))},e.dinf=function(){return e.box(e.types.dinf,e.box(e.types.dref,e.constants.DREF))},e.stbl=function(t){return e.box(e.types.stbl,e.stsd(t),e.box(e.types.stts,e.constants.STTS),e.box(e.types.stsc,e.constants.STSC),e.box(e.types.stsz,e.constants.STSZ),e.box(e.types.stco,e.constants.STCO))},e.stsd=function(t){return"audio"===t.type?"mp3"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp3(t)):"ac-3"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.ac3(t)):"ec-3"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.ec3(t)):"opus"===t.codec?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.Opus(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.mp4a(t)):"video"===t.type&&t.codec.startsWith("hvc1")?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.hvc1(t)):"video"===t.type&&t.codec.startsWith("av01")?e.box(e.types.stsd,e.constants.STSD_PREFIX,e.av01(t)):e.box(e.types.stsd,e.constants.STSD_PREFIX,e.avc1(t))},e.mp3=function(t){var a=t.channelCount,n=t.audioSampleRate,i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,16,0,0,0,0,n>>>8&255,255&n,0,0]);return e.box(e.types[".mp3"],i)},e.mp4a=function(t){var a=t.channelCount,n=t.audioSampleRate,i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,16,0,0,0,0,n>>>8&255,255&n,0,0]);return e.box(e.types.mp4a,i,e.esds(t))},e.ac3=function(t){var a=t.channelCount,n=t.audioSampleRate,i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,16,0,0,0,0,n>>>8&255,255&n,0,0]);return e.box(e.types["ac-3"],i,e.box(e.types.dac3,new Uint8Array(t.config)))},e.ec3=function(t){var a=t.channelCount,n=t.audioSampleRate,i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,16,0,0,0,0,n>>>8&255,255&n,0,0]);return e.box(e.types["ec-3"],i,e.box(e.types.dec3,new Uint8Array(t.config)))},e.esds=function(t){var a=t.config||[],n=a.length,i=new Uint8Array([0,0,0,0,3,23+n,0,1,0,4,15+n,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([n]).concat(a).concat([6,1,2]));return e.box(e.types.esds,i)},e.Opus=function(t){var a=t.channelCount,n=t.audioSampleRate,i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,a,0,16,0,0,0,0,n>>>8&255,255&n,0,0]);return e.box(e.types.Opus,i,e.dOps(t))},e.dOps=function(t){var a=t.channelCount,n=t.channelConfigCode,i=t.audioSampleRate;if(t.config)return e.box(e.types.dOps,o);var r=[];switch(n){case 1:case 2:r=[0];break;case 0:r=[255,1,1,0,1];break;case 128:r=[255,2,0,0,1];break;case 3:r=[1,2,1,0,2,1];break;case 4:r=[1,2,2,0,1,2,3];break;case 5:r=[1,3,2,0,4,1,2,3];break;case 6:r=[1,4,2,0,4,1,2,3,5];break;case 7:r=[1,4,2,0,4,1,2,3,5,6];break;case 8:r=[1,5,3,0,6,1,2,3,4,5,7];break;case 130:r=[1,1,2,0,1];break;case 131:r=[1,1,3,0,1,2];break;case 132:r=[1,1,4,0,1,2,3];break;case 133:r=[1,1,5,0,1,2,3,4];break;case 134:r=[1,1,6,0,1,2,3,4,5];break;case 135:r=[1,1,7,0,1,2,3,4,5,6];break;case 136:r=[1,1,8,0,1,2,3,4,5,6,7]}var o=new Uint8Array(Te([0,a,0,0,i>>>24&255,i>>>17&255,i>>>8&255,i>>>0&255,0,0],r));return e.box(e.types.dOps,o)},e.avc1=function(t){var a=t.avcc,n=t.codecWidth,i=t.codecHeight,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,n>>>8&255,255&n,i>>>8&255,255&i,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.avc1,r,e.box(e.types.avcC,a))},e.hvc1=function(t){var a=t.hvcc,n=t.codecWidth,i=t.codecHeight,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,n>>>8&255,255&n,i>>>8&255,255&i,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.hvc1,r,e.box(e.types.hvcC,a))},e.av01=function(t){var a=t.av1c,n=t.codecWidth||192,i=t.codecHeight||108,r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,n>>>8&255,255&n,i>>>8&255,255&i,0,72,0,0,0,72,0,0,0,0,0,0,0,1,10,120,113,113,47,102,108,118,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]);return e.box(e.types.av01,r,e.box(e.types.av1C,a))},e.mvex=function(t){return e.box(e.types.mvex,e.trex(t))},e.trex=function(t){var a=t.id,n=new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return e.box(e.types.trex,n)},e.moof=function(t,a){return e.box(e.types.moof,e.mfhd(t.sequenceNumber),e.traf(t,a))},e.mfhd=function(t){var a=new Uint8Array([0,0,0,0,t>>>24&255,t>>>16&255,t>>>8&255,255&t]);return e.box(e.types.mfhd,a)},e.traf=function(t,a){var n=t.id,i=e.box(e.types.tfhd,new Uint8Array([0,0,0,0,n>>>24&255,n>>>16&255,n>>>8&255,255&n])),r=e.box(e.types.tfdt,new Uint8Array([0,0,0,0,a>>>24&255,a>>>16&255,a>>>8&255,255&a])),o=e.sdtp(t),s=e.trun(t,o.byteLength+16+16+8+16+8+8);return e.box(e.types.traf,i,r,s,o)},e.sdtp=function(t){for(var a=t.samples||[],n=a.length,i=new Uint8Array(4+n),r=0;r<n;r++){var o=a[r].flags;i[r+4]=o.isLeading<<6|o.dependsOn<<4|o.isDependedOn<<2|o.hasRedundancy}return e.box(e.types.sdtp,i)},e.trun=function(t,a){var n=t.samples||[],i=n.length,r=12+16*i,o=new Uint8Array(r);a+=8+r,o.set([0,0,15,1,i>>>24&255,i>>>16&255,i>>>8&255,255&i,a>>>24&255,a>>>16&255,a>>>8&255,255&a],0);for(var s=0;s<i;s++){var l=n[s].duration,d=n[s].size,c=n[s].flags,u=n[s].cts;o.set([l>>>24&255,l>>>16&255,l>>>8&255,255&l,d>>>24&255,d>>>16&255,d>>>8&255,255&d,c.isLeading<<2|c.dependsOn,c.isDependedOn<<6|c.hasRedundancy<<4|c.isNonSync,0,0,u>>>24&255,u>>>16&255,u>>>8&255,255&u],12+16*s)}return e.box(e.types.trun,o)},e.mdat=function(t){return e.box(e.types.mdat,t)},e}();Re.init();var De=Re,ke=function(){function e(){}return e.getSilentFrame=function(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},e}(),xe=a(7),Le=function(){function e(e){this.TAG="MP4Remuxer",this._config=e,this._isLive=!0===e.isLive,this._dtsBase=-1,this._dtsBaseInited=!1,this._audioDtsBase=1/0,this._videoDtsBase=1/0,this._audioNextDts=void 0,this._videoNextDts=void 0,this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList=new xe.c("audio"),this._videoSegmentInfoList=new xe.c("video"),this._onInitSegment=null,this._onMediaSegment=null,this._forceFirstIDR=!(!o.a.chrome||!(o.a.version.major<50||50===o.a.version.major&&o.a.version.build<2661)),this._fillSilentAfterSeek=o.a.msedge||o.a.msie,this._mp3UseMpegAudio=!o.a.firefox,this._fillAudioTimestampGap=this._config.fixAudioTimestampGap}return e.prototype.destroy=function(){this._dtsBase=-1,this._dtsBaseInited=!1,this._audioMeta=null,this._videoMeta=null,this._audioSegmentInfoList.clear(),this._audioSegmentInfoList=null,this._videoSegmentInfoList.clear(),this._videoSegmentInfoList=null,this._onInitSegment=null,this._onMediaSegment=null},e.prototype.bindDataSource=function(e){return e.onDataAvailable=this.remux.bind(this),e.onTrackMetadata=this._onTrackMetadataReceived.bind(this),this},Object.defineProperty(e.prototype,"onInitSegment",{get:function(){return this._onInitSegment},set:function(e){this._onInitSegment=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onMediaSegment",{get:function(){return this._onMediaSegment},set:function(e){this._onMediaSegment=e},enumerable:!1,configurable:!0}),e.prototype.insertDiscontinuity=function(){this._audioNextDts=this._videoNextDts=void 0},e.prototype.seek=function(e){this._audioStashedLastSample=null,this._videoStashedLastSample=null,this._videoSegmentInfoList.clear(),this._audioSegmentInfoList.clear()},e.prototype.remux=function(e,t){if(!this._onMediaSegment)throw new u.a("MP4Remuxer: onMediaSegment callback must be specificed!");this._dtsBaseInited||this._calculateDtsBase(e,t),t&&this._remuxVideo(t),e&&this._remuxAudio(e)},e.prototype._onTrackMetadataReceived=function(e,t){var a=null,n="mp4",i=t.codec;if("audio"===e)this._audioMeta=t,"mp3"===t.codec&&this._mp3UseMpegAudio?(n="mpeg",i="",a=new Uint8Array):a=De.generateInitSegment(t);else{if("video"!==e)return;this._videoMeta=t,a=De.generateInitSegment(t)}if(!this._onInitSegment)throw new u.a("MP4Remuxer: onInitSegment callback must be specified!");this._onInitSegment(e,{type:e,data:a.buffer,codec:i,container:e+"/"+n,mediaDuration:t.duration})},e.prototype._calculateDtsBase=function(e,t){this._dtsBaseInited||(e&&e.samples&&e.samples.length&&(this._audioDtsBase=e.samples[0].dts),t&&t.samples&&t.samples.length&&(this._videoDtsBase=t.samples[0].dts),this._dtsBase=Math.min(this._audioDtsBase,this._videoDtsBase),this._dtsBaseInited=!0)},e.prototype.getTimestampBase=function(){if(this._dtsBaseInited)return this._dtsBase},e.prototype.flushStashedSamples=function(){var e=this._videoStashedLastSample,t=this._audioStashedLastSample,a={type:"video",id:1,sequenceNumber:0,samples:[],length:0};null!=e&&(a.samples.push(e),a.length=e.length);var n={type:"audio",id:2,sequenceNumber:0,samples:[],length:0};null!=t&&(n.samples.push(t),n.length=t.length),this._videoStashedLastSample=null,this._audioStashedLastSample=null,this._remuxVideo(a,!0),this._remuxAudio(n,!0)},e.prototype._remuxAudio=function(e,t){if(null!=this._audioMeta){var a,n=e,i=n.samples,s=void 0,l=-1,d=this._audioMeta.refSampleDuration,c="mp3"===this._audioMeta.codec&&this._mp3UseMpegAudio,u=this._dtsBaseInited&&void 0===this._audioNextDts,h=!1;if(i&&0!==i.length&&(1!==i.length||t)){var p=0,f=null,_=0;c?(p=0,_=n.length):(p=8,_=8+n.length);var m=null;if(i.length>1&&(_-=(m=i.pop()).length),null!=this._audioStashedLastSample){var g=this._audioStashedLastSample;this._audioStashedLastSample=null,i.unshift(g),_+=g.length}null!=m&&(this._audioStashedLastSample=m);var v=i[0].dts-this._dtsBase;if(this._audioNextDts)s=v-this._audioNextDts;else if(this._audioSegmentInfoList.isEmpty())s=0,this._fillSilentAfterSeek&&!this._videoSegmentInfoList.isEmpty()&&"mp3"!==this._audioMeta.originalCodec&&(h=!0);else{var y=this._audioSegmentInfoList.getLastSampleBefore(v);if(null!=y){var b=v-(y.originalDts+y.duration);b<=3&&(b=0),s=v-(y.dts+y.duration+b)}else s=0}if(h){var E=v-s,S=this._videoSegmentInfoList.getLastSegmentBefore(v);if(null!=S&&S.beginDts<E){if(B=ke.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount)){var A=S.beginDts,w=E-S.beginDts;r.a.v(this.TAG,"InsertPrefixSilentAudio: dts: "+A+", duration: "+w),i.unshift({unit:B,dts:A,pts:A}),_+=B.byteLength}}else h=!1}for(var C=[],T=0;T<i.length;T++){var R=(g=i[T]).unit,D=g.dts-this._dtsBase,k=(A=D,!1),x=null,L=0;if(!(D<-.001)){if("mp3"!==this._audioMeta.codec){var N=D;if(this._audioNextDts&&(N=this._audioNextDts),(s=D-N)<=-3*d){r.a.w(this.TAG,"Dropping 1 audio frame (originalDts: "+D+" ms ,curRefDts: "+N+" ms)  due to dtsCorrection: "+s+" ms overlap.");continue}if(s>=3*d&&this._fillAudioTimestampGap&&!o.a.safari){k=!0;var B,V=Math.floor(s/d);r.a.w(this.TAG,"Large audio timestamp gap detected, may cause AV sync to drift. Silent frames will be generated to avoid unsync.\noriginalDts: "+D+" ms, curRefDts: "+N+" ms, dtsCorrection: "+Math.round(s)+" ms, generate: "+V+" frames"),A=Math.floor(N),L=Math.floor(N+d)-A,null==(B=ke.getSilentFrame(this._audioMeta.originalCodec,this._audioMeta.channelCount))&&(r.a.w(this.TAG,"Unable to generate silent frame for "+this._audioMeta.originalCodec+" with "+this._audioMeta.channelCount+" channels, repeat last frame"),B=R),x=[];for(var M=0;M<V;M++){N+=d;var O=Math.floor(N),I=Math.floor(N+d)-O,P={dts:O,pts:O,cts:0,unit:B,size:B.byteLength,duration:I,originalDts:D,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}};x.push(P),_+=P.size}this._audioNextDts=N+d}else A=Math.floor(N),L=Math.floor(N+d)-A,this._audioNextDts=N+d}else A=D-s,L=T!==i.length-1?i[T+1].dts-this._dtsBase-s-A:null!=m?m.dts-this._dtsBase-s-A:C.length>=1?C[C.length-1].duration:Math.floor(d),this._audioNextDts=A+L;-1===l&&(l=A),C.push({dts:A,pts:A,cts:0,unit:g.unit,size:g.unit.byteLength,duration:L,originalDts:D,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0}}),k&&C.push.apply(C,x)}}if(0===C.length)return n.samples=[],void(n.length=0);for(c?f=new Uint8Array(_):((f=new Uint8Array(_))[0]=_>>>24&255,f[1]=_>>>16&255,f[2]=_>>>8&255,f[3]=255&_,f.set(De.types.mdat,4)),T=0;T<C.length;T++)R=C[T].unit,f.set(R,p),p+=R.byteLength;var U=C[C.length-1];a=U.dts+U.duration;var j=new xe.b;j.beginDts=l,j.endDts=a,j.beginPts=l,j.endPts=a,j.originalBeginDts=C[0].originalDts,j.originalEndDts=U.originalDts+U.duration,j.firstSample=new xe.d(C[0].dts,C[0].pts,C[0].duration,C[0].originalDts,!1),j.lastSample=new xe.d(U.dts,U.pts,U.duration,U.originalDts,!1),this._isLive||this._audioSegmentInfoList.append(j),n.samples=C,n.sequenceNumber++;var F=null;F=c?new Uint8Array:De.moof(n,l),n.samples=[],n.length=0;var z={type:"audio",data:this._mergeBoxes(F,f).buffer,sampleCount:C.length,info:j};c&&u&&(z.timestampOffset=l),this._onMediaSegment("audio",z)}}},e.prototype._remuxVideo=function(e,t){if(null!=this._videoMeta){var a,n,i=e,r=i.samples,o=void 0,s=-1,l=-1;if(r&&0!==r.length&&(1!==r.length||t)){var d=8,c=null,u=8+e.length,h=null;if(r.length>1&&(u-=(h=r.pop()).length),null!=this._videoStashedLastSample){var p=this._videoStashedLastSample;this._videoStashedLastSample=null,r.unshift(p),u+=p.length}null!=h&&(this._videoStashedLastSample=h);var f=r[0].dts-this._dtsBase;if(this._videoNextDts)o=f-this._videoNextDts;else if(this._videoSegmentInfoList.isEmpty())o=0;else{var _=this._videoSegmentInfoList.getLastSampleBefore(f);if(null!=_){var m=f-(_.originalDts+_.duration);m<=3&&(m=0),o=f-(_.dts+_.duration+m)}else o=0}for(var g=new xe.b,v=[],y=0;y<r.length;y++){var b=(p=r[y]).dts-this._dtsBase,E=p.isKeyframe,S=b-o,A=p.cts,w=S+A;-1===s&&(s=S,l=w);var C=0;if(C=y!==r.length-1?r[y+1].dts-this._dtsBase-o-S:null!=h?h.dts-this._dtsBase-o-S:v.length>=1?v[v.length-1].duration:Math.floor(this._videoMeta.refSampleDuration),E){var T=new xe.d(S,w,C,p.dts,!0);T.fileposition=p.fileposition,g.appendSyncPoint(T)}v.push({dts:S,pts:w,cts:A,units:p.units,size:p.length,isKeyframe:E,duration:C,originalDts:b,flags:{isLeading:0,dependsOn:E?2:1,isDependedOn:E?1:0,hasRedundancy:0,isNonSync:E?0:1}})}for((c=new Uint8Array(u))[0]=u>>>24&255,c[1]=u>>>16&255,c[2]=u>>>8&255,c[3]=255&u,c.set(De.types.mdat,4),y=0;y<v.length;y++)for(var R=v[y].units;R.length;){var D=R.shift().data;c.set(D,d),d+=D.byteLength}var k=v[v.length-1];if(a=k.dts+k.duration,n=k.pts+k.duration,this._videoNextDts=a,g.beginDts=s,g.endDts=a,g.beginPts=l,g.endPts=n,g.originalBeginDts=v[0].originalDts,g.originalEndDts=k.originalDts+k.duration,g.firstSample=new xe.d(v[0].dts,v[0].pts,v[0].duration,v[0].originalDts,v[0].isKeyframe),g.lastSample=new xe.d(k.dts,k.pts,k.duration,k.originalDts,k.isKeyframe),this._isLive||this._videoSegmentInfoList.append(g),i.samples=v,i.sequenceNumber++,this._forceFirstIDR){var x=v[0].flags;x.dependsOn=2,x.isNonSync=0}var L=De.moof(i,s);i.samples=[],i.length=0,this._onMediaSegment("video",{type:"video",data:this._mergeBoxes(L,c).buffer,sampleCount:v.length,info:g})}}},e.prototype._mergeBoxes=function(e,t){var a=new Uint8Array(e.byteLength+t.byteLength);return a.set(e,0),a.set(t,e.byteLength),a},e}(),Ne=a(11),Be=a(1),Ve=function(){function e(e,t){this.TAG="TransmuxingController",this._emitter=new i.a,this._config=t,e.segments||(e.segments=[{duration:e.duration,filesize:e.filesize,url:e.url}]),"boolean"!=typeof e.cors&&(e.cors=!0),"boolean"!=typeof e.withCredentials&&(e.withCredentials=!1),this._mediaDataSource=e,this._currentSegmentIndex=0;var a=0;this._mediaDataSource.segments.forEach((function(n){n.timestampBase=a,a+=n.duration,n.cors=e.cors,n.withCredentials=e.withCredentials,t.referrerPolicy&&(n.referrerPolicy=t.referrerPolicy)})),isNaN(a)||this._mediaDataSource.duration===a||(this._mediaDataSource.duration=a),this._mediaInfo=null,this._demuxer=null,this._remuxer=null,this._ioctl=null,this._pendingSeekTime=null,this._pendingResolveSeekPoint=null,this._statisticsReporter=null}return e.prototype.destroy=function(){this._mediaInfo=null,this._mediaDataSource=null,this._statisticsReporter&&this._disableStatisticsReporter(),this._ioctl&&(this._ioctl.destroy(),this._ioctl=null),this._demuxer&&(this._demuxer.destroy(),this._demuxer=null),this._remuxer&&(this._remuxer.destroy(),this._remuxer=null),this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.start=function(){this._loadSegment(0),this._enableStatisticsReporter()},e.prototype._loadSegment=function(e,t){this._currentSegmentIndex=e;var a=this._mediaDataSource.segments[e],n=this._ioctl=new Ne.a(a,this._config,e);n.onError=this._onIOException.bind(this),n.onSeeked=this._onIOSeeked.bind(this),n.onComplete=this._onIOComplete.bind(this),n.onRedirect=this._onIORedirect.bind(this),n.onRecoveredEarlyEof=this._onIORecoveredEarlyEof.bind(this),t?this._demuxer.bindDataSource(this._ioctl):n.onDataArrival=this._onInitChunkArrival.bind(this),n.open(t)},e.prototype.stop=function(){this._internalAbort(),this._disableStatisticsReporter()},e.prototype._internalAbort=function(){this._ioctl&&(this._ioctl.destroy(),this._ioctl=null)},e.prototype.pause=function(){this._ioctl&&this._ioctl.isWorking()&&(this._ioctl.pause(),this._disableStatisticsReporter())},e.prototype.resume=function(){this._ioctl&&this._ioctl.isPaused()&&(this._ioctl.resume(),this._enableStatisticsReporter())},e.prototype.seek=function(e){if(null!=this._mediaInfo&&this._mediaInfo.isSeekable()){var t=this._searchSegmentIndexContains(e);if(t===this._currentSegmentIndex){var a=this._mediaInfo.segments[t];if(null==a)this._pendingSeekTime=e;else{var n=a.getNearestKeyframe(e);this._remuxer.seek(n.milliseconds),this._ioctl.seek(n.fileposition),this._pendingResolveSeekPoint=n.milliseconds}}else{var i=this._mediaInfo.segments[t];null==i?(this._pendingSeekTime=e,this._internalAbort(),this._remuxer.seek(),this._remuxer.insertDiscontinuity(),this._loadSegment(t)):(n=i.getNearestKeyframe(e),this._internalAbort(),this._remuxer.seek(e),this._remuxer.insertDiscontinuity(),this._demuxer.resetMediaInfo(),this._demuxer.timestampBase=this._mediaDataSource.segments[t].timestampBase,this._loadSegment(t,n.fileposition),this._pendingResolveSeekPoint=n.milliseconds,this._reportSegmentMediaInfo(t))}this._enableStatisticsReporter()}},e.prototype._searchSegmentIndexContains=function(e){for(var t=this._mediaDataSource.segments,a=t.length-1,n=0;n<t.length;n++)if(e<t[n].timestampBase){a=n-1;break}return a},e.prototype._onInitChunkArrival=function(e,t){var a=this,n=0;if(t>0)this._demuxer.bindDataSource(this._ioctl),this._demuxer.timestampBase=this._mediaDataSource.segments[this._currentSegmentIndex].timestampBase,n=this._demuxer.parseChunks(e,t);else{var i=null;(i=w.probe(e)).match&&(this._setupFLVDemuxerRemuxer(i),n=this._demuxer.parseChunks(e,t)),i.match||i.needMoreData||(i=Ce.probe(e)).match&&(this._setupTSDemuxerRemuxer(i),n=this._demuxer.parseChunks(e,t)),i.match||i.needMoreData||(i=null,r.a.e(this.TAG,"Non MPEG-TS/FLV, Unsupported media type!"),Promise.resolve().then((function(){a._internalAbort()})),this._emitter.emit(Be.a.DEMUX_ERROR,m.a.FORMAT_UNSUPPORTED,"Non MPEG-TS/FLV, Unsupported media type!"))}return n},e.prototype._setupFLVDemuxerRemuxer=function(e){this._demuxer=new w(e,this._config),this._remuxer||(this._remuxer=new Le(this._config));var t=this._mediaDataSource;null==t.duration||isNaN(t.duration)||(this._demuxer.overridedDuration=t.duration),"boolean"==typeof t.hasAudio&&(this._demuxer.overridedHasAudio=t.hasAudio),"boolean"==typeof t.hasVideo&&(this._demuxer.overridedHasVideo=t.hasVideo),this._demuxer.timestampBase=t.segments[this._currentSegmentIndex].timestampBase,this._demuxer.onError=this._onDemuxException.bind(this),this._demuxer.onMediaInfo=this._onMediaInfo.bind(this),this._demuxer.onMetaDataArrived=this._onMetaDataArrived.bind(this),this._demuxer.onScriptDataArrived=this._onScriptDataArrived.bind(this),this._remuxer.bindDataSource(this._demuxer.bindDataSource(this._ioctl)),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},e.prototype._setupTSDemuxerRemuxer=function(e){var t=this._demuxer=new Ce(e,this._config);this._remuxer||(this._remuxer=new Le(this._config)),t.onError=this._onDemuxException.bind(this),t.onMediaInfo=this._onMediaInfo.bind(this),t.onMetaDataArrived=this._onMetaDataArrived.bind(this),t.onTimedID3Metadata=this._onTimedID3Metadata.bind(this),t.onSynchronousKLVMetadata=this._onSynchronousKLVMetadata.bind(this),t.onAsynchronousKLVMetadata=this._onAsynchronousKLVMetadata.bind(this),t.onSMPTE2038Metadata=this._onSMPTE2038Metadata.bind(this),t.onSCTE35Metadata=this._onSCTE35Metadata.bind(this),t.onPESPrivateDataDescriptor=this._onPESPrivateDataDescriptor.bind(this),t.onPESPrivateData=this._onPESPrivateData.bind(this),this._remuxer.bindDataSource(this._demuxer),this._demuxer.bindDataSource(this._ioctl),this._remuxer.onInitSegment=this._onRemuxerInitSegmentArrival.bind(this),this._remuxer.onMediaSegment=this._onRemuxerMediaSegmentArrival.bind(this)},e.prototype._onMediaInfo=function(e){var t=this;null==this._mediaInfo&&(this._mediaInfo=Object.assign({},e),this._mediaInfo.keyframesIndex=null,this._mediaInfo.segments=[],this._mediaInfo.segmentCount=this._mediaDataSource.segments.length,Object.setPrototypeOf(this._mediaInfo,s.a.prototype));var a=Object.assign({},e);Object.setPrototypeOf(a,s.a.prototype),this._mediaInfo.segments[this._currentSegmentIndex]=a,this._reportSegmentMediaInfo(this._currentSegmentIndex),null!=this._pendingSeekTime&&Promise.resolve().then((function(){var e=t._pendingSeekTime;t._pendingSeekTime=null,t.seek(e)}))},e.prototype._onMetaDataArrived=function(e){this._emitter.emit(Be.a.METADATA_ARRIVED,e)},e.prototype._onScriptDataArrived=function(e){this._emitter.emit(Be.a.SCRIPTDATA_ARRIVED,e)},e.prototype._onTimedID3Metadata=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.dts&&(e.dts-=t),this._emitter.emit(Be.a.TIMED_ID3_METADATA_ARRIVED,e))},e.prototype._onSynchronousKLVMetadata=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.dts&&(e.dts-=t),this._emitter.emit(Be.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,e))},e.prototype._onAsynchronousKLVMetadata=function(e){this._emitter.emit(Be.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,e)},e.prototype._onSMPTE2038Metadata=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.dts&&(e.dts-=t),null!=e.nearest_pts&&(e.nearest_pts-=t),this._emitter.emit(Be.a.SMPTE2038_METADATA_ARRIVED,e))},e.prototype._onSCTE35Metadata=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.nearest_pts&&(e.nearest_pts-=t),this._emitter.emit(Be.a.SCTE35_METADATA_ARRIVED,e))},e.prototype._onPESPrivateDataDescriptor=function(e){this._emitter.emit(Be.a.PES_PRIVATE_DATA_DESCRIPTOR,e)},e.prototype._onPESPrivateData=function(e){var t=this._remuxer.getTimestampBase();null!=t&&(null!=e.pts&&(e.pts-=t),null!=e.nearest_pts&&(e.nearest_pts-=t),null!=e.dts&&(e.dts-=t),this._emitter.emit(Be.a.PES_PRIVATE_DATA_ARRIVED,e))},e.prototype._onIOSeeked=function(){this._remuxer.insertDiscontinuity()},e.prototype._onIOComplete=function(e){var t=e+1;t<this._mediaDataSource.segments.length?(this._internalAbort(),this._remuxer&&this._remuxer.flushStashedSamples(),this._loadSegment(t)):(this._remuxer&&this._remuxer.flushStashedSamples(),this._emitter.emit(Be.a.LOADING_COMPLETE),this._disableStatisticsReporter())},e.prototype._onIORedirect=function(e){var t=this._ioctl.extraData;this._mediaDataSource.segments[t].redirectedURL=e},e.prototype._onIORecoveredEarlyEof=function(){this._emitter.emit(Be.a.RECOVERED_EARLY_EOF)},e.prototype._onIOException=function(e,t){r.a.e(this.TAG,"IOException: type = "+e+", code = "+t.code+", msg = "+t.msg),this._emitter.emit(Be.a.IO_ERROR,e,t),this._disableStatisticsReporter()},e.prototype._onDemuxException=function(e,t){r.a.e(this.TAG,"DemuxException: type = "+e+", info = "+t),this._emitter.emit(Be.a.DEMUX_ERROR,e,t)},e.prototype._onRemuxerInitSegmentArrival=function(e,t){this._emitter.emit(Be.a.INIT_SEGMENT,e,t)},e.prototype._onRemuxerMediaSegmentArrival=function(e,t){if(null==this._pendingSeekTime&&(this._emitter.emit(Be.a.MEDIA_SEGMENT,e,t),null!=this._pendingResolveSeekPoint&&"video"===e)){var a=t.info.syncPoints,n=this._pendingResolveSeekPoint;this._pendingResolveSeekPoint=null,o.a.safari&&a.length>0&&a[0].originalDts===n&&(n=a[0].pts),this._emitter.emit(Be.a.RECOMMEND_SEEKPOINT,n)}},e.prototype._enableStatisticsReporter=function(){null==this._statisticsReporter&&(this._statisticsReporter=self.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval))},e.prototype._disableStatisticsReporter=function(){this._statisticsReporter&&(self.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype._reportSegmentMediaInfo=function(e){var t=this._mediaInfo.segments[e],a=Object.assign({},t);a.duration=this._mediaInfo.duration,a.segmentCount=this._mediaInfo.segmentCount,delete a.segments,delete a.keyframesIndex,this._emitter.emit(Be.a.MEDIA_INFO,a)},e.prototype._reportStatisticsInfo=function(){var e={};e.url=this._ioctl.currentURL,e.hasRedirect=this._ioctl.hasRedirect,e.hasRedirect&&(e.redirectedURL=this._ioctl.currentRedirectedURL),e.speed=this._ioctl.currentSpeed,e.loaderType=this._ioctl.loaderType,e.currentSegmentIndex=this._currentSegmentIndex,e.totalSegmentCount=this._mediaDataSource.segments.length,this._emitter.emit(Be.a.STATISTICS_INFO,e)},e}();t.a=Ve},function(e,t,a){var n,i=a(0),r=function(){function e(){this._firstCheckpoint=0,this._lastCheckpoint=0,this._intervalBytes=0,this._totalBytes=0,this._lastSecondBytes=0,self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now}return e.prototype.reset=function(){this._firstCheckpoint=this._lastCheckpoint=0,this._totalBytes=this._intervalBytes=0,this._lastSecondBytes=0},e.prototype.addBytes=function(e){0===this._firstCheckpoint?(this._firstCheckpoint=this._now(),this._lastCheckpoint=this._firstCheckpoint,this._intervalBytes+=e,this._totalBytes+=e):this._now()-this._lastCheckpoint<1e3?(this._intervalBytes+=e,this._totalBytes+=e):(this._lastSecondBytes=this._intervalBytes,this._intervalBytes=e,this._totalBytes+=e,this._lastCheckpoint=this._now())},Object.defineProperty(e.prototype,"currentKBps",{get:function(){this.addBytes(0);var e=(this._now()-this._lastCheckpoint)/1e3;return 0==e&&(e=1),this._intervalBytes/e/1024},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastSecondKBps",{get:function(){return this.addBytes(0),0!==this._lastSecondBytes?this._lastSecondBytes/1024:this._now()-this._lastCheckpoint>=500?this.currentKBps:0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"averageKBps",{get:function(){var e=(this._now()-this._firstCheckpoint)/1e3;return this._totalBytes/e/1024},enumerable:!1,configurable:!0}),e}(),o=a(2),s=a(4),l=a(3),d=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),c=function(e){function t(t,a){var n=e.call(this,"fetch-stream-loader")||this;return n.TAG="FetchStreamLoader",n._seekHandler=t,n._config=a,n._needStash=!0,n._requestAbort=!1,n._abortController=null,n._contentLength=null,n._receivedLength=0,n}return d(t,e),t.isSupported=function(){try{var e=s.a.msedge&&s.a.version.minor>=15048,t=!s.a.msedge||e;return self.fetch&&self.ReadableStream&&t}catch(e){return!1}},t.prototype.destroy=function(){this.isWorking()&&this.abort(),e.prototype.destroy.call(this)},t.prototype.open=function(e,t){var a=this;this._dataSource=e,this._range=t;var n=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(n=e.redirectedURL);var i=this._seekHandler.getConfig(n,t),r=new self.Headers;if("object"==typeof i.headers){var s=i.headers;for(var d in s)s.hasOwnProperty(d)&&r.append(d,s[d])}var c={method:"GET",headers:r,mode:"cors",cache:"default",referrerPolicy:"no-referrer-when-downgrade"};if("object"==typeof this._config.headers)for(var d in this._config.headers)r.append(d,this._config.headers[d]);!1===e.cors&&(c.mode="same-origin"),e.withCredentials&&(c.credentials="include"),e.referrerPolicy&&(c.referrerPolicy=e.referrerPolicy),self.AbortController&&(this._abortController=new self.AbortController,c.signal=this._abortController.signal),this._status=o.c.kConnecting,self.fetch(i.url,c).then((function(e){if(a._requestAbort)return a._status=o.c.kIdle,void e.body.cancel();if(e.ok&&e.status>=200&&e.status<=299){if(e.url!==i.url&&a._onURLRedirect){var t=a._seekHandler.removeURLParameters(e.url);a._onURLRedirect(t)}var n=e.headers.get("Content-Length");return null!=n&&(a._contentLength=parseInt(n),0!==a._contentLength&&a._onContentLengthKnown&&a._onContentLengthKnown(a._contentLength)),a._pump.call(a,e.body.getReader())}if(a._status=o.c.kError,!a._onError)throw new l.d("FetchStreamLoader: Http code invalid, "+e.status+" "+e.statusText);a._onError(o.b.HTTP_STATUS_CODE_INVALID,{code:e.status,msg:e.statusText})})).catch((function(e){if(!a._abortController||!a._abortController.signal.aborted){if(a._status=o.c.kError,!a._onError)throw e;a._onError(o.b.EXCEPTION,{code:-1,msg:e.message})}}))},t.prototype.abort=function(){if(this._requestAbort=!0,(this._status!==o.c.kBuffering||!s.a.chrome)&&this._abortController)try{this._abortController.abort()}catch(e){}},t.prototype._pump=function(e){var t=this;return e.read().then((function(a){if(a.done)if(null!==t._contentLength&&t._receivedLength<t._contentLength){t._status=o.c.kError;var n=o.b.EARLY_EOF,i={code:-1,msg:"Fetch stream meet Early-EOF"};if(!t._onError)throw new l.d(i.msg);t._onError(n,i)}else t._status=o.c.kComplete,t._onComplete&&t._onComplete(t._range.from,t._range.from+t._receivedLength-1);else{if(t._abortController&&t._abortController.signal.aborted)return void(t._status=o.c.kComplete);if(!0===t._requestAbort)return t._status=o.c.kComplete,e.cancel();t._status=o.c.kBuffering;var r=a.value.buffer,s=t._range.from+t._receivedLength;t._receivedLength+=r.byteLength,t._onDataArrival&&t._onDataArrival(r,s,t._receivedLength),t._pump(e)}})).catch((function(e){if(t._abortController&&t._abortController.signal.aborted)t._status=o.c.kComplete;else if(11!==e.code||!s.a.msedge){t._status=o.c.kError;var a=0,n=null;if(19!==e.code&&"network error"!==e.message||!(null===t._contentLength||null!==t._contentLength&&t._receivedLength<t._contentLength)?(a=o.b.EXCEPTION,n={code:e.code,msg:e.message}):(a=o.b.EARLY_EOF,n={code:e.code,msg:"Fetch stream meet Early-EOF"}),!t._onError)throw new l.d(n.msg);t._onError(a,n)}}))},t}(o.a),u=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),h=function(e){function t(t,a){var n=e.call(this,"xhr-moz-chunked-loader")||this;return n.TAG="MozChunkedLoader",n._seekHandler=t,n._config=a,n._needStash=!0,n._xhr=null,n._requestAbort=!1,n._contentLength=null,n._receivedLength=0,n}return u(t,e),t.isSupported=function(){try{var e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="moz-chunked-arraybuffer","moz-chunked-arraybuffer"===e.responseType}catch(e){return i.a.w("MozChunkedLoader",e.message),!1}},t.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onloadend=null,this._xhr.onerror=null,this._xhr=null),e.prototype.destroy.call(this)},t.prototype.open=function(e,t){this._dataSource=e,this._range=t;var a=e.url;this._config.reuseRedirectedURL&&null!=e.redirectedURL&&(a=e.redirectedURL);var n=this._seekHandler.getConfig(a,t);this._requestURL=n.url;var i=this._xhr=new XMLHttpRequest;if(i.open("GET",n.url,!0),i.responseType="moz-chunked-arraybuffer",i.onreadystatechange=this._onReadyStateChange.bind(this),i.onprogress=this._onProgress.bind(this),i.onloadend=this._onLoadEnd.bind(this),i.onerror=this._onXhrError.bind(this),e.withCredentials&&(i.withCredentials=!0),"object"==typeof n.headers){var r=n.headers;for(var s in r)r.hasOwnProperty(s)&&i.setRequestHeader(s,r[s])}if("object"==typeof this._config.headers)for(var s in r=this._config.headers)r.hasOwnProperty(s)&&i.setRequestHeader(s,r[s]);this._status=o.c.kConnecting,i.send()},t.prototype.abort=function(){this._requestAbort=!0,this._xhr&&this._xhr.abort(),this._status=o.c.kComplete},t.prototype._onReadyStateChange=function(e){var t=e.target;if(2===t.readyState){if(null!=t.responseURL&&t.responseURL!==this._requestURL&&this._onURLRedirect){var a=this._seekHandler.removeURLParameters(t.responseURL);this._onURLRedirect(a)}if(0!==t.status&&(t.status<200||t.status>299)){if(this._status=o.c.kError,!this._onError)throw new l.d("MozChunkedLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(o.b.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}else this._status=o.c.kBuffering}},t.prototype._onProgress=function(e){if(this._status!==o.c.kError){null===this._contentLength&&null!==e.total&&0!==e.total&&(this._contentLength=e.total,this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength));var t=e.target.response,a=this._range.from+this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,a,this._receivedLength)}},t.prototype._onLoadEnd=function(e){!0!==this._requestAbort?this._status!==o.c.kError&&(this._status=o.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1)):this._requestAbort=!1},t.prototype._onXhrError=function(e){this._status=o.c.kError;var t=0,a=null;if(this._contentLength&&e.loaded<this._contentLength?(t=o.b.EARLY_EOF,a={code:-1,msg:"Moz-Chunked stream meet Early-Eof"}):(t=o.b.EXCEPTION,a={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new l.d(a.msg);this._onError(t,a)},t}(o.a),p=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),f=function(e){function t(t,a){var n=e.call(this,"xhr-range-loader")||this;return n.TAG="RangeLoader",n._seekHandler=t,n._config=a,n._needStash=!1,n._chunkSizeKBList=[128,256,384,512,768,1024,1536,2048,3072,4096,5120,6144,7168,8192],n._currentChunkSizeKB=384,n._currentSpeedNormalized=0,n._zeroSpeedChunkCount=0,n._xhr=null,n._speedSampler=new r,n._requestAbort=!1,n._waitForTotalLength=!1,n._totalLengthReceived=!1,n._currentRequestURL=null,n._currentRedirectedURL=null,n._currentRequestRange=null,n._totalLength=null,n._contentLength=null,n._receivedLength=0,n._lastTimeLoaded=0,n}return p(t,e),t.isSupported=function(){try{var e=new XMLHttpRequest;return e.open("GET","https://example.com",!0),e.responseType="arraybuffer","arraybuffer"===e.responseType}catch(e){return i.a.w("RangeLoader",e.message),!1}},t.prototype.destroy=function(){this.isWorking()&&this.abort(),this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr=null),e.prototype.destroy.call(this)},Object.defineProperty(t.prototype,"currentSpeed",{get:function(){return this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),t.prototype.open=function(e,t){this._dataSource=e,this._range=t,this._status=o.c.kConnecting;var a=!1;null!=this._dataSource.filesize&&0!==this._dataSource.filesize&&(a=!0,this._totalLength=this._dataSource.filesize),this._totalLengthReceived||a?this._openSubRange():(this._waitForTotalLength=!0,this._internalOpen(this._dataSource,{from:0,to:-1}))},t.prototype._openSubRange=function(){var e=1024*this._currentChunkSizeKB,t=this._range.from+this._receivedLength,a=t+e;null!=this._contentLength&&a-this._range.from>=this._contentLength&&(a=this._range.from+this._contentLength-1),this._currentRequestRange={from:t,to:a},this._internalOpen(this._dataSource,this._currentRequestRange)},t.prototype._internalOpen=function(e,t){this._lastTimeLoaded=0;var a=e.url;this._config.reuseRedirectedURL&&(null!=this._currentRedirectedURL?a=this._currentRedirectedURL:null!=e.redirectedURL&&(a=e.redirectedURL));var n=this._seekHandler.getConfig(a,t);this._currentRequestURL=n.url;var i=this._xhr=new XMLHttpRequest;if(i.open("GET",n.url,!0),i.responseType="arraybuffer",i.onreadystatechange=this._onReadyStateChange.bind(this),i.onprogress=this._onProgress.bind(this),i.onload=this._onLoad.bind(this),i.onerror=this._onXhrError.bind(this),e.withCredentials&&(i.withCredentials=!0),"object"==typeof n.headers){var r=n.headers;for(var o in r)r.hasOwnProperty(o)&&i.setRequestHeader(o,r[o])}if("object"==typeof this._config.headers)for(var o in r=this._config.headers)r.hasOwnProperty(o)&&i.setRequestHeader(o,r[o]);i.send()},t.prototype.abort=function(){this._requestAbort=!0,this._internalAbort(),this._status=o.c.kComplete},t.prototype._internalAbort=function(){this._xhr&&(this._xhr.onreadystatechange=null,this._xhr.onprogress=null,this._xhr.onload=null,this._xhr.onerror=null,this._xhr.abort(),this._xhr=null)},t.prototype._onReadyStateChange=function(e){var t=e.target;if(2===t.readyState){if(null!=t.responseURL){var a=this._seekHandler.removeURLParameters(t.responseURL);t.responseURL!==this._currentRequestURL&&a!==this._currentRedirectedURL&&(this._currentRedirectedURL=a,this._onURLRedirect&&this._onURLRedirect(a))}if(t.status>=200&&t.status<=299){if(this._waitForTotalLength)return;this._status=o.c.kBuffering}else{if(this._status=o.c.kError,!this._onError)throw new l.d("RangeLoader: Http code invalid, "+t.status+" "+t.statusText);this._onError(o.b.HTTP_STATUS_CODE_INVALID,{code:t.status,msg:t.statusText})}}},t.prototype._onProgress=function(e){if(this._status!==o.c.kError){if(null===this._contentLength){var t=!1;if(this._waitForTotalLength){this._waitForTotalLength=!1,this._totalLengthReceived=!0,t=!0;var a=e.total;this._internalAbort(),null!=a&0!==a&&(this._totalLength=a)}if(-1===this._range.to?this._contentLength=this._totalLength-this._range.from:this._contentLength=this._range.to-this._range.from+1,t)return void this._openSubRange();this._onContentLengthKnown&&this._onContentLengthKnown(this._contentLength)}var n=e.loaded-this._lastTimeLoaded;this._lastTimeLoaded=e.loaded,this._speedSampler.addBytes(n)}},t.prototype._normalizeSpeed=function(e){var t=this._chunkSizeKBList,a=t.length-1,n=0,i=0,r=a;if(e<t[0])return t[0];for(;i<=r;){if((n=i+Math.floor((r-i)/2))===a||e>=t[n]&&e<t[n+1])return t[n];t[n]<e?i=n+1:r=n-1}},t.prototype._onLoad=function(e){if(this._status!==o.c.kError)if(this._waitForTotalLength)this._waitForTotalLength=!1;else{this._lastTimeLoaded=0;var t=this._speedSampler.lastSecondKBps;if(0===t&&(this._zeroSpeedChunkCount++,this._zeroSpeedChunkCount>=3&&(t=this._speedSampler.currentKBps)),0!==t){var a=this._normalizeSpeed(t);this._currentSpeedNormalized!==a&&(this._currentSpeedNormalized=a,this._currentChunkSizeKB=a)}var n=e.target.response,i=this._range.from+this._receivedLength;this._receivedLength+=n.byteLength;var r=!1;null!=this._contentLength&&this._receivedLength<this._contentLength?this._openSubRange():r=!0,this._onDataArrival&&this._onDataArrival(n,i,this._receivedLength),r&&(this._status=o.c.kComplete,this._onComplete&&this._onComplete(this._range.from,this._range.from+this._receivedLength-1))}},t.prototype._onXhrError=function(e){this._status=o.c.kError;var t=0,a=null;if(this._contentLength&&this._receivedLength>0&&this._receivedLength<this._contentLength?(t=o.b.EARLY_EOF,a={code:-1,msg:"RangeLoader meet Early-Eof"}):(t=o.b.EXCEPTION,a={code:-1,msg:e.constructor.name+" "+e.type}),!this._onError)throw new l.d(a.msg);this._onError(t,a)},t}(o.a),_=function(){var e=function(t,a){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(t,a)};return function(t,a){function n(){this.constructor=t}e(t,a),t.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)}}(),m=function(e){function t(){var t=e.call(this,"websocket-loader")||this;return t.TAG="WebSocketLoader",t._needStash=!0,t._ws=null,t._requestAbort=!1,t._receivedLength=0,t}return _(t,e),t.isSupported=function(){try{return void 0!==self.WebSocket}catch(e){return!1}},t.prototype.destroy=function(){this._ws&&this.abort(),e.prototype.destroy.call(this)},t.prototype.open=function(e){try{var t=this._ws=new self.WebSocket(e.url);t.binaryType="arraybuffer",t.onopen=this._onWebSocketOpen.bind(this),t.onclose=this._onWebSocketClose.bind(this),t.onmessage=this._onWebSocketMessage.bind(this),t.onerror=this._onWebSocketError.bind(this),this._status=o.c.kConnecting}catch(e){this._status=o.c.kError;var a={code:e.code,msg:e.message};if(!this._onError)throw new l.d(a.msg);this._onError(o.b.EXCEPTION,a)}},t.prototype.abort=function(){var e=this._ws;!e||0!==e.readyState&&1!==e.readyState||(this._requestAbort=!0,e.close()),this._ws=null,this._status=o.c.kComplete},t.prototype._onWebSocketOpen=function(e){this._status=o.c.kBuffering},t.prototype._onWebSocketClose=function(e){!0!==this._requestAbort?(this._status=o.c.kComplete,this._onComplete&&this._onComplete(0,this._receivedLength-1)):this._requestAbort=!1},t.prototype._onWebSocketMessage=function(e){var t=this;if(e.data instanceof ArrayBuffer)this._dispatchArrayBuffer(e.data);else if(e.data instanceof Blob){var a=new FileReader;a.onload=function(){t._dispatchArrayBuffer(a.result)},a.readAsArrayBuffer(e.data)}else{this._status=o.c.kError;var n={code:-1,msg:"Unsupported WebSocket message type: "+e.data.constructor.name};if(!this._onError)throw new l.d(n.msg);this._onError(o.b.EXCEPTION,n)}},t.prototype._dispatchArrayBuffer=function(e){var t=e,a=this._receivedLength;this._receivedLength+=t.byteLength,this._onDataArrival&&this._onDataArrival(t,a,this._receivedLength)},t.prototype._onWebSocketError=function(e){this._status=o.c.kError;var t={code:e.code,msg:e.message};if(!this._onError)throw new l.d(t.msg);this._onError(o.b.EXCEPTION,t)},t}(o.a),g=function(){function e(e){this._zeroStart=e||!1}return e.prototype.getConfig=function(e,t){var a={};if(0!==t.from||-1!==t.to){var n=void 0;n=-1!==t.to?"bytes="+t.from.toString()+"-"+t.to.toString():"bytes="+t.from.toString()+"-",a.Range=n}else this._zeroStart&&(a.Range="bytes=0-");return{url:e,headers:a}},e.prototype.removeURLParameters=function(e){return e},e}(),v=function(){function e(e,t){this._startName=e,this._endName=t}return e.prototype.getConfig=function(e,t){var a=e;if(0!==t.from||-1!==t.to){var n=!0;-1===a.indexOf("?")&&(a+="?",n=!1),n&&(a+="&"),a+=this._startName+"="+t.from.toString(),-1!==t.to&&(a+="&"+this._endName+"="+t.to.toString())}return{url:a,headers:{}}},e.prototype.removeURLParameters=function(e){var t=e.split("?")[0],a=void 0,n=e.indexOf("?");-1!==n&&(a=e.substring(n+1));var i="";if(null!=a&&a.length>0)for(var r=a.split("&"),o=0;o<r.length;o++){var s=r[o].split("="),l=o>0;s[0]!==this._startName&&s[0]!==this._endName&&(l&&(i+="&"),i+=r[o])}return 0===i.length?t:t+"?"+i},e}(),y=function(){function e(e,t,a){this.TAG="IOController",this._config=t,this._extraData=a,this._stashInitialSize=65536,null!=t.stashInitialSize&&t.stashInitialSize>0&&(this._stashInitialSize=t.stashInitialSize),this._stashUsed=0,this._stashSize=this._stashInitialSize,this._bufferSize=3145728,this._stashBuffer=new ArrayBuffer(this._bufferSize),this._stashByteStart=0,this._enableStash=!0,!1===t.enableStashBuffer&&(this._enableStash=!1),this._loader=null,this._loaderClass=null,this._seekHandler=null,this._dataSource=e,this._isWebSocketURL=/wss?:\/\/(.+?)/.test(e.url),this._refTotalLength=e.filesize?e.filesize:null,this._totalLength=this._refTotalLength,this._fullRequestFlag=!1,this._currentRange=null,this._redirectedURL=null,this._speedNormalized=0,this._speedSampler=new r,this._speedNormalizeList=[32,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096],this._isEarlyEofReconnecting=!1,this._paused=!1,this._resumeFrom=0,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._selectSeekHandler(),this._selectLoader(),this._createLoader()}return e.prototype.destroy=function(){this._loader.isWorking()&&this._loader.abort(),this._loader.destroy(),this._loader=null,this._loaderClass=null,this._dataSource=null,this._stashBuffer=null,this._stashUsed=this._stashSize=this._bufferSize=this._stashByteStart=0,this._currentRange=null,this._speedSampler=null,this._isEarlyEofReconnecting=!1,this._onDataArrival=null,this._onSeeked=null,this._onError=null,this._onComplete=null,this._onRedirect=null,this._onRecoveredEarlyEof=null,this._extraData=null},e.prototype.isWorking=function(){return this._loader&&this._loader.isWorking()&&!this._paused},e.prototype.isPaused=function(){return this._paused},Object.defineProperty(e.prototype,"status",{get:function(){return this._loader.status},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"extraData",{get:function(){return this._extraData},set:function(e){this._extraData=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDataArrival",{get:function(){return this._onDataArrival},set:function(e){this._onDataArrival=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onSeeked",{get:function(){return this._onSeeked},set:function(e){this._onSeeked=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onError",{get:function(){return this._onError},set:function(e){this._onError=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onComplete",{get:function(){return this._onComplete},set:function(e){this._onComplete=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRedirect",{get:function(){return this._onRedirect},set:function(e){this._onRedirect=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRecoveredEarlyEof",{get:function(){return this._onRecoveredEarlyEof},set:function(e){this._onRecoveredEarlyEof=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentURL",{get:function(){return this._dataSource.url},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasRedirect",{get:function(){return null!=this._redirectedURL||null!=this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentRedirectedURL",{get:function(){return this._redirectedURL||this._dataSource.redirectedURL},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentSpeed",{get:function(){return this._loaderClass===f?this._loader.currentSpeed:this._speedSampler.lastSecondKBps},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"loaderType",{get:function(){return this._loader.type},enumerable:!1,configurable:!0}),e.prototype._selectSeekHandler=function(){var e=this._config;if("range"===e.seekType)this._seekHandler=new g(this._config.rangeLoadZeroStart);else if("param"===e.seekType){var t=e.seekParamStart||"bstart",a=e.seekParamEnd||"bend";this._seekHandler=new v(t,a)}else{if("custom"!==e.seekType)throw new l.b("Invalid seekType in config: "+e.seekType);if("function"!=typeof e.customSeekHandler)throw new l.b("Custom seekType specified in config but invalid customSeekHandler!");this._seekHandler=new e.customSeekHandler}},e.prototype._selectLoader=function(){if(null!=this._config.customLoader)this._loaderClass=this._config.customLoader;else if(this._isWebSocketURL)this._loaderClass=m;else if(c.isSupported())this._loaderClass=c;else if(h.isSupported())this._loaderClass=h;else{if(!f.isSupported())throw new l.d("Your browser doesn't support xhr with arraybuffer responseType!");this._loaderClass=f}},e.prototype._createLoader=function(){this._loader=new this._loaderClass(this._seekHandler,this._config),!1===this._loader.needStashBuffer&&(this._enableStash=!1),this._loader.onContentLengthKnown=this._onContentLengthKnown.bind(this),this._loader.onURLRedirect=this._onURLRedirect.bind(this),this._loader.onDataArrival=this._onLoaderChunkArrival.bind(this),this._loader.onComplete=this._onLoaderComplete.bind(this),this._loader.onError=this._onLoaderError.bind(this)},e.prototype.open=function(e){this._currentRange={from:0,to:-1},e&&(this._currentRange.from=e),this._speedSampler.reset(),e||(this._fullRequestFlag=!0),this._loader.open(this._dataSource,Object.assign({},this._currentRange))},e.prototype.abort=function(){this._loader.abort(),this._paused&&(this._paused=!1,this._resumeFrom=0)},e.prototype.pause=function(){this.isWorking()&&(this._loader.abort(),0!==this._stashUsed?(this._resumeFrom=this._stashByteStart,this._currentRange.to=this._stashByteStart-1):this._resumeFrom=this._currentRange.to+1,this._stashUsed=0,this._stashByteStart=0,this._paused=!0)},e.prototype.resume=function(){if(this._paused){this._paused=!1;var e=this._resumeFrom;this._resumeFrom=0,this._internalSeek(e,!0)}},e.prototype.seek=function(e){this._paused=!1,this._stashUsed=0,this._stashByteStart=0,this._internalSeek(e,!0)},e.prototype._internalSeek=function(e,t){this._loader.isWorking()&&this._loader.abort(),this._flushStashBuffer(t),this._loader.destroy(),this._loader=null;var a={from:e,to:-1};this._currentRange={from:a.from,to:-1},this._speedSampler.reset(),this._stashSize=this._stashInitialSize,this._createLoader(),this._loader.open(this._dataSource,a),this._onSeeked&&this._onSeeked()},e.prototype.updateUrl=function(e){if(!e||"string"!=typeof e||0===e.length)throw new l.b("Url must be a non-empty string!");this._dataSource.url=e},e.prototype._expandBuffer=function(e){for(var t=this._stashSize;t+1048576<e;)t*=2;if((t+=1048576)!==this._bufferSize){var a=new ArrayBuffer(t);if(this._stashUsed>0){var n=new Uint8Array(this._stashBuffer,0,this._stashUsed);new Uint8Array(a,0,t).set(n,0)}this._stashBuffer=a,this._bufferSize=t}},e.prototype._normalizeSpeed=function(e){var t=this._speedNormalizeList,a=t.length-1,n=0,i=0,r=a;if(e<t[0])return t[0];for(;i<=r;){if((n=i+Math.floor((r-i)/2))===a||e>=t[n]&&e<t[n+1])return t[n];t[n]<e?i=n+1:r=n-1}},e.prototype._adjustStashSize=function(e){var t=0;(t=this._config.isLive?e/8:e<512?e:e>=512&&e<=1024?Math.floor(1.5*e):2*e)>8192&&(t=8192);var a=1024*t+1048576;this._bufferSize<a&&this._expandBuffer(a),this._stashSize=1024*t},e.prototype._dispatchChunks=function(e,t){return this._currentRange.to=t+e.byteLength-1,this._onDataArrival(e,t)},e.prototype._onURLRedirect=function(e){this._redirectedURL=e,this._onRedirect&&this._onRedirect(e)},e.prototype._onContentLengthKnown=function(e){e&&this._fullRequestFlag&&(this._totalLength=e,this._fullRequestFlag=!1)},e.prototype._onLoaderChunkArrival=function(e,t,a){if(!this._onDataArrival)throw new l.a("IOController: No existing consumer (onDataArrival) callback!");if(!this._paused){this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,this._onRecoveredEarlyEof&&this._onRecoveredEarlyEof()),this._speedSampler.addBytes(e.byteLength);var n=this._speedSampler.lastSecondKBps;if(0!==n){var i=this._normalizeSpeed(n);this._speedNormalized!==i&&(this._speedNormalized=i,this._adjustStashSize(i))}if(this._enableStash)if(0===this._stashUsed&&0===this._stashByteStart&&(this._stashByteStart=t),this._stashUsed+e.byteLength<=this._stashSize)(s=new Uint8Array(this._stashBuffer,0,this._stashSize)).set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength;else if(s=new Uint8Array(this._stashBuffer,0,this._bufferSize),this._stashUsed>0){var r=this._stashBuffer.slice(0,this._stashUsed);(d=this._dispatchChunks(r,this._stashByteStart))<r.byteLength?d>0&&(c=new Uint8Array(r,d),s.set(c,0),this._stashUsed=c.byteLength,this._stashByteStart+=d):(this._stashUsed=0,this._stashByteStart+=d),this._stashUsed+e.byteLength>this._bufferSize&&(this._expandBuffer(this._stashUsed+e.byteLength),s=new Uint8Array(this._stashBuffer,0,this._bufferSize)),s.set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength}else(d=this._dispatchChunks(e,t))<e.byteLength&&((o=e.byteLength-d)>this._bufferSize&&(this._expandBuffer(o),s=new Uint8Array(this._stashBuffer,0,this._bufferSize)),s.set(new Uint8Array(e,d),0),this._stashUsed+=o,this._stashByteStart=t+d);else if(0===this._stashUsed){var o;(d=this._dispatchChunks(e,t))<e.byteLength&&((o=e.byteLength-d)>this._bufferSize&&this._expandBuffer(o),(s=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(e,d),0),this._stashUsed+=o,this._stashByteStart=t+d)}else{var s,d;if(this._stashUsed+e.byteLength>this._bufferSize&&this._expandBuffer(this._stashUsed+e.byteLength),(s=new Uint8Array(this._stashBuffer,0,this._bufferSize)).set(new Uint8Array(e),this._stashUsed),this._stashUsed+=e.byteLength,(d=this._dispatchChunks(this._stashBuffer.slice(0,this._stashUsed),this._stashByteStart))<this._stashUsed&&d>0){var c=new Uint8Array(this._stashBuffer,d);s.set(c,0)}this._stashUsed-=d,this._stashByteStart+=d}}},e.prototype._flushStashBuffer=function(e){if(this._stashUsed>0){var t=this._stashBuffer.slice(0,this._stashUsed),a=this._dispatchChunks(t,this._stashByteStart),n=t.byteLength-a;if(a<t.byteLength){if(!e){if(a>0){var r=new Uint8Array(this._stashBuffer,0,this._bufferSize),o=new Uint8Array(t,a);r.set(o,0),this._stashUsed=o.byteLength,this._stashByteStart+=a}return 0}i.a.w(this.TAG,n+" bytes unconsumed data remain when flush buffer, dropped")}return this._stashUsed=0,this._stashByteStart=0,n}return 0},e.prototype._onLoaderComplete=function(e,t){this._flushStashBuffer(!0),this._onComplete&&this._onComplete(this._extraData)},e.prototype._onLoaderError=function(e,t){switch(i.a.e(this.TAG,"Loader error, code = "+t.code+", msg = "+t.msg),this._flushStashBuffer(!1),this._isEarlyEofReconnecting&&(this._isEarlyEofReconnecting=!1,e=o.b.UNRECOVERABLE_EARLY_EOF),e){case o.b.EARLY_EOF:if(!this._config.isLive&&this._totalLength){var a=this._currentRange.to+1;return void(a<this._totalLength&&(i.a.w(this.TAG,"Connection lost, trying reconnect..."),this._isEarlyEofReconnecting=!0,this._internalSeek(a,!1)))}e=o.b.UNRECOVERABLE_EARLY_EOF;case o.b.UNRECOVERABLE_EARLY_EOF:case o.b.CONNECTING_TIMEOUT:case o.b.HTTP_STATUS_CODE_INVALID:case o.b.EXCEPTION:}if(!this._onError)throw new l.d("IOException: "+t.msg);this._onError(e,t)},e}();t.a=y},function(e,t,a){var n=function(){function e(){}return e.install=function(){Object.setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},Object.assign=Object.assign||function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),a=1;a<arguments.length;a++){var n=arguments[a];if(null!=n)for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])}return t},"function"!=typeof self.Promise&&a(15).polyfill()},e}();n.install(),t.a=n},function(e,t,a){function n(e){var t={};function a(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=t,a.i=function(e){return e},a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},a.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/",a.oe=function(e){throw e};var n=a(a.s=ENTRY_MODULE);return n.default||n}function i(e){return(e+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function r(e,t,n){var r={};r[n]=[];var o=t.toString(),s=o.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!s)return r;for(var l,d=s[1],c=new RegExp("(\\\\n|\\W)"+i(d)+"\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)","g");l=c.exec(o);)"dll-reference"!==l[3]&&r[n].push(l[3]);for(c=new RegExp("\\("+i(d)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)',"g");l=c.exec(o);)e[l[2]]||(r[n].push(l[1]),e[l[2]]=a(l[1]).m),r[l[2]]=r[l[2]]||[],r[l[2]].push(l[4]);for(var u,h=Object.keys(r),p=0;p<h.length;p++)for(var f=0;f<r[h[p]].length;f++)u=r[h[p]][f],isNaN(1*u)||(r[h[p]][f]=1*r[h[p]][f]);return r}function o(e){return Object.keys(e).reduce((function(t,a){return t||e[a].length>0}),!1)}e.exports=function(e,t){t=t||{};var i={main:a.m},s=t.all?{main:Object.keys(i.main)}:function(e,t){for(var a={main:[t]},n={main:[]},i={main:{}};o(a);)for(var s=Object.keys(a),l=0;l<s.length;l++){var d=s[l],c=a[d].pop();if(i[d]=i[d]||{},!i[d][c]&&e[d][c]){i[d][c]=!0,n[d]=n[d]||[],n[d].push(c);for(var u=r(e,e[d][c],d),h=Object.keys(u),p=0;p<h.length;p++)a[h[p]]=a[h[p]]||[],a[h[p]]=a[h[p]].concat(u[h[p]])}}return n}(i,e),l="";Object.keys(s).filter((function(e){return"main"!==e})).forEach((function(e){for(var t=0;s[e][t];)t++;s[e].push(t),i[e][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",l=l+"var "+e+" = ("+n.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+s[e].map((function(t){return JSON.stringify(t)+": "+i[e][t].toString()})).join(",")+"});\n"})),l=l+"new (("+n.toString().replace("ENTRY_MODULE",JSON.stringify(e))+")({"+s.main.map((function(e){return JSON.stringify(e)+": "+i.main[e].toString()})).join(",")+"}))(self);";var d=new window.Blob([l],{type:"text/javascript"});if(t.bare)return d;var c=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(d),u=new window.Worker(c);return u.objectURL=c,u}},function(e,t,a){e.exports=a(19).default},function(e,t,a){(function(t,a){var n;n=function(){function e(e){return"function"==typeof e}var n=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},i=0,r=void 0,o=void 0,s=function(e,t){f[i]=e,f[i+1]=t,2===(i+=2)&&(o?o(_):b())},l="undefined"!=typeof window?window:void 0,d=l||{},c=d.MutationObserver||d.WebKitMutationObserver,u="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function p(){var e=setTimeout;return function(){return e(_,1)}}var f=new Array(1e3);function _(){for(var e=0;e<i;e+=2)(0,f[e])(f[e+1]),f[e]=void 0,f[e+1]=void 0;i=0}var m,g,v,y,b=void 0;function E(e,t){var a=this,n=new this.constructor(w);void 0===n[A]&&V(n);var i=a._state;if(i){var r=arguments[i-1];s((function(){return N(i,n,r,a._result)}))}else x(a,n,e,t);return n}function S(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(w);return T(t,e),t}u?b=function(){return t.nextTick(_)}:c?(g=0,v=new c(_),y=document.createTextNode(""),v.observe(y,{characterData:!0}),b=function(){y.data=g=++g%2}):h?((m=new MessageChannel).port1.onmessage=_,b=function(){return m.port2.postMessage(0)}):b=void 0===l?function(){try{var e=Function("return this")().require("vertx");return void 0!==(r=e.runOnLoop||e.runOnContext)?function(){r(_)}:p()}catch(e){return p()}}():p();var A=Math.random().toString(36).substring(2);function w(){}function C(t,a,n){a.constructor===t.constructor&&n===E&&a.constructor.resolve===S?function(e,t){1===t._state?D(e,t._result):2===t._state?k(e,t._result):x(t,void 0,(function(t){return T(e,t)}),(function(t){return k(e,t)}))}(t,a):void 0===n?D(t,a):e(n)?function(e,t,a){s((function(e){var n=!1,i=function(e,t,a,n){try{e.call(t,a,n)}catch(e){return e}}(a,t,(function(a){n||(n=!0,t!==a?T(e,a):D(e,a))}),(function(t){n||(n=!0,k(e,t))}),e._label);!n&&i&&(n=!0,k(e,i))}),e)}(t,a,n):D(t,a)}function T(e,t){if(e===t)k(e,new TypeError("You cannot resolve a promise with itself"));else if(i=typeof(n=t),null===n||"object"!==i&&"function"!==i)D(e,t);else{var a=void 0;try{a=t.then}catch(t){return void k(e,t)}C(e,t,a)}var n,i}function R(e){e._onerror&&e._onerror(e._result),L(e)}function D(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&s(L,e))}function k(e,t){void 0===e._state&&(e._state=2,e._result=t,s(R,e))}function x(e,t,a,n){var i=e._subscribers,r=i.length;e._onerror=null,i[r]=t,i[r+1]=a,i[r+2]=n,0===r&&e._state&&s(L,e)}function L(e){var t=e._subscribers,a=e._state;if(0!==t.length){for(var n=void 0,i=void 0,r=e._result,o=0;o<t.length;o+=3)n=t[o],i=t[o+a],n?N(a,n,i,r):i(r);e._subscribers.length=0}}function N(t,a,n,i){var r=e(n),o=void 0,s=void 0,l=!0;if(r){try{o=n(i)}catch(e){l=!1,s=e}if(a===o)return void k(a,new TypeError("A promises callback cannot return that same promise."))}else o=i;void 0!==a._state||(r&&l?T(a,o):!1===l?k(a,s):1===t?D(a,o):2===t&&k(a,o))}var B=0;function V(e){e[A]=B++,e._state=void 0,e._result=void 0,e._subscribers=[]}var M=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(w),this.promise[A]||V(this.promise),n(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?D(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&D(this.promise,this._result))):k(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var a=this._instanceConstructor,n=a.resolve;if(n===S){var i=void 0,r=void 0,o=!1;try{i=e.then}catch(e){o=!0,r=e}if(i===E&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof i)this._remaining--,this._result[t]=e;else if(a===O){var s=new a(w);o?k(s,r):C(s,e,i),this._willSettleAt(s,t)}else this._willSettleAt(new a((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,a){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?k(n,a):this._result[t]=a),0===this._remaining&&D(n,this._result)},e.prototype._willSettleAt=function(e,t){var a=this;x(e,void 0,(function(e){return a._settledAt(1,t,e)}),(function(e){return a._settledAt(2,t,e)}))},e}(),O=function(){function t(e){this[A]=B++,this._result=this._state=void 0,this._subscribers=[],w!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){T(e,t)}),(function(t){k(e,t)}))}catch(t){k(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var a=this.constructor;return e(t)?this.then((function(e){return a.resolve(t()).then((function(){return e}))}),(function(e){return a.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return O.prototype.then=E,O.all=function(e){return new M(this,e).promise},O.race=function(e){var t=this;return n(e)?new t((function(a,n){for(var i=e.length,r=0;r<i;r++)t.resolve(e[r]).then(a,n)})):new t((function(e,t){return t(new TypeError("You must pass an array to race."))}))},O.resolve=S,O.reject=function(e){var t=new this(w);return k(t,e),t},O._setScheduler=function(e){o=e},O._setAsap=function(e){s=e},O._asap=s,O.polyfill=function(){var e=void 0;if(void 0!==a)e=a;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var n=null;try{n=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===n&&!t.cast)return}e.Promise=O},O.Promise=O,O},e.exports=n()}).call(this,a(16),a(17))},function(e,t){var a,n,i=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(a===setTimeout)return setTimeout(e,0);if((a===r||!a)&&setTimeout)return a=setTimeout,setTimeout(e,0);try{return a(e,0)}catch(t){try{return a.call(null,e,0)}catch(t){return a.call(this,e,0)}}}!function(){try{a="function"==typeof setTimeout?setTimeout:r}catch(e){a=r}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var l,d=[],c=!1,u=-1;function h(){c&&l&&(c=!1,l.length?d=l.concat(d):u=-1,d.length&&p())}function p(){if(!c){var e=s(h);c=!0;for(var t=d.length;t;){for(l=d,d=[];++u<t;)l&&l[u].run();u=-1,t=d.length}l=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function _(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];d.push(new f(e,t)),1!==d.length||c||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=_,i.addListener=_,i.once=_,i.off=_,i.removeListener=_,i.removeAllListeners=_,i.emit=_,i.prependListener=_,i.prependOnceListener=_,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){var a;a=function(){return this}();try{a=a||new Function("return this")()}catch(e){"object"==typeof window&&(a=window)}e.exports=a},function(e,t,a){a.r(t);var n=a(9),i=a(12),r=a(10),o=a(1);t.default=function(e){var t=null,a=function(t,a){e.postMessage({msg:"logcat_callback",data:{type:t,logcat:a}})}.bind(this);function s(t,a){var n={msg:o.a.INIT_SEGMENT,data:{type:t,data:a}};e.postMessage(n,[a.data])}function l(t,a){var n={msg:o.a.MEDIA_SEGMENT,data:{type:t,data:a}};e.postMessage(n,[a.data])}function d(){var t={msg:o.a.LOADING_COMPLETE};e.postMessage(t)}function c(){var t={msg:o.a.RECOVERED_EARLY_EOF};e.postMessage(t)}function u(t){var a={msg:o.a.MEDIA_INFO,data:t};e.postMessage(a)}function h(t){var a={msg:o.a.METADATA_ARRIVED,data:t};e.postMessage(a)}function p(t){var a={msg:o.a.SCRIPTDATA_ARRIVED,data:t};e.postMessage(a)}function f(t){var a={msg:o.a.TIMED_ID3_METADATA_ARRIVED,data:t};e.postMessage(a)}function _(t){var a={msg:o.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,data:t};e.postMessage(a)}function m(t){var a={msg:o.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,data:t};e.postMessage(a)}function g(t){var a={msg:o.a.SMPTE2038_METADATA_ARRIVED,data:t};e.postMessage(a)}function v(t){var a={msg:o.a.SCTE35_METADATA_ARRIVED,data:t};e.postMessage(a)}function y(t){var a={msg:o.a.PES_PRIVATE_DATA_DESCRIPTOR,data:t};e.postMessage(a)}function b(t){var a={msg:o.a.PES_PRIVATE_DATA_ARRIVED,data:t};e.postMessage(a)}function E(t){var a={msg:o.a.STATISTICS_INFO,data:t};e.postMessage(a)}function S(t,a){e.postMessage({msg:o.a.IO_ERROR,data:{type:t,info:a}})}function A(t,a){e.postMessage({msg:o.a.DEMUX_ERROR,data:{type:t,info:a}})}function w(t){e.postMessage({msg:o.a.RECOMMEND_SEEKPOINT,data:t})}i.a.install(),e.addEventListener("message",(function(i){switch(i.data.cmd){case"init":(t=new r.a(i.data.param[0],i.data.param[1])).on(o.a.IO_ERROR,S.bind(this)),t.on(o.a.DEMUX_ERROR,A.bind(this)),t.on(o.a.INIT_SEGMENT,s.bind(this)),t.on(o.a.MEDIA_SEGMENT,l.bind(this)),t.on(o.a.LOADING_COMPLETE,d.bind(this)),t.on(o.a.RECOVERED_EARLY_EOF,c.bind(this)),t.on(o.a.MEDIA_INFO,u.bind(this)),t.on(o.a.METADATA_ARRIVED,h.bind(this)),t.on(o.a.SCRIPTDATA_ARRIVED,p.bind(this)),t.on(o.a.TIMED_ID3_METADATA_ARRIVED,f.bind(this)),t.on(o.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,_.bind(this)),t.on(o.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,m.bind(this)),t.on(o.a.SMPTE2038_METADATA_ARRIVED,g.bind(this)),t.on(o.a.SCTE35_METADATA_ARRIVED,v.bind(this)),t.on(o.a.PES_PRIVATE_DATA_DESCRIPTOR,y.bind(this)),t.on(o.a.PES_PRIVATE_DATA_ARRIVED,b.bind(this)),t.on(o.a.STATISTICS_INFO,E.bind(this)),t.on(o.a.RECOMMEND_SEEKPOINT,w.bind(this));break;case"destroy":t&&(t.destroy(),t=null),e.postMessage({msg:"destroyed"});break;case"start":t.start();break;case"stop":t.stop();break;case"seek":t.seek(i.data.param);break;case"pause":t.pause();break;case"resume":t.resume();break;case"logging_config":var C=i.data.param;n.a.applyConfig(C),!0===C.enableCallback?n.a.addLogListener(a):n.a.removeLogListener(a)}}))}},function(e,t,a){a.r(t);var n=a(12),i=a(11),r={enableWorker:!1,enableStashBuffer:!0,stashInitialSize:void 0,isLive:!1,liveBufferLatencyChasing:!1,liveBufferLatencyMaxLatency:1.5,liveBufferLatencyMinRemain:.5,lazyLoad:!0,lazyLoadMaxDuration:180,lazyLoadRecoverDuration:30,deferLoadAfterSourceOpen:!0,autoCleanupMaxBackwardDuration:180,autoCleanupMinBackwardDuration:120,statisticsInfoReportInterval:600,fixAudioTimestampGap:!0,accurateSeek:!1,seekType:"range",seekParamStart:"bstart",seekParamEnd:"bend",rangeLoadZeroStart:!1,customSeekHandler:void 0,reuseRedirectedURL:!1,headers:void 0,customLoader:void 0};function o(){return Object.assign({},r)}var s=function(){function e(){}return e.supportMSEH264Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"')},e.supportMSEH265Playback=function(){return window.MediaSource&&window.MediaSource.isTypeSupported('video/mp4; codecs="hvc1.1.6.L93.B0"')},e.supportNetworkStreamIO=function(){var e=new i.a({},o()),t=e.loaderType;return e.destroy(),"fetch-stream-loader"==t||"xhr-moz-chunked-loader"==t},e.getNetworkLoaderTypeName=function(){var e=new i.a({},o()),t=e.loaderType;return e.destroy(),t},e.supportNativeMediaPlayback=function(t){null==e.videoElement&&(e.videoElement=window.document.createElement("video"));var a=e.videoElement.canPlayType(t);return"probably"===a||"maybe"==a},e.getFeatureList=function(){var t={msePlayback:!1,mseLivePlayback:!1,mseH265Playback:!1,networkStreamIO:!1,networkLoaderName:"",nativeMP4H264Playback:!1,nativeMP4H265Playback:!1,nativeWebmVP8Playback:!1,nativeWebmVP9Playback:!1};return t.msePlayback=e.supportMSEH264Playback(),t.networkStreamIO=e.supportNetworkStreamIO(),t.networkLoaderName=e.getNetworkLoaderTypeName(),t.mseLivePlayback=t.msePlayback&&t.networkStreamIO,t.mseH265Playback=e.supportMSEH265Playback(),t.nativeMP4H264Playback=e.supportNativeMediaPlayback('video/mp4; codecs="avc1.42001E, mp4a.40.2"'),t.nativeMP4H265Playback=e.supportNativeMediaPlayback('video/mp4; codecs="hvc1.1.6.L93.B0"'),t.nativeWebmVP8Playback=e.supportNativeMediaPlayback('video/webm; codecs="vp8.0, vorbis"'),t.nativeWebmVP9Playback=e.supportNativeMediaPlayback('video/webm; codecs="vp9"'),t},e}(),l=a(2),d=a(6),c=a.n(d),u=a(0),h=a(4),p={ERROR:"error",LOADING_COMPLETE:"loading_complete",RECOVERED_EARLY_EOF:"recovered_early_eof",MEDIA_INFO:"media_info",METADATA_ARRIVED:"metadata_arrived",SCRIPTDATA_ARRIVED:"scriptdata_arrived",TIMED_ID3_METADATA_ARRIVED:"timed_id3_metadata_arrived",SYNCHRONOUS_KLV_METADATA_ARRIVED:"synchronous_klv_metadata_arrived",ASYNCHRONOUS_KLV_METADATA_ARRIVED:"asynchronous_klv_metadata_arrived",SMPTE2038_METADATA_ARRIVED:"smpte2038_metadata_arrived",SCTE35_METADATA_ARRIVED:"scte35_metadata_arrived",PES_PRIVATE_DATA_DESCRIPTOR:"pes_private_data_descriptor",PES_PRIVATE_DATA_ARRIVED:"pes_private_data_arrived",STATISTICS_INFO:"statistics_info",DESTROYING:"destroying"},f=a(13),_=a.n(f),m=a(9),g=a(10),v=a(1),y=a(8),b=function(){function e(e,t){if(this.TAG="Transmuxer",this._emitter=new c.a,t.enableWorker&&"undefined"!=typeof Worker)try{this._worker=_()(18),this._workerDestroying=!1,this._worker.addEventListener("message",this._onWorkerMessage.bind(this)),this._worker.postMessage({cmd:"init",param:[e,t]}),this.e={onLoggingConfigChanged:this._onLoggingConfigChanged.bind(this)},m.a.registerListener(this.e.onLoggingConfigChanged),this._worker.postMessage({cmd:"logging_config",param:m.a.getConfig()})}catch(a){u.a.e(this.TAG,"Error while initialize transmuxing worker, fallback to inline transmuxing"),this._worker=null,this._controller=new g.a(e,t)}else this._controller=new g.a(e,t);if(this._controller){var a=this._controller;a.on(v.a.IO_ERROR,this._onIOError.bind(this)),a.on(v.a.DEMUX_ERROR,this._onDemuxError.bind(this)),a.on(v.a.INIT_SEGMENT,this._onInitSegment.bind(this)),a.on(v.a.MEDIA_SEGMENT,this._onMediaSegment.bind(this)),a.on(v.a.LOADING_COMPLETE,this._onLoadingComplete.bind(this)),a.on(v.a.RECOVERED_EARLY_EOF,this._onRecoveredEarlyEof.bind(this)),a.on(v.a.MEDIA_INFO,this._onMediaInfo.bind(this)),a.on(v.a.METADATA_ARRIVED,this._onMetaDataArrived.bind(this)),a.on(v.a.SCRIPTDATA_ARRIVED,this._onScriptDataArrived.bind(this)),a.on(v.a.TIMED_ID3_METADATA_ARRIVED,this._onTimedID3MetadataArrived.bind(this)),a.on(v.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,this._onSynchronousKLVMetadataArrived.bind(this)),a.on(v.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,this._onAsynchronousKLVMetadataArrived.bind(this)),a.on(v.a.SMPTE2038_METADATA_ARRIVED,this._onSMPTE2038MetadataArrived.bind(this)),a.on(v.a.SCTE35_METADATA_ARRIVED,this._onSCTE35MetadataArrived.bind(this)),a.on(v.a.PES_PRIVATE_DATA_DESCRIPTOR,this._onPESPrivateDataDescriptor.bind(this)),a.on(v.a.PES_PRIVATE_DATA_ARRIVED,this._onPESPrivateDataArrived.bind(this)),a.on(v.a.STATISTICS_INFO,this._onStatisticsInfo.bind(this)),a.on(v.a.RECOMMEND_SEEKPOINT,this._onRecommendSeekpoint.bind(this))}}return e.prototype.destroy=function(){this._worker?this._workerDestroying||(this._workerDestroying=!0,this._worker.postMessage({cmd:"destroy"}),m.a.removeListener(this.e.onLoggingConfigChanged),this.e=null):(this._controller.destroy(),this._controller=null),this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.hasWorker=function(){return null!=this._worker},e.prototype.open=function(){this._worker?this._worker.postMessage({cmd:"start"}):this._controller.start()},e.prototype.close=function(){this._worker?this._worker.postMessage({cmd:"stop"}):this._controller.stop()},e.prototype.seek=function(e){this._worker?this._worker.postMessage({cmd:"seek",param:e}):this._controller.seek(e)},e.prototype.pause=function(){this._worker?this._worker.postMessage({cmd:"pause"}):this._controller.pause()},e.prototype.resume=function(){this._worker?this._worker.postMessage({cmd:"resume"}):this._controller.resume()},e.prototype._onInitSegment=function(e,t){var a=this;Promise.resolve().then((function(){a._emitter.emit(v.a.INIT_SEGMENT,e,t)}))},e.prototype._onMediaSegment=function(e,t){var a=this;Promise.resolve().then((function(){a._emitter.emit(v.a.MEDIA_SEGMENT,e,t)}))},e.prototype._onLoadingComplete=function(){var e=this;Promise.resolve().then((function(){e._emitter.emit(v.a.LOADING_COMPLETE)}))},e.prototype._onRecoveredEarlyEof=function(){var e=this;Promise.resolve().then((function(){e._emitter.emit(v.a.RECOVERED_EARLY_EOF)}))},e.prototype._onMediaInfo=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.MEDIA_INFO,e)}))},e.prototype._onMetaDataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.METADATA_ARRIVED,e)}))},e.prototype._onScriptDataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.SCRIPTDATA_ARRIVED,e)}))},e.prototype._onTimedID3MetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.TIMED_ID3_METADATA_ARRIVED,e)}))},e.prototype._onSynchronousKLVMetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,e)}))},e.prototype._onAsynchronousKLVMetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,e)}))},e.prototype._onSMPTE2038MetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.SMPTE2038_METADATA_ARRIVED,e)}))},e.prototype._onSCTE35MetadataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.SCTE35_METADATA_ARRIVED,e)}))},e.prototype._onPESPrivateDataDescriptor=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.PES_PRIVATE_DATA_DESCRIPTOR,e)}))},e.prototype._onPESPrivateDataArrived=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.PES_PRIVATE_DATA_ARRIVED,e)}))},e.prototype._onStatisticsInfo=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.STATISTICS_INFO,e)}))},e.prototype._onIOError=function(e,t){var a=this;Promise.resolve().then((function(){a._emitter.emit(v.a.IO_ERROR,e,t)}))},e.prototype._onDemuxError=function(e,t){var a=this;Promise.resolve().then((function(){a._emitter.emit(v.a.DEMUX_ERROR,e,t)}))},e.prototype._onRecommendSeekpoint=function(e){var t=this;Promise.resolve().then((function(){t._emitter.emit(v.a.RECOMMEND_SEEKPOINT,e)}))},e.prototype._onLoggingConfigChanged=function(e){this._worker&&this._worker.postMessage({cmd:"logging_config",param:e})},e.prototype._onWorkerMessage=function(e){var t=e.data,a=t.data;if("destroyed"===t.msg||this._workerDestroying)return this._workerDestroying=!1,this._worker.terminate(),void(this._worker=null);switch(t.msg){case v.a.INIT_SEGMENT:case v.a.MEDIA_SEGMENT:this._emitter.emit(t.msg,a.type,a.data);break;case v.a.LOADING_COMPLETE:case v.a.RECOVERED_EARLY_EOF:this._emitter.emit(t.msg);break;case v.a.MEDIA_INFO:Object.setPrototypeOf(a,y.a.prototype),this._emitter.emit(t.msg,a);break;case v.a.METADATA_ARRIVED:case v.a.SCRIPTDATA_ARRIVED:case v.a.TIMED_ID3_METADATA_ARRIVED:case v.a.SYNCHRONOUS_KLV_METADATA_ARRIVED:case v.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED:case v.a.SMPTE2038_METADATA_ARRIVED:case v.a.SCTE35_METADATA_ARRIVED:case v.a.PES_PRIVATE_DATA_DESCRIPTOR:case v.a.PES_PRIVATE_DATA_ARRIVED:case v.a.STATISTICS_INFO:this._emitter.emit(t.msg,a);break;case v.a.IO_ERROR:case v.a.DEMUX_ERROR:this._emitter.emit(t.msg,a.type,a.info);break;case v.a.RECOMMEND_SEEKPOINT:this._emitter.emit(t.msg,a);break;case"logcat_callback":u.a.emitter.emit("log",a.type,a.logcat)}},e}(),E={ERROR:"error",SOURCE_OPEN:"source_open",UPDATE_END:"update_end",BUFFER_FULL:"buffer_full"},S=a(7),A=a(3),w=function(){function e(e){this.TAG="MSEController",this._config=e,this._emitter=new c.a,this._config.isLive&&null==this._config.autoCleanupSourceBuffer&&(this._config.autoCleanupSourceBuffer=!0),this.e={onSourceOpen:this._onSourceOpen.bind(this),onSourceEnded:this._onSourceEnded.bind(this),onSourceClose:this._onSourceClose.bind(this),onSourceBufferError:this._onSourceBufferError.bind(this),onSourceBufferUpdateEnd:this._onSourceBufferUpdateEnd.bind(this)},this._mediaSource=null,this._mediaSourceObjectURL=null,this._mediaElement=null,this._isBufferFull=!1,this._hasPendingEos=!1,this._requireSetMediaDuration=!1,this._pendingMediaDuration=0,this._pendingSourceBufferInit=[],this._mimeTypes={video:null,audio:null},this._sourceBuffers={video:null,audio:null},this._lastInitSegments={video:null,audio:null},this._pendingSegments={video:[],audio:[]},this._pendingRemoveRanges={video:[],audio:[]},this._idrList=new S.a}return e.prototype.destroy=function(){(this._mediaElement||this._mediaSource)&&this.detachMediaElement(),this.e=null,this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.attachMediaElement=function(e){if(this._mediaSource)throw new A.a("MediaSource has been attached to an HTMLMediaElement!");var t=this._mediaSource=new window.MediaSource;t.addEventListener("sourceopen",this.e.onSourceOpen),t.addEventListener("sourceended",this.e.onSourceEnded),t.addEventListener("sourceclose",this.e.onSourceClose),this._mediaElement=e,this._mediaSourceObjectURL=window.URL.createObjectURL(this._mediaSource),e.src=this._mediaSourceObjectURL},e.prototype.detachMediaElement=function(){if(this._mediaSource){var e=this._mediaSource;for(var t in this._sourceBuffers){var a=this._pendingSegments[t];a.splice(0,a.length),this._pendingSegments[t]=null,this._pendingRemoveRanges[t]=null,this._lastInitSegments[t]=null;var n=this._sourceBuffers[t];if(n){if("closed"!==e.readyState){try{e.removeSourceBuffer(n)}catch(e){u.a.e(this.TAG,e.message)}n.removeEventListener("error",this.e.onSourceBufferError),n.removeEventListener("updateend",this.e.onSourceBufferUpdateEnd)}this._mimeTypes[t]=null,this._sourceBuffers[t]=null}}if("open"===e.readyState)try{e.endOfStream()}catch(e){u.a.e(this.TAG,e.message)}e.removeEventListener("sourceopen",this.e.onSourceOpen),e.removeEventListener("sourceended",this.e.onSourceEnded),e.removeEventListener("sourceclose",this.e.onSourceClose),this._pendingSourceBufferInit=[],this._isBufferFull=!1,this._idrList.clear(),this._mediaSource=null}this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement=null),this._mediaSourceObjectURL&&(window.URL.revokeObjectURL(this._mediaSourceObjectURL),this._mediaSourceObjectURL=null)},e.prototype.appendInitSegment=function(e,t){if(!this._mediaSource||"open"!==this._mediaSource.readyState)return this._pendingSourceBufferInit.push(e),void this._pendingSegments[e.type].push(e);var a=e,n=""+a.container;a.codec&&a.codec.length>0&&(n+=";codecs="+a.codec);var i=!1;if(u.a.v(this.TAG,"Received Initialization Segment, mimeType: "+n),this._lastInitSegments[a.type]=a,n!==this._mimeTypes[a.type]){if(this._mimeTypes[a.type])u.a.v(this.TAG,"Notice: "+a.type+" mimeType changed, origin: "+this._mimeTypes[a.type]+", target: "+n);else{i=!0;try{var r=this._sourceBuffers[a.type]=this._mediaSource.addSourceBuffer(n);r.addEventListener("error",this.e.onSourceBufferError),r.addEventListener("updateend",this.e.onSourceBufferUpdateEnd)}catch(e){return u.a.e(this.TAG,e.message),void this._emitter.emit(E.ERROR,{code:e.code,msg:e.message})}}this._mimeTypes[a.type]=n}t||this._pendingSegments[a.type].push(a),i||this._sourceBuffers[a.type]&&!this._sourceBuffers[a.type].updating&&this._doAppendSegments(),h.a.safari&&"audio/mpeg"===a.container&&a.mediaDuration>0&&(this._requireSetMediaDuration=!0,this._pendingMediaDuration=a.mediaDuration/1e3,this._updateMediaSourceDuration())},e.prototype.appendMediaSegment=function(e){var t=e;this._pendingSegments[t.type].push(t),this._config.autoCleanupSourceBuffer&&this._needCleanupSourceBuffer()&&this._doCleanupSourceBuffer();var a=this._sourceBuffers[t.type];!a||a.updating||this._hasPendingRemoveRanges()||this._doAppendSegments()},e.prototype.seek=function(e){for(var t in this._sourceBuffers)if(this._sourceBuffers[t]){var a=this._sourceBuffers[t];if("open"===this._mediaSource.readyState)try{a.abort()}catch(e){u.a.e(this.TAG,e.message)}this._idrList.clear();var n=this._pendingSegments[t];if(n.splice(0,n.length),"closed"!==this._mediaSource.readyState){for(var i=0;i<a.buffered.length;i++){var r=a.buffered.start(i),o=a.buffered.end(i);this._pendingRemoveRanges[t].push({start:r,end:o})}if(a.updating||this._doRemoveRanges(),h.a.safari){var s=this._lastInitSegments[t];s&&(this._pendingSegments[t].push(s),a.updating||this._doAppendSegments())}}}},e.prototype.endOfStream=function(){var e=this._mediaSource,t=this._sourceBuffers;e&&"open"===e.readyState?t.video&&t.video.updating||t.audio&&t.audio.updating?this._hasPendingEos=!0:(this._hasPendingEos=!1,e.endOfStream()):e&&"closed"===e.readyState&&this._hasPendingSegments()&&(this._hasPendingEos=!0)},e.prototype.getNearestKeyframe=function(e){return this._idrList.getLastSyncPointBeforeDts(e)},e.prototype._needCleanupSourceBuffer=function(){if(!this._config.autoCleanupSourceBuffer)return!1;var e=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var a=this._sourceBuffers[t];if(a){var n=a.buffered;if(n.length>=1&&e-n.start(0)>=this._config.autoCleanupMaxBackwardDuration)return!0}}return!1},e.prototype._doCleanupSourceBuffer=function(){var e=this._mediaElement.currentTime;for(var t in this._sourceBuffers){var a=this._sourceBuffers[t];if(a){for(var n=a.buffered,i=!1,r=0;r<n.length;r++){var o=n.start(r),s=n.end(r);if(o<=e&&e<s+3){if(e-o>=this._config.autoCleanupMaxBackwardDuration){i=!0;var l=e-this._config.autoCleanupMinBackwardDuration;this._pendingRemoveRanges[t].push({start:o,end:l})}}else s<e&&(i=!0,this._pendingRemoveRanges[t].push({start:o,end:s}))}i&&!a.updating&&this._doRemoveRanges()}}},e.prototype._updateMediaSourceDuration=function(){var e=this._sourceBuffers;if(0!==this._mediaElement.readyState&&"open"===this._mediaSource.readyState&&!(e.video&&e.video.updating||e.audio&&e.audio.updating)){var t=this._mediaSource.duration,a=this._pendingMediaDuration;a>0&&(isNaN(t)||a>t)&&(u.a.v(this.TAG,"Update MediaSource duration from "+t+" to "+a),this._mediaSource.duration=a),this._requireSetMediaDuration=!1,this._pendingMediaDuration=0}},e.prototype._doRemoveRanges=function(){for(var e in this._pendingRemoveRanges)if(this._sourceBuffers[e]&&!this._sourceBuffers[e].updating)for(var t=this._sourceBuffers[e],a=this._pendingRemoveRanges[e];a.length&&!t.updating;){var n=a.shift();t.remove(n.start,n.end)}},e.prototype._doAppendSegments=function(){var e=this._pendingSegments;for(var t in e)if(this._sourceBuffers[t]&&!this._sourceBuffers[t].updating&&e[t].length>0){var a=e[t].shift();if(a.timestampOffset){var n=this._sourceBuffers[t].timestampOffset,i=a.timestampOffset/1e3;Math.abs(n-i)>.1&&(u.a.v(this.TAG,"Update MPEG audio timestampOffset from "+n+" to "+i),this._sourceBuffers[t].timestampOffset=i),delete a.timestampOffset}if(!a.data||0===a.data.byteLength)continue;try{this._sourceBuffers[t].appendBuffer(a.data),this._isBufferFull=!1,"video"===t&&a.hasOwnProperty("info")&&this._idrList.appendArray(a.info.syncPoints)}catch(e){this._pendingSegments[t].unshift(a),22===e.code?(this._isBufferFull||this._emitter.emit(E.BUFFER_FULL),this._isBufferFull=!0):(u.a.e(this.TAG,e.message),this._emitter.emit(E.ERROR,{code:e.code,msg:e.message}))}}},e.prototype._onSourceOpen=function(){if(u.a.v(this.TAG,"MediaSource onSourceOpen"),this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._pendingSourceBufferInit.length>0)for(var e=this._pendingSourceBufferInit;e.length;){var t=e.shift();this.appendInitSegment(t,!0)}this._hasPendingSegments()&&this._doAppendSegments(),this._emitter.emit(E.SOURCE_OPEN)},e.prototype._onSourceEnded=function(){u.a.v(this.TAG,"MediaSource onSourceEnded")},e.prototype._onSourceClose=function(){u.a.v(this.TAG,"MediaSource onSourceClose"),this._mediaSource&&null!=this.e&&(this._mediaSource.removeEventListener("sourceopen",this.e.onSourceOpen),this._mediaSource.removeEventListener("sourceended",this.e.onSourceEnded),this._mediaSource.removeEventListener("sourceclose",this.e.onSourceClose))},e.prototype._hasPendingSegments=function(){var e=this._pendingSegments;return e.video.length>0||e.audio.length>0},e.prototype._hasPendingRemoveRanges=function(){var e=this._pendingRemoveRanges;return e.video.length>0||e.audio.length>0},e.prototype._onSourceBufferUpdateEnd=function(){this._requireSetMediaDuration?this._updateMediaSourceDuration():this._hasPendingRemoveRanges()?this._doRemoveRanges():this._hasPendingSegments()?this._doAppendSegments():this._hasPendingEos&&this.endOfStream(),this._emitter.emit(E.UPDATE_END)},e.prototype._onSourceBufferError=function(e){u.a.e(this.TAG,"SourceBuffer Error: "+e)},e}(),C=a(5),T={NETWORK_ERROR:"NetworkError",MEDIA_ERROR:"MediaError",OTHER_ERROR:"OtherError"},R={NETWORK_EXCEPTION:l.b.EXCEPTION,NETWORK_STATUS_CODE_INVALID:l.b.HTTP_STATUS_CODE_INVALID,NETWORK_TIMEOUT:l.b.CONNECTING_TIMEOUT,NETWORK_UNRECOVERABLE_EARLY_EOF:l.b.UNRECOVERABLE_EARLY_EOF,MEDIA_MSE_ERROR:"MediaMSEError",MEDIA_FORMAT_ERROR:C.a.FORMAT_ERROR,MEDIA_FORMAT_UNSUPPORTED:C.a.FORMAT_UNSUPPORTED,MEDIA_CODEC_UNSUPPORTED:C.a.CODEC_UNSUPPORTED},D=function(){function e(e,t){this.TAG="MSEPlayer",this._type="MSEPlayer",this._emitter=new c.a,this._config=o(),"object"==typeof t&&Object.assign(this._config,t);var a=e.type.toLowerCase();if("mse"!==a&&"mpegts"!==a&&"m2ts"!==a&&"flv"!==a)throw new A.b("MSEPlayer requires an mpegts/m2ts/flv MediaDataSource input!");!0===e.isLive&&(this._config.isLive=!0),this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this),onvSeeking:this._onvSeeking.bind(this),onvCanPlay:this._onvCanPlay.bind(this),onvStalled:this._onvStalled.bind(this),onvProgress:this._onvProgress.bind(this)},self.performance&&self.performance.now?this._now=self.performance.now.bind(self.performance):this._now=Date.now,this._pendingSeekTime=null,this._requestSetTime=!1,this._seekpointRecord=null,this._progressChecker=null,this._mediaDataSource=e,this._mediaElement=null,this._msectl=null,this._transmuxer=null,this._mseSourceOpened=!1,this._hasPendingLoad=!1,this._receivedCanPlay=!1,this._mediaInfo=null,this._statisticsInfo=null;var n=h.a.chrome&&(h.a.version.major<50||50===h.a.version.major&&h.a.version.build<2661);this._alwaysSeekKeyframe=!!(n||h.a.msedge||h.a.msie),this._alwaysSeekKeyframe&&(this._config.accurateSeek=!1)}return e.prototype.destroy=function(){this._emitter.emit(p.DESTROYING),null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._transmuxer&&this.unload(),this._mediaElement&&this.detachMediaElement(),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){var a=this;e===p.MEDIA_INFO?null!=this._mediaInfo&&Promise.resolve().then((function(){a._emitter.emit(p.MEDIA_INFO,a.mediaInfo)})):e===p.STATISTICS_INFO&&null!=this._statisticsInfo&&Promise.resolve().then((function(){a._emitter.emit(p.STATISTICS_INFO,a.statisticsInfo)})),this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.attachMediaElement=function(e){var t=this;if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),e.addEventListener("seeking",this.e.onvSeeking),e.addEventListener("canplay",this.e.onvCanPlay),e.addEventListener("stalled",this.e.onvStalled),e.addEventListener("progress",this.e.onvProgress),this._msectl=new w(this._config),this._msectl.on(E.UPDATE_END,this._onmseUpdateEnd.bind(this)),this._msectl.on(E.BUFFER_FULL,this._onmseBufferFull.bind(this)),this._msectl.on(E.SOURCE_OPEN,(function(){t._mseSourceOpened=!0,t._hasPendingLoad&&(t._hasPendingLoad=!1,t.load())})),this._msectl.on(E.ERROR,(function(e){t._emitter.emit(p.ERROR,T.MEDIA_ERROR,R.MEDIA_MSE_ERROR,e)})),this._msectl.attachMediaElement(e),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}},e.prototype.detachMediaElement=function(){this._mediaElement&&(this._msectl.detachMediaElement(),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement.removeEventListener("seeking",this.e.onvSeeking),this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay),this._mediaElement.removeEventListener("stalled",this.e.onvStalled),this._mediaElement.removeEventListener("progress",this.e.onvProgress),this._mediaElement=null),this._msectl&&(this._msectl.destroy(),this._msectl=null)},e.prototype.load=function(){var e=this;if(!this._mediaElement)throw new A.a("HTMLMediaElement must be attached before load()!");if(this._transmuxer)throw new A.a("MSEPlayer.load() has been called, please call unload() first!");this._hasPendingLoad||(this._config.deferLoadAfterSourceOpen&&!1===this._mseSourceOpened?this._hasPendingLoad=!0:(this._mediaElement.readyState>0&&(this._requestSetTime=!0,this._mediaElement.currentTime=0),this._transmuxer=new b(this._mediaDataSource,this._config),this._transmuxer.on(v.a.INIT_SEGMENT,(function(t,a){e._msectl.appendInitSegment(a)})),this._transmuxer.on(v.a.MEDIA_SEGMENT,(function(t,a){if(e._msectl.appendMediaSegment(a),e._config.lazyLoad&&!e._config.isLive){var n=e._mediaElement.currentTime;a.info.endDts>=1e3*(n+e._config.lazyLoadMaxDuration)&&null==e._progressChecker&&(u.a.v(e.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),e._suspendTransmuxer())}})),this._transmuxer.on(v.a.LOADING_COMPLETE,(function(){e._msectl.endOfStream(),e._emitter.emit(p.LOADING_COMPLETE)})),this._transmuxer.on(v.a.RECOVERED_EARLY_EOF,(function(){e._emitter.emit(p.RECOVERED_EARLY_EOF)})),this._transmuxer.on(v.a.IO_ERROR,(function(t,a){e._emitter.emit(p.ERROR,T.NETWORK_ERROR,t,a)})),this._transmuxer.on(v.a.DEMUX_ERROR,(function(t,a){e._emitter.emit(p.ERROR,T.MEDIA_ERROR,t,{code:-1,msg:a})})),this._transmuxer.on(v.a.MEDIA_INFO,(function(t){e._mediaInfo=t,e._emitter.emit(p.MEDIA_INFO,Object.assign({},t))})),this._transmuxer.on(v.a.METADATA_ARRIVED,(function(t){e._emitter.emit(p.METADATA_ARRIVED,t)})),this._transmuxer.on(v.a.SCRIPTDATA_ARRIVED,(function(t){e._emitter.emit(p.SCRIPTDATA_ARRIVED,t)})),this._transmuxer.on(v.a.TIMED_ID3_METADATA_ARRIVED,(function(t){e._emitter.emit(p.TIMED_ID3_METADATA_ARRIVED,t)})),this._transmuxer.on(v.a.SYNCHRONOUS_KLV_METADATA_ARRIVED,(function(t){e._emitter.emit(p.SYNCHRONOUS_KLV_METADATA_ARRIVED,t)})),this._transmuxer.on(v.a.ASYNCHRONOUS_KLV_METADATA_ARRIVED,(function(t){e._emitter.emit(p.ASYNCHRONOUS_KLV_METADATA_ARRIVED,t)})),this._transmuxer.on(v.a.SMPTE2038_METADATA_ARRIVED,(function(t){e._emitter.emit(p.SMPTE2038_METADATA_ARRIVED,t)})),this._transmuxer.on(v.a.SCTE35_METADATA_ARRIVED,(function(t){e._emitter.emit(p.SCTE35_METADATA_ARRIVED,t)})),this._transmuxer.on(v.a.PES_PRIVATE_DATA_DESCRIPTOR,(function(t){e._emitter.emit(p.PES_PRIVATE_DATA_DESCRIPTOR,t)})),this._transmuxer.on(v.a.PES_PRIVATE_DATA_ARRIVED,(function(t){e._emitter.emit(p.PES_PRIVATE_DATA_ARRIVED,t)})),this._transmuxer.on(v.a.STATISTICS_INFO,(function(t){e._statisticsInfo=e._fillStatisticsInfo(t),e._emitter.emit(p.STATISTICS_INFO,Object.assign({},e._statisticsInfo))})),this._transmuxer.on(v.a.RECOMMEND_SEEKPOINT,(function(t){e._mediaElement&&!e._config.accurateSeek&&(e._requestSetTime=!0,e._mediaElement.currentTime=t/1e3)})),this._transmuxer.open()))},e.prototype.unload=function(){this._mediaElement&&this._mediaElement.pause(),this._msectl&&this._msectl.seek(0),this._transmuxer&&(this._transmuxer.close(),this._transmuxer.destroy(),this._transmuxer=null)},e.prototype.play=function(){return this._mediaElement.play()},e.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(e){this._mediaElement.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(e){this._mediaElement.muted=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(e){this._mediaElement?this._internalSeek(e):this._pendingSeekTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mediaInfo",{get:function(){return Object.assign({},this._mediaInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statisticsInfo",{get:function(){return null==this._statisticsInfo&&(this._statisticsInfo={}),this._statisticsInfo=this._fillStatisticsInfo(this._statisticsInfo),Object.assign({},this._statisticsInfo)},enumerable:!1,configurable:!0}),e.prototype._fillStatisticsInfo=function(e){if(e.playerType=this._type,!(this._mediaElement instanceof HTMLVideoElement))return e;var t=!0,a=0,n=0;if(this._mediaElement.getVideoPlaybackQuality){var i=this._mediaElement.getVideoPlaybackQuality();a=i.totalVideoFrames,n=i.droppedVideoFrames}else null!=this._mediaElement.webkitDecodedFrameCount?(a=this._mediaElement.webkitDecodedFrameCount,n=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=a,e.droppedFrames=n),e},e.prototype._onmseUpdateEnd=function(){var e=this._mediaElement.buffered,t=this._mediaElement.currentTime;if(this._config.isLive&&this._config.liveBufferLatencyChasing&&e.length>0&&!this._mediaElement.paused){var a=e.end(e.length-1);if(a>this._config.liveBufferLatencyMaxLatency&&a-t>this._config.liveBufferLatencyMaxLatency){var n=a-this._config.liveBufferLatencyMinRemain;this.currentTime=n}}if(this._config.lazyLoad&&!this._config.isLive){for(var i=0,r=0;r<e.length;r++){var o=e.start(r),s=e.end(r);if(o<=t&&t<s){i=s;break}}i>=t+this._config.lazyLoadMaxDuration&&null==this._progressChecker&&(u.a.v(this.TAG,"Maximum buffering duration exceeded, suspend transmuxing task"),this._suspendTransmuxer())}},e.prototype._onmseBufferFull=function(){u.a.v(this.TAG,"MSE SourceBuffer is full, suspend transmuxing task"),null==this._progressChecker&&this._suspendTransmuxer()},e.prototype._suspendTransmuxer=function(){this._transmuxer&&(this._transmuxer.pause(),null==this._progressChecker&&(this._progressChecker=window.setInterval(this._checkProgressAndResume.bind(this),1e3)))},e.prototype._checkProgressAndResume=function(){for(var e=this._mediaElement.currentTime,t=this._mediaElement.buffered,a=!1,n=0;n<t.length;n++){var i=t.start(n),r=t.end(n);if(e>=i&&e<r){e>=r-this._config.lazyLoadRecoverDuration&&(a=!0);break}}a&&(window.clearInterval(this._progressChecker),this._progressChecker=null,a&&(u.a.v(this.TAG,"Continue loading from paused position"),this._transmuxer.resume()))},e.prototype._isTimepointBuffered=function(e){for(var t=this._mediaElement.buffered,a=0;a<t.length;a++){var n=t.start(a),i=t.end(a);if(e>=n&&e<i)return!0}return!1},e.prototype._internalSeek=function(e){var t=this._isTimepointBuffered(e),a=!1,n=0;if(e<1&&this._mediaElement.buffered.length>0){var i=this._mediaElement.buffered.start(0);(i<1&&e<i||h.a.safari)&&(a=!0,n=h.a.safari?.1:i)}if(a)this._requestSetTime=!0,this._mediaElement.currentTime=n;else if(t){if(this._alwaysSeekKeyframe){var r=this._msectl.getNearestKeyframe(Math.floor(1e3*e));this._requestSetTime=!0,this._mediaElement.currentTime=null!=r?r.dts/1e3:e}else this._requestSetTime=!0,this._mediaElement.currentTime=e;null!=this._progressChecker&&this._checkProgressAndResume()}else null!=this._progressChecker&&(window.clearInterval(this._progressChecker),this._progressChecker=null),this._msectl.seek(e),this._transmuxer.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e)},e.prototype._checkAndApplyUnbufferedSeekpoint=function(){if(this._seekpointRecord)if(this._seekpointRecord.recordTime<=this._now()-100){var e=this._mediaElement.currentTime;this._seekpointRecord=null,this._isTimepointBuffered(e)||(null!=this._progressChecker&&(window.clearTimeout(this._progressChecker),this._progressChecker=null),this._msectl.seek(e),this._transmuxer.seek(Math.floor(1e3*e)),this._config.accurateSeek&&(this._requestSetTime=!0,this._mediaElement.currentTime=e))}else window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)},e.prototype._checkAndResumeStuckPlayback=function(e){var t=this._mediaElement;if(e||!this._receivedCanPlay||t.readyState<2){var a=t.buffered;a.length>0&&t.currentTime<a.start(0)&&(u.a.w(this.TAG,"Playback seems stuck at "+t.currentTime+", seek to "+a.start(0)),this._requestSetTime=!0,this._mediaElement.currentTime=a.start(0),this._mediaElement.removeEventListener("progress",this.e.onvProgress))}else this._mediaElement.removeEventListener("progress",this.e.onvProgress)},e.prototype._onvLoadedMetadata=function(e){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null)},e.prototype._onvSeeking=function(e){var t=this._mediaElement.currentTime,a=this._mediaElement.buffered;if(this._requestSetTime)this._requestSetTime=!1;else{if(t<1&&a.length>0){var n=a.start(0);if(n<1&&t<n||h.a.safari)return this._requestSetTime=!0,void(this._mediaElement.currentTime=h.a.safari?.1:n)}if(this._isTimepointBuffered(t)){if(this._alwaysSeekKeyframe){var i=this._msectl.getNearestKeyframe(Math.floor(1e3*t));null!=i&&(this._requestSetTime=!0,this._mediaElement.currentTime=i.dts/1e3)}null!=this._progressChecker&&this._checkProgressAndResume()}else this._seekpointRecord={seekPoint:t,recordTime:this._now()},window.setTimeout(this._checkAndApplyUnbufferedSeekpoint.bind(this),50)}},e.prototype._onvCanPlay=function(e){this._receivedCanPlay=!0,this._mediaElement.removeEventListener("canplay",this.e.onvCanPlay)},e.prototype._onvStalled=function(e){this._checkAndResumeStuckPlayback(!0)},e.prototype._onvProgress=function(e){this._checkAndResumeStuckPlayback()},e}(),k=function(){function e(e,t){this.TAG="NativePlayer",this._type="NativePlayer",this._emitter=new c.a,this._config=o(),"object"==typeof t&&Object.assign(this._config,t);var a=e.type.toLowerCase();if("mse"===a||"mpegts"===a||"m2ts"===a||"flv"===a)throw new A.b("NativePlayer does't support mse/mpegts/m2ts/flv MediaDataSource input!");if(e.hasOwnProperty("segments"))throw new A.b("NativePlayer("+e.type+") doesn't support multipart playback!");this.e={onvLoadedMetadata:this._onvLoadedMetadata.bind(this)},this._pendingSeekTime=null,this._statisticsReporter=null,this._mediaDataSource=e,this._mediaElement=null}return e.prototype.destroy=function(){this._emitter.emit(p.DESTROYING),this._mediaElement&&(this.unload(),this.detachMediaElement()),this.e=null,this._mediaDataSource=null,this._emitter.removeAllListeners(),this._emitter=null},e.prototype.on=function(e,t){var a=this;e===p.MEDIA_INFO?null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then((function(){a._emitter.emit(p.MEDIA_INFO,a.mediaInfo)})):e===p.STATISTICS_INFO&&null!=this._mediaElement&&0!==this._mediaElement.readyState&&Promise.resolve().then((function(){a._emitter.emit(p.STATISTICS_INFO,a.statisticsInfo)})),this._emitter.addListener(e,t)},e.prototype.off=function(e,t){this._emitter.removeListener(e,t)},e.prototype.attachMediaElement=function(e){if(this._mediaElement=e,e.addEventListener("loadedmetadata",this.e.onvLoadedMetadata),null!=this._pendingSeekTime)try{e.currentTime=this._pendingSeekTime,this._pendingSeekTime=null}catch(e){}},e.prototype.detachMediaElement=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src"),this._mediaElement.removeEventListener("loadedmetadata",this.e.onvLoadedMetadata),this._mediaElement=null),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype.load=function(){if(!this._mediaElement)throw new A.a("HTMLMediaElement must be attached before load()!");this._mediaElement.src=this._mediaDataSource.url,this._mediaElement.readyState>0&&(this._mediaElement.currentTime=0),this._mediaElement.preload="auto",this._mediaElement.load(),this._statisticsReporter=window.setInterval(this._reportStatisticsInfo.bind(this),this._config.statisticsInfoReportInterval)},e.prototype.unload=function(){this._mediaElement&&(this._mediaElement.src="",this._mediaElement.removeAttribute("src")),null!=this._statisticsReporter&&(window.clearInterval(this._statisticsReporter),this._statisticsReporter=null)},e.prototype.play=function(){return this._mediaElement.play()},e.prototype.pause=function(){this._mediaElement.pause()},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"buffered",{get:function(){return this._mediaElement.buffered},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._mediaElement.duration},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this._mediaElement.volume},set:function(e){this._mediaElement.volume=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this._mediaElement.muted},set:function(e){this._mediaElement.muted=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentTime",{get:function(){return this._mediaElement?this._mediaElement.currentTime:0},set:function(e){this._mediaElement?this._mediaElement.currentTime=e:this._pendingSeekTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mediaInfo",{get:function(){var e={mimeType:(this._mediaElement instanceof HTMLAudioElement?"audio/":"video/")+this._mediaDataSource.type};return this._mediaElement&&(e.duration=Math.floor(1e3*this._mediaElement.duration),this._mediaElement instanceof HTMLVideoElement&&(e.width=this._mediaElement.videoWidth,e.height=this._mediaElement.videoHeight)),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"statisticsInfo",{get:function(){var e={playerType:this._type,url:this._mediaDataSource.url};if(!(this._mediaElement instanceof HTMLVideoElement))return e;var t=!0,a=0,n=0;if(this._mediaElement.getVideoPlaybackQuality){var i=this._mediaElement.getVideoPlaybackQuality();a=i.totalVideoFrames,n=i.droppedVideoFrames}else null!=this._mediaElement.webkitDecodedFrameCount?(a=this._mediaElement.webkitDecodedFrameCount,n=this._mediaElement.webkitDroppedFrameCount):t=!1;return t&&(e.decodedFrames=a,e.droppedFrames=n),e},enumerable:!1,configurable:!0}),e.prototype._onvLoadedMetadata=function(e){null!=this._pendingSeekTime&&(this._mediaElement.currentTime=this._pendingSeekTime,this._pendingSeekTime=null),this._emitter.emit(p.MEDIA_INFO,this.mediaInfo)},e.prototype._reportStatisticsInfo=function(){this._emitter.emit(p.STATISTICS_INFO,this.statisticsInfo)},e}();n.a.install();var x={createPlayer:function(e,t){var a=e;if(null==a||"object"!=typeof a)throw new A.b("MediaDataSource must be an javascript object!");if(!a.hasOwnProperty("type"))throw new A.b("MediaDataSource must has type field to indicate video file type!");switch(a.type){case"mse":case"mpegts":case"m2ts":case"flv":return new D(a,t);default:return new k(a,t)}},isSupported:function(){return s.supportMSEH264Playback()},getFeatureList:function(){return s.getFeatureList()}};x.BaseLoader=l.a,x.LoaderStatus=l.c,x.LoaderErrors=l.b,x.Events=p,x.ErrorTypes=T,x.ErrorDetails=R,x.MSEPlayer=D,x.NativePlayer=k,x.LoggingControl=m.a,Object.defineProperty(x,"version",{enumerable:!0,get:function(){return"1.7.3"}}),t.default=x}])}(ls);var ds=Vr(ls.exports);const cs=m("video-player");var us=t.defineComponent({name:"NextVideoPlayer",props:{className:{type:String,default:""},style:{type:Object,default:()=>({})},type:{type:String,default:"mp4",values:["mp4","m3u8","flv","mpegts"]},src:{type:String,default:""},tensorflow:{type:Object}},emits:["play","error","detector"],setup(e,{emit:i,expose:o}){const{lang:c}=rn(),h={"zh-cn":s,en:l,"zh-tw":d};h[c.value]?r.addLanguage("zh-CN",h[c.value]):r.addLanguage("zh-CN",s);const p=t.toRaw(e.src),f=t.ref(),_=t.ref(),m=t.ref(),g=t.ref(),v=t.ref(),y=t.ref(null),b=t.ref(null),E=e=>{const i=t.createVNode({render:()=>t.h("span",{class:"screemshot-btn",onClick:()=>((e,t)=>{const a=n.useDateFormat(n.useNow(),"YYYY-MM-DD_HH-mm-ss").value,i=e.el().getElementsByTagName("video")[0],r=document.createElement("canvas"),o=i.videoWidth,s=i.videoHeight;r.width=o,r.height=s;const l=r.getContext("2d"),d=o/s,c=r.width/r.height,u=o,h=s;let p,f,_,m;d>c?(_=r.width,m=r.width/d,p=0,f=Math.round((r.height-m)/2)):d===c?(_=r.width,m=r.height,p=0,f=0):d<c&&(_=r.height*d,m=r.height,p=Math.round((r.width-_)/2),f=0),l.drawImage(i,0,0,u,h,p,f,_,m),t&&l.drawImage(t,0,0);const g="image/png";let v=r.toDataURL(g,.92).replace(g,"image/octet-stream");v=v.replace(/^data:image\/[^;]+/,"data:application/octet-stream");const y=document.createElement("a");y.href=v,y.download=a+"_screenshot.png",y.click()})(m.value,b.value)},[t.h(a.ElIcon,{color:"#FFFFFF",size:"22px"},{default:()=>t.h(Pn)})])});m.value.on("loadedmetadata",(()=>{t.render(i,e)}))},S=(t,a)=>{if(!e.tensorflow)return;const{modelUrl:n,classNames:i}=e.tensorflow;if(!n)throw new Error("模型文件地址不能未空！");if(!i||!i.length)throw new Error("模型类别不能未空！");t.innerHTML="",u.loadGraphModel(n).then((e=>{const n=document.createElement("canvas");n.className=cs.b("recongition"),t.appendChild(n);const r=n.getContext("2d"),o=document.createElement("canvas").getContext("2d");a.ontimeupdate=()=>{const{videoWidth:t,videoHeight:s,offsetTop:l,offsetLeft:d}=a;n.width=t,n.height=s,n.style.top=l+"px",n.style.left=d+"px",hn(a,e,r,u,i,[],o)},y.value=e,b.value=n}))};t.onUnmounted((()=>{y.value&&(u.dispose(),y.value.dispose(),y.value=null),m.value&&(m.value.mse&&(m.value.mse.endOfStream(),m.value.mse.unload(),m.value.mse=null),m.value.pause(),m.value.dispose(),m.value=null),g.value&&(g.value.pause(),g.value.unload(),g.value.detachMediaElement(),g.value.destroy(),g.value=null),v.value&&(v.value.pause(),v.value.unload(),v.value.detachMediaElement(),v.value.destroy(),v.value=null),f.value&&t.render(null,f.value)}));const A=t=>{if(!t)return(()=>{const e=f.value,t=document.createElement("video");t.className="video-js vjs-default-skin",t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),_.value=t,e.appendChild(t),m.value=r(t,{techOrder:["html5"],controls:!0,fluid:!0,preload:"auto",language:"zh-CN",sources:[]});const a=document.createElement("div");e.children[0].appendChild(a),m.value.on("play",(()=>{i("play",t,e),S(a,t)})),E(e)})(),!1;const a=e.type;"m3u8"===a?(e=>{const t=f.value,a=document.createElement("video");a.className="video-js vjs-default-skin",a.setAttribute("autoplay","true"),a.setAttribute("muted","true"),_.value=a,t.appendChild(a);const n={techOrder:["html5"],flvjs:{mediaDataSource:{cors:!0,withCredentials:!1}},controls:!0,fluid:!0,preload:"auto",language:"zh-CN",sources:[{src:e,type:"application/x-mpegURL"}]};m.value=r(a,n);const o=document.createElement("div");t.children[0].appendChild(o),m.value.on("play",(()=>{i("play",a,t),S(o,a)})),E(t)})(t):"mp4"===a?(e=>{const t=f.value,a=document.createElement("video");a.className="video-js vjs-default-skin",a.setAttribute("autoplay","true"),a.setAttribute("muted","true"),_.value=a,t.appendChild(a);const n={techOrder:["html5"],controls:!0,fluid:!0,preload:"auto",language:"zh-CN",sources:[{src:e,type:"video/mp4"}]};m.value=r(a,n);const o=document.createElement("div");t.children[0].appendChild(o),m.value.on("play",(()=>{i("play",a,t),S(o,a)})),E(t)})(t):"mpegts"===a?(e=>{const t=window.mpegts||ds;if(t&&t.getFeatureList().mseLivePlayback){const a=f.value,n=document.createElement("video");n.className="video-js vjs-default-skin",n.setAttribute("autoplay","true"),n.setAttribute("muted","true"),_.value=n,a.appendChild(n);const o={controls:!0,autoplay:!0,fluid:!0,muted:!0,liveui:!0,preload:"auto",language:"zh-CN"};m.value=r(n,o),v.value=t.createPlayer({enableWorker:!0,type:"flv",isLive:!0,url:e}),v.value.attachMediaElement(n),v.value.load(),v.value.play(),v.value.on("error",(()=>{i("error",n)})),E(a);const s=document.createElement("div");a.children[0].appendChild(s),v.value.on("metadata_arrived",(()=>{i("play",n,a),S(s,n)}))}})(t):"flv"===a&&(e=>{const t=f.value,a=document.createElement("video");a.className="video-js vjs-default-skin",a.setAttribute("autoplay","true"),a.setAttribute("muted","true"),_.value=a,t.appendChild(a);const n={techOrder:["html5"],flvjs:{mediaDataSource:{cors:!0,withCredentials:!1}},controls:!0,fluid:!0,preload:"auto",language:"zh-CN",sources:[{src:e,type:"video/x-flv"}]};m.value=r(a,n);const o=document.createElement("div");t.children[0].appendChild(o),m.value.on("play",(()=>{i("play",a,t),S(o,a)})),E(t)})(t)};t.onMounted((()=>{t.nextTick((()=>{A(p)}))}));o({getElement:()=>{const e=f.value,t=e.children[0];return{videoElement:_.value,container:e,palyerContainer:t}}});return()=>t.createVNode(t.Fragment,null,[t.createVNode("div",{ref:f,class:[cs.b(),e.className],style:e.style},null)])}});const hs=fn(us);const ps=fn(t.defineComponent({name:"NextDragResize",props:{},setup:()=>()=>t.createVNode(t.Fragment,null,[t.createVNode(t.Fragment,null,null)])}));var fs=Object.freeze({__proto__:null,NextContainer:Br,NextCrudTable:is,NextDialog:Ho,NextDragResize:ps,NextForm:Qo,NextLayout:Dr,NextMenu:sr,NextSpinLoading:rs,NextTabs:Lr,NextTextEllipsis:bn,NextUpload:ss,NextVideoPlayer:hs});const _s=e=>{e.directive("zoom",{mounted(e,a){if(!a.value)return!1;const n="string"==typeof(i=a.value)||!B(i)&&x(i)&&"[object String]"==k(i)?[a.value,".el-dialog__body",!1,!0]:a.value;var i;n[1]=n[1]?n[1]:".el-dialog__body",n[2]=void 0!==n[2]&&n[2],n[3]=void 0===n[3]||n[3],t.nextTick((()=>{const e=document.querySelector(n[1]),t=document.querySelector(n[0]),a=document.createElement("div");a.className="dialog-zoom",a.onmouseenter=()=>{a.onmousedown=a=>{const i=a.clientX,r=a.clientY,o=e.offsetWidth,s=e.offsetHeight,l=t.offsetWidth,d=t.offsetHeight;document.onmousemove=a=>{a.preventDefault();const c=o+2*(a.clientX-i),u=s+(a.clientY-r);if(e.style.width=`${c}px`,e.style.height=`${u}px`,n[2]){const e=d+(a.clientY-r);t.style.height=`${e}px`}if(n[3]){const e=l+2*(a.clientX-i);t.style.width=`${e}px`}},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null}}},t.appendChild(a)}))}})},ms="0.1.17",gs=function(e){Object.keys(fs).forEach((t=>{const a=fs[t];e.component(a.name,a)})),(e=>{_s(e)})(e)};var vs={version:ms,install:gs};e.NextContainer=Br,e.NextCrudTable=is,e.NextDialog=Ho,e.NextDragResize=ps,e.NextForm=Qo,e.NextLayout=Dr,e.NextMenu=sr,e.NextSpinLoading=rs,e.NextTabs=Lr,e.NextTextEllipsis=bn,e.NextUpload=ss,e.NextVideoPlayer=hs,e.buildLocaleContext=an,e.buildTranslator=tn,e.default=vs,e.defaultNamespace=h,e.install=gs,e.localeContextKey=nn,e.localeLang=Qa,e.namespaceContextKey=f,e.nextUseCssTheme=dn,e.nextUseCssVar=ln,e.translate=en,e.updateThemeColor=e=>{e&&dn("--el-color-primary",e)},e.updateThemeColorCssVar=un,e.useDetectVideo=()=>({detectVideoFrameImage:({container:e,video:t,modelUrl:a,classNames:n,classInput:i=[]},r,o)=>a?n?void u.loadGraphModel(a).then((a=>{const o=document.createElement("canvas"),s=o.getContext("2d");o.style.position="absolute",o.style.zIndex="99",o.style.pointerEvents="none",e&&e.appendChild(o);const l=document.createElement("canvas"),d=l.getContext("2d");t.ontimeupdate=e=>{const{clientWidth:c,clientHeight:h}=e.target,{videoWidth:p,videoHeight:f,offsetTop:_,offsetLeft:m}=t;o.width=p,o.height=f,o.style.top=_+"px",o.style.left=m+"px",o.style.width=c+"px",o.style.height=h+"px",l.width=p,l.height=f,l.style.width=c+"px",l.style.height=h+"px",hn(t,a,s,u,n,i,d,((e,t)=>{const a="image/png";let n=o.toDataURL(a,.92).replace(a,"image/octet-stream");n=n.replace(/^data:image\/[^;]+/,"data:application/octet-stream");const i=l.toDataURL(a,.92);r&&r({name:e,score:t,detectImage:i,detectCanvas:l},{canvas:o,imageDataURL:n})}))}})):(o&&o("模型类别不能未空"),!1):(o&&o("模型文件地址不能为空"),!1)}),e.useGetDerivedNamespace=_,e.useLanguage=(e,a)=>{const n=t.isRef(e)?e:t.ref(e),i=Qa[a]||Qa["zh-cn"];n.value.name=a,n.value.next=i.next},e.useLocale=rn,e.useNamespace=m,e.version=ms,Object.defineProperty(e,"__esModule",{value:!0})}));
