<script setup lang="ts">
import { onMounted, ref } from 'vue';
const classes = ref<any>(['动物-马', '动物-鹿', '动物-狼', '动物-狐狸']);
const list = ref<any>([
	{
		id: 3,
		imageSrc: 'https://fuss10.elemecdn.com/1/34/19aa98b1fcb2781c4fba33d850549jpeg.jpeg',
		labels: {
			shapes: [
				{
					id: 1,
					label: '动物-马',
					group_id: '1',
					shape_type: 'polygon',
					points: [
						[355.0295857988166, 190.46449704142012],
						[380.4733727810651, 188.0976331360947],
						[427.2189349112426, 191.64792899408286],
						[460.9467455621302, 267.38757396449705],
						[463.31360946745565, 376.85502958579883],
						[433.13609467455626, 513.5414201183432],
						[415.9763313609468, 511.17455621301775],
						[406.50887573964496, 394.6065088757396],
						[397.63313609467457, 396.3816568047337],
						[402.36686390532543, 494.6065088757396],
						[381.06508875739644, 494.0147928994083],
						[373.96449704142015, 420.64201183431953],
						[348.5207100591716, 344.31065088757396],
						[337.2781065088758, 307.0325443786982],
						[343.78698224852076, 271.5295857988165],
						[354.43786982248525, 249.63609467455623],
						[362.7218934911243, 227.1508875739645],
						[345.56213017751486, 203.48224852071007],
					],
				},
				{
					id: 2,
					label: '动物-鹿',
					group_id: null,
					shape_type: 'polygon',
					points: [
						[72.18934911242604, 289.87278106508876],
						[83.4319526627219, 290.4644970414201],
						[113.60946745562131, 278.6301775147929],
						[136.09467455621302, 289.87278106508876],
						[168.04733727810654, 297.56508875739644],
						[166.86390532544382, 423.00887573964496],
						[158.57988165680473, 424.78402366863907],
						[155.02958579881658, 362.65384615384613],
						[143.19526627218937, 368.57100591715977],
						[145.5621301775148, 420.64201183431953],
						[138.46153846153848, 424.1923076923077],
						[134.31952662721895, 392.2396449704142],
						[130.17751479289942, 407.62426035502955],
						[133.13609467455623, 427.7426035502958],
						[122.48520710059174, 425.9674556213018],
						[121.30177514792899, 399.34023668639054],
						[123.66863905325445, 373.896449704142],
						[118.3431952662722, 372.1213017751479],
						[119.52662721893492, 426.5591715976331],
						[111.83431952662724, 427.1508875739645],
						[108.28402366863907, 393.4230769230769],
						[95.8579881656805, 352.00295857988164],
						[85.20710059171597, 370.3461538461538],
						[71.00591715976333, 360.87869822485203],
						[72.7810650887574, 340.1686390532544],
						[71.59763313609469, 314.13313609467457],
					],
				},
				{
					id: '20250922222503788741',
					shape_type: 'rectangle',
					points: [
						[590.5429071803853, 352.7618425972731],
						[702.6269702276708, 425.69868480426396],
					],
					label: '动物-马',
					description: '',
					group_id: '2',
				},
				{
					id: '20250922222515775779',
					shape_type: 'circle',
					points: [
						[153.41506129597198, 471.9855269740851],
						[191.2434325744308, 492.3236848971883],
					],
					label: '动物-狐狸',
					description: '',
					group_id: '3',
				},
			],
			imageHeight: 533,
			imageWidth: 800,
		},
	},
	{
		id: 4,
		imageSrc: 'https://fuss10.elemecdn.com/d/e6/c4d93a3805b3ce3f323f7974e6f78jpeg.jpeg',
		labels: {},
	},
]);
const onEditPolygon = (arg: any) => {
	console.log('标注内容-->', arg);
};
const onSave = (node: any, done: Function) => {
	console.log(node);
	setTimeout(() => {
		done();
	}, 500);
};
const labelmeRef = ref<any>(null);
const onSaveClick = () => {
	labelmeRef.value.onSave();
	const currentNode = labelmeRef.value.getCurrentNode();
	console.log(currentNode);
};
</script>

<template>
	<div class="container">
		<el-button @click="onSaveClick" type="primary" style="margin-bottom: 10px">保存</el-button>
		<NextLabelme ref="labelmeRef" :classes="classes" :data="list" @edit-polygon="onEditPolygon" @save="onSave"></NextLabelme>
	</div>
</template>

<style lang="scss" scoped></style>
